{"version":3,"sources":["util/types.ts","components/web3/hooks/useWeb3Modal.ts","store/connectedMember/reducers.ts","store/connectModal/reducers.ts","store/contracts/reducers.ts","store/subgraphNetworkStatus/reducers.ts","store/reducers.ts","store/index.ts","GlobalConnectWalletModal.tsx","Head.tsx","components/common/InputError.tsx","components/common/PreviewInputMarkdown.tsx","pages/governance/CreateGovernanceProposal.tsx","components/common/Wrap.tsx","pages/onboarding/CreateOnboardingProposal.tsx","components/common/Slider.tsx","pages/transfers/CreateTransferProposal.tsx","pages/tributes/CreateTributeProposal.tsx","components/logo/Logo.tsx","components/logo/index.tsx","assets/svg/HamburgerSVG.tsx","components/web3/Web3ModalButton.tsx","components/Nav.tsx","assets/svg/DiscordSVG.tsx","components/common/SocialMedia.tsx","assets/svg/GitHubSVG.tsx","pages/start/GetStarted.tsx","components/governance/GovernanceActions.tsx","pages/subpages/NotFound.tsx","components/proposals/ProposalDetails.tsx","pages/governance/GovernanceProposalDetails.tsx","components/proposals/ProposalCard.tsx","components/governance/GovernanceProposalsList.tsx","components/governance/hooks/useGovernanceProposals.ts","pages/governance/GovernanceProposals.tsx","util/features.ts","components/dao-token/hooks/useDaoTokenDetails.ts","components/kyc-onboarding/hooks/useTotalAmountContributedMultisig.ts","components/kyc-onboarding/hooks/useVerifyKYCApplicant.tsx","pages/kyc-onboarding/KycOnboardingForm.tsx","assets/svg/CopySVG.tsx","assets/svg/WalletSVG.tsx","components/dao-token/DaoToken.tsx","components/common/Checkbox.tsx","pages/members/Delegation.tsx","assets/svg/UserSVG.tsx","pages/members/hooks/useMembers.ts","pages/members/MemberProfile.tsx","pages/members/MemberCard.tsx","pages/members/Members.tsx","components/proposals/Proposals.tsx","pages/onboarding/Onboarding.tsx","components/proposals/ProcessActionOnboarding.tsx","components/proposals/ProposalActions.tsx","components/proposals/ProposalAmount.tsx","pages/onboarding/OnboardingDetails.tsx","components/feedback/LoaderWithEmoji.tsx","pages/redeem/RedeemManager.tsx","pages/redeem/Redeem.tsx","components/proposals/PostProcessActionTransfer.tsx","pages/transfers/TransferDetails.tsx","pages/transfers/Transfers.tsx","components/proposals/ProcessActionTribute.tsx","pages/tributes/TributeDetails.tsx","pages/tributes/Tributes.tsx","components/Header.tsx","components/Footer.tsx","Routes.tsx","Init.tsx","App.tsx","InitError.tsx","reportWebVitals.ts","index.tsx","util/helpers/chooseRandom.ts","util/helpers/disableReactDevTools.ts","util/helpers/dontCloseWindowWarning.ts","util/helpers/formatNumber.ts","util/helpers/formatNumberAbbreviated.ts","util/helpers/getAlchemyURL.ts","util/helpers/getTimeRemaining.ts","util/helpers/getValidationError.ts","util/helpers/normalizeString.ts","util/helpers/isPossibleContractWallet.ts","util/helpers/numberRangeArray.ts","util/helpers/stripFormatNumber.ts","gql/queryDao.ts","gql/queryMembers.ts","gql/queryAdaptersAndExtensions.ts","gql/queryTokenHolderBalances.ts","gql/handleSubgraphError.ts","config.ts","components/proposals/voting/OffchainOpRollupVotingSubmitResultAction.tsx","components/proposals/voting/OffchainVotingAction.tsx","components/proposals/ProposalPeriodCountdown.tsx","assets/svg/StopwatchSVG.tsx","components/proposals/voting/VotingStatus.tsx","components/proposals/voting/OffchainVotingStatus.tsx","assets/svg/CheckSVG.tsx","components/proposals/voting/SquareRootVotingBar.tsx","components/proposals/voting/VotingActionButtons.tsx","components/web3/hooks/useContractSend.ts","components/web3/hooks/useENSName.ts","components/web3/hooks/useETHGasPrice.ts","components/web3/hooks/useInitContracts.ts","components/web3/hooks/useIsDefaultChain.ts","components/web3/hooks/useMaybeContractWallet.ts","assets/svg/TimesSVG.tsx","util/helpers/numberTo0xHexString.ts","hooks/useRedeemCoupon.ts","store/connectedMember/actions.ts","store/connectModal/actions.ts","components/web3/hooks/useWeb3ModalManager.ts","components/common/CopyWithTooltip.tsx","util/helpers/truncateEthAddress.ts","components/web3/helpers/getExtensionAddress.ts","store/subgraphNetworkStatus/actions.ts","components/feedback/CycleEllipsis.tsx","components/proposals/SubmitAction.tsx","components/web3/Web3ModalManager.tsx","store/contracts/actions.ts","components/common/FadeIn.tsx","components/web3/helpers/alchemyFetchAssetTransfers.ts","components/web3/helpers/contractSend.ts","components/web3/helpers/getAdapterAddress.ts","components/web3/helpers/getDaoState.ts","components/web3/helpers/getAdapterAddressFromContracts.ts","components/web3/helpers/getContractByAddress.ts","components/web3/helpers/getDAOAddressConfigEntry.ts","components/web3/helpers/getDAOConfigEntry.ts","components/web3/helpers/getVotingAdapterName.ts","components/web3/helpers/hasFlag.ts","components/web3/helpers/isNotReservedAddress.ts","components/web3/helpers/isNotZeroAddress.ts","components/web3/helpers/multicall.ts","components/web3/helpers/reverseResolveENS.ts","components/common/ErrorMessageWithDetails.tsx","hooks/useAbortController.ts","hooks/useCounter.ts","hooks/useDaoConfigurations.ts","hooks/useDaoTotalUnits.ts","hooks/useIsMounted.ts","hooks/useMemberActionDisabled.tsx","hooks/useMemberUnitsAtSnapshot.ts","hooks/useTimeStartEnd.ts","util/enums.ts","components/adapters-extensions/enums.ts","components/proposals/types.ts","components/proposals/hooks/useCheckApplicant.ts","components/proposals/hooks/useDaoProposals.ts","components/proposals/hooks/useOffchainVotingResults.ts","components/proposals/hooks/useProposalsVotingAdapter.ts","components/proposals/hooks/useProposalOrDraft.ts","components/proposals/hooks/useProposals.ts","components/proposals/hooks/useProposalsVotes.ts","components/proposals/hooks/useProposalsVotingState.ts","components/proposals/hooks/useProposalWithOffchainVoteStatus.ts","components/proposals/hooks/useSignAndSendVote.ts","components/proposals/hooks/useSignAndSubmitProposal.ts","components/proposals/voting/types.ts","components/web3/helpers/isEIP1559Compatible.ts","components/common/Modal.tsx","util/constants.ts","components/web3/WalletIcon.tsx","components/feedback/index.ts","components/web3/EtherscanURL.tsx","components/feedback/Loader.tsx","components/proposals/helpers/calculateVotingTimeRanges.ts","components/proposals/helpers/getOffchainVotingProof.ts","components/proposals/helpers/getVoteChosen.ts","components/proposals/helpers/getVotingAdapterABI.ts","components/proposals/helpers/proposalHasFlag.ts","components/proposals/helpers/proposalHasVotingState.ts","components/proposals/helpers/submitOffchainVotingProof.ts","components/web3/config.ts","components/feedback/CycleMessage.tsx","util/validation.ts","components/feedback/LoaderLarge.tsx","components/web3/types.ts","store/subgraphNetworkStatus/types.ts"],"names":["AsyncStatus","useWeb3Modal","useContext","Web3ModalContext","INITIAL_STATE","setConnectedMemberReducer","state","payload","clearConnectedMemberReducer","isOpen","connectModalClose","connectModalOpen","initialState","BankAdapterContract","BankExtensionContract","BankFactoryContract","ConfigurationContract","CouponOnboardingContract","DaoFactoryContract","DaoRegistryAdapterContract","DaoRegistryContract","DistributeContract","ERC20ExtensionContract","FinancingContract","GuildKickContract","KycOnboardingContract","ManagingContract","NFTExtensionContract","OnboardingContract","RagequitContract","TributeContract","TributeNFTContract","VotingContract","clearContracts","contractBankFactory","contractDAOFactory","contractDAORegistry","contractDaoRegistryAdapter","contractBankExtension","contractConfiguration","contractDistribute","contractFinancing","contractGuildKick","contractOnboarding","contractRagequit","contractTribute","contractVoting","contractManaging","contractBankAdapter","contractTributeNFT","contractCouponOnboarding","contractKycOnboarding","contractNFTExtension","contractERC20Extension","status","SubgraphNetworkStatus","OK","setSubgraphNetworkStatus","combineReducers","connectModal","action","type","CONNECT_MODAL_CLOSE","CONNECT_MODAL_OPEN","connectedMember","SET_CONNECTED_MEMBER","CLEAR_CONNECTED_MEMBER","contracts","CLEAR_CONTRACTS","CONTRACT_BANK_ADAPTER","CONTRACT_BANK_EXTENSION","CONTRACT_BANK_FACTORY","CONTRACT_CONFIGURATION","CONTRACT_COUPON_ONBOARDING","CONTRACT_DAO_FACTORY","CONTRACT_DAO_REGISTRY","CONTRACT_DAO_REGISTRY_ADAPTER","CONTRACT_DISTRIBUTE","CONTRACT_ERC20_EXTENSION","CONTRACT_FINANCING","CONTRACT_GUILDKICK","CONTRACT_KYC_ONBOARDING","CONTRACT_MANAGING","CONTRACT_NFT_EXTENSION","CONTRACT_ONBOARDING","CONTRACT_RAGEQUIT","CONTRACT_TRIBUTE","CONTRACT_TRIBUTE_NFT","CONTRACT_VOTING","CONTRACT_VOTING_OP_ROLLUP","subgraphNetworkStatus","SET_SUBGRAPH_NETWORK_STATUS","store","createStore","rootReducer","composeWithDevTools","applyMiddleware","thunk","ConnectWalletModal","lazy","GlobalConnectWalletModal","isConnectModalOpen","useSelector","useState","onRequestClose","dispatch","modalProps","setModalProps","account","connected","initialCachedConnectorCheckStatus","web3Instance","isDefaultChain","useIsDefaultChain","maybeContractWallet","useMaybeContractWallet","currentProvider","useDispatch","pathname","useLocation","useEffect","prevState","FULFILLED","fallback","Head","Helmet","name","content","InputError","props","error","restProps","FadeIn","className","PreviewInputMarkdown","value","style","cursor","outline","marginTop","Fields","Wrap","children","rest","position","CreateGovernanceProposal","delegateAddress","s","delegateKey","isAddressDelegated","isActiveMember","submitError","setSubmitError","useSignAndSubmitProposal","proposalSignAndSendStatus","signAndSendProposal","defaultChainError","form","useForm","mode","reValidateMode","history","useHistory","errors","getValues","register","trigger","watch","isConnected","isInProcess","Web3TxStatus","AWAITING_CONFIRM","PENDING","isDone","isInProcessOrDone","handleSubmit","values","a","partialProposalData","title","body","description","metadata","SnapshotMetadataType","Governance","SnapshotType","proposal","uniqueId","push","e","RenderWrapper","onSubmit","preventDefault","htmlFor","id","ref","required","FormFieldErrors","REQUIRED","disabled","getValidationError","placeholder","onClick","Loader","intervalMs","renderSubmitStatus","ErrorMessageWithDetails","renderText","message","truncateEthAddress","getUnauthorizedMessage","Slider","defaultValue","max","min","onChange","step","setValue","Number","event","target","PLACEHOLDER","isERC20Onboarding","ONBOARDING_TOKEN_ADDRESS","ETH_TOKEN_ADDRESS","renderUnauthorizedMessage","CreateOnboardingProposal","daoRegistryContract","proposalData","proposalSignAndSendError","userAccountBalance","setUserAccountBalance","sliderStep","setSliderStep","sliderMin","setSliderMin","sliderMax","setSliderMax","onboardingConfigs","setOnboardingConfigs","erc20Contract","setERC20Contract","erc20Details","setERC20Details","clearErrors","control","ethAddressValue","ethAddress","amountValue","amount","createOnboardError","useCheckApplicant","checkApplicantError","checkApplicantInvalidMsg","checkApplicantStatus","isApplicantValid","minUnitsText","formatNumber","unitsPerChunk","minAmountText","maxUnitsText","String","toBN","mul","maximumChunks","maxAmountText","amountUnit","symbol","getUserAccountBalanceCached","useCallback","setSliderConfigsCached","undefined","divisor","pow","decimals","beforeDecimal","chunkSize","div","afterDecimal","mod","stepAmount","eq","fromWei","console","getOnboardingConfigsCached","getERC20ContractCached","getERC20DetailsCached","Error","lazyERC20ABI","default","instance","eth","Contract","methods","call","getDAOConfigEntry","ContractDAOConfigKeys","onboardingChunkSize","UNITS_ADDRESS","onboardingMaximumChunks","onboardingUnitsPerChunk","balanceOf","balance","balanceBN","balanceReadable","utils","getBalance","warn","proposalId","ethAddressToChecksum","toChecksumAddress","proposerAddressToChecksum","amountArg","isInteger","multiplier","erc20AmountWithDecimals","ethAmountInWei","toWei","proposalAmountValues","tributeAmount","tributeAmountUnit","submitActionArgs","normalizeString","accountAuthorizedToProcessPassedProposal","adapterName","ContractAdapterNames","onboarding","draft","validate","isEthAddressValid","INVALID_ETHEREUM_ADDRESS","render","rules","renderUserAccountBalance","detailsProps","open","CreateTransferProposal","gasPrice","useETHGasPrice","average","useContractSend","txError","txEtherscanURL","txIsPromptOpen","txSend","txStatus","daoTokens","setDaoTokens","selectedTokenBalance","setSelectedTokenBalance","isTypeAllMembers","selectedTokenValue","createTransferError","erc20ABI","ERC20ABI","getDaoTokensCached","getSelectedTokenBalanceCached","bankABI","abi","bankAddress","contractAddress","bankMethods","nbTokens","parsedAndSortedTokens","getTokenABI","find","item","getTokenCalls","Array","keys","map","index","toString","multicall","calls","fetchedTokens","balanceOfABI","getDaoTokenBalanceCalls","token","GUILD_ADDRESS","daoTokenBalances","tokensArray","address","daoBalance","filter","tokenObj","gt","ethToken","erc20Tokens","length","nameABI","nameCalls","symbolABI","symbolCalls","decimalsABI","decimalsCalls","erc20DetailsCalls","results","chunkedResults","splice","names","symbols","parsedAndSortedERC20Tokens","sort","b","localeCompare","selectedTokenObj","JSON","parse","selectedToken","memberAddress","notes","memberAddressToChecksum","tokenAddress","stripFormatNumber","amountWithDecimals","data","signature","submitter","bodyIntro","transferAmount","transferAmountUnit","now","Math","floor","Date","timestamp","distribute","returnData","returnSignature","returnSubmitter","memberAddressArg","BURN_ADDRESS","preparedVoteVerificationBytes","prepareVoteProposalData","choices","snapshot","start","end","sig","space","parseInt","transferArguments","txArguments","from","isActiveMemberWithUnits","unitsBalance","stringify","debounce","amountToNumber","isSelectedTokenEth","isNaN","INVALID_NUMBER","CycleMessage","messages","TX_CYCLE_MESSAGES","useFirstItemStart","EtherscanURL","url","isPending","CreateTributeProposal","userERC20Balance","setUserERC20Balance","erc20AddressValue","erc20Address","applicantAddressValue","applicantAddress","createTributeError","getUserERC20BalanceCached","getRequestAmountUnit","log","requestAmount","tributeAmountWithDecimals","requestAmountArg","applicantAddressToChecksum","requestAmountUnit","tribute","visibility","height","margin","width","display","alignItems","amountChange","readOnly","backgroundColor","marginBottom","padding","method","kycSubmit","document","getElementById","innerHTML","click","formEl","forms","formData","FormData","fetch","res","Logo","size","ModalLogo","LeftLogo","CenterLogo","HamburgerSVG","xmlns","viewBox","fill","d","ConnectWalletButton","customWalletText","showWalletETHBadge","accountENS","web3Modal","isWrongNetwork","isMobile","providerName","cachedProvider","defaultStyle","transition","transitionOpeningStyles","entering","right","entered","exiting","opacity","exited","transitionClosingStyles","NavHamburger","shouldShowMenuModal","setShouldShowMenuModal","transitionStyles","setTransitionStyles","closeMenuRef","useRef","current","clearTimeout","isCurrentMemberOrDelegateConnected","handleMenuModalClose","close","setTimeout","tabIndex","ariaHideApp","overlayClassName","role","overlay","zIndex","Transition","appear","in","timeout","TimesSVG","to","Nav","query","_matches","DiscordSVG","fillRule","stroke","strokeWidth","transform","SocialMediaLinks","GitHubSVG","React","Component","SocialMedia","href","DISCORD","rel","GITHUB","TributeCube","memo","GetStartedHeader","GetStarted","AOS","init","duration","offset","delay","mirror","once","ENABLE_KYC_ONBOARDING","GovernanceActions","snapshotProposal","votingStartMs","msg","votingEndMs","hasVotingStarted","hasVotingEnded","votingStartEndInitReady","votingPeriodData","setVotingPeriodData","offchainVotingResults","useOffchainVotingResults","handleOnVotingPeriodChangeCached","votingPeriodProps","votingResult","countdownVotingEndMs","countdownVotingStartMs","onVotingPeriodChange","NotFound","textAlign","fontSize","ProposalDetails","renderAmountBadge","renderActions","commonData","getCommonSnapshotProposalData","GovernanceProposalDetails","useParams","useProposalOrDraft","proposalError","proposalNotFound","proposalStatus","LoaderLarge","DEFAULT_BUTTON_TEXT","ResponsiveEllipsis","responsiveHOC","LinesEllipsis","ProposalCard","buttonText","proposalOnClickId","linkPath","renderStatus","location","path","text","maxLine","ellipsis","trimRight","basedOn","renderName","GovernanceProposalsList","actionId","onProposalClick","proposalLinkPath","renderProposalCard","proposalsForVotingResults","setProposalsForVotingResults","failedProposals","passedProposals","votingProposals","filteredProposals","setFilteredProposals","governanceProposals","setGovernanceProposals","governanceProposalsError","setGovernanceProposalsError","STANDBY","governanceProposalsStatus","setGovernanceProposalsStatus","isMountedRef","useIsMounted","useQuery","getSnapshotProposalsByActionId","enabled","snapshotProposalEntriesData","snapshotProposalEntriesError","handleGetProposalsCached","baseURL","SNAPSHOT_HUB_API_URL","SPACE","proposals","ok","json","proposalsJSON","Object","entries","daoProposal","snapshotDraft","idInSnapshot","idInDAO","refetchProposalOrDraft","snapshotType","REJECTED","useGovernanceProposals","offchainVotingResultsError","offchainVotingResultsStatus","isLoading","renderProposalCards","proposalName","offchainResult","proposalHash","gp","filteredProposalsToSet","forEach","p","ceil","didPassSimpleMajority","Yes","units","No","flatMap","ProposalHeaderNames","VOTING","PASSED","FAILED","GovernanceProposals","featureFlags","joinIsWhitelisted","useDaoTokenDetails","daoTokenDetails","setDaoTokenDetails","daoTokenDetailsStatus","setDaoTokenDetailsStatus","daoTokenDetailsError","setDaoTokenDetailsError","getDaoTokenDetailsCached","image","window","origin","sha3","kycOnboardingChunkSize","kycOnboardingMaximumChunks","CHECK_IN_PROGRESS_JSX","REDIRECT_IN_PROGRESS_JSX","NOT_WHITELISTED_JSX","PENDING_VERIFICATION_JSX","setStateWithDelay","setState","Promise","r","txEtherscanURLTokenApprove","txStatusTokenApprove","KycOnboardingForm","kycOnboardingContract","txIsPromptOpenTokenApprove","txSendTokenApprove","kycCheckStatus","setKYCCheckStatus","kycCheckCertificate","setKYCCheckCertificate","kycCheckError","setKYCCheckError","kycCheckMessageJSX","setKYCCheckMessageJSX","setETHAddress","redirect","setRedirect","shouldRedirect","setShouldRedirect","useAbortController","abortController","setKYCCheckMessageJSXWithDelay","useMemo","setRedirectWithDelay","verifyApplicantKYCCached","signal","KYC_BACKEND_URL","response","responseJSON","includes","isWhitelisted","abort","setKYCCheckETHAddress","setKYCCheckRedirect","useVerifyKYCApplicant","kycOnboardingConfigs","setKycOnboardingConfigs","kycOnboardingError","submitDisabled","maxMembersText","maxMembers","getKycOnboardingConfigsCached","kycOnboardingMaxMembers","kycOnboardingUnitsPerChunk","handleSubmitTokenApprove","allowance","allowanceBN","difference","sub","approveAmount","add","tokenApproveArguments","onboardERC20Arguments","txReceipt","onboardEthArguments","getConnectedMember","addTokenToWallet","ethereum","request","params","options","KYC_FORMS_URL","CopySVG","focusable","ArrowsSVG","DaoToken","CopyWithTooltip","elementRef","isCopied","setCopied","tooltipID","textToCopy","effect","delayShow","CheckboxSize","DelegationStatus","DelegationStep","UserSVG","DelegationModal","closeHandler","currentStep","daoRegistryAdapterContract","delegateError","delegateAddressValue","confirmDelegationValue","confirmDelegation","isFormFieldEmpty","steps","setDelegation","SMALL","handleConfirmDelegation","revokeDelegation","handleRevokeDelegation","updateDelegation","updateDelegateKeyArguments","parsedError","Modal","keyProp","isOpenHandler","modalClassNames","Delegation","SET_DELEGATION","setCurrentStep","delegationStatus","setDelegationStatus","showDelegationModal","setShowDelegationModal","fetchDelegationInfoCached","DELEGATE","REVOKE_DELEGATION","UPDATE_DELEGATION","UPDATE_DELEGATE","renderDelegationStatus","useMembers","useENSName","ensReverseResolvedAddresses","setAddressesToENSReverseResolve","useLazyQuery","GET_MEMBERS","variables","daoAddress","toLowerCase","getMembersFromSubgraphResult","called","loading","members","setMembers","membersError","setMembersError","membersStatus","setMembersStatus","getMembersFromRegistryCached","getMembersFromSubgraphCached","filteredMembersWithDetails","tributeDaos","member","didFullyRagequit","createdAt","parsedMember","m","daoRegistryABI","daoRegistryAddress","daoRegistryMethods","getNbMembers","nbMembers","getMemberAddressABI","getMemberAddressCalls","memberAddresses","getCurrentDelegateKeyABI","getCurrentDelegateKeyCalls","delegateKeys","unitsBalanceOfCalls","unitsBalances","membersWithDetails","isDelegated","reverse","i","addressENS","MemberProfile","useDaoTotalUnits","totalUnitsIssued","totalUnitsStatus","ethereumAddress","memberDetails","setMemberDetails","memberNotFound","setMemberNotFound","activeMember","isLoadingDone","ensNameFound","isCurrentMemberConnected","votingWeight","toFixed","renderMemberInfo","MemberCard","ensTooltipIDRef","uuidv4","titleTooltipIDRef","unitsTooltipIDRef","unitAbbreviated","formatNumberAbbreviated","unitsFormatted","addressTooltipText","renderMemberCards","Members","configurationKeysToGet","offchainVotingVotingPeriod","offchainVotingGracePeriod","Proposals","includeProposalsExistingOnlyOffchain","nonsponsoredProposals","useDaoConfigurations","daoConfigurations","offchainVotingPeriod","offchainGracePeriod","useProposals","proposalsError","proposalsStatus","daoProposalVote","daoProposalVotingAdapter","votingAdapterName","gracePeriodEndMs","gracePeriodStartMs","voteEndMs","voteStartMs","VotingAdapterName","OffchainVotingContract","startingTime","gracePeriodStartingTime","times","calculateVotingTimeRanges","gracePeriodLength","votePeriodLength","voteStartingTime","countdownGracePeriodEndMs","countdownGracePeriodStartMs","voteState","daoProposalVotingState","votesData","noSnapshotVotes","votes","offchainResultNotYetSubmitted","proposalHasVotingState","VotingState","GRACE_PERIOD","TIE","proposalHasFlag","ProposalFlag","SPONSORED","flags","reporter","PASS","PROCESSED","NOT_PASS","IN_PROGRESS","EXISTS","REQUESTS","Onboarding","DaoAdapterConstants","ONBOARDING","useMemberActionDisabledProps","skipIsActiveMemberCheck","ProcessActionOnboarding","propsDisabled","onboardingProposalAmount","setOnboardingProposalAmount","actionDisabledReasonsRef","notProposerMessage","useMemberActionDisabled","isDisabled","openWhyDisabledModal","WhyDisabledModal","setOtherDisabledReasons","areSomeDisabled","getOnboardingProposalAmountCached","proposalDetails","erc20AmountBN","erc20Instance","processArguments","ProposalWithOffchainVoteActions","fadeInProps","cycleEllipsisStyles","ProposalActions","renderAction","daoVotingAdapterName","adapterOrExtensionName","ProposalAmount","amount2","amount2Unit","OnboardingDetails","daoProposalVoteResult","ProposalFlowStatus","Submit","applicant","SubmitAction","checkApplicant","Process","OffchainVotingGracePeriod","LoaderWithEmoji","showAfterMs","showLoaderAfterMs","setShowLoaderAfterMs","timeoutId","emoji","RedeemManager","redeemables","RedeemCard","redeemable","invalidApplicantMessage","useRedeemCoupon","redeemCoupon","submitStatus","recipient","FetchStatus","isRedeemd","CycleEllipsis","RedeemCoupon","redeemableCoupon","setReedemableCoupon","couponStatus","setCouponStatus","coupon","URLSearchParams","search","get","checkBySigOrAddrCached","COUPON_API_URL","headers","coupons","PostProcessActionTransfer","alreadyCompletedMessage","toIndexArg","distributeArguments","distributions","distributeProposal","DistributionStatus","getActionDisabledReasons","TransferDetails","Completed","Transfers","DISTRIBUTE","ProcessActionTribute","tributeProposalDetails","setTributeProposalDetails","getTributeProposalDetailsCached","tributeAmountBN","approveValue","TributeDetails","Tributes","TRIBUTE","Header","RenderLogo","Footer","ProcessName","proposalIdParameter","Routes","exact","App","Init","setError","isInitComplete","setIsInitComplete","initSnapshotAPI","processReadyMap","setProcessReadyMap","initContracts","useInitContracts","handleInitContractsCached","handleGetMemberCached","handleGetSnapshotAPIStatusCached","getSnapshotAPIStatus","version","every","fs","InitError","maxWidth","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","root","ENVIRONMENT","disableReactDevTools","autoRefreshOnNetworkChange","defaultGraphqlEndpoint","HttpLink","uri","operationName","GRAPH_API_URL","CORE","couponOnboardingGraphqlEndpoint","COUPON_ONBOARDING","nftExtensionGraphqlEndpoint","NFT_EXTENSION","graphqlEndpoints","split","operation","getContext","serviceName","GRAPH_API_SERVICE_NAME","getApolloClient","ApolloClient","link","concat","handleSubgraphError","cache","InMemoryCache","typePolicies","Adapter","fields","adapters","merge","existing","incoming","Extension","extensions","queryClient","QueryClient","defaultOptions","queries","refetchOnWindowFocus","Web3ModalManager","onBeforeDisconnect","clearConnectedMember","onBeforeConnect","providerOptions","WALLETCONNECT_PROVIDER_OPTIONS","ApolloProvider","client","renderMainContent","chooseRandom","array","doNotChooseItem","arrayToUse","random","noop","DEV_TOOLS","__REACT_DEVTOOLS_GLOBAL_HOOK__","key","dontCloseWindowWarning","callback","returnValue","addEventListener","removeEventListener","number","toLocaleString","intlFormat","v","Intl","NumberFormat","format","round","getAlchemyURL","networkID","DEFAULT_CHAIN","CHAINS","GANACHE","HARMONY_MAIN","HARMONY_TEST","POLYGON","POLYGON_TEST","AVALANCHE_TEST","AVALANCHE_MAIN","process","REACT_APP_ALCHEMY_API_KEY","CHAIN_NAME","DEFAULT_REMAINING","days","hours","minutes","seconds","total","getTimeRemaining","endTime","nowDate","getTime","field","stringToNormalize","trim","isPossibleContractWallet","provider","getCode","bytecode","addressIsExernallyOwnedAccount","numberRangeArray","startAt","adjustedSize","_","replace","GET_DAO","gql","GET_TOKEN_HOLDER_BALANCES","onError","networkError","getState","ERR","dotenvConfig","resolve","__dirname","REACT_APP_COUPON_API_URL","REACT_APP_DAO_REGISTRY_CONTRACT_ADDRESS","REACT_APP_DEFAULT_CHAIN_NAME_LOCAL","REACT_APP_ENABLE_KYC_ONBOARDING","REACT_APP_ENVIRONMENT","REACT_APP_GRAPH_CORE_URL","REACT_APP_GRAPH_COUPON_ONBOARDING_URL","REACT_APP_GRAPH_NFT_EXTENSION_URL","REACT_APP_INFURA_PROJECT_ID_DEV","REACT_APP_INFURA_PROJECT_ID_LOCAL","REACT_APP_INFURA_PROJECT_ID_PROD","REACT_APP_KYC_BACKEND_URL","REACT_APP_KYC_FORMS_URL","REACT_APP_MULTICALL_CONTRACT_ADDRESS","REACT_APP_ONBOARDING_TOKEN_ADDRESS","REACT_APP_SNAPSHOT_HUB_API_URL","REACT_APP_SNAPSHOT_SPACE","MAINNET","ROPSTEN","RINKEBY","GOERLI","KOVAN","CHAIN_NAME_FULL","ETHERSCAN_URLS","INFURA_WS_URLS","INFURA_PROJECT_ID","ETHEREUM_PROVIDER_URL","injected","package","walletconnect","WalletConnectProvider","infuraId","qrcodeModalOptions","mobileLinks","DAO_REGISTRY_CONTRACT_ADDRESS","DAO_FACTORY_CONTRACT_ADDRESS","BANK_FACTORY_CONTRACT_ADDRESS","MULTICALL_CONTRACT_ADDRESS","TOTAL_ADDRESS","MEMBER_COUNT_ADDRESS","ESCROW_ADDRESS","OffchainOpRollupVotingSubmitResultAction","signatureStatus","setSignatureStatus","bankExtensionAddress","bankExtensionMethods","getPriorAmountABI","ai","votingAdapterMethods","getWeb3VotingAdapterContract","adapterAddress","getAdapterAddressFromContracts","getPriorAmount","numberOfDAOMembersAtSnapshot","memberIndex","memberBalanceCalls","memberBalancesAtSnapshot","voteData","createVote","voteYes","choice","VoteChoicesIndex","weight","prepareVoteResult","chainId","voteResultTree","result","voteResultTreeHexRoot","getHexRoot","resultNodeLast","getBadNodeError","getBadNodeErrorResponse","BadNodeError","getVoteResultRootDomainDefinition","domain","types","messageParams","primaryType","PRIMARY_TYPE_ERC712","signMessage","getOffchainVotingProof","merkle_root","submitOffchainVotingProof","merkleRoot","verifyingContract","submitVoteResultArguments","OffchainVotingAction","voteChoiceClicked","setVoteChoiceClicked","votingDisabledReasonsRef","alreadyVotedMessage","fetchingMembershipAtSnapshotMessage","noMembershipAtSnapshotMessage","undeterminedMembershipAtSnapshotMessage","useSignAndSendVote","signAndSendVote","voteDataStatus","voteChosen","getVoteChosen","useMemberUnitsAtSnapshot","hasMembershipAtSnapshot","memberUnitsAtSnapshotError","memberUnitsAtSnapshotStatus","snapshotProposalId","isSubmitDisabled","voteChoiceProgress","VoteChoices","partialVoteData","proposalIdInDAO","proposalIdInSnapshot","setDisabledReasonHelper","VotingActionButtons","buttonProps","voteProgress","displayCountdown","countdownFrom","renderCountdownText","showDaysOnly","renderedCountdownText","formatTimePeriod","time","period","formattedPeriod","ProposalPeriodCountdown","endedLabel","endLabel","endPeriodMs","startLabel","startPeriodMs","currentDate","setCurrentDate","startDate","endDate","interval","setInterval","clearInterval","StopwatchSVG","xlinkHref","VotingStatus","noUnits","renderTimer","showPercentages","totalUnits","yesUnits","renderedStatus","SquareRootVotingBar","votingExpired","gracePeriodLabel","cycleEllipsisFadeInProps","OffchainVotingStatus","onGracePeriodChange","useTimeStartEnd","hasTimeEnded","hasTimeStarted","timeStartEndInitReady","hasGracePeriodEnded","hasGracePeriodStarted","gracePeriodStartEndInitReady","isGracePeriodActive","didVotePassSimpleMajority","renderedStatusFromProp","ariaLabel","ProposalPeriodComponent","CheckSVG","xmlnsXlink","getUnitsPercent","percentYes","percentNo","getButtonARIALabel","getButtonText","handleClick","renderVotedCheck","setTxError","setTxEtherscanURL","setTxIsPromptOpen","setTxReceipt","setTxStatus","networkId","handleOnTxProcess","txHash","unsubscribeDontCloseWindow","contractSendParams","contractSend","receipt","addresses","setAddresses","reverseResolvedAddresses","setReverseResolvedAddresses","handleGetENSNamesCached","reverseResolveENS","URL","convertGasToWEI","gasStationPrice","BigNumber","INITIAL_GAS_PRICES","fast","fastest","safeLow","ignoreEnvironment","noRunIfEIP1559","gasPrices","setGasPrices","gasPriceError","setGasPriceError","gasPriceStatus","setGasPriceStatus","shouldExitIfNotProduction","handleGetGasPricesCached","isEIP1559Compatible","initContractsCached","initContractDaoRegistry","initContractBankAdapter","initContractBankExtension","initContractBankFactory","initContractConfiguration","initContractCouponOnboarding","initContractDaoFactory","initContractDaoRegistryAdapter","initContractDistribute","initContractERC20Extension","initContractFinancing","initContractGuildKick","initContractKycOnboarding","initContractManaging","initContractNFTExtension","initContractOnboarding","initContractRagequit","initContractTribute","initContractTributeNFT","initRegisteredVotingAdapter","setDefaultChainError","defaultChain","INITIAL_MAYBE_CONTRACT_WALLET_STATE","web3Provider","setMaybeContractWallet","handleIsPossibleContractWalletCached","Web3Provider","numberTo0xHexString","n","abs","couponOnboardingContract","setSubmitStatus","redeemCouponArguments","nonce","daoRegistryInstance","getAddressIfDelegatedABI","membersABI","isActiveMemberABI","addressIfDelegated","memberFlag","currentDelegateKey","doesMemberExist","hasFlag","MemberFlag","setConnectedMember","DefaultTheme","ActionType","Web3ModalErrorType","reducer","CONNECT_WEB3MODAL","DEACTIVATE_PROVIDER_WEB3MODAL","ERROR_WEB3MODAL","INITIAL_CACHED_CONNECTOR_CHECK_STATUS","NEW_WEB3MODAL","UPDATE_ACCOUNT","useWeb3ModalManager","defaultTheme","useReducer","web3ModalTheme","web3ModalChain","connectWeb3ModalCached","connectWeb3Modal","chainChangedCallbackCached","_chainIdHex","accountsChangedCallback","connectorId","connectCallback","statusAction","connectTo","Web3","getAccounts","net","getId","CONNECT","clearCachedProvider","DISCONNECT","on","removeListener","Web3Modal","cacheProvider","network","NetworkNames","NetworkIDs","theme","attemptUpdateFromCachedConnector","disconnectWeb3Modal","copySuccessResetMs","tooltipProps","useClipboard","successDuration","ReactTooltip","show","isTooltipShownRef","tooltipIDRef","afterHide","args","afterShow","maxLength","firstSegment","substring","secondPart","getExtensionAddress","extensionName","daoContractInstance","extensionNameSha3","MESSAGES","rootStyles","nbspStyles","fadeInPropsMerged","inline","upToIndex","setUpToIndex","intervalId","prevIndex","WEB3_TX_FULFILLED","defaultChoices","VOTE_CHOICES","signerAddress","proposalChoices","proposalBody","proposalStart","proposalEnd","proposalSnapshot","proposalTimestamp","proposalSig","snapshotProposalSubmitted","setSnapshotProposalSubmitted","proposalDataForDaoRef","contract","getContractByAddress","idForDAO","draftName","draftBody","draftMetadata","draftTimestamp","submitArguments","createContext","DARK","defaultWeb3InstanceRef","providers","WebsocketProvider","defaultWeb3NetID","setDefaultWeb3NetID","web3ModalProviderArguments","ensName","catch","web3ModalContext","Provider","lazyBankFactoryABI","bankFactoryContract","createContractAction","lazyDaoFactoryABI","daoFactoryContract","lazyDaoRegistryABI","initContractVoting","initContractThunkFactory","actionType","voting","adapterNameForRedux","lazyImport","initContractVotingOpRollup","DaoExtensionConstants","BANK","ContractExtensionNames","bank","isExtension","MANAGING","managing","DAO_REGISTRY","dao_registry","RAGEQUIT","ragequit","GUILDKICK","guildkick","FINANCING","financing","CONFIGURATION","configuration","TRIBUTE_NFT","tribute_nft","coupon_onboarding","KYC_ONBOARDING","kyc_onboarding","NFT","nft","ERC20","erc20","getVotingAdapterName","getAdapterAddress","lazyABI","contractABI","alchemyFetchAssetTransfers","parameters","fromBlock","ALCHEMY_URL","maxCount","toBlock","requestOptions","jsonrpc","t","transfers","pageKey","methodName","contractInstanceMethods","methodArguments","onProcess","reject","BN","estimateGas","gas","gastoBN","decimalPlaces","ROUND_DOWN","toNumber","send","adapterNameSha3","DaoState","getContractAddressOrThrow","c","getDAOAddressConfigEntry","configKey","configKeySha3","web3","encodeParameters","getAddressConfiguration","getConfiguration","lazyIVotingABI","getAdapterName","flagToCheck","daoProposalFlag","log2","isNotReservedAddress","isNotZeroAddress","blockNumber","lazyMulticallABI","multicallMethods","aggregate","encodeFunctionCall","hexString","outputsABIItem","outputs","decodedOutputs","decodeParameters","__length__","REVERSE_RECORDS_ADDRESS","ReverseRecordsABI","getNames","namehash","normalize","isExpanded","setIsExpanded","isWalletRejectedRequest","code","test","textToDisplay","areErrorMessageAndTextStringSame","setAbortController","AbortController","count","useCounter","INITIAL_CONFIG_ENTRIES","configKeys","setDaoConfigurations","daoConfigurationsStatus","setDaoConfigurationsStatus","daoConfigurationsError","setDaoConfigurationsError","getConfigurationABI","ck","handleGetConfigurations","getDaoFromSubgraphResult","setTotalUnits","setTotalUnitsIssued","setTotalUnitsStatus","totalUnitsError","setTotalUnitsError","getTotalUnitsFromExtensionCached","getTotalUnitsFromSubgraphCached","totalUnitsToSet","balanceOfGuildUnits","totalUnitsIssuedToSet","otherDisabledReasons","shouldShowWhyModal","setShouldShowWhyModal","otherReasonNext","disabledReason","getDisabledReason","canShowDisabledReason","WhyDisabledModalCached","handleSetOtherDisabledReasonsCached","otherReasons","Boolean","DEFAULT_POLL_INTERVAL_MS","pollUntilBlockInPast","block","blockOffset","pollInterval","blockOffsetCheck","currentBlock","getBlockNumber","blockCheckOffset","currentBlockPollIntervalMs","memberUnitsAtSnapshot","setMemberUnitsAtSnapshot","setHasMembershipAtSnapshot","setMemberUnitsAtSnapshotError","setMemberUnitsAtSnapshotStatus","handleGetPriorUnitsAmountCached","isGreaterThan","areAllAsyncReady","asyncMapping","startSeconds","endSeconds","startEndStatusRef","setHasTimeStarted","setHasTimeEnded","setTimeStartEndInitReady","shouldNotCheck","intervalID","hasStartedCheck","hasEndedCheck","setCheckApplicantError","setCheckApplicantInvalidMsg","setCheckApplicantStatus","setIsApplicantValid","prevAddress","usePreviousDistinct","checkApplicantValidityCached","truncatedAddress","getAddressIfDelegated","getAddressIfDelegatedResult","INITIAL_DAO_PROPOSAL_ENTRIES","useDaoProposals","proposalIds","proposalsAbi","registryAddress","daoProposals","setDaoProposals","daoProposalsStatus","setDaoProposalsStatus","daoProposalsError","setDaoProposalsError","safeProposalIds","setSafeProposalIds","daoProposalsCalls","setDaoProposalsCalls","daoProposalsData","daoProposalsQueryError","handleGetDaoProposalsCached","safeProposalIdsToSet","isHexStrict","daoProposalsCallsToSet","votingResults","setVotingResults","setOffchainVotingResultsStatus","setOffchainVotingResultsError","proposalsToMap","setProposalsToMap","all","voterEntries","vote","voterAddressesAndChoices","fromEntries","getUnitsPerChoiceCached","votingResultsToSetData","votingResultsToSetError","buildOffchainVotingResultEntriesCached","filteredVotingResultsToSetData","percentage","totalUnitsCall","balanceOfGuildUnitsCall","unitsCalls","totalUnitsResult","balanceOfGuildResult","proposalsToMapToSet","isArray","INITIAL_VOTING_ADAPTERS","useProposalsVotingAdapter","registryABI","proposalsVotingAdapters","setProposalsVotingAdapters","proposalsVotingAdaptersError","setProposalsVotingAdaptersError","proposalsVotingAdaptersStatus","setProposalsVotingAdaptersStatus","getProposalsVotingAdaptersOnchainCached","votingAdapterABI","votingAdapterCalls","votingAdapterAddressResults","getAdapterNameABI","filteredProposalIds","_id","filteredVotingAdapterAddressResults","votingAdapterNameCalls","votingAdapterAddress","adapterNameResults","getVotingAdapterABI","votingAdaptersToSet","ERROR_PROPOSAL","ERROR_PROPOSAL_NOT_FOUND","setSnapshotDraft","setSnapshotProposal","setProposalNotFound","setProposalError","setProposalStatus","proposalVotingAdapterId","setProposalVotingAdapterId","proposalInclusiveStatus","setProposalInclusiveStatus","proposalInclusiveError","setProposalInclusiveError","refetchCount","updateRefetchCount","useQueryClient","handleGetDraftCached","handleGetProposalCached","handleGetProposalOrDraftCached","idKey","erc712DraftHash","resetQueries","statuses","some","INITIAL_ARRAY","getSnapshotDraftsByAdapterAddress","drafts","draftsJSON","draftEntries","sponsored","getSnapshotProposalsByAdapterAddress","proposalEntries","setAdapterAddress","snapshotDraftAndProposals","setSnapshotDraftAndProposals","snapshotDraftAndProposalsStatus","setSnapshotDraftAndProposalsStatus","snapshotDraftAndProposalsError","setSnapshotDraftAndProposalsError","daoProposalIdsToUse","setDaoProposalIdsToUse","setProposals","proposalsInclusiveStatus","setProposalsInclusiveStatus","proposalsInclusiveError","setProposalsInclusiveError","useProposalsVotingState","proposalsVotingState","proposalsVotingStateError","proposalsVotingStateStatus","proposalVotingAdapters","proposalsVotes","setProposalsVotes","proposalsVotesError","setProposalsVotesError","proposalsVotesStatus","setProposalsVotesStatus","safeProposalVotingAdapters","setSafeProposalVotingAdapters","getVotesDataABI","votesDataCallsData","votesDataCallsError","votesDataResults","votesDataResultsError","getProposalsVotesOnchainCached","buildVotesData","resultRoot","nbYes","nbNo","isChallenged","stepRequested","forceFailed","fallbackVotesCount","offchainVotesDataABI","votingVotesDataABI","safeProposalVotingAdaptersToSet","useProposalsVotes","snapshotDraftEntriesData","snapshotDraftEntriesError","allSnapshotDraftsAndProposalsError","handleGetAllSnapshotDraftsAndProposalsCached","mergedEntries","proposalsToSet","daoProposalId","snapshotId","snapshotDataId","snapshotData","isSnapshotDraft","proposalIdVotingAdapter","proposalIdVotingState","proposalIdVotes","setProposaslsVotingState","setProposalsVotingStateError","setProposalsVotingStateStatus","votingResultABIError","setVotingResultABIError","proposalsVotingStateCalls","setProposalsVotingStateCalls","proposalsVotingStateResult","proposalsVotingStateResultError","getProposalsVotingStateOnchainCached","votingResultABI","proposalsVotingStateCallsToSet","setProposalsVotingStateCallsPrepData","OffchainVotingSubmitResult","OffchainVoting","Sponsor","useProposalWithOffchainVoteStatus","countdownVotingEndSeconds","countdownVotingStartSeconds","useCountdownToCheckInVoting","setStatus","initComplete","setInitComplete","setDAOProposal","setDAOProposalVote","setDAOProposalVoteResult","proposalFlowStatusError","setProposalFlowStatusError","pollingIntervalIdRef","stopPollingRef","initialAsyncChecksCompleted","atExistsInDAO","atSponsoredInDAO","atProcessedInDAO","offchainVotingAddress","offchainVotingABI","offchainResultSubmitted","isAddress","isInVoting","isInVotingGracePeriod","getStatusFromContractCached","proposalsABI","voteResultABI","voteABI","voteResult","votesToSet","handleStopPollingForStatus","isStatusInitial","stopPollingForStatus","setVoteData","voteDataError","setVoteDataError","setVoteDataStatus","getSpace","snapshotSpace","voteProposalData","buildVoteMessage","erc712Message","prepareVoteMessage","getDomainDefinition","dataToSign","submitMessage","dataToReturn","setProposalData","setProposalSignAndSendError","setProposalSignAndSendStatus","buildProposalMessageHelper","votingTimeSeconds","buildProposalMessage","buildDraftMessage","prepareDraftMessage","prepareProposalMessage","uniqueIdDraft","getBlock","latestBlock","baseFeePerGas","styleProps","MetaMaskSVG","WalletConnectSVG","walletIconMap","WalletIcon","Spinner","textProps","loaderProps","MS_MULTIPLIER","merkleRootHex","voteEntry","ve","lazyOffchainVotingABI","lazyVotingABI","votingStateToCheck","votingState","INITIAL_ITEM","activeMessage","setActiveMessage","prevMessage"],"mappings":"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","file":"static/js/main.940a96a4.chunk.js","sourcesContent":["/**\n * FOR HIGH REUSE TYPES\n *\n * For any other more specific types, co-locate them in either:\n *\n * 1) The actual code file.\n * 2) In a type file in the location of the code files which mainly use the types.\n *\n * @see https://kentcdodds.com/blog/colocation\n */\n\nexport type EnvironmentName = 'localhost' | 'development' | 'production';\n\nexport enum AsyncStatus {\n  STANDBY = 'STANDBY',\n  PENDING = 'PENDING',\n  FULFILLED = 'FULFILLED',\n  REJECTED = 'REJECTED',\n}\n\nexport interface MetaMaskRPCError extends Error {\n  code: number;\n}\n","import {useContext} from 'react';\n\nimport {Web3ModalContextValue, Web3ModalContext} from '../Web3ModalManager';\n\n/**\n * useWeb3Modal(): Web3ModalContextValue\n *\n * Internal hook to access wallet connectivity and connected state.\n *\n * @example\n * const {account, connected, networkId, ...} = useWeb3Modal();\n */\nexport function useWeb3Modal(): Web3ModalContextValue {\n  return useContext(Web3ModalContext);\n}\n","import {CLEAR_CONNECTED_MEMBER, SET_CONNECTED_MEMBER} from './actions';\nimport {ConnectedMemberState} from './types';\n\nconst INITIAL_STATE = null;\n\nexport default function reducer(\n  state: ConnectedMemberState = INITIAL_STATE,\n  action: any\n) {\n  const {type, ...payload} = action;\n\n  switch (type) {\n    case SET_CONNECTED_MEMBER:\n      return setConnectedMemberReducer(state, payload);\n    case CLEAR_CONNECTED_MEMBER:\n      return clearConnectedMemberReducer();\n    default:\n      return state;\n  }\n}\n\nfunction setConnectedMemberReducer(\n  state: Partial<ConnectedMemberState>,\n  payload: Record<string, any>\n) {\n  return {...state, ...payload};\n}\n\nfunction clearConnectedMemberReducer() {\n  return INITIAL_STATE;\n}\n","import {CONNECT_MODAL_CLOSE, CONNECT_MODAL_OPEN} from './actions';\nimport {ConnectModalState} from './types';\n\nconst INITIAL_STATE = {\n  isOpen: false,\n};\n\nexport default function reducer(\n  state: ConnectModalState = INITIAL_STATE,\n  action: any\n) {\n  const {type} = action;\n\n  switch (type) {\n    case CONNECT_MODAL_CLOSE:\n      return connectModalClose(state);\n    case CONNECT_MODAL_OPEN:\n      return connectModalOpen(state);\n    default:\n      return state;\n  }\n}\n\nfunction connectModalClose(\n  state: Partial<ConnectModalState>\n): ConnectModalState {\n  return {...state, isOpen: false};\n}\n\nfunction connectModalOpen(\n  state: Partial<ConnectModalState>\n): ConnectModalState {\n  return {...state, isOpen: true};\n}\n","import {\n  CLEAR_CONTRACTS,\n  CONTRACT_BANK_ADAPTER,\n  CONTRACT_BANK_EXTENSION,\n  CONTRACT_BANK_FACTORY,\n  CONTRACT_CONFIGURATION,\n  CONTRACT_COUPON_ONBOARDING,\n  CONTRACT_DAO_FACTORY,\n  CONTRACT_DAO_REGISTRY_ADAPTER,\n  CONTRACT_DAO_REGISTRY,\n  CONTRACT_DISTRIBUTE,\n  CONTRACT_ERC20_EXTENSION,\n  CONTRACT_FINANCING,\n  CONTRACT_GUILDKICK,\n  CONTRACT_KYC_ONBOARDING,\n  CONTRACT_MANAGING,\n  CONTRACT_NFT_EXTENSION,\n  CONTRACT_ONBOARDING,\n  CONTRACT_RAGEQUIT,\n  CONTRACT_TRIBUTE_NFT,\n  CONTRACT_TRIBUTE,\n  CONTRACT_VOTING_OP_ROLLUP,\n  CONTRACT_VOTING,\n} from '../actions';\nimport {ContractsState} from './types';\n\nconst initialState = {\n  BankAdapterContract: null,\n  BankExtensionContract: null,\n  BankFactoryContract: null,\n  ConfigurationContract: null,\n  CouponOnboardingContract: null,\n  DaoFactoryContract: null,\n  DaoRegistryAdapterContract: null,\n  DaoRegistryContract: null,\n  DistributeContract: null,\n  ERC20ExtensionContract: null,\n  FinancingContract: null,\n  GuildKickContract: null,\n  KycOnboardingContract: null,\n  ManagingContract: null,\n  NFTExtensionContract: null,\n  OnboardingContract: null,\n  RagequitContract: null,\n  TributeContract: null,\n  TributeNFTContract: null,\n  VotingContract: null,\n};\n\nexport default function reducer(\n  state: ContractsState = initialState,\n  action: any\n) {\n  const {type, ...payload} = action;\n\n  switch (type) {\n    case CLEAR_CONTRACTS:\n      return clearContracts(state);\n    case CONTRACT_BANK_ADAPTER:\n      return contractBankAdapter(state, payload);\n    case CONTRACT_BANK_EXTENSION:\n      return contractBankExtension(state, payload);\n    case CONTRACT_BANK_FACTORY:\n      return contractBankFactory(state, payload);\n    case CONTRACT_CONFIGURATION:\n      return contractConfiguration(state, payload);\n    case CONTRACT_COUPON_ONBOARDING:\n      return contractCouponOnboarding(state, payload);\n    case CONTRACT_DAO_FACTORY:\n      return contractDAOFactory(state, payload);\n    case CONTRACT_DAO_REGISTRY:\n      return contractDAORegistry(state, payload);\n    case CONTRACT_DAO_REGISTRY_ADAPTER:\n      return contractDaoRegistryAdapter(state, payload);\n    case CONTRACT_DISTRIBUTE:\n      return contractDistribute(state, payload);\n    case CONTRACT_ERC20_EXTENSION:\n      return contractERC20Extension(state, payload);\n    case CONTRACT_FINANCING:\n      return contractFinancing(state, payload);\n    case CONTRACT_GUILDKICK:\n      return contractGuildKick(state, payload);\n    case CONTRACT_KYC_ONBOARDING:\n      return contractKycOnboarding(state, payload);\n    case CONTRACT_MANAGING:\n      return contractManaging(state, payload);\n    case CONTRACT_NFT_EXTENSION:\n      return contractNFTExtension(state, payload);\n    case CONTRACT_ONBOARDING:\n      return contractOnboarding(state, payload);\n    case CONTRACT_RAGEQUIT:\n      return contractRagequit(state, payload);\n    case CONTRACT_TRIBUTE:\n      return contractTribute(state, payload);\n    case CONTRACT_TRIBUTE_NFT:\n      return contractTributeNFT(state, payload);\n    case CONTRACT_VOTING:\n      return contractVoting(state, payload);\n    case CONTRACT_VOTING_OP_ROLLUP:\n      return contractVoting(state, payload);\n\n    default:\n      return state;\n  }\n}\n\nfunction clearContracts(state: ContractsState) {\n  return {...state, ...initialState};\n}\n\nfunction contractBankFactory(state: ContractsState, payload: any) {\n  return {...state, BankFactoryContract: {...payload}};\n}\n\nfunction contractDAOFactory(state: ContractsState, payload: any) {\n  return {...state, DaoFactoryContract: {...payload}};\n}\n\nfunction contractDAORegistry(state: ContractsState, payload: any) {\n  return {...state, DaoRegistryContract: {...payload}};\n}\n\nfunction contractDaoRegistryAdapter(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, DaoRegistryAdapterContract: {...payload}};\n}\n\nfunction contractBankExtension(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, BankExtensionContract: {...payload}};\n}\n\nfunction contractConfiguration(state: ContractsState, payload: any) {\n  return {...state, ConfigurationContract: {...payload}};\n}\n\nfunction contractDistribute(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, DistributeContract: {...payload}};\n}\n\nfunction contractFinancing(state: ContractsState, payload: any) {\n  return {...state, FinancingContract: {...payload}};\n}\n\nfunction contractGuildKick(state: ContractsState, payload: any) {\n  return {...state, GuildKickContract: {...payload}};\n}\n\nfunction contractOnboarding(state: ContractsState, payload: any) {\n  return {...state, OnboardingContract: {...payload}};\n}\n\nfunction contractRagequit(state: ContractsState, payload: any) {\n  return {...state, RagequitContract: {...payload}};\n}\n\nfunction contractTribute(state: ContractsState, payload: any): ContractsState {\n  return {...state, TributeContract: {...payload}};\n}\n\nfunction contractVoting(state: ContractsState, payload: any): ContractsState {\n  return {...state, VotingContract: {...payload}};\n}\n\nfunction contractManaging(state: ContractsState, payload: any): ContractsState {\n  return {...state, ManagingContract: {...payload}};\n}\n\nfunction contractBankAdapter(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, BankAdapterContract: {...payload}};\n}\n\nfunction contractTributeNFT(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, TributeNFTContract: {...payload}};\n}\n\nfunction contractCouponOnboarding(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, CouponOnboardingContract: {...payload}};\n}\n\nfunction contractKycOnboarding(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, KycOnboardingContract: {...payload}};\n}\n\nfunction contractNFTExtension(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, NFTExtensionContract: {...payload}};\n}\n\nfunction contractERC20Extension(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, ERC20ExtensionContract: {...payload}};\n}\n","import {SET_SUBGRAPH_NETWORK_STATUS} from './actions';\nimport {SubgraphNetworkStatus, SubgraphNetworkStatusState} from './types';\n\nconst INITIAL_STATE = {\n  status: SubgraphNetworkStatus.OK,\n};\n\nexport default function reducer(\n  state: SubgraphNetworkStatusState = INITIAL_STATE,\n  action: any\n) {\n  const {type, ...payload} = action;\n\n  switch (type) {\n    case SET_SUBGRAPH_NETWORK_STATUS:\n      return setSubgraphNetworkStatus(state, payload);\n    default:\n      return state;\n  }\n}\n\nfunction setSubgraphNetworkStatus(\n  state: Partial<SubgraphNetworkStatusState>,\n  payload: Record<string, any>\n) {\n  return {...state, ...payload};\n}\n","import {combineReducers} from 'redux';\n\nimport connectedMember from './connectedMember/reducers';\nimport connectModal from './connectModal/reducers';\nimport contracts from './contracts/reducers';\nimport subgraphNetworkStatus from './subgraphNetworkStatus/reducers';\n\nexport default combineReducers({\n  connectModal,\n  connectedMember,\n  contracts,\n  subgraphNetworkStatus,\n});\n","import {applyMiddleware, createStore} from 'redux';\nimport {composeWithDevTools} from 'redux-devtools-extension/logOnlyInProduction';\nimport thunk from 'redux-thunk';\n\nimport rootReducer from './reducers';\n\nexport const store = createStore(\n  rootReducer,\n  composeWithDevTools(applyMiddleware(thunk))\n);\n","import {lazy, Suspense, useState} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {useEffect} from 'react';\n\nimport {\n  useIsDefaultChain,\n  useMaybeContractWallet,\n  useWeb3Modal,\n} from './components/web3/hooks';\nimport {AsyncStatus} from './util/types';\nimport {connectModalClose, connectModalOpen} from './store/actions';\nimport {StoreState} from './store/types';\nimport {useLocation} from 'react-router-dom';\n\n/**\n * Lazy load ConnectWalletModal only when open\n */\nconst ConnectWalletModal = lazy(\n  () => import('./components/web3/ConnectWalletModal')\n);\n\nexport default function GlobalConnectWalletModal() {\n  /**\n   * Selectors\n   */\n\n  const isConnectModalOpen: boolean = useSelector(\n    ({connectModal}: StoreState) => connectModal.isOpen\n  );\n\n  /**\n   * State\n   */\n\n  const [modalProps, setModalProps] = useState<\n    Parameters<typeof ConnectWalletModal>[0]['modalProps']\n  >({\n    isOpen: isConnectModalOpen,\n    onRequestClose: () => {\n      dispatch(connectModalClose());\n    },\n  });\n\n  /**\n   * Our hooks\n   */\n\n  const {account, connected, initialCachedConnectorCheckStatus, web3Instance} =\n    useWeb3Modal();\n\n  const {isDefaultChain} = useIsDefaultChain();\n\n  const maybeContractWallet = useMaybeContractWallet(\n    account,\n    web3Instance?.currentProvider\n  );\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch();\n  const {pathname} = useLocation();\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    setModalProps((prevState) => ({...prevState, isOpen: isConnectModalOpen}));\n  }, [isConnectModalOpen]);\n\n  /**\n   * Effects\n   */\n\n  /**\n   * Will automatically re-show the modal (on app `pathname` change) only when:\n   *  - If wrong chain\n   *  - If smart contract wallet\n   */\n  useEffect(() => {\n    if (initialCachedConnectorCheckStatus === AsyncStatus.FULFILLED) {\n      const shouldAutomaticallyOpenModal: boolean =\n        connected && (!isDefaultChain || maybeContractWallet) ? true : false;\n\n      shouldAutomaticallyOpenModal\n        ? dispatch(connectModalOpen())\n        : dispatch(connectModalClose());\n    }\n  }, [\n    connected,\n    dispatch,\n    initialCachedConnectorCheckStatus,\n    isDefaultChain,\n    maybeContractWallet,\n    pathname,\n  ]);\n\n  /**\n   * Render\n   */\n\n  if (!isConnectModalOpen) return null;\n\n  return (\n    <Suspense fallback={null}>\n      <ConnectWalletModal\n        // @todo Look into more generic way to render errors in the modal\n        maybeContractWallet={maybeContractWallet}\n        modalProps={modalProps}\n      />\n    </Suspense>\n  );\n}\n","import {Helmet} from 'react-helmet';\n\nexport default function Head() {\n  return (\n    <Helmet>\n      <title>Tribute</title>\n      <meta\n        name=\"description\"\n        content=\"A modular DAO framework developed and coordinated by its members\"\n      />\n    </Helmet>\n  );\n}\n","import React from 'react';\n\nimport FadeIn from './FadeIn';\n\ntype InputErrorProps = {\n  error: string;\n};\n\nexport default function InputError(\n  props: InputErrorProps & React.HtmlHTMLAttributes<HTMLParagraphElement>\n) {\n  const {error, ...restProps} = props;\n\n  return (\n    <>\n      {error && (\n        <FadeIn>\n          <p\n            {...restProps}\n            className={`error-message ${restProps.className || ''}`}>\n            {error}\n          </p>\n        </FadeIn>\n      )}\n    </>\n  );\n}\n","import Markdown from 'markdown-to-jsx';\n\ntype PreviewInputMarkdownProps = {\n  value: string;\n};\n\nexport default function PreviewInputMarkdown(props: PreviewInputMarkdownProps) {\n  const {value} = props;\n\n  if (!value) return null;\n\n  return (\n    <details>\n      <summary style={{cursor: 'pointer', outline: 'none'}}>\n        <small>Preview Markdown</small>\n      </summary>\n\n      <div style={{marginTop: '1em'}}>\n        <Markdown>{value}</Markdown>\n      </div>\n    </details>\n  );\n}\n","import React, {useState} from 'react';\nimport {useForm} from 'react-hook-form';\nimport {useHistory} from 'react-router';\nimport {useSelector} from 'react-redux';\nimport {SnapshotType} from '@openlaw/snapshot-js-erc712';\n\nimport {CycleEllipsis} from '../../components/feedback';\nimport {FormFieldErrors} from '../../util/enums';\nimport {getValidationError, truncateEthAddress} from '../../util/helpers';\nimport {SnapshotMetadataType} from '../../components/proposals/types';\nimport {StoreState} from '../../store/types';\nimport {useSignAndSubmitProposal} from '../../components/proposals/hooks';\nimport {useWeb3Modal, useIsDefaultChain} from '../../components/web3/hooks';\nimport {Web3TxStatus} from '../../components/web3/types';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport InputError from '../../components/common/InputError';\nimport Loader from '../../components/feedback/Loader';\nimport PreviewInputMarkdown from '../../components/common/PreviewInputMarkdown';\nimport Wrap from '../../components/common/Wrap';\n\nenum Fields {\n  title = 'title',\n  description = 'description',\n}\n\ntype FormInputs = {\n  title: string;\n  description: string;\n};\n\nconst getDelegatedAddressMessage = (a: string) =>\n  `Your member address is delegated to ${truncateEthAddress(\n    a,\n    7\n  )}. You must use that address.`;\n\nexport default function CreateGovernanceProposal() {\n  /**\n   * Selectors\n   */\n\n  const delegateAddress = useSelector(\n    (s: StoreState) => s.connectedMember?.delegateKey\n  );\n\n  const isAddressDelegated = useSelector(\n    (s: StoreState) => s.connectedMember?.isAddressDelegated\n  );\n\n  const isActiveMember = useSelector(\n    (s: StoreState) => s.connectedMember?.isActiveMember\n  );\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n\n  /**\n   * Our hooks\n   */\n\n  const {connected, account} = useWeb3Modal();\n  const {proposalSignAndSendStatus, signAndSendProposal} =\n    useSignAndSubmitProposal<SnapshotType.proposal>();\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Their hooks\n   */\n\n  const form = useForm<FormInputs>({\n    mode: 'onBlur',\n    reValidateMode: 'onChange',\n  });\n  const history = useHistory();\n\n  /**\n   * Variables\n   */\n\n  const {errors, getValues, register, trigger, watch} = form;\n  const isConnected = connected && account;\n  const isInProcess =\n    proposalSignAndSendStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    proposalSignAndSendStatus === Web3TxStatus.PENDING;\n\n  const isDone = proposalSignAndSendStatus === Web3TxStatus.FULFILLED;\n  const isInProcessOrDone = isInProcess || isDone;\n\n  /**\n   * Functions\n   */\n\n  function getUnauthorizedMessage() {\n    // user is not connected\n    if (!isConnected) {\n      return 'Connect your wallet to submit a governance proposal.';\n    }\n\n    // user is on wrong network\n    if (defaultChainError) {\n      return defaultChainError.message;\n    }\n\n    // user is not an active member\n    if (!isActiveMember && !isAddressDelegated) {\n      return 'Either you are not a member, or your membership is not active.';\n    }\n\n    // member has delegated to another address\n    if (!isActiveMember && delegateAddress && isAddressDelegated) {\n      return getDelegatedAddressMessage(delegateAddress);\n    }\n  }\n\n  async function handleSubmit(values: FormInputs) {\n    try {\n      // Sign and submit proposal for Snapshot Hub\n      const {uniqueId} = await signAndSendProposal({\n        partialProposalData: {\n          name: values.title,\n          body: values.description,\n          metadata: {\n            type: SnapshotMetadataType.Governance,\n          },\n        },\n        type: SnapshotType.proposal,\n      });\n\n      // Go to newly creatd governance proposal's page\n      history.push(`/governance/${uniqueId}`);\n    } catch (error) {\n      const e = error as Error;\n\n      setSubmitError(e);\n    }\n  }\n\n  function renderSubmitStatus(): React.ReactNode {\n    switch (proposalSignAndSendStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return (\n          <>\n            Awaiting your confirmation\n            <CycleEllipsis intervalMs={500} />\n          </>\n        );\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            Submitting\n            <CycleEllipsis intervalMs={500} />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return 'Done!';\n      default:\n        return '';\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  // Render unauthorized message\n  if (!isConnected || !isActiveMember || defaultChainError) {\n    return (\n      <RenderWrapper>\n        <div className=\"form__description--unauthorized\">\n          <p>{getUnauthorizedMessage()}</p>\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      <form className=\"form\" onSubmit={(e) => e.preventDefault()}>\n        {/* PROPOSAL TITLE */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\" htmlFor={Fields.title}>\n            Title\n          </label>\n          <div className=\"form__input-row-fieldwrap\">\n            <input\n              aria-describedby={`error-${Fields.title}`}\n              aria-invalid={errors.title ? 'true' : 'false'}\n              id={Fields.title}\n              name={Fields.title}\n              ref={register({\n                required: FormFieldErrors.REQUIRED,\n              })}\n              type=\"text\"\n              disabled={isInProcessOrDone}\n            />\n\n            <InputError\n              error={getValidationError(Fields.title, errors)}\n              id={`error-${Fields.title}`}\n            />\n          </div>\n        </div>\n\n        {/* PROPOSAL DESCRIPTION */}\n        <div className=\"form__textarea-row\">\n          <label className=\"form__input-row-label\" htmlFor={Fields.description}>\n            Description\n          </label>\n          <div className=\"form__input-row-fieldwrap\">\n            <textarea\n              aria-describedby={`error-${Fields.description}`}\n              aria-invalid={errors.description ? 'true' : 'false'}\n              id={Fields.description}\n              name={Fields.description}\n              placeholder=\"Say something about your governance proposal...\"\n              ref={register({\n                required: FormFieldErrors.REQUIRED,\n              })}\n              disabled={isInProcessOrDone}\n            />\n\n            <InputError\n              error={getValidationError(Fields.description, errors)}\n              id={`error-${Fields.description}`}\n            />\n\n            <PreviewInputMarkdown value={watch(Fields.description)} />\n          </div>\n        </div>\n\n        {/* SUBMIT */}\n        <button\n          aria-label={isInProcess ? 'Submitting your proposal...' : ''}\n          className=\"button\"\n          disabled={isInProcessOrDone}\n          onClick={async () => {\n            if (isInProcessOrDone) return;\n\n            if (!(await trigger())) {\n              return;\n            }\n\n            handleSubmit(getValues());\n          }}\n          type=\"submit\">\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Submit'}\n        </button>\n\n        {/* SUBMIT STATUS */}\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {/* SUBMIT ERROR */}\n        {submitError && (\n          <div className=\"form__submit-error-container\">\n            <ErrorMessageWithDetails\n              renderText=\"Something went wrong while submitting the proposal.\"\n              error={submitError}\n            />\n          </div>\n        )}\n      </form>\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Governance Proposal</h2>\n        </div>\n\n        <div className=\"form-wrapper\">\n          <div className=\"form__description\">\n            <p>\n              Nulla aliquet porttitor venenatis. Donec a dui et dui fringilla\n              consectetur id nec massa. Aliquam erat volutpat. Sed ut dui ut\n              lacus dictum fermentum vel tincidunt neque. Sed sed lacinia...\n            </p>\n          </div>\n\n          {/* RENDER CHILDREN */}\n          {props.children}\n        </div>\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import React, {ReactNode} from 'react';\n\ninterface WrapProps {\n  children: ReactNode;\n  className?: string;\n}\n\nconst Wrap = ({\n  children,\n  ...rest\n}: WrapProps & React.HTMLAttributes<HTMLDivElement>) => (\n  <div style={{position: 'relative'}} {...rest}>\n    {children}\n  </div>\n);\n\nexport default Wrap;\n","import {useState, useCallback, useEffect} from 'react';\nimport {SnapshotType} from '@openlaw/snapshot-js-erc712';\nimport {useForm, Controller} from 'react-hook-form';\nimport {AbiItem, fromWei, toBN, toWei, toChecksumAddress} from 'web3-utils';\nimport {Contract as Web3Contract} from 'web3-eth-contract/types';\nimport {useHistory} from 'react-router-dom';\nimport {useSelector} from 'react-redux';\n\nimport {\n  formatNumber,\n  getValidationError,\n  normalizeString,\n  truncateEthAddress,\n} from '../../util/helpers';\nimport {useIsDefaultChain, useWeb3Modal} from '../../components/web3/hooks';\nimport {\n  ContractAdapterNames,\n  ContractDAOConfigKeys,\n  Web3TxStatus,\n} from '../../components/web3/types';\nimport {FormFieldErrors} from '../../util/enums';\nimport {getDAOConfigEntry} from '../../components/web3/helpers';\nimport {isEthAddressValid} from '../../util/validation';\nimport {AsyncStatus} from '../../util/types';\nimport {\n  ETH_TOKEN_ADDRESS,\n  ONBOARDING_TOKEN_ADDRESS,\n  UNITS_ADDRESS,\n} from '../../config';\nimport {CycleEllipsis} from '../../components/feedback';\nimport {\n  useCheckApplicant,\n  useSignAndSubmitProposal,\n} from '../../components/proposals/hooks';\nimport {StoreState} from '../../store/types';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport InputError from '../../components/common/InputError';\nimport Loader from '../../components/feedback/Loader';\nimport Slider from '../../components/common/Slider';\nimport Wrap from '../../components/common/Wrap';\n\nenum Fields {\n  ethAddress = 'ethAddress',\n  amount = 'amount',\n}\n\ntype FormInputs = {\n  ethAddress: string;\n  amount: string;\n};\n\ntype SubmitActionArguments = [\n  applicant: string, // `applicant`\n  tokenToMint: string, // `tokenToMint`\n  tokenAmount: string // `tokenAmount`\n];\n\ntype OnboardingConfigs = {\n  chunkSize: string;\n  maximumChunks: string;\n  unitsPerChunk: string;\n};\n\ntype ERC20Details = {\n  symbol: string;\n  decimals: number;\n};\n\nconst PLACEHOLDER = '\\u2014'; /* em dash */\n\nconst isERC20Onboarding = ONBOARDING_TOKEN_ADDRESS !== ETH_TOKEN_ADDRESS;\n\nfunction renderUserAccountBalance(userAccountBalance: string | undefined) {\n  if (!userAccountBalance) {\n    return '---';\n  }\n\n  return formatNumber(userAccountBalance);\n}\n\nfunction renderUnauthorizedMessage({\n  defaultChainError,\n  isConnected,\n}: {\n  defaultChainError: Error | undefined;\n  isConnected: boolean;\n}) {\n  // user is not connected\n  if (!isConnected) {\n    return 'Connect your wallet to submit an onboarding proposal.';\n  }\n\n  // user is on wrong network\n  if (defaultChainError) {\n    return defaultChainError.message;\n  }\n}\n\nfunction renderSubmitStatus(\n  proposalSignAndSendStatus: Web3TxStatus\n): React.ReactNode {\n  switch (proposalSignAndSendStatus) {\n    case Web3TxStatus.AWAITING_CONFIRM:\n      return (\n        <>\n          Awaiting your confirmation\n          <CycleEllipsis intervalMs={500} />\n        </>\n      );\n    case Web3TxStatus.PENDING:\n      return (\n        <>\n          Submitting\n          <CycleEllipsis intervalMs={500} />\n        </>\n      );\n    case Web3TxStatus.FULFILLED:\n      return 'Done!';\n    default:\n      return null;\n  }\n}\n\nexport default function CreateOnboardingProposal() {\n  /**\n   * Selectors\n   */\n\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  const {connected, account, web3Instance} = useWeb3Modal();\n\n  const {\n    proposalData,\n    proposalSignAndSendError,\n    proposalSignAndSendStatus,\n    signAndSendProposal,\n  } = useSignAndSubmitProposal<SnapshotType.draft>();\n\n  /**\n   * Their hooks\n   */\n\n  const form = useForm<FormInputs>({\n    mode: 'onBlur',\n    reValidateMode: 'onChange',\n  });\n\n  const history = useHistory();\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n\n  const [userAccountBalance, setUserAccountBalance] = useState<string>();\n\n  const [sliderStep, setSliderStep] = useState<number>();\n\n  const [sliderMin, setSliderMin] = useState<number>();\n\n  const [sliderMax, setSliderMax] = useState<number>();\n\n  const [onboardingConfigs, setOnboardingConfigs] =\n    useState<OnboardingConfigs>();\n\n  const [erc20Contract, setERC20Contract] = useState<Web3Contract>();\n\n  const [erc20Details, setERC20Details] = useState<ERC20Details>();\n\n  /**\n   * Variables\n   */\n\n  const {\n    clearErrors,\n    control,\n    errors,\n    getValues,\n    register,\n    setValue,\n    trigger,\n    watch,\n  } = form;\n\n  const ethAddressValue = watch(Fields.ethAddress);\n\n  const amountValue = watch(Fields.amount);\n\n  const createOnboardError = submitError || proposalSignAndSendError;\n\n  const isConnected: boolean = connected && account ? true : false;\n\n  const isInProcess =\n    proposalSignAndSendStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    proposalSignAndSendStatus === Web3TxStatus.PENDING;\n\n  const isDone = proposalSignAndSendStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone = isInProcess || isDone;\n\n  const {\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n  } = useCheckApplicant(ethAddressValue);\n\n  const minUnitsText = onboardingConfigs\n    ? formatNumber(onboardingConfigs.unitsPerChunk)\n    : PLACEHOLDER;\n\n  const minAmountText = sliderMin ? formatNumber(sliderMin) : PLACEHOLDER;\n\n  const maxUnitsText = onboardingConfigs\n    ? formatNumber(\n        String(\n          toBN(onboardingConfigs.unitsPerChunk).mul(\n            toBN(onboardingConfigs.maximumChunks)\n          )\n        )\n      )\n    : PLACEHOLDER;\n\n  const maxAmountText = sliderMax ? formatNumber(sliderMax) : PLACEHOLDER;\n\n  const amountUnit = isERC20Onboarding ? erc20Details?.symbol : 'ETH';\n\n  /**\n   * Cached callbacks\n   */\n\n  const getUserAccountBalanceCached = useCallback(getUserAccountBalance, [\n    account,\n    defaultChainError,\n    erc20Contract,\n    web3Instance,\n  ]);\n\n  const setSliderConfigsCached = useCallback(setSliderConfigs, [\n    daoRegistryContract,\n    defaultChainError,\n    erc20Details,\n    onboardingConfigs,\n    setValue,\n  ]);\n\n  const getOnboardingConfigsCached = useCallback(getOnboardingConfigs, [\n    daoRegistryContract,\n    defaultChainError,\n  ]);\n\n  const getERC20ContractCached = useCallback(getERC20Contract, [\n    defaultChainError,\n    web3Instance,\n  ]);\n\n  const getERC20DetailsCached = useCallback(getERC20Details, [\n    defaultChainError,\n    erc20Contract,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getUserAccountBalanceCached();\n  }, [getUserAccountBalanceCached]);\n\n  // Set the value of `ethAddress` if the `account` changes\n  useEffect(() => {\n    if (defaultChainError) return;\n\n    setValue(Fields.ethAddress, account && toChecksumAddress(account));\n  }, [account, defaultChainError, setValue]);\n\n  useEffect(() => {\n    setSliderConfigsCached();\n  }, [setSliderConfigsCached]);\n\n  useEffect(() => {\n    setSubmitError(undefined);\n    clearErrors();\n  }, [clearErrors, ethAddressValue]);\n\n  useEffect(() => {\n    getOnboardingConfigsCached();\n  }, [getOnboardingConfigsCached]);\n\n  useEffect(() => {\n    if (isERC20Onboarding) {\n      getERC20ContractCached();\n    }\n  }, [getERC20ContractCached]);\n\n  useEffect(() => {\n    if (isERC20Onboarding) {\n      getERC20DetailsCached();\n    }\n  }, [getERC20DetailsCached]);\n\n  /**\n   * Functions\n   */\n\n  async function getERC20Contract() {\n    if (!web3Instance || defaultChainError) {\n      setERC20Contract(undefined);\n      return;\n    }\n\n    try {\n      if (!ONBOARDING_TOKEN_ADDRESS) {\n        throw new Error(\n          'No Onboarding ERC20 address was found. Are you sure it is set?'\n        );\n      }\n\n      const {default: lazyERC20ABI} = await import(\n        '../../abis/external/ERC20.json'\n      );\n      const erc20Contract: AbiItem[] = lazyERC20ABI as any;\n      const instance = new web3Instance.eth.Contract(\n        erc20Contract,\n        ONBOARDING_TOKEN_ADDRESS\n      );\n\n      setERC20Contract(instance);\n    } catch (error) {\n      console.error(error);\n      setERC20Contract(undefined);\n    }\n  }\n\n  async function getERC20Details() {\n    if (!erc20Contract || defaultChainError) {\n      setERC20Details(undefined);\n      return;\n    }\n\n    try {\n      const symbol = await erc20Contract.methods.symbol().call();\n      const decimals = await erc20Contract.methods.decimals().call();\n      setERC20Details({symbol, decimals: Number(decimals)});\n    } catch (error) {\n      console.error(error);\n      setERC20Details(undefined);\n    }\n  }\n\n  function setSliderConfigs() {\n    try {\n      if (!daoRegistryContract || defaultChainError || !onboardingConfigs) {\n        setSliderStep(undefined);\n        setSliderMin(undefined);\n        setSliderMax(undefined);\n        setValue(Fields.amount, PLACEHOLDER);\n\n        return;\n      }\n\n      if (isERC20Onboarding) {\n        // ERC20 onboarding\n        if (!erc20Details) {\n          setSliderStep(undefined);\n          setSliderMin(undefined);\n          setSliderMax(undefined);\n          setValue(Fields.amount, PLACEHOLDER);\n\n          return;\n        }\n\n        const divisor = toBN(10).pow(toBN(erc20Details.decimals));\n        const beforeDecimal = toBN(onboardingConfigs.chunkSize).div(divisor);\n        const afterDecimal = toBN(onboardingConfigs.chunkSize).mod(divisor);\n        const stepAmount: number = afterDecimal.eq(toBN(0))\n          ? Number(String(beforeDecimal))\n          : Number(`${String(beforeDecimal)}.${String(afterDecimal)}`);\n        setSliderStep(stepAmount);\n\n        setSliderMax(stepAmount * Number(onboardingConfigs.maximumChunks));\n\n        setSliderMin(stepAmount);\n\n        setValue(Fields.amount, String(stepAmount));\n      } else {\n        // ETH onboarding\n        setSliderStep(Number(fromWei(onboardingConfigs.chunkSize, 'ether')));\n\n        setSliderMax(\n          Number(\n            fromWei(\n              toBN(onboardingConfigs.chunkSize).mul(\n                toBN(onboardingConfigs.maximumChunks)\n              ),\n              'ether'\n            )\n          )\n        );\n\n        setSliderMin(Number(fromWei(onboardingConfigs.chunkSize, 'ether')));\n\n        setValue(Fields.amount, fromWei(onboardingConfigs.chunkSize, 'ether'));\n      }\n    } catch (error) {\n      setSliderStep(undefined);\n      setSliderMin(undefined);\n      setSliderMax(undefined);\n      setValue(Fields.amount, PLACEHOLDER);\n\n      console.error(error);\n    }\n  }\n\n  async function getOnboardingConfigs() {\n    try {\n      if (!daoRegistryContract || defaultChainError) return;\n\n      const chunkSize = await getDAOConfigEntry(\n        daoRegistryContract.instance,\n        ContractDAOConfigKeys.onboardingChunkSize,\n        UNITS_ADDRESS\n      );\n      const maximumChunks = await getDAOConfigEntry(\n        daoRegistryContract.instance,\n        ContractDAOConfigKeys.onboardingMaximumChunks,\n        UNITS_ADDRESS\n      );\n      const unitsPerChunk = await getDAOConfigEntry(\n        daoRegistryContract.instance,\n        ContractDAOConfigKeys.onboardingUnitsPerChunk,\n        UNITS_ADDRESS\n      );\n      setOnboardingConfigs({\n        chunkSize,\n        maximumChunks,\n        unitsPerChunk,\n      });\n    } catch (error) {\n      console.error(error);\n\n      setOnboardingConfigs(undefined);\n    }\n  }\n\n  async function getUserAccountBalance() {\n    try {\n      if (!account || defaultChainError) {\n        setUserAccountBalance(undefined);\n\n        return;\n      }\n\n      if (isERC20Onboarding) {\n        // ERC20 onboarding\n        if (!erc20Contract) {\n          setUserAccountBalance(undefined);\n\n          return;\n        }\n\n        const balance = await erc20Contract.methods.balanceOf(account).call();\n        const balanceBN = toBN(balance);\n        const decimals = await erc20Contract.methods.decimals().call();\n        const divisor = toBN(10).pow(toBN(decimals));\n        const beforeDecimal = balanceBN.div(divisor);\n        const afterDecimal = balanceBN.mod(divisor);\n        const balanceReadable = afterDecimal.eq(toBN(0))\n          ? String(beforeDecimal)\n          : `${String(beforeDecimal)}.${String(afterDecimal)}`;\n\n        setUserAccountBalance(balanceReadable);\n      } else {\n        // ETH onboarding\n        if (!web3Instance) {\n          setUserAccountBalance(undefined);\n\n          return;\n        }\n\n        // Ether wallet balance\n        setUserAccountBalance(\n          web3Instance.utils.fromWei(\n            await web3Instance.eth.getBalance(account),\n            'ether'\n          )\n        );\n      }\n    } catch (error) {\n      console.error(error);\n      setUserAccountBalance(undefined);\n    }\n  }\n\n  async function handleSubmit(values: FormInputs) {\n    try {\n      if (!isConnected) {\n        throw new Error(\n          'No user account was found. Please make sure your wallet is connected.'\n        );\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (checkApplicantError) {\n        // Just log the error (don't throw) because it is not a blocker for the\n        // snapshot draft to be submitted. The applicant address validity will\n        // be checked again when the proposal is submitted onchain.\n        console.warn(\n          `Error checking if the applicant address is valid: ${checkApplicantError.message}`\n        );\n      }\n\n      if (\n        checkApplicantStatus === AsyncStatus.FULFILLED &&\n        !isApplicantValid &&\n        checkApplicantInvalidMsg\n      ) {\n        throw new Error(checkApplicantInvalidMsg);\n      }\n\n      // Maybe set proposal ID from previous attempt\n      let proposalId: string = proposalData?.uniqueId || '';\n\n      const {ethAddress, amount} = values;\n      const ethAddressToChecksum = toChecksumAddress(ethAddress);\n      const proposerAddressToChecksum = toChecksumAddress(account);\n\n      let amountArg = '';\n\n      if (isERC20Onboarding) {\n        // ERC20 onboarding\n        if (!erc20Details) {\n          throw new Error('No ERC20 details found.');\n        }\n\n        if (!Number.isInteger(Number(amount))) {\n          throw new Error('The amount must be an integer for an ERC20 token.');\n        }\n\n        const multiplier = toBN(10).pow(toBN(erc20Details.decimals));\n        const erc20AmountWithDecimals = toBN(amount).mul(multiplier);\n\n        amountArg = String(erc20AmountWithDecimals);\n      } else {\n        // ETH onboarding\n        const ethAmountInWei = toWei(amount, 'ether');\n\n        amountArg = ethAmountInWei;\n      }\n\n      // Values needed to display relevant proposal amounts in the proposal\n      // details page are set in the snapshot draft metadata. (We can no longer\n      // rely on getting this data from onchain because the proposal may not\n      // exist there yet.)\n      const proposalAmountValues = {\n        tributeAmount: formatNumber(amount),\n        tributeAmountUnit: amountUnit,\n      };\n\n      // Arguments needed to submit the proposal onchain are set in the snapshot\n      // draft metadata.\n      const submitActionArgs: SubmitActionArguments = [\n        ethAddressToChecksum,\n        UNITS_ADDRESS,\n        amountArg,\n      ];\n\n      // Only submit to snapshot if there is not already a proposal ID returned from a previous attempt.\n      if (!proposalId) {\n        const body =\n          normalizeString(ethAddress) === normalizeString(account)\n            ? `Onboarding ${truncateEthAddress(ethAddressToChecksum, 7)}.`\n            : `Onboarding proposal from ${truncateEthAddress(\n                proposerAddressToChecksum,\n                7\n              )} for applicant ${truncateEthAddress(ethAddressToChecksum, 7)}.`;\n\n        // Sign and submit draft for snapshot-hub\n        const {uniqueId} = await signAndSendProposal({\n          partialProposalData: {\n            name: ethAddressToChecksum,\n            body,\n            metadata: {\n              proposalAmountValues,\n              submitActionArgs,\n              accountAuthorizedToProcessPassedProposal:\n                proposerAddressToChecksum,\n            },\n          },\n          adapterName: ContractAdapterNames.onboarding,\n          type: SnapshotType.draft,\n        });\n\n        proposalId = uniqueId;\n      }\n\n      // go to OnboardingDetails page for newly created member proposal\n      history.push(`/onboarding/${proposalId}`);\n    } catch (error) {\n      // Set any errors from Web3 utils or explicitly set above.\n      const e = error as Error;\n\n      setSubmitError(e);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  // Render unauthorized message\n  if (!isConnected || defaultChainError) {\n    return (\n      <RenderWrapper>\n        <div className=\"form__description--unauthorized\">\n          <p>{renderUnauthorizedMessage({defaultChainError, isConnected})}</p>\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      <div className=\"form__description\">\n        <p>\n          Submit a proposal to join Tribute DAO. Each member can purchase{' '}\n          {minUnitsText} units for {minAmountText} {amountUnit} (up to{' '}\n          {maxUnitsText} units for {maxAmountText} {amountUnit}). Please put\n          your preferred ETH address below and the amount of {amountUnit}{' '}\n          you&apos;d like to contribute.\n        </p>\n        <p>\n          Following your submission, existing members will consider your\n          proposal. If approved by vote, your proposal will be processed and you\n          will finalize the transfer of your allocated {amountUnit} in exchange\n          for membership units.\n        </p>\n      </div>\n\n      <form className=\"form\" onSubmit={(e) => e.preventDefault()}>\n        {/* ETH ADDRESS */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\" htmlFor={Fields.ethAddress}>\n            Applicant Address\n          </label>\n          <div className=\"form__input-row-fieldwrap\">\n            {/* @note We don't need the default value as it's handled in the useEffect above. */}\n            <input\n              aria-describedby={`error-${Fields.ethAddress}`}\n              aria-invalid={errors.ethAddress ? 'true' : 'false'}\n              id={Fields.ethAddress}\n              name={Fields.ethAddress}\n              ref={register({\n                validate: (ethAddress: string): string | boolean => {\n                  return !ethAddress\n                    ? FormFieldErrors.REQUIRED\n                    : !isEthAddressValid(ethAddress)\n                    ? FormFieldErrors.INVALID_ETHEREUM_ADDRESS\n                    : true;\n                },\n              })}\n              type=\"text\"\n              disabled={isInProcessOrDone}\n            />\n\n            <InputError\n              error={getValidationError(Fields.ethAddress, errors)}\n              id={`error-${Fields.ethAddress}`}\n            />\n          </div>\n        </div>\n\n        {/* AMOUNT SLIDER */}\n        <div className=\"form__input-row\">\n          <label\n            className=\"form__input-row-label\"\n            htmlFor={Fields.amount}\n            id={`${Fields.amount}-label`}>\n            Amount\n          </label>\n          <div className=\"form__input-row-fieldwrap--narrow\">\n            <Controller\n              render={({onChange}) => (\n                <Slider\n                  data-testid=\"onboarding-slider\"\n                  aria-labelledby={`${Fields.amount}-label`}\n                  defaultValue={sliderMin || 0}\n                  id={Fields.amount}\n                  max={sliderMax || 0}\n                  min={sliderMin || 0}\n                  step={sliderStep || 0}\n                  onChange={onChange}\n                  disabled={isInProcessOrDone}\n                />\n              )}\n              defaultValue={sliderMin || 0}\n              control={control}\n              name={Fields.amount}\n              rules={{\n                validate: (value: string): string | boolean => {\n                  const amount = Number(value);\n\n                  return amount > Number(userAccountBalance)\n                    ? `Insufficient funds. ${renderUserAccountBalance(\n                        userAccountBalance\n                      )} ${amountUnit} available.`\n                    : true;\n                },\n              }}\n            />\n\n            <InputError\n              error={getValidationError(Fields.amount, errors)}\n              id={`error-${Fields.amount}`}\n            />\n          </div>\n          <div className=\"form__input-addon\">\n            {formatNumber(amountValue)} {amountUnit}\n          </div>\n        </div>\n\n        {/* SUBMIT */}\n        <button\n          aria-label={isInProcess ? 'Submitting your proposal.' : ''}\n          className=\"button\"\n          disabled={isInProcessOrDone}\n          onClick={\n            isInProcessOrDone\n              ? () => {}\n              : async () => {\n                  if (!(await trigger())) {\n                    return;\n                  }\n\n                  handleSubmit(getValues());\n                }\n          }\n          type=\"submit\">\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Submit'}\n        </button>\n\n        {/* SUBMIT STATUS */}\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus(proposalSignAndSendStatus)}\n          </div>\n        )}\n\n        {/* SUBMIT ERROR */}\n        {createOnboardError && (\n          <div className=\"form__submit-error-container\">\n            <ErrorMessageWithDetails\n              renderText=\"Something went wrong while submitting the proposal.\"\n              error={createOnboardError}\n              detailsProps={{open: true}}\n            />\n          </div>\n        )}\n      </form>\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Onboard</h2>\n        </div>\n\n        <div className=\"form-wrapper\">\n          {/* RENDER CHILDREN */}\n          {props.children}\n        </div>\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {useState} from 'react';\n\ntype SliderProps = {\n  max: number;\n  min: number;\n  step: number;\n};\n\n/**\n * Slider\n *\n * @param {SliderProps} props\n */\nexport default function Slider(\n  props: SliderProps & React.InputHTMLAttributes<HTMLInputElement>\n) {\n  const {defaultValue, max, min, name, onChange, step, ...restProps} = props;\n\n  const [value, setValue] = useState<string>();\n\n  function handleOnChange(event: React.ChangeEvent<HTMLInputElement>) {\n    setValue(event.target.value);\n\n    onChange && onChange(event);\n  }\n\n  return (\n    <input\n      {...restProps}\n      aria-valuemin={min}\n      aria-valuemax={max}\n      aria-valuenow={Number(value)}\n      max={max}\n      min={min}\n      name={name}\n      onChange={handleOnChange}\n      step={step}\n      type=\"range\"\n      value={value || defaultValue}\n    />\n  );\n}\n","import {\n  SnapshotType,\n  SnapshotProposalData,\n  prepareVoteProposalData,\n} from '@openlaw/snapshot-js-erc712';\nimport {toBN, AbiItem, toWei, toChecksumAddress} from 'web3-utils';\nimport {useForm} from 'react-hook-form';\nimport {useHistory} from 'react-router-dom';\nimport {useSelector} from 'react-redux';\nimport {useState, useCallback, useEffect} from 'react';\nimport {debounce} from 'debounce';\n\nimport {\n  useContractSend,\n  useETHGasPrice,\n  useIsDefaultChain,\n  useWeb3Modal,\n} from '../../components/web3/hooks';\nimport {\n  formatNumber,\n  getValidationError,\n  stripFormatNumber,\n  truncateEthAddress,\n} from '../../util/helpers';\nimport {BURN_ADDRESS} from '../../util/constants';\nimport {ContractAdapterNames, Web3TxStatus} from '../../components/web3/types';\nimport {default as ERC20ABI} from '../../abis/external/ERC20.json';\nimport {ETH_TOKEN_ADDRESS, GUILD_ADDRESS, UNITS_ADDRESS} from '../../config';\nimport {FormFieldErrors} from '../../util/enums';\nimport {isEthAddressValid} from '../../util/validation';\nimport {multicall, MulticallTuple} from '../../components/web3/helpers';\nimport {StoreState} from '../../store/types';\nimport {TX_CYCLE_MESSAGES} from '../../components/web3/config';\nimport {useSignAndSubmitProposal} from '../../components/proposals/hooks';\nimport CycleMessage from '../../components/feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport EtherscanURL from '../../components/web3/EtherscanURL';\nimport FadeIn from '../../components/common/FadeIn';\nimport InputError from '../../components/common/InputError';\nimport Loader from '../../components/feedback/Loader';\nimport Wrap from '../../components/common/Wrap';\n\nenum Fields {\n  type = 'type',\n  selectedToken = 'selectedToken',\n  memberAddress = 'memberAddress',\n  amount = 'amount',\n  notes = 'notes',\n}\n\ntype FormInputs = {\n  type: string;\n  selectedToken: string;\n  memberAddress: string;\n  amount: string;\n  notes: string;\n};\n\ntype TransferArguments = [\n  string, // `dao`\n  string, // `proposalId`\n  string, // `unitHolderAddr`\n  string, // `token`\n  string, // `amount`\n  string // `data`\n];\n\ntype InitialTokenDetails = {\n  address: string;\n  daoBalance: string;\n};\n\ntype TokenDetails = InitialTokenDetails & {\n  name: string;\n  symbol: string;\n  decimals: number;\n};\n\nconst getDelegatedAddressMessage = (a: string) =>\n  `Your member address is delegated to ${truncateEthAddress(\n    a,\n    7\n  )}. You must use that address.`;\n\nexport default function CreateTransferProposal() {\n  /**\n   * Selectors\n   */\n\n  const DistributeContract = useSelector(\n    (state: StoreState) => state.contracts?.DistributeContract\n  );\n  const DaoRegistryContract = useSelector(\n    (state: StoreState) => state.contracts?.DaoRegistryContract\n  );\n  const BankExtensionContract = useSelector(\n    (state: StoreState) => state.contracts?.BankExtensionContract\n  );\n  const delegateAddress = useSelector(\n    (s: StoreState) => s.connectedMember?.delegateKey\n  );\n  const isAddressDelegated = useSelector(\n    (s: StoreState) => s.connectedMember?.isAddressDelegated\n  );\n  const isActiveMember = useSelector(\n    (s: StoreState) => s.connectedMember?.isActiveMember\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {defaultChainError} = useIsDefaultChain();\n  const {connected, account, web3Instance} = useWeb3Modal();\n  const {average: gasPrice} = useETHGasPrice();\n\n  const {txError, txEtherscanURL, txIsPromptOpen, txSend, txStatus} =\n    useContractSend();\n\n  const {proposalData, proposalSignAndSendStatus, signAndSendProposal} =\n    useSignAndSubmitProposal<SnapshotType.proposal>();\n\n  /**\n   * Their hooks\n   */\n\n  const form = useForm<FormInputs>({\n    mode: 'onBlur',\n    reValidateMode: 'onChange',\n  });\n  const history = useHistory();\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n  const [daoTokens, setDaoTokens] = useState<TokenDetails[]>();\n  const [selectedTokenBalance, setSelectedTokenBalance] = useState<string>();\n\n  /**\n   * Variables\n   */\n\n  const {errors, getValues, setValue, register, trigger, watch} = form;\n  const typeValue = watch('type');\n  const isTypeAllMembers = typeValue === 'all members';\n  const selectedTokenValue = watch('selectedToken');\n\n  const createTransferError = submitError || txError;\n  const isConnected = connected && account;\n  const erc20ABI: AbiItem[] = ERC20ABI as any;\n\n  const isInProcess =\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING ||\n    proposalSignAndSendStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    proposalSignAndSendStatus === Web3TxStatus.PENDING;\n\n  const isDone =\n    txStatus === Web3TxStatus.FULFILLED &&\n    proposalSignAndSendStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n\n  /**\n   * Cached callbacks\n   */\n\n  const getDaoTokensCached = useCallback(getDaoTokens, [\n    BankExtensionContract,\n    account,\n    erc20ABI,\n    web3Instance,\n  ]);\n\n  const getSelectedTokenBalanceCached = useCallback(getSelectedTokenBalance, [\n    account,\n    selectedTokenValue,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getDaoTokensCached();\n  }, [getDaoTokensCached]);\n\n  useEffect(() => {\n    getSelectedTokenBalanceCached();\n  }, [getSelectedTokenBalanceCached]);\n\n  /**\n   * Functions\n   */\n\n  async function getDaoTokens() {\n    if (!account || !BankExtensionContract || !web3Instance) {\n      setDaoTokens(undefined);\n      return;\n    }\n\n    try {\n      const {\n        abi: bankABI,\n        contractAddress: bankAddress,\n        instance: {methods: bankMethods},\n      } = BankExtensionContract;\n\n      const nbTokens = await bankMethods.nbTokens().call();\n\n      if (Number(nbTokens) < 1) {\n        setDaoTokens([]);\n      } else {\n        let parsedAndSortedTokens: TokenDetails[] = [];\n\n        // Build calls to get DAO token list with details\n        const getTokenABI = bankABI.find((item) => item.name === 'getToken');\n        const getTokenCalls = [...Array(Number(nbTokens)).keys()].map(\n          (index): MulticallTuple => [\n            bankAddress,\n            getTokenABI as AbiItem,\n            [index.toString()],\n          ]\n        );\n        const fetchedTokens: string[] = await multicall({\n          calls: getTokenCalls,\n          web3Instance,\n        });\n\n        const balanceOfABI = bankABI.find((item) => item.name === 'balanceOf');\n        const getDaoTokenBalanceCalls = fetchedTokens.map(\n          (token): MulticallTuple => [\n            bankAddress,\n            balanceOfABI as AbiItem,\n            [GUILD_ADDRESS, token],\n          ]\n        );\n        const daoTokenBalances: string[] = await multicall({\n          calls: getDaoTokenBalanceCalls,\n          web3Instance,\n        });\n\n        const tokensArray: InitialTokenDetails[] = fetchedTokens\n          .map((token, index) => ({\n            address: token,\n            daoBalance: daoTokenBalances[index],\n          }))\n          // Don't need to include tokens that have 0 balance\n          .filter((tokenObj) => toBN(tokenObj.daoBalance).gt(toBN(0)));\n\n        const ethToken = tokensArray.find(\n          (token) => token.address === ETH_TOKEN_ADDRESS\n        );\n        if (ethToken) {\n          parsedAndSortedTokens.push({\n            ...ethToken,\n            name: 'Ether',\n            symbol: 'ETH',\n            decimals: 18,\n          });\n        }\n\n        // Filter out Ether to handle ERC20 tokens\n        const erc20Tokens = tokensArray.filter(\n          (token) => token.address !== ETH_TOKEN_ADDRESS\n        );\n\n        if (erc20Tokens.length > 0) {\n          const nameABI = erc20ABI.find((item) => item.name === 'name');\n          const nameCalls = erc20Tokens.map(\n            (token): MulticallTuple => [\n              token.address as string,\n              nameABI as AbiItem,\n              [],\n            ]\n          );\n          const symbolABI = erc20ABI.find((item) => item.name === 'symbol');\n          const symbolCalls = erc20Tokens.map(\n            (token): MulticallTuple => [\n              token.address as string,\n              symbolABI as AbiItem,\n              [],\n            ]\n          );\n          const decimalsABI = erc20ABI.find((item) => item.name === 'decimals');\n          const decimalsCalls = erc20Tokens.map(\n            (token): MulticallTuple => [\n              token.address as string,\n              decimalsABI as AbiItem,\n              [],\n            ]\n          );\n          const erc20DetailsCalls = [\n            ...nameCalls,\n            ...symbolCalls,\n            ...decimalsCalls,\n          ];\n          let results = await multicall({\n            calls: erc20DetailsCalls,\n            web3Instance,\n          });\n          let chunkedResults = [];\n          while (results.length) {\n            chunkedResults.push(results.splice(0, erc20Tokens.length));\n          }\n          const [names, symbols, decimals] = chunkedResults;\n\n          const parsedAndSortedERC20Tokens = erc20Tokens\n            .map((token, index) => ({\n              ...token,\n              name: names[index],\n              symbol: symbols[index],\n              decimals: decimals[index],\n            }))\n            .sort((a, b) => a.name.localeCompare(b.name));\n\n          parsedAndSortedTokens = [\n            ...parsedAndSortedTokens,\n            ...parsedAndSortedERC20Tokens,\n          ];\n        }\n\n        setDaoTokens(parsedAndSortedTokens);\n      }\n    } catch (error) {\n      console.error(error);\n      setDaoTokens(undefined);\n    }\n  }\n\n  async function getSelectedTokenBalance() {\n    if (!account || !selectedTokenValue) {\n      setSelectedTokenBalance(undefined);\n      return;\n    }\n\n    try {\n      const selectedTokenObj = JSON.parse(selectedTokenValue);\n      const balance = selectedTokenObj.daoBalance;\n      const balanceBN = toBN(balance);\n      const decimals = selectedTokenObj.decimals;\n      const divisor = toBN(10).pow(toBN(decimals));\n      const beforeDecimal = balanceBN.div(divisor);\n      const afterDecimal = balanceBN.mod(divisor);\n      const balanceReadable = afterDecimal.eq(toBN(0))\n        ? beforeDecimal.toString()\n        : `${beforeDecimal.toString()}.${afterDecimal.toString()}`;\n\n      setSelectedTokenBalance(balanceReadable);\n    } catch (error) {\n      console.error(error);\n      setSelectedTokenBalance(undefined);\n    }\n  }\n\n  async function handleSubmit(values: FormInputs) {\n    try {\n      if (!isConnected) {\n        throw new Error(\n          'No user account was found. Please make sure your wallet is connected.'\n        );\n      }\n\n      if (!DistributeContract) {\n        throw new Error('No DistributeContract found.');\n      }\n\n      if (!DaoRegistryContract) {\n        throw new Error('No DaoRegistryContract found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      const {selectedToken, memberAddress, amount, notes} = values;\n      const memberAddressToChecksum = toChecksumAddress(memberAddress);\n      const selectedTokenObj = JSON.parse(selectedToken);\n      const {symbol, decimals, address: tokenAddress} = selectedTokenObj;\n      let amountArg;\n      if (tokenAddress === ETH_TOKEN_ADDRESS) {\n        amountArg = toWei(stripFormatNumber(amount), 'ether');\n      } else {\n        const multiplier = toBN(10).pow(toBN(decimals));\n        const amountWithDecimals = toBN(stripFormatNumber(amount)).mul(\n          multiplier\n        );\n        amountArg = amountWithDecimals.toString();\n      }\n\n      // Maybe set proposal info from previous attempt\n      let proposalId: string = proposalData?.uniqueId || '';\n      let data: SnapshotProposalData | undefined = proposalData?.data;\n      let signature: string = proposalData?.signature || '';\n      let submitter: string = proposalData?.submitter || '';\n\n      const bodyIntro = isTypeAllMembers\n        ? 'Transfer to all members pro rata.'\n        : `Transfer to ${truncateEthAddress(memberAddressToChecksum, 7)}.`;\n\n      // Values needed to display relevant proposal amounts in the proposal\n      // details page are set in the snapshot draft metadata. (We can no longer\n      // rely on getting this data from onchain because the proposal may not\n      // exist there yet.)\n      const proposalAmountValues = {\n        transferAmount: amount,\n        transferAmountUnit: symbol,\n      };\n\n      // Only submit to snapshot if there is not already a proposal ID returned from a previous attempt.\n      if (!proposalId) {\n        const body = notes ? `${bodyIntro}\\n${notes}` : bodyIntro;\n        const name = isTypeAllMembers ? 'All members' : memberAddressToChecksum;\n        const now = Math.floor(Date.now() / 1000);\n\n        // Sign and submit proposal for snapshot-hub\n        const {\n          uniqueId,\n          data: returnData,\n          signature: returnSignature,\n          submitter: returnSubmitter,\n        } = await signAndSendProposal({\n          partialProposalData: {\n            name,\n            body,\n            metadata: {\n              proposalAmountValues,\n              isTypeAllMembers,\n            },\n            timestamp: now.toString(),\n          },\n          adapterName: ContractAdapterNames.distribute,\n          type: SnapshotType.proposal,\n        });\n\n        proposalId = uniqueId;\n        data = returnData;\n        signature = returnSignature;\n        submitter = returnSubmitter;\n      }\n\n      const memberAddressArg = isTypeAllMembers\n        ? BURN_ADDRESS // 0x0 address indicates distribution to all active members\n        : memberAddressToChecksum;\n      /**\n       * Prepare `data` argument for submission to DAO\n       *\n       * For information about which data the smart contract needs for signature verification (e.g. `hashMessage`):\n       * @link https://github.com/openlawteam/tribute-contracts/blob/master/contracts/adapters/voting/OffchainVoting.sol\n       */\n      const preparedVoteVerificationBytes = data\n        ? prepareVoteProposalData(\n            {\n              payload: {\n                name: data.payload.name,\n                body: data.payload.body,\n                choices: data.payload.choices,\n                snapshot: data.payload.snapshot.toString(),\n                start: data.payload.start,\n                end: data.payload.end,\n              },\n              submitter,\n              sig: signature,\n              space: data.space,\n              timestamp: parseInt(data.timestamp),\n            },\n            web3Instance\n          )\n        : '';\n\n      const transferArguments: TransferArguments = [\n        DaoRegistryContract.contractAddress,\n        proposalId,\n        memberAddressArg,\n        tokenAddress,\n        amountArg,\n        preparedVoteVerificationBytes,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(gasPrice ? {gasPrice} : null),\n      };\n\n      // Execute contract call for `submitProposal`\n      await txSend(\n        'submitProposal',\n        DistributeContract.instance.methods,\n        transferArguments,\n        txArguments\n      );\n\n      // go to TransferDetails page for newly created transfer proposal\n      history.push(`/transfers/${proposalId}`);\n    } catch (error) {\n      // Set any errors from Web3 utils or explicitly set above.\n      const e = error as Error;\n\n      setSubmitError(e);\n    }\n  }\n\n  function renderSubmitStatus(): React.ReactNode {\n    // Either Snapshot or chain tx\n    if (\n      txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n      proposalSignAndSendStatus === Web3TxStatus.AWAITING_CONFIRM\n    ) {\n      return 'Awaiting your confirmation\\u2026';\n    }\n\n    // Only for chain tx\n    switch (txStatus) {\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>Proposal submitted!</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  function renderSelectedTokenBalance() {\n    if (!selectedTokenBalance) {\n      return '---';\n    }\n\n    return formatNumber(selectedTokenBalance);\n  }\n\n  function getUnauthorizedMessage() {\n    // user is not connected\n    if (!isConnected) {\n      return 'Connect your wallet to submit a transfer proposal.';\n    }\n\n    // user is on wrong network\n    if (defaultChainError) {\n      return defaultChainError.message;\n    }\n\n    // user is not an active member\n    if (!isActiveMember && !isAddressDelegated) {\n      return 'Either you are not a member, or your membership is not active.';\n    }\n\n    // member has delegated to another address\n    if (!isActiveMember && delegateAddress && isAddressDelegated) {\n      return getDelegatedAddressMessage(delegateAddress);\n    }\n  }\n\n  async function isActiveMemberWithUnits(address: string) {\n    if (!BankExtensionContract) {\n      console.error('No BankExtensionContract found.');\n      return false;\n    }\n\n    const unitsBalance = await BankExtensionContract.instance.methods\n      .balanceOf(address, UNITS_ADDRESS)\n      .call();\n\n    return toBN(unitsBalance).gt(toBN(0));\n  }\n\n  /**\n   * Render\n   */\n\n  // Render unauthorized message\n  if (!isConnected || defaultChainError || !isActiveMember) {\n    return (\n      <RenderWrapper>\n        <div className=\"form__description--unauthorized\">\n          <p>{getUnauthorizedMessage()}</p>\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      <form className=\"form\" onSubmit={(e) => e.preventDefault()}>\n        {/* TYPE */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\">Type</label>\n          <div className=\"form__input-row-fieldwrap\">\n            <select\n              name={Fields.type}\n              ref={register}\n              disabled={isInProcessOrDone}>\n              <option value=\"single member\">Single member</option>\n              <option value=\"all members\">All members</option>\n            </select>\n          </div>\n        </div>\n\n        {/* MEMBER ADDRESS */}\n        {!isTypeAllMembers && (\n          <div className=\"form__input-row\">\n            <label className=\"form__input-row-label\">Member Address</label>\n            <div className=\"form__input-row-fieldwrap\">\n              <input\n                aria-describedby={`error-${Fields.memberAddress}`}\n                aria-invalid={errors.memberAddress ? 'true' : 'false'}\n                name={Fields.memberAddress}\n                ref={register({\n                  validate: async (\n                    memberAddress: string\n                  ): Promise<string | boolean> => {\n                    return !memberAddress\n                      ? FormFieldErrors.REQUIRED\n                      : !isEthAddressValid(memberAddress)\n                      ? FormFieldErrors.INVALID_ETHEREUM_ADDRESS\n                      : !(await isActiveMemberWithUnits(memberAddress))\n                      ? 'The address is not an active member with membership tokens.'\n                      : true;\n                  },\n                })}\n                type=\"text\"\n                disabled={isInProcessOrDone}\n              />\n\n              <InputError\n                error={getValidationError(Fields.memberAddress, errors)}\n                id={`error-${Fields.memberAddress}`}\n              />\n            </div>\n          </div>\n        )}\n\n        {/* SELECTED TOKEN */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\">Asset</label>\n          <div className=\"form__input-row-fieldwrap\">\n            <select\n              aria-describedby={`error-${Fields.selectedToken}`}\n              aria-invalid={errors.selectedToken ? 'true' : 'false'}\n              name={Fields.selectedToken}\n              ref={register({\n                validate: (token: string): string | boolean => {\n                  return !daoTokens || daoTokens.length < 1\n                    ? 'No tokens available for distribution.'\n                    : !token\n                    ? FormFieldErrors.REQUIRED\n                    : true;\n                },\n              })}\n              disabled={isInProcessOrDone}>\n              <option value=\"\">Select from DAO assets</option>\n              {daoTokens?.map((token) => (\n                <option\n                  key={token.address}\n                  value={JSON.stringify(\n                    token\n                  )}>{`${token.name} (${token.symbol})`}</option>\n              ))}\n            </select>\n\n            <InputError\n              error={getValidationError(Fields.selectedToken, errors)}\n              id={`error-${Fields.selectedToken}`}\n            />\n          </div>\n        </div>\n\n        {/* AMOUNT */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\">Amount</label>\n          <div className=\"form__input-row-fieldwrap--narrow\">\n            <div className=\"input__suffix-wrap\">\n              <input\n                className=\"input__suffix\"\n                aria-describedby={`error-${Fields.amount}`}\n                aria-invalid={errors.amount ? 'true' : 'false'}\n                name={Fields.amount}\n                onChange={debounce(\n                  () =>\n                    setValue(\n                      Fields.amount,\n                      formatNumber(stripFormatNumber(getValues().amount))\n                    ),\n                  1000\n                )}\n                ref={register({\n                  validate: (amount: string): string | boolean => {\n                    const amountToNumber = Number(stripFormatNumber(amount));\n                    const selectedTokenObj =\n                      selectedTokenValue && JSON.parse(selectedTokenValue);\n                    const isSelectedTokenEth =\n                      selectedTokenObj?.address === ETH_TOKEN_ADDRESS;\n\n                    return amount === ''\n                      ? FormFieldErrors.REQUIRED\n                      : isNaN(amountToNumber)\n                      ? FormFieldErrors.INVALID_NUMBER\n                      : amountToNumber <= 0\n                      ? 'The value must be greater than 0.'\n                      : amountToNumber > Number(selectedTokenBalance)\n                      ? 'Insufficient funds.'\n                      : isSelectedTokenEth\n                      ? true\n                      : !Number.isInteger(amountToNumber)\n                      ? 'The value must be an integer for an ERC20 token.'\n                      : true;\n                  },\n                })}\n                type=\"text\"\n                disabled={isInProcessOrDone}\n              />\n\n              <div className=\"input__suffix-item\">\n                {(selectedTokenValue &&\n                  JSON.parse(selectedTokenValue).symbol) ||\n                  '___'}\n              </div>\n            </div>\n\n            <InputError\n              error={getValidationError(Fields.amount, errors)}\n              id={`error-${Fields.amount}`}\n            />\n\n            <div className=\"form__input-description\">\n              {isTypeAllMembers\n                ? \"If the proposal passes, this total amount will be distributed pro rata to all members' internal accounts, based on the current number of membership tokens held by each member.\"\n                : \"If the proposal passes, this amount will be distributed to the member's internal account.\"}\n            </div>\n          </div>\n\n          <div className=\"form__input-addon\">\n            available: <span>{renderSelectedTokenBalance()}</span>\n          </div>\n        </div>\n\n        {/* NOTES */}\n        <div className=\"form__textarea-row\">\n          <label className=\"form__input-row-label\">Notes</label>\n          <div className=\"form__input-row-fieldwrap\">\n            <textarea\n              name={Fields.notes}\n              placeholder=\"Transactions purpose...\"\n              ref={register}\n              disabled={isInProcessOrDone}\n            />\n          </div>\n        </div>\n\n        {/* SUBMIT */}\n        <button\n          className=\"button\"\n          disabled={isInProcessOrDone}\n          onClick={async () => {\n            if (isInProcessOrDone) return;\n\n            if (!(await trigger())) {\n              return;\n            }\n\n            handleSubmit(getValues());\n          }}\n          type=\"submit\">\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Submit'}\n        </button>\n\n        {/* SUBMIT STATUS */}\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {/* SUBMIT ERROR */}\n        {createTransferError && (\n          <div className=\"form__submit-error-container\">\n            <ErrorMessageWithDetails\n              renderText=\"Something went wrong while submitting the proposal.\"\n              error={createTransferError}\n            />\n          </div>\n        )}\n      </form>\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Transfer Proposal</h2>\n        </div>\n\n        <div className=\"form-wrapper\">\n          <div className=\"form__description\">\n            <p>\n              Nulla aliquet porttitor venenatis. Donec a dui et dui fringilla\n              consectetur id nec massa. Aliquam erat volutpat. Sed ut dui ut\n              lacus dictum fermentum vel tincidunt neque. Sed sed lacinia...\n            </p>\n          </div>\n\n          {/* RENDER CHILDREN */}\n          {props.children}\n        </div>\n      </FadeIn>\n    </Wrap>\n  );\n}\n","// @ts-nocheck\nimport { useState, useCallback, useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { SnapshotType } from \"@openlaw/snapshot-js-erc712\";\nimport { useForm } from \"react-hook-form\";\nimport { useHistory } from \"react-router-dom\";\nimport { Contract as Web3Contract } from \"web3-eth-contract/types\";\nimport { toBN, AbiItem, toChecksumAddress } from \"web3-utils\";\nimport { debounce } from \"debounce\";\n\nimport {\n  formatNumber,\n  getValidationError,\n  normalizeString,\n  stripFormatNumber,\n  truncateEthAddress,\n} from \"../../util/helpers\";\nimport { useIsDefaultChain, useWeb3Modal } from \"../../components/web3/hooks\";\nimport {\n  ContractAdapterNames,\n  Web3TxStatus,\n} from \"../../components/web3/types\";\nimport { FormFieldErrors } from \"../../util/enums\";\nimport { isEthAddressValid } from \"../../util/validation\";\nimport { AsyncStatus } from \"../../util/types\";\nimport { UNITS_ADDRESS } from \"../../config\";\nimport { StoreState } from \"../../store/types\";\nimport {\n  useCheckApplicant,\n  useSignAndSubmitProposal,\n} from \"../../components/proposals/hooks\";\nimport { CycleEllipsis } from \"../../components/feedback\";\nimport ErrorMessageWithDetails from \"../../components/common/ErrorMessageWithDetails\";\nimport FadeIn from \"../../components/common/FadeIn\";\nimport InputError from \"../../components/common/InputError\";\nimport Loader from \"../../components/feedback/Loader\";\nimport Wrap from \"../../components/common/Wrap\";\n\nenum Fields {\n  applicantAddress = \"applicantAddress\",\n  erc20Address = \"erc20Address\",\n  tributeAmount = \"tributeAmount\",\n  requestAmount = \"requestAmount\",\n  description = \"description\",\n}\n\ntype FormInputs = {\n  applicantAddress: string;\n  erc20Address: string;\n  tributeAmount: string;\n  requestAmount: string;\n  description: string;\n};\n\ntype SubmitActionArguments = [\n  string, // `applicant`\n  string, // `tokenToMint`\n  string, // `requestAmount`\n  string, // `tokenAddr`\n  string, // `tributeAmount`\n  string // `tributeTokenOwner`\n];\n\ntype ERC20Details = {\n  symbol: string;\n  decimals: number;\n};\n\nexport default function CreateTributeProposal() {\n  /**\n   * Selectors\n   */\n\n  const ERC20ExtensionContract = useSelector(\n    (state: StoreState) => state.contracts?.ERC20ExtensionContract\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const { defaultChainError } = useIsDefaultChain();\n  const { connected, account, web3Instance } = useWeb3Modal();\n  const {\n    proposalData,\n    proposalSignAndSendError,\n    proposalSignAndSendStatus,\n    signAndSendProposal,\n  } = useSignAndSubmitProposal<SnapshotType.draft>();\n\n  /**\n   * Their hooks\n   */\n\n  const form = useForm<FormInputs>({\n    mode: \"onBlur\",\n    reValidateMode: \"onChange\",\n  });\n  const history = useHistory();\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n  const [userERC20Balance, setUserERC20Balance] = useState<string>();\n  const [erc20Details, setERC20Details] = useState<ERC20Details>();\n  const [erc20Contract, setERC20Contract] = useState<Web3Contract>();\n\n  /**\n   * Variables\n   */\n\n  const { errors, getValues, setValue, register, trigger, watch } = form;\n\n  const erc20AddressValue = watch(Fields.erc20Address);\n\n  const applicantAddressValue = watch(Fields.applicantAddress);\n\n  const createTributeError = submitError || proposalSignAndSendError;\n\n  const isConnected = connected && account;\n\n  const isInProcess =\n    proposalSignAndSendStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    proposalSignAndSendStatus === Web3TxStatus.PENDING;\n\n  const isDone = proposalSignAndSendStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone = isInProcess || isDone;\n\n  const {\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n  } = useCheckApplicant(applicantAddressValue);\n\n  var amountSelected = 1;\n  /**\n   * Cached callbacks\n   */\n\n  const getERC20ContractCached = useCallback(getERC20Contract, [\n    erc20AddressValue,\n    web3Instance,\n  ]);\n\n  const getERC20DetailsCached = useCallback(getERC20Details, [\n    account,\n    erc20Contract,\n  ]);\n\n  const getUserERC20BalanceCached = useCallback(getUserERC20Balance, [\n    account,\n    erc20Contract,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getERC20ContractCached();\n  }, [getERC20ContractCached]);\n\n  useEffect(() => {\n    getERC20DetailsCached();\n  }, [getERC20DetailsCached]);\n\n  useEffect(() => {\n    getUserERC20BalanceCached();\n  }, [getUserERC20BalanceCached]);\n\n  // Set the value of `applicantAddress` if the `account` changes\n  useEffect(() => {\n    setValue(Fields.applicantAddress, account);\n  }, [account, setValue]);\n\n  /**\n   * Functions\n   */\n\n  async function getERC20Contract() {\n    if (!web3Instance || !erc20AddressValue) {\n      setERC20Contract(undefined);\n      return;\n    }\n\n    try {\n      const { default: lazyERC20ABI } = await import(\n        \"../../abis/external/ERC20.json\"\n      );\n      const erc20Contract: AbiItem[] = lazyERC20ABI as any;\n      const instance = new web3Instance.eth.Contract(\n        erc20Contract,\n        erc20AddressValue\n      );\n      setERC20Contract(instance);\n    } catch (error) {\n      console.error(error);\n      setERC20Contract(undefined);\n    }\n  }\n\n  async function getERC20Details() {\n    if (!account || !erc20Contract) {\n      setERC20Details(undefined);\n      return;\n    }\n\n    try {\n      const symbol = await erc20Contract.methods.symbol().call();\n      const decimals = await erc20Contract.methods.decimals().call();\n      setERC20Details({ symbol, decimals: Number(decimals) });\n    } catch (error) {\n      console.error(error);\n      setERC20Details(undefined);\n    }\n  }\n\n  async function getUserERC20Balance() {\n    if (!account || !erc20Contract) {\n      setUserERC20Balance(undefined);\n      return;\n    }\n\n    try {\n      const balance = await erc20Contract.methods.balanceOf(account).call();\n      const balanceBN = toBN(balance);\n      const decimals = await erc20Contract.methods.decimals().call();\n      const divisor = toBN(10).pow(toBN(decimals));\n      const beforeDecimal = balanceBN.div(divisor);\n      const afterDecimal = balanceBN.mod(divisor);\n      const balanceReadable = afterDecimal.eq(toBN(0))\n        ? beforeDecimal.toString()\n        : `${beforeDecimal.toString()}.${afterDecimal.toString()}`;\n\n      setUserERC20Balance(balanceReadable);\n    } catch (error) {\n      console.error(error);\n      setUserERC20Balance(undefined);\n    }\n  }\n\n  async function getRequestAmountUnit() {\n    if (!ERC20ExtensionContract) {\n      return \"UNITS\";\n    } else {\n      try {\n        return await ERC20ExtensionContract.instance.methods.symbol().call();\n      } catch (error) {\n        console.log(error);\n        return \"UNITS\";\n      }\n    }\n  }\n\n  async function handleSubmit(values: FormInputs) {\n    try {\n      if (!isConnected) {\n        throw new Error(\n          \"No user account was found. Please make sure your wallet is connected.\"\n        );\n      }\n\n      if (!account) {\n        throw new Error(\"No account found.\");\n      }\n\n      if (!erc20Contract) {\n        throw new Error(\"No ERC20Contract found.\");\n      }\n\n      if (!erc20Details) {\n        throw new Error(\"No ERC20 details found.\");\n      }\n\n      if (checkApplicantError) {\n        // Just log the error (don't throw) because it is not a blocker for the\n        // snapshot draft to be submitted. The applicant address validity will\n        // be checked again when the proposal is submitted onchain.\n        console.warn(\n          `Error checking if the applicant address is valid: ${checkApplicantError.message}`\n        );\n      }\n\n      if (\n        checkApplicantStatus === AsyncStatus.FULFILLED &&\n        !isApplicantValid &&\n        checkApplicantInvalidMsg\n      ) {\n        throw new Error(checkApplicantInvalidMsg);\n      }\n\n      const {\n        applicantAddress,\n        erc20Address,\n        tributeAmount,\n        requestAmount,\n        description,\n      } = values;\n      const multiplier = toBN(10).pow(toBN(erc20Details.decimals));\n      const tributeAmountWithDecimals = toBN(\n        stripFormatNumber(tributeAmount)\n      ).mul(multiplier);\n      const requestAmountArg = stripFormatNumber(requestAmount);\n      const applicantAddressToChecksum = toChecksumAddress(applicantAddress);\n      const proposerAddressToChecksum = toChecksumAddress(account);\n\n      // Maybe set proposal ID from previous attempt\n      let proposalId: string = proposalData?.uniqueId || \"\";\n\n      // Only submit to snapshot if there is not already a proposal ID returned from a previous attempt.\n      if (!proposalId) {\n        const bodyIntro =\n          normalizeString(applicantAddress) === normalizeString(account)\n            ? `Tribute from ${truncateEthAddress(\n                applicantAddressToChecksum,\n                7\n              )}.`\n            : `Tribute from ${truncateEthAddress(\n                proposerAddressToChecksum,\n                7\n              )} for applicant ${truncateEthAddress(\n                applicantAddressToChecksum,\n                7\n              )}.`;\n        const body = description ? `${bodyIntro}\\n${description}` : bodyIntro;\n\n        // Values needed to display relevant proposal amounts in the proposal\n        // details page are set in the snapshot draft metadata. (We can no\n        // longer rely on getting this data from onchain because the proposal\n        // may not exist there yet.)\n        const proposalAmountValues = {\n          requestAmount,\n          requestAmountUnit: await getRequestAmountUnit(),\n          tributeAmount,\n          tributeAmountUnit: erc20Details.symbol,\n        };\n\n        // Arguments needed to submit the proposal onchain are set in the\n        // snapshot draft metadata.\n        const submitActionArgs: SubmitActionArguments = [\n          applicantAddressToChecksum,\n          UNITS_ADDRESS,\n          requestAmountArg,\n          toChecksumAddress(erc20Address),\n          tributeAmountWithDecimals.toString(),\n          proposerAddressToChecksum,\n        ];\n\n        // Sign and submit draft for snapshot-hub\n        const { uniqueId } = await signAndSendProposal({\n          partialProposalData: {\n            name: applicantAddressToChecksum,\n            body,\n            metadata: {\n              proposalAmountValues,\n              submitActionArgs,\n              accountAuthorizedToProcessPassedProposal: proposerAddressToChecksum,\n            },\n          },\n          adapterName: ContractAdapterNames.tribute,\n          type: SnapshotType.draft,\n        });\n\n        proposalId = uniqueId;\n      }\n\n      // go to TributeDetails page for newly created tribute proposal\n      history.push(`/tributes/${proposalId}`);\n    } catch (error) {\n      // Set any errors from Web3 utils or explicitly set above.\n      const e = error as Error;\n\n      setSubmitError(e);\n    }\n  }\n\n  function renderSubmitStatus(): React.ReactNode {\n    switch (proposalSignAndSendStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return (\n          <>\n            Awaiting your confirmation\n            <CycleEllipsis intervalMs={500} />\n          </>\n        );\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            Submitting\n            <CycleEllipsis intervalMs={500} />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return \"Done!\";\n      default:\n        return \"\";\n    }\n  }\n\n  function renderUserERC20Balance() {\n    if (!userERC20Balance) {\n      return \"---\";\n    }\n\n    return formatNumber(userERC20Balance);\n  }\n\n  function getUnauthorizedMessage() {\n    // user is not connected\n    if (!isConnected) {\n      return \"Connect your wallet to submit a tribute proposal.\";\n    }\n\n    // user is on wrong network\n    if (defaultChainError) {\n      return defaultChainError.message;\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  // Render unauthorized message\n  if (!isConnected || defaultChainError) {\n    return (\n      <RenderWrapper>\n        <div className=\"form__description--unauthorized\">\n          <p>{getUnauthorizedMessage()}</p>\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      <form className=\"form\" onSubmit={(e) => e.preventDefault()}>\n        {/* APPLICANT ADDRESS */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\">Applicant Address</label>\n          <div className=\"form__input-row-fieldwrap\">\n            {/* @note We don't need the default value as it's handled in the useEffect above. */}\n            <input\n              aria-describedby={`error-${Fields.applicantAddress}`}\n              aria-invalid={errors.applicantAddress ? \"true\" : \"false\"}\n              name={Fields.applicantAddress}\n              ref={register({\n                validate: (applicantAddress: string): string | boolean => {\n                  return !applicantAddress\n                    ? FormFieldErrors.REQUIRED\n                    : !isEthAddressValid(applicantAddress)\n                    ? FormFieldErrors.INVALID_ETHEREUM_ADDRESS\n                    : true;\n                },\n              })}\n              type=\"text\"\n              disabled={isInProcessOrDone}\n            />\n\n            <InputError\n              error={getValidationError(Fields.applicantAddress, errors)}\n              id={`error-${Fields.applicantAddress}`}\n            />\n          </div>\n        </div>\n\n        {/* ERC20 ADDRESS */}\n        <div\n          className=\"form__input-row\"\n          style={{ visibility: \"hidden\", height: \"0rem\", margin: \"0rem\" }}\n        >\n          <label className=\"form__input-row-label\">ERC20 Address</label>\n          <div className=\"form__input-row-fieldwrap\">\n            <input\n              aria-describedby={`error-${Fields.erc20Address}`}\n              aria-invalid={errors.erc20Address ? \"true\" : \"false\"}\n              name={Fields.erc20Address}\n              ref={register({\n                validate: (erc20Address: string): string | boolean => {\n                  return !erc20Address\n                    ? FormFieldErrors.REQUIRED\n                    : !isEthAddressValid(erc20Address)\n                    ? FormFieldErrors.INVALID_ETHEREUM_ADDRESS\n                    : true;\n                },\n              })}\n              type=\"text\"\n              disabled={isInProcessOrDone}\n              defaultValue=\"0x4DBCdF9B62e891a7cec5A2568C3F4FAF9E8Abe2b\"\n            />\n\n            <InputError\n              error={getValidationError(Fields.erc20Address, errors)}\n              id={`error-${Fields.erc20Address}`}\n            />\n          </div>\n        </div>\n\n        <div className=\"form__input-row formbuilder-radio-group form-group form__input-row field-type_of_entity\">\n          <label className=\"formbuilder-radio-group-label form__input-row-label\">\n            Amount\n          </label>\n          <div style={{ width: \"100%\" }} className=\"bootstrap-wrapper\">\n            <div\n              className=\"row\"\n              style={{ display: \"flex\", alignItems: \"center\" }}\n            >\n              <div className=\"col-md-8\">\n                <input\n                  type=\"range\"\n                  defaultValue=\"1\"\n                  id=\"points\"\n                  onChange={amountChange}\n                  name=\"points\"\n                  min=\"1\"\n                  max=\"10\"\n                />\n              </div>\n              <div className=\"col-md-4\">\n                <span id=\"aVal\">1%</span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* TRIBUTE AMOUNT */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\"></label>\n          <div className=\"form__input-row-fieldwrap--narrow\">\n            <div className=\"input__suffix-wrap\">\n              <input\n                id=\"salonAmount\"\n                readOnly\n                defaultValue=\"1\"\n                className=\"input__suffix\"\n                aria-describedby={`error-${Fields.tributeAmount}`}\n                aria-invalid={errors.tributeAmount ? \"true\" : \"false\"}\n                name={Fields.tributeAmount}\n                onChange={debounce(\n                  () =>\n                    setValue(\n                      Fields.tributeAmount,\n                      formatNumber(stripFormatNumber(getValues().tributeAmount))\n                    ),\n                  1000\n                )}\n                ref={register({\n                  validate: (tributeAmount: string): string | boolean => {\n                    const amount = Number(stripFormatNumber(tributeAmount));\n\n                    return tributeAmount === \"\"\n                      ? FormFieldErrors.REQUIRED\n                      : isNaN(amount)\n                      ? FormFieldErrors.INVALID_NUMBER\n                      : amount <= 0\n                      ? \"The value must be greater than 0.\"\n                      : amount > Number(userERC20Balance)\n                      ? \"Insufficient funds.\"\n                      : !Number.isInteger(amount)\n                      ? \"The value must be an integer for an ERC20 token.\"\n                      : true;\n                  },\n                })}\n                type=\"text\"\n                disabled={true}\n                style={{ backgroundColor: \"#f7fafd\" }}\n              />\n\n              <div\n                style={{ width: \"5rem\", backgroundColor: \"#f7fafd\" }}\n                className=\"input__suffix-item\"\n              >\n                {erc20Details?.symbol || \"___\"}\n              </div>\n            </div>\n\n            <InputError\n              error={getValidationError(Fields.tributeAmount, errors)}\n              id={`error-${Fields.tributeAmount}`}\n            />\n\n            <div className=\"form__input-description\">\n              This amount will be held in escrow pending a member vote. If the\n              proposal passes, the funds will automatically be sent to the DAO.\n              If the proposal fails, the funds will be refunded to you.\n            </div>\n          </div>\n\n          <div className=\"form__input-addon\">\n            available: <span>{renderUserERC20Balance()}</span>\n          </div>\n        </div>\n\n        {/* REQUEST AMOUNT */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\"></label>\n          <div className=\"form__input-row-fieldwrap--narrow\">\n            <input\n              id=\"reqAmount\"\n              aria-describedby={`error-${Fields.requestAmount}`}\n              aria-invalid={errors.requestAmount ? \"true\" : \"false\"}\n              name={Fields.requestAmount}\n              onChange={debounce(\n                () =>\n                  setValue(\n                    Fields.requestAmount,\n                    formatNumber(stripFormatNumber(getValues().requestAmount))\n                  ),\n                1000\n              )}\n              ref={register({\n                validate: (requestAmount: string): string | boolean => {\n                  const amount = Number(stripFormatNumber(requestAmount));\n\n                  return requestAmount === \"\"\n                    ? FormFieldErrors.REQUIRED\n                    : isNaN(amount)\n                    ? FormFieldErrors.INVALID_NUMBER\n                    : amount < 0\n                    ? \"The value must be at least 0.\"\n                    : !Number.isInteger(amount)\n                    ? \"The value must be an integer.\"\n                    : true;\n                },\n              })}\n              type=\"text\"\n              readOnly\n              disabled={true}\n              defaultValue=\"3\"\n              style={{ backgroundColor: \"#f7fafd\" }}\n            />\n\n            <InputError\n              error={getValidationError(Fields.requestAmount, errors)}\n              id={`error-${Fields.requestAmount}`}\n            />\n\n            <div className=\"form__input-description\">\n              This is the amount of DAO membership tokens you are requesting be\n              sent to the Applicant Address in exchange for your tribute.\n            </div>\n          </div>\n        </div>\n\n        {/* DESCRIPTION */}\n        <div\n          style={{ marginBottom: \"0\", display: \"none\" }}\n          className=\"form__textarea-row\"\n        >\n          <label className=\"form__input-row-label\">Description</label>\n          <div className=\"form__input-row-fieldwrap\">\n            <textarea\n              name={Fields.description}\n              placeholder=\"Say something about your tribute...\"\n              ref={register}\n              disabled={isInProcessOrDone}\n            />\n          </div>\n        </div>\n\n        {/* SUBMIT */}\n        <button\n          style={{\n            visibility: \"hidden\",\n            height: \"0\",\n            margin: \"0\",\n            padding: \"0\",\n          }}\n          id=\"submitBtn\"\n          className=\"button\"\n          disabled={isInProcessOrDone}\n          onClick={async () => {\n            if (isInProcessOrDone) return;\n\n            if (!(await trigger())) {\n              return;\n            }\n\n            handleSubmit(getValues());\n          }}\n          type=\"submit\"\n        >\n          {isInProcess ? <Loader /> : isDone ? \"Done\" : \"Submit\"}\n        </button>\n\n        {/* SUBMIT STATUS */}\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {/* SUBMIT ERROR */}\n        {createTributeError && (\n          <div className=\"form__submit-error-container\">\n            <ErrorMessageWithDetails\n              renderText=\"Something went wrong while submitting the proposal.\"\n              error={createTributeError}\n            />\n          </div>\n        )}\n      </form>\n\n      <form\n        id=\"kycSubmit\"\n        style={{ width: \"100%\", margin: \"0\" }}\n        action=\"https://getform.io/f/9ddb7b44-927e-475f-bf03-6e92cd6c71a8\"\n        method=\"POST\"\n        className=\"form\"\n        onSubmit={kycSubmit}\n      >\n        <div className=\"rendered-form\">\n          <div\n            style={{ marginTop: \"1rem\" }}\n            className=\"form__input-row formbuilder-radio-group form-group form__input-row field-type_of_entity\"\n          >\n            <label\n              htmlFor=\"type_of_entity\"\n              className=\"formbuilder-radio-group-label form__input-row-label\"\n            >\n              Type of Entity\n            </label>\n            <div className=\"radio-group\">\n              <div className=\"formbuilder-radio\">\n                <input\n                  name=\"type_of_entity\"\n                  id=\"type_of_entity-0\"\n                  aria-required=\"true\"\n                  value=\"person\"\n                  type=\"radio\"\n                  required\n                />\n                <label htmlFor=\"type_of_entity-0\">Person</label>\n              </div>\n              <div className=\"formbuilder-radio\">\n                <input\n                  name=\"type_of_entity\"\n                  id=\"type_of_entity-1\"\n                  aria-required=\"true\"\n                  value=\"company\"\n                  type=\"radio\"\n                  required\n                />\n                <label htmlFor=\"type_of_entity-1\">Company</label>\n              </div>\n              <div className=\"formbuilder-radio\">\n                <input\n                  name=\"type_of_entity\"\n                  id=\"type_of_entity-2\"\n                  aria-required=\"true\"\n                  value=\"trust\"\n                  type=\"radio\"\n                  required\n                />\n                <label htmlFor=\"type_of_entity-2\">Trust</label>\n              </div>\n            </div>\n          </div>\n          <div className=\"form__input-row formbuilder-text form-group form__input-row field-legal_name_of_person\">\n            <label\n              htmlFor=\"legal_name_of_person\"\n              className=\"formbuilder-text-label form__input-row-label\"\n            >\n              Legal Name of Person\n            </label>\n            <input\n              type=\"text\"\n              name=\"legal_name_of_person\"\n              id=\"legal_name_of_person\"\n              aria-required=\"true\"\n              required\n            />\n          </div>\n          <div className=\"formbuilder-text form-group form__input-row field-email_address\">\n            <label\n              htmlFor=\"email_address\"\n              className=\"formbuilder-text-label form__input-row-label\"\n            >\n              Email Address\n            </label>\n            <input\n              type=\"text\"\n              name=\"email_address\"\n              id=\"email_address\"\n              aria-required=\"true\"\n              required\n            />\n          </div>\n          <div className=\"formbuilder-text form-group form__input-row field-text-1650421756581\">\n            <label\n              htmlFor=\"text-1650421756581\"\n              className=\"formbuilder-text-label form__input-row-label\"\n            >\n              Home Address\n            </label>\n            <input\n              type=\"text\"\n              className=\"form-control\"\n              name=\"text-1650421756581\"\n              id=\"text-1650421756581\"\n              aria-required=\"true\"\n              required\n            />\n          </div>\n\n          <div className=\"formbuilder-select form-group form__input-row field-select-1650421785515\">\n            <label\n              htmlFor=\"text-1650421756581\"\n              className=\"formbuilder-text-label form__input-row-label\"\n            >\n              Date of Birth\n            </label>\n\n            <div style={{ width: \"100%\" }} className=\"bootstrap-wrapper\">\n              <div className=\"row\">\n                <div className=\"col-md-4\">\n                  <select\n                    className=\"form-control\"\n                    name=\"DOB_month\"\n                    id=\"select-1650421785515\"\n                    aria-required=\"true\"\n                    required\n                  >\n                    <option value=\"01\" id=\"select-1650421785515-0\">\n                      01\n                    </option>\n                    <option value=\"02\" id=\"select-1650421785515-1\">\n                      02\n                    </option>\n                    <option value=\"03\" id=\"select-1650421785515-2\">\n                      03\n                    </option>\n                  </select>\n                </div>\n                <div\n                  className=\"hidden-md-up col-12\"\n                  style={{ height: \"1rem\" }}\n                ></div>\n                <div className=\"col-md-4\">\n                  <select\n                    name=\"DOB_day\"\n                    id=\"day\"\n                    required\n                    aria-required=\"true\"\n                    required\n                  >\n                    <option value=\"01\" id=\"day-0\">\n                      01\n                    </option>\n                    <option value=\"02\" id=\"day-1\">\n                      02\n                    </option>\n                    <option value=\"03\" id=\"day-2\">\n                      03\n                    </option>\n                  </select>\n                </div>\n                <div\n                  className=\"hidden-md-up col-12\"\n                  style={{ height: \"1rem\" }}\n                ></div>\n                <div className=\"col-md-4\">\n                  <select\n                    name=\"DOB_year\"\n                    id=\"year\"\n                    aria-required=\"true\"\n                    required\n                  >\n                    <option value=\"2000\" id=\"year-0\">\n                      2000\n                    </option>\n                    <option value=\"2001\" id=\"year-1\">\n                      2001\n                    </option>\n                    <option value=\"2003\" id=\"year-2\">\n                      2003\n                    </option>\n                  </select>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div\n            className=\"formbuilder-file form-group form__input-row field-id_scan\"\n            style={{ display: \"block\" }}\n          >\n            <p>\n              <label htmlFor=\"id_scan\" className=\"formbuilder-file-label\">\n                ID Scan\n              </label>\n            </p>\n            <p>\n              A passport is highly recommended but other forms of\n              governmentissued color photo ID (such as a national identity card\n              or drivers license) are also acceptable.\n            </p>\n            <p>\n              <input\n                type=\"file\"\n                name=\"id_scan\"\n                id=\"id_scan\"\n                aria-required=\"true\"\n              />\n            </p>\n          </div>\n          <div\n            className=\"formbuilder-file form-group form__input-row field-back_of_id_scan\"\n            style={{ display: \"block\" }}\n          >\n            <p>\n              <label\n                htmlFor=\"back_of_id_scan\"\n                className=\"formbuilder-file-label form__input-row-label\"\n              >\n                Back of ID Scan (Optional)\n              </label>\n            </p>\n            <p>Not required if you uploaded a passport above.</p>\n            <p>\n              <input type=\"file\" name=\"back_of_id_scan\" id=\"back_of_id_scan\" />\n            </p>\n          </div>\n          <div className=\"formbuilder-text form-group form__input-row field-passport_or_id_number\">\n            <label\n              htmlFor=\"passport_or_id_number\"\n              className=\"formbuilder-text-label form__input-row-label\"\n            >\n              Passport or ID Number\n            </label>\n            <input\n              type=\"text\"\n              name=\"passport_or_id_number\"\n              id=\"passport_or_id_number\"\n              aria-required=\"true\"\n              required\n            />\n          </div>\n          <div className=\"formbuilder-text form-group form__input-row field-Phone-Number\">\n            <label\n              htmlFor=\"Phone-Number\"\n              className=\"formbuilder-text-label form__input-row-label\"\n            >\n              Phone Number\n            </label>\n            <input\n              type=\"text\"\n              name=\"Phone-Number\"\n              id=\"Phone-Number\"\n              aria-required=\"true\"\n              required\n            />\n          </div>\n          <div className=\"formbuilder-text form-group form__input-row field-occupation\">\n            <label\n              htmlFor=\"occupation\"\n              className=\"formbuilder-text-label form__input-row-label\"\n            >\n              Occupation\n            </label>\n            <input\n              type=\"text\"\n              className=\"form-control\"\n              name=\"occupation\"\n              id=\"occupation\"\n              aria-required=\"true\"\n              required\n            />\n          </div>\n          <h3>How are you accredited?</h3>\n\n          <div className=\"formbuilder-radio-group form-group form__input-row field-basis_of_accreditation\">\n            <label\n              htmlFor=\"basis_of_accreditation\"\n              className=\"formbuilder-radio-group-label form__input-row-label\"\n            >\n              Basis of Accreditation\n            </label>\n            <div className=\"radio-group\">\n              <div className=\"formbuilder-radio\">\n                <input\n                  name=\"basis_of_accreditation\"\n                  id=\"basis_of_accreditation-0\"\n                  aria-required=\"true\"\n                  value=\"income\"\n                  type=\"radio\"\n                  required\n                />\n                <label htmlFor=\"basis_of_accreditation-0\">\n                  Income of $200k ($300K with spouse) in each of the last 2\n                  years\n                </label>\n              </div>\n              <div className=\"formbuilder-radio\">\n                <input\n                  name=\"basis_of_accreditation\"\n                  id=\"basis_of_accreditation-1\"\n                  aria-required=\"true\"\n                  value=\"net-worth\"\n                  type=\"radio\"\n                  required\n                />\n                <label htmlFor=\"basis_of_accreditation-1\">\n                  Net worth over $1M\n                </label>\n              </div>\n            </div>\n          </div>\n\n          <h3>Your income in the most recent tax year</h3>\n          <div className=\"formbuilder-text form-group form__input-row field-income_recent\">\n            <label\n              htmlFor=\"income_recent\"\n              className=\"formbuilder-text-label form__input-row-label\"\n            >\n              Income\n            </label>\n            <input\n              type=\"text\"\n              name=\"income_recent\"\n              id=\"income_recent\"\n              aria-required=\"true\"\n              required\n            />\n          </div>\n          <div\n            className=\"formbuilder-file form-group form__input-row field-income_recent_documentation\"\n            style={{ display: \"block\" }}\n          >\n            <p>\n              <label\n                htmlFor=\"income_recent_documentation\"\n                className=\"formbuilder-file-label form__input-row-label\"\n              >\n                Documentation\n              </label>\n            </p>\n            <p>\n              Government tax filings, pay stubs, or a letter from your attorney,\n              accountant, or investment advisor written in the last 90 days\n              (upload pdf, docx).\n            </p>\n            <p>\n              <input\n                type=\"file\"\n                name=\"income_recent_documentation\"\n                id=\"income_recent_documentation\"\n                aria-required=\"true\"\n              />\n            </p>\n          </div>\n\n          <h3>Your income in the previous tax year</h3>\n\n          <div className=\"formbuilder-text form-group form__input-row field-income_last\">\n            <label\n              htmlFor=\"income_last\"\n              className=\"formbuilder-text-label form__input-row-label\"\n            >\n              Income\n            </label>\n            <input\n              type=\"text\"\n              name=\"income_last\"\n              id=\"income_last\"\n              aria-required=\"true\"\n              required\n            />\n          </div>\n          <div\n            className=\"formbuilder-file form-group form__input-row field-income_last_documentation\"\n            style={{ display: \"block\" }}\n          >\n            <p>\n              <label\n                htmlFor=\"income_last_documentation\"\n                className=\"formbuilder-file-label form__input-row-label\"\n              >\n                Documenation\n              </label>\n            </p>\n            <p>\n              Government tax filings, pay stubs, or a letter from your attorney,\n              accountant, or investment advisor written in the last 90 days\n              (upload pdf, docx).\n            </p>\n            <p>\n              <input\n                type=\"file\"\n                name=\"income_last_documentation\"\n                id=\"income_last_documentation\"\n                aria-required=\"true\"\n              />\n            </p>\n          </div>\n          <div className=\"formbuilder-checkbox-group form-group form__input-row field-current_year_income\">\n            <label\n              htmlFor=\"current_year_income\"\n              className=\"formbuilder-checkbox-group-label form__input-row-label\"\n            >\n              Current Year Income\n            </label>\n            <div className=\"checkbox-group\">\n              <div className=\"formbuilder-checkbox\">\n                <input\n                  name=\"current_year_income[]\"\n                  id=\"current_year_income-0\"\n                  aria-required=\"true\"\n                  value=\"true\"\n                  type=\"checkbox\"\n                  required\n                />\n                <label htmlFor=\"current_year_income-0\">\n                  I expect to earn an income of at least $200k ($300k with\n                  spouse) again this year.{\" \"}\n                </label>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <input type=\"hidden\" name=\"_captcha\" value=\"false\" />\n        <button id=\"kycSubmitBtn\" className=\"button\" type=\"submit\">\n          {isInProcess ? <Loader /> : isDone ? \"Done\" : \"Submit\"}\n        </button>\n      </form>\n    </RenderWrapper>\n  );\n}\n\nfunction amountChange(e: any) {\n  document.getElementById(\"aVal\").innerHTML = e.target.value + \" %\";\n  document.getElementById(\"salonAmount\").value = e.target.value;\n  document.getElementById(\"reqAmount\").value = e.target.value * 3;\n  document.getElementById(\"salonAmount\").click();\n  debounce(\n    () =>\n      setValue(\n        Fields.tributeAmount,\n        formatNumber(stripFormatNumber(getValues().tributeAmount))\n      ),\n    1000\n  );\n}\n\nasync function kycSubmit(e: any) {\n  e.preventDefault();\n  var formEl = document.forms.kycSubmit;\n  var formData = new FormData(formEl);\n  var res = await fetch(\"https://salontest-terrifickid.cloud.okteto.net\", {\n    method: \"POST\",\n    body: formData,\n  });\n  console.log(res);\n  document.getElementById(\"submitBtn\").click();\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Become a Member</h2>\n        </div>\n\n        <div className=\"form-wrapper\">\n          <div className=\"form__description\">\n            <p>For U.S. accredited investors</p>\n            <p>\n              Salon is a for-profit member-managed limited liability company\n              organized in Delaware.{\" \"}\n            </p>\n            <p>\n              Salon will have up to 100 initial members who will pool their\n              capital to build a world class collection of contemporary art.\n              Each member can purchase 1% blocks of Salon units for $30,000 (up\n              to 10% for $300,000).\n            </p>\n            <p>Interested? Get accredited below.</p>\n          </div>\n\n          {/* RENDER CHILDREN */}\n          {props.children}\n        </div>\n      </FadeIn>\n    </Wrap>\n  );\n}\n","interface LogoProps {\n  size?: 'small' | 'medium' | 'large' | '';\n}\n\nexport default function Logo(props: LogoProps) {\n  return (\n    <div className={`logo ${props.size ? `logo--${props.size}` : ''}`}>\n      Salon\n    </div>\n  );\n}\n","import React from 'react';\n\nimport Logo from './Logo';\n\n/**\n * ModalLogo\n * This component is used for modal menu\n */\nexport function ModalLogo() {\n  return (\n    <div className=\"logo-container logo-container--center\">\n      <Logo size=\"small\" />\n    </div>\n  );\n}\n\n/**\n * LeftLogo\n * This component is used for main pages\n */\nexport function LeftLogo() {\n  return (\n    <div className=\"logo-container logo-container--header\">\n      <Logo size=\"medium\" />\n    </div>\n  );\n}\n\n/**\n * CenterLogo\n * This component is used for splash page\n */\nexport function CenterLogo() {\n  return (\n    <div className=\"logo-container logo-container--center\">\n      <Logo size=\"large\" />\n    </div>\n  );\n}\n","export default function HamburgerSVG() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      aria-hidden=\"true\"\n      data-icon=\"bars\"\n      data-prefix=\"fal\"\n      viewBox=\"0 0 448 512\">\n      <path\n        fill=\"currentColor\"\n        d=\"M442 114H6a6 6 0 01-6-6V84a6 6 0 016-6h436a6 6 0 016 6v24a6 6 0 01-6 6zm0 160H6a6 6 0 01-6-6v-24a6 6 0 016-6h436a6 6 0 016 6v24a6 6 0 01-6 6zm0 160H6a6 6 0 01-6-6v-24a6 6 0 016-6h436a6 6 0 016 6v24a6 6 0 01-6 6z\"></path>\n    </svg>\n  );\n}\n","import {isMobile} from '@walletconnect/browser-utils';\nimport {useDispatch} from 'react-redux';\nimport {toChecksumAddress} from 'web3-utils';\n\nimport {connectModalOpen} from '../../store/actions';\nimport {truncateEthAddress} from '../../util/helpers';\nimport {useIsDefaultChain} from './hooks';\nimport {useWeb3Modal} from './hooks';\nimport {WalletIcon} from './';\n\ntype CustomWalletTextProps = {\n  account: ReturnType<typeof useWeb3Modal>['account'];\n  connected: ReturnType<typeof useWeb3Modal>['connected'];\n  isMobile: ReturnType<typeof isMobile>;\n};\n\ntype ConnectWalletButtonProps = {\n  customWalletText?: ((o: CustomWalletTextProps) => string) | string;\n  showWalletETHBadge?: boolean;\n};\n\nexport default function ConnectWalletButton({\n  customWalletText,\n  // Defaults to `true`\n  showWalletETHBadge = true,\n}: ConnectWalletButtonProps): JSX.Element {\n  /**\n   * Our hooks\n   */\n\n  const {account, accountENS, connected, web3Modal} = useWeb3Modal();\n  const {isDefaultChain} = useIsDefaultChain();\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch();\n\n  /**\n   * Variables\n   */\n\n  const isWrongNetwork: boolean = isDefaultChain === false;\n\n  /**\n   * Functions\n   */\n\n  function getWalletText(): string {\n    if (customWalletText) {\n      return typeof customWalletText === 'function'\n        ? customWalletText({account, connected, isMobile: isMobile()})\n        : customWalletText;\n    }\n\n    if (account) {\n      return accountENS || truncateEthAddress(toChecksumAddress(account));\n    }\n\n    return 'Connect';\n  }\n\n  /**\n   * Return\n   */\n\n  return (\n    <button\n      className={`walletconnect__connect-button \n        ${\n          isWrongNetwork && connected\n            ? 'walletconnect__connect-button--error'\n            : ''\n        }`}\n      onClick={() => {\n        dispatch(connectModalOpen());\n      }}>\n      <span\n        className={`connect-button-text ${\n          connected ? 'connect-button-text--ethAddress' : ''\n        }`}>\n        {getWalletText()}\n      </span>\n\n      {isWrongNetwork && connected && <span>Wrong Network</span>}\n\n      {showWalletETHBadge && (\n        <WalletIcon providerName={web3Modal?.cachedProvider} />\n      )}\n    </button>\n  );\n}\n","import {NavLink} from 'react-router-dom';\nimport {Transition} from 'react-transition-group';\nimport {useSelector} from 'react-redux';\nimport {useState, useEffect, useRef} from 'react';\nimport Media from 'react-media';\nimport ReactModal from 'react-modal';\n\nimport {ENABLE_KYC_ONBOARDING} from '../config';\nimport {ModalLogo} from './logo';\nimport {normalizeString} from '../util/helpers';\nimport {StoreState} from '../store/types';\nimport {useWeb3Modal} from './web3/hooks';\nimport DaoTokenHolder from './dao-token/DaoTokenHolder';\nimport HamburgerSVG from '../assets/svg/HamburgerSVG';\nimport TimesSVG from '../assets/svg/TimesSVG';\nimport Web3ModalButton from './web3/Web3ModalButton';\n\n// see: http://reactcommunity.org/react-transition-group/transition\nconst duration = 200;\n\nconst defaultStyle = {\n  transition: '0.1s',\n};\n\nconst transitionOpeningStyles: Record<string, any> = {\n  entering: {right: '-300px'},\n  entered: {right: 0},\n  exiting: {right: 0, opacity: 0},\n  exited: {right: '-300px', opacity: 0},\n};\n\nconst transitionClosingStyles: Record<string, any> = {\n  entering: {right: 0, opacity: 1},\n  entered: {right: '-300px', opacity: 1},\n  exiting: {right: '-300px', opacity: 1},\n  exited: {right: 0, opacity: 1},\n};\n\nexport function NavLinks() {\n  return (\n    <nav role=\"navigation\" id=\"navigation\">\n      <ul className=\"nav__list\" data-testid=\"nav__list\">\n        <li tabIndex={0}>\n          <NavLink to=\"/governance\">\n            <span>Governance</span>\n          </NavLink>\n        </li>\n        <li tabIndex={0}>\n          <NavLink to=\"/members\">\n            <span>Members</span>\n          </NavLink>\n        </li>\n      </ul>\n    </nav>\n  );\n}\n\nexport function NavHamburger() {\n  /**\n   * Selectors\n   */\n\n  const connectedMember = useSelector((s: StoreState) => s.connectedMember);\n\n  /**\n   * State\n   */\n\n  const [shouldShowMenuModal, setShouldShowMenuModal] = useState(false);\n  const [transitionStyles, setTransitionStyles] = useState<Record<string, any>>(\n    transitionOpeningStyles\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account} = useWeb3Modal();\n\n  /**\n   * Refs\n   */\n\n  const closeMenuRef = useRef<NodeJS.Timeout>();\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    // Clean up on unmount\n    return () => {\n      closeMenuRef.current && clearTimeout(closeMenuRef.current);\n    };\n  }, []);\n\n  /**\n   * Variables\n   */\n\n  // const isActiveMemberConnected: boolean =\n  //   account && connectedMember?.isActiveMember ? true : false;\n\n  const isCurrentMemberOrDelegateConnected: boolean =\n    account &&\n    connectedMember &&\n    (connectedMember.isActiveMember || connectedMember.isAddressDelegated) &&\n    (normalizeString(account) ===\n      normalizeString(connectedMember.memberAddress) ||\n      normalizeString(account) === normalizeString(connectedMember.delegateKey))\n      ? true\n      : false;\n\n  /**\n   * Functions\n   */\n\n  function handleMenuModalClose(close: boolean) {\n    // delay transition for closing\n    if (close) {\n      setShouldShowMenuModal(close);\n      setTransitionStyles(transitionOpeningStyles);\n    } else {\n      setTransitionStyles(transitionClosingStyles);\n      closeMenuRef.current = setTimeout(\n        () => setShouldShowMenuModal(close),\n        500\n      );\n      return () => closeMenuRef.current && clearTimeout(closeMenuRef.current);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      <div tabIndex={0} className=\"nav__hamburger-wrapper\">\n        <div\n          className=\"nav__hamburger\"\n          aria-label=\"Menu\"\n          aria-controls=\"navigation\"\n          onClick={(event) => {\n            event.preventDefault();\n            handleMenuModalClose(true);\n          }}>\n          <HamburgerSVG />\n        </div>\n      </div>\n\n      {/** MODAL MENU */}\n      <ReactModal\n        ariaHideApp={false}\n        className=\"nav-modal-container\"\n        isOpen={shouldShowMenuModal}\n        onRequestClose={() => {\n          handleMenuModalClose(false);\n        }}\n        overlayClassName=\"nav-modal-overlay\"\n        role=\"dialog\"\n        style={{overlay: {zIndex: '99'}} as any}>\n        <Transition appear in={shouldShowMenuModal} timeout={duration}>\n          {(transition) => (\n            <nav role=\"navigation\" id=\"navigation\">\n              <div\n                style={{\n                  ...defaultStyle,\n                  ...transitionStyles[transition],\n                }}\n                className=\"nav-modal\">\n                <button\n                  className=\"modal__close-button modal__close-button--icon\"\n                  onClick={(event) => {\n                    event.preventDefault();\n                    handleMenuModalClose(false);\n                  }}>\n                  <TimesSVG />\n                </button>\n\n                <ModalLogo />\n\n                <div className=\"nav-modal__walletconnect-button-container\">\n                  <Web3ModalButton />\n                </div>\n                <ul className=\"nav__list\">\n                  {!isCurrentMemberOrDelegateConnected && (\n                    <li\n                      onClick={() => {\n                        handleMenuModalClose(false);\n                      }}>\n                      <NavLink to=\"/tribute\">\n                        <span>Join</span>\n                      </NavLink>\n                    </li>\n                  )}\n                  <li\n                    onClick={() => {\n                      handleMenuModalClose(false);\n                    }}>\n                    <NavLink to=\"/tributes\">\n                      <span>Applications</span>\n                    </NavLink>\n                  </li>\n                  {isCurrentMemberOrDelegateConnected && (\n                    <li\n                      onClick={() => {\n                        handleMenuModalClose(false);\n                      }}>\n                      <NavLink to=\"/transfers\">\n                        <span>Transfer</span>\n                      </NavLink>\n                    </li>\n                  )}\n                  {isCurrentMemberOrDelegateConnected && (\n                    <li\n                      onClick={() => {\n                        handleMenuModalClose(false);\n                      }}>\n                      <NavLink to=\"/governance\">\n                        <span>Governance</span>\n                      </NavLink>\n                    </li>\n                  )}\n                  {isCurrentMemberOrDelegateConnected && (\n                    <li\n                      onClick={() => {\n                        handleMenuModalClose(false);\n                      }}>\n                      <NavLink to=\"/members\">\n                        <span>Members</span>\n                      </NavLink>\n                    </li>\n                  )}\n                  {/* The Profile link for the member account is available to both the connected member address and its delegate address. */}\n                  {isCurrentMemberOrDelegateConnected && (\n                    <li\n                      onClick={() => {\n                        handleMenuModalClose(false);\n                      }}>\n                      <NavLink\n                        to={`/members/${connectedMember?.memberAddress}`}>\n                        <span>Profile</span>\n                      </NavLink>\n                    </li>\n                  )}\n                  {/* @note Disabling DAO Manager for now because we paused on maintaining it. */}\n                  {/* {isActiveMemberConnected && (\n                    <li\n                      onClick={() => {\n                        handleMenuModalClose(false);\n                      }}>\n                      <NavLink to=\"/dao-manager\">\n                        <span>Manage DAO</span>\n                      </NavLink>\n                    </li>\n                  )} */}\n                </ul>\n              </div>\n            </nav>\n          )}\n        </Transition>\n      </ReactModal>\n    </>\n  );\n}\n\nexport default function Nav() {\n  /**\n   * Render\n   */\n\n  return (\n    <Media query=\"(max-width: 62em)\">\n      {(_matches: boolean) => (\n        <div className=\"nav-header\">\n          <div className=\"nav-header__menu-container\">\n            {/* NAV */}\n\n            <NavHamburger />\n            <div className=\"nav-header__walletconnect-button-container\">\n              <Web3ModalButton />\n            </div>\n          </div>\n        </div>\n      )}\n    </Media>\n  );\n}\n","import React from 'react';\n\nexport default function DiscordSVG(props: React.SVGAttributes<SVGElement>) {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 12 14\" {...props}>\n      <g fillRule=\"evenodd\" stroke=\"none\" strokeWidth=\"1\">\n        <g transform=\"translate(-737 -124)\">\n          <g transform=\"translate(596 124)\">\n            <path\n              fill=\"currentColor\"\n              d=\"M151.166.8h-8.679c-.733 0-1.344.611-1.344 1.345v8.8c0 .734.611 1.345 1.344 1.345h7.395l-.366-1.223.855.795.795.733 1.405 1.223V2.145c-.06-.734-.61-1.345-1.405-1.345zm-2.506 8.495s-.244-.306-.428-.55c.49-.122.917-.367 1.161-.795a2.065 2.065 0 01-.733.367c-.306.122-.611.245-.917.306a4.039 4.039 0 01-1.71 0 6.007 6.007 0 01-.979-.306 1.83 1.83 0 01-.489-.244s-.06 0-.06-.061c-.123-.062-.184-.123-.184-.123.305.367.672.673 1.161.795-.183.244-.428.55-.428.55a2.579 2.579 0 01-2.017-.978c0-1.344.367-2.628.917-3.79.55-.427 1.161-.671 1.834-.671l.06.06c-.61.184-1.222.429-1.71.856l.366-.183c.49-.183.978-.367 1.467-.428h.122a4.947 4.947 0 011.345 0c.672.061 1.344.306 1.955.611a5.299 5.299 0 00-1.65-.855l.061-.122c.673.06 1.284.244 1.834.672.611 1.161.917 2.506.917 3.789-.367.733-1.1 1.1-1.895 1.1zm-2.995-3.056c-.427-.06-.733.245-.794.673-.061.427.244.733.672.794.428.061.734-.244.795-.672v-.061c0-.367-.306-.734-.673-.734zm2.384 0c-.428-.06-.733.245-.795.673-.06.427.245.733.673.794.427.061.733-.244.794-.672v-.061c0-.367-.305-.734-.672-.734z\"></path>\n          </g>\n        </g>\n      </g>\n    </svg>\n  );\n}\n","import DiscordSVG from '../../assets/svg/DiscordSVG';\nimport GitHubSVG from '../../assets/svg/GitHubSVG';\n// import MediumSVG from '../../assets/svg/MediumSVG';\n\n// @todo Add missing URLs when available\nenum SocialMediaLinks {\n  DISCORD = 'https://discord.gg/tEfP68xnTd',\n  /*\n   * query params search sepcifically for:\n   * openlawteam/tribute-ui\n   * openlawteam/tribute-contracts\n   * openlawteam/tribute-contracts-cli\n   * openlawteam/tribute-subgraph\n   */\n  GITHUB = 'https://github.com/search?q=org%3Aopenlawteam+tribute-ui+OR+tribute-contracts+OR+tribute-subgraph+in%3Aname&type=repositories',\n  // MEDIUM = '#',\n}\n\nexport default function SocialMedia() {\n  return (\n    <div className=\"socialmedia\">\n      {/* <a\n        href={SocialMediaLinks.MEDIUM}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\">\n        <MediumSVG />\n      </a> */}\n      <a\n        href={SocialMediaLinks.DISCORD}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\">\n        <DiscordSVG />\n      </a>\n      <a\n        href={SocialMediaLinks.GITHUB}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\">\n        <GitHubSVG />\n      </a>\n    </div>\n  );\n}\n","import React from 'react';\n\nclass GitHubSVG extends React.Component {\n  render() {\n    return (\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        aria-hidden=\"true\"\n        data-icon=\"github\"\n        data-prefix=\"fab\"\n        viewBox=\"0 0 496 512\">\n        <path\n          fill=\"currentColor\"\n          d=\"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z\"\n        />\n      </svg>\n    );\n  }\n}\n\nexport default GitHubSVG;\n","import {memo, useEffect} from 'react';\nimport {useHistory} from 'react-router-dom';\nimport AOS from 'aos';\nimport '../../../node_modules/aos/dist/aos.css';\n\nimport {CenterLogo} from '../../components/logo';\nimport {NavHamburger} from '../../components/Nav';\nimport FadeIn from '../../components/common/FadeIn';\nimport SocialMedia from '../../components/common/SocialMedia';\nimport Wrap from '../../components/common/Wrap';\nimport {ENABLE_KYC_ONBOARDING} from '../../config';\n\nconst TributeCube = memo(() => {\n  return (\n    <div\n      className=\"cube\"\n      data-testid=\"cube\"\n      data-aos=\"fade-up\"\n      data-aos-delay=\"150\">\n      <div className=\"cube__segment--top\"></div>\n      <div className=\"cube__segment--left\"></div>\n      <div className=\"cube__segment--right\"></div>\n    </div>\n  );\n});\n\nfunction GetStartedHeader() {\n  return (\n    <div data-testid=\"get-started-header\" className=\"landing__header\">\n      <SocialMedia />\n      <NavHamburger />\n    </div>\n  );\n}\n\nexport default function GetStarted() {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    AOS.init({\n      duration: 800,\n      offset: 40,\n      delay: 120,\n      mirror: false,\n      once: true,\n    });\n  }, []);\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      <GetStartedHeader />\n      <Wrap className=\"section-wrapper\">\n        <FadeIn>\n          <CenterLogo />\n\n          <div className=\"landing\">\n            <div className=\"landing__subtitle\">\n            The art world's DAO.<br />\nCollecting contemporary art together.\n            </div>\n\n            <div className=\"landing__img\">\n              <TributeCube />\n            </div>\n\n            <div className=\"landing__button\">\n              <button\n                className=\"button\"\n                onClick={() => {\n                  history.push(ENABLE_KYC_ONBOARDING ? '/join' : '/tribute');\n                }}>\n                Join\n              </button>\n            </div>\n          </div>\n        </FadeIn>\n      </Wrap>\n    </>\n  );\n}\n","import {useCallback, useState} from 'react';\n\nimport {\n  OffchainVotingAction,\n  OffchainVotingStatus,\n  OnVotingPeriodChangeProps,\n} from '../proposals/voting';\nimport {ProposalData} from '../proposals/types';\nimport {useOffchainVotingResults} from '../proposals/hooks';\n\ntype GovernanceActionsProps = {\n  proposal: ProposalData;\n};\n\nexport function GovernanceActions(props: GovernanceActionsProps) {\n  const {proposal} = props;\n  const {snapshotProposal} = proposal;\n\n  const votingStartMs: number | undefined =\n    Number(snapshotProposal?.msg.payload.start || 0) * 1000;\n\n  const votingEndMs: number =\n    Number(snapshotProposal?.msg.payload.end || 0) * 1000;\n\n  /**\n   * State\n   */\n\n  const [votingPeriodData, setVotingPeriodData] =\n    useState<OnVotingPeriodChangeProps>({\n      hasVotingStarted: false,\n      hasVotingEnded: false,\n      votingStartEndInitReady: false,\n    });\n\n  /**\n   * Our hooks\n   */\n\n  const {offchainVotingResults} = useOffchainVotingResults(snapshotProposal);\n\n  /**\n   * Cached callbacks\n   */\n\n  const handleOnVotingPeriodChangeCached = useCallback(\n    handleOnVotingPeriodChange,\n    []\n  );\n\n  /**\n   * Variables\n   */\n\n  const votingResult = offchainVotingResults[0]?.[1];\n\n  const {hasVotingEnded, hasVotingStarted, votingStartEndInitReady} =\n    votingPeriodData;\n\n  /**\n   * Functions\n   */\n\n  function handleOnVotingPeriodChange(\n    votingPeriodProps: OnVotingPeriodChangeProps\n  ) {\n    setVotingPeriodData(votingPeriodProps);\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      <OffchainVotingStatus\n        countdownVotingEndMs={votingEndMs}\n        countdownVotingStartMs={votingStartMs}\n        onVotingPeriodChange={handleOnVotingPeriodChangeCached}\n        votingResult={votingResult}\n      />\n\n      {votingStartEndInitReady && hasVotingStarted && !hasVotingEnded && (\n        <OffchainVotingAction proposal={proposal} />\n      )}\n    </>\n  );\n}\n","import React from 'react';\n\nimport Wrap from '../../components/common/Wrap';\nimport FadeIn from '../../components/common/FadeIn';\n\nexport default function NotFound() {\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div style={{textAlign: 'center', fontSize: '5rem'}}>\n          <h3>\n            4\n            <span\n              className=\"pulse\"\n              role=\"img\"\n              aria-label=\"404, not found\"\n              style={{display: 'inline-block'}}>\n              \n            </span>\n            4\n          </h3>\n        </div>\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {ProposalData} from './types';\n\nimport {truncateEthAddress} from '../../util/helpers';\nimport Markdown from 'markdown-to-jsx';\n\ntype ProposalDetailsProps = {\n  proposal: ProposalData;\n  /**\n   * A render prop to render amount(s) badge.\n   */\n  renderAmountBadge?: () => React.ReactNode;\n  /**\n   * A render prop to render any action button flows for a proposal.\n   */\n  renderActions: () => React.ReactNode;\n};\n\nexport default function ProposalDetails(props: ProposalDetailsProps) {\n  const {proposal, renderAmountBadge, renderActions} = props;\n\n  const commonData = proposal.getCommonSnapshotProposalData();\n\n  /**\n   * Render\n   */\n\n  if (!commonData) {\n    return null;\n  }\n\n  return (\n    <>\n      <div className=\"proposaldetails__header\">Proposal Details</div>\n      <div className=\"proposaldetails\">\n        {/* PROPOSAL NAME (an address in most cases) AND BODY */}\n        <div className=\"proposaldetails__content\">\n          <h3>\n            {/* @note If the proposal title is not an address it will fall back to a normal, non-truncated string. */}\n            {truncateEthAddress(commonData.msg.payload.name || '', 7)}\n          </h3>\n\n          <Markdown>{commonData.msg.payload.body}</Markdown>\n        </div>\n\n        {/* SIDEBAR */}\n        <div className=\"proposaldetails__status\">\n          {/* AMOUNT(S) IF RELEVANT FOR PROPOSAL */}\n          {renderAmountBadge && renderAmountBadge()}\n\n          {/* SPONSOR & VOTING ACTIONS */}\n          {renderActions()}\n        </div>\n      </div>\n    </>\n  );\n}\n","import {SnapshotType} from '@openlaw/snapshot-js-erc712';\nimport React from 'react';\nimport {useHistory, useParams} from 'react-router-dom';\n\nimport {AsyncStatus} from '../../util/types';\nimport {GovernanceActions} from '../../components/governance';\nimport {useIsDefaultChain} from '../../components/web3/hooks';\nimport {useProposalOrDraft} from '../../components/proposals/hooks';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderLarge from '../../components/feedback/LoaderLarge';\nimport NotFound from '../subpages/NotFound';\nimport ProposalDetails from '../../components/proposals/ProposalDetails';\nimport Wrap from '../../components/common/Wrap';\n\nexport default function GovernanceProposalDetails() {\n  /**\n   * Their hooks\n   */\n\n  // Get hash for fetching the proposal.\n  const {proposalId} = useParams<{proposalId: string}>();\n\n  /**\n   * Our hooks\n   */\n\n  const {proposalData, proposalError, proposalNotFound, proposalStatus} =\n    useProposalOrDraft(proposalId, SnapshotType.proposal);\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const isLoading: boolean = proposalStatus === AsyncStatus.PENDING;\n  const error: Error | undefined = proposalError || defaultChainError;\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <RenderWrapper>\n        <div className=\"loader--large-container\">\n          <LoaderLarge />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render 404 no proposal found\n  if (proposalNotFound) {\n    return (\n      <RenderWrapper>\n        <NotFound />\n      </RenderWrapper>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center\">\n          <ErrorMessageWithDetails\n            error={error}\n            renderText=\"Something went wrong while getting the proposal.\"\n          />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render proposal\n  if (proposalData) {\n    return (\n      <RenderWrapper>\n        <ProposalDetails\n          proposal={proposalData}\n          renderActions={() => <GovernanceActions proposal={proposalData} />}\n        />\n      </RenderWrapper>\n    );\n  }\n\n  // Render nothing. Should never reach this case.\n  return <></>;\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function viewAll(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n\n    history.push('/governance');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Governance</h2>\n\n          <button className=\"titlebar__action\" onClick={viewAll}>\n            View all\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {Link, useHistory} from 'react-router-dom';\nimport LinesEllipsis from 'react-lines-ellipsis';\nimport responsiveHOC from 'react-lines-ellipsis/lib/responsiveHOC';\n\nimport {isEthAddressValid} from '../../util/validation';\nimport {truncateEthAddress} from '../../util/helpers';\n\ntype ProposalCardProps = {\n  buttonText?: string;\n  /**\n   * The path to link to. Defaults to `${location.pathname}/${proposalOnClickId}`.\n   */\n  linkPath?: string | ((id: string) => string);\n  /**\n   * Take arbitrary actions on click\n   */\n  onClick?: (proposalOnClickId: string) => void;\n  /**\n   * The ID for the proposal to be used for navigation.\n   * As there can be a few different options, it's best to provide it\n   * explicitly.\n   */\n  proposalOnClickId: string;\n  name: string;\n  /**\n   * Render a custom status via render prop\n   */\n  renderStatus?: () => React.ReactNode;\n};\n\nconst DEFAULT_BUTTON_TEXT: string = 'View Proposal';\n\nconst ResponsiveEllipsis = responsiveHOC()(LinesEllipsis);\n\n/**\n * Shows a preview of a proposal's details\n *\n * @param {ProposalCardProps} props\n * @returns {JSX.Element}\n */\nexport default function ProposalCard(props: ProposalCardProps): JSX.Element {\n  const {\n    buttonText = DEFAULT_BUTTON_TEXT,\n    proposalOnClickId,\n    linkPath,\n    onClick,\n    name,\n    renderStatus,\n  } = props;\n\n  /**\n   * Their hooks\n   */\n\n  const {location} = useHistory();\n\n  /**\n   * Variables\n   */\n\n  const pathname: string = location.pathname === '/' ? '' : location.pathname;\n\n  const path: string =\n    typeof linkPath === 'function'\n      ? linkPath(proposalOnClickId)\n      : linkPath || `${pathname}/${proposalOnClickId}`;\n\n  /**\n   * Functions\n   */\n\n  function handleClick() {\n    onClick?.(proposalOnClickId);\n  }\n\n  function renderName(name: string) {\n    if (isEthAddressValid(name)) {\n      return truncateEthAddress(name, 7);\n    } else {\n      return (\n        <ResponsiveEllipsis\n          text={name}\n          maxLine={1}\n          ellipsis=\"...\"\n          trimRight\n          basedOn=\"letters\"\n        />\n      );\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Link className=\"proposalcard__link\" to={path} onClick={handleClick}>\n      <div className=\"proposalcard\">\n        {/* TITLE */}\n        <h3 className=\"proposalcard__title\">{renderName(name)}</h3>\n\n        {/* E.G. VOTING PROGRESS STATUS AND BAR */}\n        {renderStatus && renderStatus()}\n\n        {/**\n         * BUTTON (no click handler)\n         *\n         * @todo Set to a `<span>` as `<button>` is invalid as a descendent of `<a>`.\n         */}\n        <button className=\"proposalcard__button\">\n          {buttonText || DEFAULT_BUTTON_TEXT}\n        </button>\n      </div>\n    </Link>\n  );\n}\n","import React, {Fragment, useEffect, useState} from 'react';\n\nimport {AsyncStatus} from '../../util/types';\nimport {BURN_ADDRESS} from '../../util/constants';\nimport {normalizeString} from '../../util/helpers';\nimport {OffchainVotingStatus} from '../proposals/voting';\nimport {ProposalData, VotingResult} from '../proposals/types';\nimport {ProposalHeaderNames} from '../../util/enums';\nimport {useGovernanceProposals} from './hooks';\nimport {useIsDefaultChain} from '../web3/hooks';\nimport {useOffchainVotingResults} from '../proposals/hooks';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport LoaderLarge from '../feedback/LoaderLarge';\nimport ProposalCard from '../proposals/ProposalCard';\n\ntype GovernanceProposalsListProps = {\n  /**\n   * The `actionId` to get proposals for in Snapshot Hub.\n   */\n  actionId?: string;\n  /**\n   * Optionally provide a click handler for `ProposalCard`.\n   * The proposal's id (in Snapshot) will be provided as an argument.\n   * Defaults to noop: `() => {}`\n   */\n  onProposalClick?: (id: string) => void;\n  /**\n   * The path to link to. Defaults to `${location.pathname}/${proposalOnClickId}`.\n   */\n  proposalLinkPath?: Parameters<typeof ProposalCard>['0']['linkPath'];\n  /**\n   * Optionally render a custom proposal card.\n   */\n  renderProposalCard?: (data: {\n    proposalData: ProposalData;\n    votingResult?: VotingResult;\n  }) => React.ReactNode;\n};\n\ntype FilteredProposals = {\n  failedProposals: ProposalData[];\n  passedProposals: ProposalData[];\n  votingProposals: ProposalData[];\n};\n\nexport default function GovernanceProposalsList(\n  props: GovernanceProposalsListProps\n): JSX.Element {\n  const {\n    actionId = BURN_ADDRESS,\n    onProposalClick = () => {},\n    proposalLinkPath,\n    renderProposalCard,\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [proposalsForVotingResults, setProposalsForVotingResults] = useState<\n    ProposalData['snapshotProposal'][]\n  >([]);\n  const [filteredProposals, setFilteredProposals] = useState<FilteredProposals>(\n    {\n      failedProposals: [],\n      passedProposals: [],\n      votingProposals: [],\n    }\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {\n    governanceProposals,\n    governanceProposalsError,\n    governanceProposalsStatus,\n  } = useGovernanceProposals({\n    actionId,\n  });\n\n  const {\n    offchainVotingResults,\n    offchainVotingResultsError,\n    offchainVotingResultsStatus,\n  } = useOffchainVotingResults(proposalsForVotingResults);\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const {failedProposals, passedProposals, votingProposals} = filteredProposals;\n\n  const isLoading: boolean =\n    governanceProposalsStatus === AsyncStatus.STANDBY ||\n    governanceProposalsStatus === AsyncStatus.PENDING ||\n    // Getting ready to fetch using `useOffchainVotingResults`; helps to show continuous loader.\n    (offchainVotingResultsStatus === AsyncStatus.STANDBY &&\n      proposalsForVotingResults.length > 0) ||\n    offchainVotingResultsStatus === AsyncStatus.PENDING;\n\n  const error: Error | undefined =\n    governanceProposalsError || offchainVotingResultsError || defaultChainError;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    setProposalsForVotingResults(\n      governanceProposals.map((gp) => gp.snapshotProposal)\n    );\n  }, [governanceProposals]);\n\n  // Separate proposals into categories: voting, passed, failed\n  useEffect(() => {\n    if (governanceProposalsStatus !== AsyncStatus.FULFILLED) return;\n\n    const filteredProposalsToSet: FilteredProposals = {\n      failedProposals: [],\n      passedProposals: [],\n      votingProposals: [],\n    };\n\n    governanceProposals.forEach((p) => {\n      const end = p.snapshotProposal?.msg.payload.end || 0;\n      const hasVoteEnded = end < Math.ceil(Date.now() / 1000);\n\n      // voting proposal\n      if (!hasVoteEnded) {\n        filteredProposalsToSet.votingProposals.push(p);\n\n        return;\n      }\n\n      const offchainResult = offchainVotingResults.find(\n        ([proposalHash, _result]) =>\n          normalizeString(proposalHash) ===\n          normalizeString(p.snapshotProposal?.idInSnapshot || '')\n      )?.[1];\n\n      // Did the vote pass by a simple majority?\n      const didPassSimpleMajority: boolean = offchainResult\n        ? offchainResult.Yes.units > offchainResult.No.units\n        : false;\n\n      // passed proposal\n      if (didPassSimpleMajority) {\n        filteredProposalsToSet.passedProposals.push(p);\n\n        return;\n      }\n\n      // failed proposal\n      if (!didPassSimpleMajority) {\n        filteredProposalsToSet.failedProposals.push(p);\n\n        return;\n      }\n    });\n\n    setFilteredProposals((prevState) => ({\n      ...prevState,\n      ...filteredProposalsToSet,\n    }));\n  }, [governanceProposals, governanceProposalsStatus, offchainVotingResults]);\n\n  /**\n   * Functions\n   */\n\n  function renderProposalCards(\n    proposals: ProposalData[]\n  ): React.ReactNode | null {\n    return proposals.map((proposal) => {\n      const {snapshotProposal} = proposal;\n      const proposalId = snapshotProposal?.idInSnapshot;\n      const proposalName = snapshotProposal?.msg.payload.name || '';\n\n      const votingStartMs: number =\n        Number(snapshotProposal?.msg.payload.start || 0) * 1000;\n\n      const votingEndMs: number =\n        Number(snapshotProposal?.msg.payload.end || 0) * 1000;\n\n      if (!proposalId) return null;\n\n      const offchainResult = offchainVotingResults.find(\n        ([proposalHash, _result]) =>\n          normalizeString(proposalHash) === normalizeString(proposalId)\n      )?.[1];\n\n      if (renderProposalCard) {\n        return (\n          <Fragment key={proposalId}>\n            {renderProposalCard({\n              proposalData: proposal,\n              votingResult: offchainResult,\n            })}\n          </Fragment>\n        );\n      }\n\n      return (\n        <ProposalCard\n          key={proposalId}\n          name={proposalName}\n          linkPath={proposalLinkPath}\n          onClick={onProposalClick}\n          proposalOnClickId={proposalId}\n          renderStatus={() => (\n            <OffchainVotingStatus\n              votingResult={offchainResult}\n              countdownVotingEndMs={votingEndMs}\n              countdownVotingStartMs={votingStartMs}\n            />\n          )}\n        />\n      );\n    });\n  }\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <div className=\"loader--large-container\">\n        <LoaderLarge />\n      </div>\n    );\n  }\n\n  // Render no proposals\n  if (\n    !governanceProposals.length &&\n    !Object.values(filteredProposals).flatMap((p) => p).length &&\n    governanceProposalsStatus === AsyncStatus.FULFILLED\n  ) {\n    return <p className=\"text-center\">No proposals, yet!</p>;\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <div className=\"text-center\">\n        <ErrorMessageWithDetails\n          error={error}\n          renderText=\"Something went wrong while getting the proposals.\"\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"grid--fluid grid-container\">\n      {/* VOTING PROPOSALS */}\n      {votingProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.VOTING}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(votingProposals)}\n          </div>\n        </>\n      )}\n\n      {/* PASSED PROPOSALS */}\n      {passedProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.PASSED}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(passedProposals)}\n          </div>\n        </>\n      )}\n\n      {/* FAILED PROPOSALS */}\n      {failedProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.FAILED}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(failedProposals)}\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {\n  SnapshotProposalResponse,\n  SnapshotType,\n} from '@openlaw/snapshot-js-erc712';\nimport {useQuery} from 'react-query';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {BURN_ADDRESS} from '../../../util/constants';\nimport {ProposalData} from '../../proposals/types';\nimport {SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {useIsMounted} from '../../../hooks';\n\ntype UseGovernanceProposalsReturn = {\n  governanceProposals: ProposalData[];\n  governanceProposalsStatus: AsyncStatus;\n  governanceProposalsError: Error | undefined;\n};\n\n/**\n * useGovernanceProposals\n *\n * Provides an array of id->proposal tuples of governance-style proposals which are not submitted on-chain.\n *\n * @param {{actionId : string}}\n *   - `actionId`: Name of the ERC-712 `actionId` to get Governance proposals by. Defaults to `BURN_ADDRESS`.\n * @returns `UseGovernanceProposalsReturn` An object with the governance proposals, and the current async status.\n */\nexport function useGovernanceProposals({\n  actionId = BURN_ADDRESS,\n}: {\n  actionId?: string;\n}): UseGovernanceProposalsReturn {\n  /**\n   * State\n   */\n\n  const [governanceProposals, setGovernanceProposals] = useState<\n    ProposalData[]\n  >([]);\n  const [governanceProposalsError, setGovernanceProposalsError] =\n    useState<Error>();\n  const [governanceProposalsStatus, setGovernanceProposalsStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  /**\n   * Our hooks\n   */\n\n  const {isMountedRef} = useIsMounted();\n\n  /**\n   * React Query\n   */\n\n  const {\n    data: snapshotProposalEntriesData,\n    error: snapshotProposalEntriesError,\n  } = useQuery(\n    ['snapshotProposalEntries', actionId],\n    async () => await getSnapshotProposalsByActionId(actionId),\n    {\n      enabled: !!actionId,\n    }\n  );\n\n  /**\n   * Cached callbacks\n   */\n\n  const handleGetProposalsCached = useCallback(handleGetProposals, [\n    isMountedRef,\n    snapshotProposalEntriesData,\n    snapshotProposalEntriesError,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    handleGetProposalsCached();\n  }, [handleGetProposalsCached]);\n\n  /**\n   * Functions\n   */\n\n  /**\n   * Gets Proposals from Snapshot Hub\n   */\n  async function getSnapshotProposalsByActionId(\n    actionId: string\n  ): Promise<ProposalData[]> {\n    try {\n      const baseURL = `${SNAPSHOT_HUB_API_URL}/api/${SPACE}`;\n\n      const proposals = await fetch(\n        `${baseURL}/proposals/${actionId}?includeVotes=true`\n      );\n\n      if (!proposals.ok) {\n        throw new Error(\n          'Something went wrong while fetching the Snapshot proposals.'\n        );\n      }\n\n      const proposalsJSON: SnapshotProposalResponse = await proposals.json();\n\n      /**\n       * @note The id of the proposal is used and we do not consider any Draft id,\n       *   as we do for Snapshot->on-chain proposals.\n       *\n       * @todo Fix type of return so we don't need to add so many empty key/value pairs.\n       */\n      return Object.entries(proposalsJSON).map(\n        ([id, snapshotProposal]): ProposalData => ({\n          daoProposal: undefined,\n          snapshotDraft: undefined,\n          snapshotProposal: {\n            ...snapshotProposal,\n            idInSnapshot: id,\n            idInDAO: '',\n          },\n          getCommonSnapshotProposalData: () => undefined,\n          refetchProposalOrDraft: () => undefined,\n          snapshotType: SnapshotType.proposal,\n        })\n      );\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async function handleGetProposals() {\n    try {\n      setGovernanceProposalsStatus(AsyncStatus.PENDING);\n\n      if (snapshotProposalEntriesError) {\n        throw snapshotProposalEntriesError;\n      }\n\n      if (snapshotProposalEntriesData) {\n        if (!isMountedRef.current) return;\n\n        setGovernanceProposalsStatus(AsyncStatus.FULFILLED);\n        setGovernanceProposals(snapshotProposalEntriesData);\n      }\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      const e = error as Error;\n\n      setGovernanceProposalsStatus(AsyncStatus.REJECTED);\n      setGovernanceProposals([]);\n      setGovernanceProposalsError(e);\n    }\n  }\n\n  return {\n    governanceProposals,\n    governanceProposalsError,\n    governanceProposalsStatus,\n  };\n}\n","import React from 'react';\nimport {useHistory} from 'react-router-dom';\n\nimport {BURN_ADDRESS} from '../../util/constants';\nimport FadeIn from '../../components/common/FadeIn';\nimport GovernanceProposalsList from '../../components/governance/GovernanceProposalsList';\nimport Wrap from '../../components/common/Wrap';\n\nexport default function GovernanceProposals() {\n  /**\n   * Functions\n   */\n\n  function proposalLinkPath(id: string) {\n    return `/governance/${id}`;\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <RenderWrapper>\n      <GovernanceProposalsList\n        actionId={BURN_ADDRESS}\n        proposalLinkPath={proposalLinkPath}\n      />\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function goToNewProposal(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n    history.push('/governance-proposal');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Governance</h2>\n          <button className=\"titlebar__action\" onClick={goToNewProposal}>\n            New Proposal\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","export const featureFlags = {\n  joinIsWhitelisted: true,\n};\n","import {useCallback, useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\n\nimport {StoreState} from '../../../store/types';\nimport {ERC20RegisterDetails} from '../DaoToken';\nimport {AsyncStatus} from '../../../util/types';\n\ntype UseDaoTokenDetailsReturn = {\n  daoTokenDetails: ERC20RegisterDetails | undefined;\n  daoTokenDetailsError: Error | undefined;\n  daoTokenDetailsStatus: AsyncStatus;\n};\n\n/**\n * useDaoTokenDetails\n *\n * Gets DAO token details from ERC20Extension contract.\n *\n * @returns {UseDaoTokenDetailsReturn}\n */\nexport function useDaoTokenDetails(): UseDaoTokenDetailsReturn {\n  /**\n   * Selectors\n   */\n\n  const ERC20ExtensionContract = useSelector(\n    (state: StoreState) => state.contracts?.ERC20ExtensionContract\n  );\n\n  /**\n   * State\n   */\n\n  const [daoTokenDetails, setDaoTokenDetails] =\n    useState<ERC20RegisterDetails>();\n  const [daoTokenDetailsStatus, setDaoTokenDetailsStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n  const [daoTokenDetailsError, setDaoTokenDetailsError] = useState<Error>();\n\n  /**\n   * Cached callbacks\n   */\n\n  const getDaoTokenDetailsCached = useCallback(getDaoTokenDetails, [\n    ERC20ExtensionContract,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getDaoTokenDetailsCached();\n  }, [getDaoTokenDetailsCached]);\n\n  /**\n   * Functions\n   */\n\n  async function getDaoTokenDetails() {\n    if (!ERC20ExtensionContract) return;\n\n    try {\n      setDaoTokenDetailsStatus(AsyncStatus.PENDING);\n\n      const symbol = await ERC20ExtensionContract.instance.methods\n        .symbol()\n        .call();\n      const decimals = await ERC20ExtensionContract.instance.methods\n        .decimals()\n        .call();\n\n      setDaoTokenDetails({\n        address: ERC20ExtensionContract.contractAddress,\n        symbol,\n        decimals: Number(decimals),\n        image: `${window.location.origin}/favicon.ico`,\n      });\n\n      setDaoTokenDetailsStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      const e = error as Error;\n\n      console.log(e);\n      setDaoTokenDetails(undefined);\n      setDaoTokenDetailsError(e);\n      setDaoTokenDetailsStatus(AsyncStatus.REJECTED);\n    }\n  }\n\n  return {daoTokenDetails, daoTokenDetailsError, daoTokenDetailsStatus};\n}\n","import {fromWei, sha3} from 'web3-utils';\nimport {useCallback, useEffect, useState} from 'react';\nimport {useQuery} from 'react-query';\nimport {useSelector} from 'react-redux';\n\nimport {\n  alchemyFetchAssetTransfers,\n  getDAOAddressConfigEntry,\n} from '../../web3/helpers';\nimport {AsyncStatus} from '../../../util/types';\nimport {BURN_ADDRESS} from '../../../util/constants';\nimport {CHAINS, DEFAULT_CHAIN, ONBOARDING_TOKEN_ADDRESS} from '../../../config';\nimport {ConfigurationUpdated} from '../../../abis/types/DaoRegistry';\nimport {ContractDAOConfigKeys} from '../../web3/types';\nimport {normalizeString} from '../../../util/helpers';\nimport {StoreState} from '../../../store/types';\nimport {useAbortController} from '../../../hooks';\nimport {useWeb3Modal} from '../../web3/hooks';\n\ntype UseTotalAmountContributedReturn = {\n  amountContributed: number;\n  amountContributedStatus: AsyncStatus;\n};\n\nconst {FULFILLED, PENDING, REJECTED, STANDBY} = AsyncStatus;\n\nconst ALLOWED_ASSETS = ['eth', 'weth'];\n\nconst CONFIGURATION_UPDATED_EVENT_SIGNATURE_HASH = sha3(\n  'ConfigurationUpdated(bytes32,uint256)'\n);\n\nconst KYC_ONBOARDING_CHUNK_SIZE_KEY_HASH = sha3(\n  ContractDAOConfigKeys.kycOnboardingChunkSize\n);\n\nconst KYC_ONBOARDING_MAXIMUM_CHUNKS_KEY_HASH = sha3(\n  ContractDAOConfigKeys.kycOnboardingMaximumChunks\n);\n\n/**\n * Returns the total amount of ETH, WETH contributed to the DAO's fund target\n * address (which is typically a multi-sig wallet on mainnet) via\n * `KycOnboarding` transfers and direct transfers.\n *\n * This hook will only run on mainnet due to constraints from the Alchemy\n * Transfers API.\n *\n * @todo Allow Alchemy parameters to be passed in\n * @todo Allow `ALLOWED_ASSETS` to be passed in\n */\nexport function useTotalAmountContributedMultisig(): UseTotalAmountContributedReturn {\n  /**\n   * Selectors\n   */\n\n  const daoAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n\n  const daoABI = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.abi\n  );\n\n  const daoInstance = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.instance\n  );\n\n  /**\n   * State\n   */\n\n  const [amountContributedStatus, setAmountContributedStatus] =\n    useState<AsyncStatus>(STANDBY);\n\n  /**\n   * Our hooks\n   */\n\n  const {abortController, isMountedRef} = useAbortController();\n  const {web3Instance} = useWeb3Modal();\n\n  /**\n   * Cached callbacks\n   */\n\n  const getAmountContributedCached = useCallback(getAmountContributed, [\n    abortController,\n    daoABI,\n    daoAddress,\n    daoInstance,\n    isMountedRef,\n    web3Instance,\n  ]);\n\n  /**\n   * React Query\n   */\n\n  const {data: amountContributed = 0, refetch} = useQuery(\n    'totalAmountContributedMultisig',\n    getAmountContributedCached,\n    /**\n     * Will manually `refetch` as the `web3Instance` dependency makes this\n     * a bit trickier as it cannot be stringified due to a circular dependency\n     */\n    {enabled: false}\n  );\n\n  /**\n   * Effects\n   */\n\n  /**\n   * Manually fetches the `useQuery`, if data has not already been fetched.\n   */\n  useEffect(() => {\n    if (amountContributed) return;\n\n    refetch();\n  }, [amountContributed, getAmountContributedCached, refetch]);\n\n  /**\n   * Functions\n   */\n\n  async function getAmountContributed() {\n    try {\n      if (\n        DEFAULT_CHAIN !== CHAINS.MAINNET ||\n        !daoAddress ||\n        !daoABI ||\n        !daoInstance ||\n        !web3Instance ||\n        !CONFIGURATION_UPDATED_EVENT_SIGNATURE_HASH ||\n        !KYC_ONBOARDING_CHUNK_SIZE_KEY_HASH ||\n        !KYC_ONBOARDING_MAXIMUM_CHUNKS_KEY_HASH\n      ) {\n        return;\n      }\n\n      /**\n       * Get the concatenated hash used in the `KycOnboarding` contract\n       * for storing `kyc-onboarding.chunkSize` key\n       */\n      const KYC_ONBOARDING_CHUNK_SIZE_CONFIG_KEY_HASH = sha3(\n        web3Instance.eth.abi.encodeParameters(\n          ['address', 'bytes32'],\n          [ONBOARDING_TOKEN_ADDRESS, KYC_ONBOARDING_CHUNK_SIZE_KEY_HASH]\n        )\n      );\n\n      if (!KYC_ONBOARDING_CHUNK_SIZE_CONFIG_KEY_HASH) return;\n\n      /**\n       * Get the concatenated hash used in the `KycOnboarding` contract\n       * for storing `kyc-onboarding.maximumChunks` key\n       */\n      const KYC_ONBOARDING_MAXIMUM_CHUNKS_CONFIG_KEY_HASH = sha3(\n        web3Instance.eth.abi.encodeParameters(\n          ['address', 'bytes32'],\n          [ONBOARDING_TOKEN_ADDRESS, KYC_ONBOARDING_MAXIMUM_CHUNKS_KEY_HASH]\n        )\n      );\n\n      if (!KYC_ONBOARDING_MAXIMUM_CHUNKS_CONFIG_KEY_HASH) return;\n\n      const configurationUpdatedEventInputs = daoABI.find(\n        ({name, type}) => type === 'event' && name === 'ConfigurationUpdated'\n      )?.inputs;\n\n      if (!configurationUpdatedEventInputs) return;\n\n      /**\n       * Get KycOnboarding fundTargetAddress from the DAO address config\n       *\n       * Assumes we care about only the latest fundTargetAddress value to\n       * calculate the total contribution amount\n       * */\n      const fundTargetAddress = await getDAOAddressConfigEntry(\n        daoInstance,\n        ContractDAOConfigKeys.kycOnboardingFundTargetAddress,\n        ONBOARDING_TOKEN_ADDRESS\n      );\n\n      if (!fundTargetAddress || fundTargetAddress === BURN_ADDRESS) return;\n\n      setAmountContributedStatus(PENDING);\n\n      const transfers = await alchemyFetchAssetTransfers(\n        {\n          /**\n           * Leave a generous block filter where no tribute-contracts would've\n           * been deployed to mainnet.\n           *\n           * 2021-01-01 00:00:00\n           */\n          fromBlock: 11565019,\n          category: ['external', 'internal', 'token'],\n          toAddress: fundTargetAddress,\n        },\n        {abortController}\n      );\n\n      const daoConfigUpdatedLogs = await web3Instance.eth.getPastLogs({\n        fromBlock: 0,\n        address: daoAddress,\n        topics: [CONFIGURATION_UPDATED_EVENT_SIGNATURE_HASH],\n      });\n\n      const chunkSizeValues = daoConfigUpdatedLogs\n        // Decode each log\n        .map(\n          (c) =>\n            web3Instance.eth.abi.decodeLog(\n              configurationUpdatedEventInputs,\n              c.data,\n              [CONFIGURATION_UPDATED_EVENT_SIGNATURE_HASH]\n            ) as any as ConfigurationUpdated['returnValues']\n        )\n        // Only take `key`s matching `KYC_ONBOARDING_CHUNK_SIZE_CONFIG_KEY_HASH`\n        .filter(\n          (d) =>\n            normalizeString(d.key) ===\n            normalizeString(KYC_ONBOARDING_CHUNK_SIZE_CONFIG_KEY_HASH)\n        )\n        // Only take the config `value`s, converted to ETH\n        .map((c) => fromWei(c.value, 'ether'));\n\n      const maximumChunksValues = daoConfigUpdatedLogs\n        // Decode each log\n        .map(\n          (c) =>\n            web3Instance.eth.abi.decodeLog(\n              configurationUpdatedEventInputs,\n              c.data,\n              [CONFIGURATION_UPDATED_EVENT_SIGNATURE_HASH]\n            ) as any as ConfigurationUpdated['returnValues']\n        )\n        // Only take `key`s matching `KYC_ONBOARDING_MAXIMUM_CHUNKS_CONFIG_KEY_HASH`\n        .filter(\n          (d) =>\n            normalizeString(d.key) ===\n            normalizeString(KYC_ONBOARDING_MAXIMUM_CHUNKS_CONFIG_KEY_HASH)\n        )\n        // Only take the config `value`s\n        .map((c) => c.value);\n\n      /**\n       * Get expected maximum amount that could have been contributed by each\n       * member.\n       *\n       * Assumes we care about only the greatest chunkSize and maximumChunks\n       * values to calculate the amount.\n       *\n       * Assumes we're working with normal `number`s, not big numbers.\n       */\n      const expectedMaxAmount: number =\n        Math.max(...chunkSizeValues.map(Number)) *\n        Math.max(...maximumChunksValues.map(Number));\n\n      /**\n       * Get total amount contributed\n       *\n       * Assumes we're working with normal `number`s, not big numbers.\n       */\n      const amountContributed: number = transfers\n        // Only take transfers which have assets in `ALLOWED_ASSETS`\n        .filter((t) =>\n          ALLOWED_ASSETS.some((a) => a === normalizeString(t.asset || ''))\n        )\n        .map((t) => t.value)\n        // Only take values which are multiples of a chunk size config value\n        .filter((v) => v && chunkSizeValues.some((c) => v % Number(c) === 0))\n        // Only take values which are less than or equal to the\n        // expectedMaxAmount\n        .filter((mv) => mv && mv <= expectedMaxAmount)\n        .reduce((acc: number, next) => (acc += next || 0), 0);\n\n      if (!isMountedRef.current) return;\n\n      setAmountContributedStatus(FULFILLED);\n\n      return amountContributed;\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      setAmountContributedStatus(REJECTED);\n    }\n  }\n\n  return {\n    amountContributed,\n    amountContributedStatus,\n  };\n}\n","import {useCallback, useEffect, useMemo, useState} from 'react';\nimport {useSelector} from 'react-redux';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {CycleEllipsis} from '../../feedback';\nimport {featureFlags} from '../../../util/features';\nimport {KYC_BACKEND_URL} from '../../../config';\nimport {StoreState} from '../../../store/types';\nimport {useAbortController} from '../../../hooks';\nimport {useIsDefaultChain} from '../../web3/hooks';\n\ntype KycCertificate = {\n  isWhitelisted: boolean;\n  signature: string;\n  // `entityType` was used before to determine the minimum contribution amount,\n  // but is no longer needed in the current implementation.\n  // entityType: string;\n};\n\ntype UseVerifyKYCApplicantReturn = {\n  kycCheckCertificate: KycCertificate | undefined;\n  kycCheckError: Error | undefined;\n  kycCheckMessageJSX: React.ReactElement | undefined;\n  kycCheckStatus: AsyncStatus;\n  setKYCCheckETHAddress: (a: string) => void;\n  setKYCCheckRedirect: (a: string) => void;\n};\n\nconst CHECK_IN_PROGRESS_JSX = (\n  <>\n    Checking your KYC status\n    <CycleEllipsis />\n  </>\n);\n\nconst REDIRECT_IN_PROGRESS_JSX = (\n  <>\n    Redirecting you to our KYC form\n    <CycleEllipsis />\n  </>\n);\n\nconst NOT_WHITELISTED_JSX = (\n  <>\n    The applicant address has been KYC verified, but has not been authorized to\n    join yet.\n  </>\n);\n\nconst PENDING_VERIFICATION_JSX = (\n  <>\n    KYC verification for the applicant address is pending and must be completed\n    first.\n    <br />\n    Please try again later.\n  </>\n);\n\n/**\n * Delays setting React state. Default delay is 2000ms.\n *\n * e.g. Delay updating UI messages which arrive async for better readability.\n *\n * @todo Maybe make into a util.\n *\n * @param setState React set state function\n * @returns (s: T, d: number) => Promise<void>\n */\nfunction setStateWithDelay<T>(\n  setState: React.Dispatch<React.SetStateAction<T>>\n): (state: T, delay?: number) => Promise<void> {\n  return async (state: T, delay: number = 2000) => {\n    await new Promise((r) => setTimeout(r, delay));\n\n    setState(state);\n  };\n}\n\nexport function useVerifyKYCApplicant(): UseVerifyKYCApplicantReturn {\n  /**\n   * Selectors\n   */\n\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n\n  /**\n   * State\n   */\n\n  const [kycCheckStatus, setKYCCheckStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n\n  const [kycCheckCertificate, setKYCCheckCertificate] =\n    useState<KycCertificate>();\n\n  const [kycCheckError, setKYCCheckError] = useState<Error>();\n\n  const [kycCheckMessageJSX, setKYCCheckMessageJSX] =\n    useState<React.ReactElement>();\n\n  const [ethAddress, setETHAddress] = useState<string>('');\n\n  const [redirect, setRedirect] = useState<string>('');\n\n  const [shouldRedirect, setShouldRedirect] = useState<boolean>(false);\n\n  /**\n   * Our hooks\n   */\n\n  const {abortController, isMountedRef} = useAbortController();\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Cached values\n   */\n\n  const setKYCCheckMessageJSXWithDelay = useMemo(\n    () => setStateWithDelay<typeof kycCheckMessageJSX>(setKYCCheckMessageJSX),\n    []\n  );\n\n  const setRedirectWithDelay = useMemo(\n    () => setStateWithDelay<typeof redirect>(setRedirect),\n    []\n  );\n\n  /**\n   * Cached callback\n   */\n\n  const verifyApplicantKYCCached = useCallback(verifyApplicantKYC, [\n    abortController?.signal,\n    daoRegistryContract,\n    defaultChainError,\n    ethAddress,\n    isMountedRef,\n    setKYCCheckMessageJSXWithDelay,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  // Run verify check\n  useEffect(() => {\n    verifyApplicantKYCCached();\n  }, [verifyApplicantKYCCached]);\n\n  // Redirect to KYC verify form\n  useEffect(() => {\n    if (!shouldRedirect || !redirect) return;\n\n    window.location.href = redirect;\n  }, [kycCheckStatus, redirect, shouldRedirect]);\n\n  // Cleanup async processes\n  useEffect(() => {\n    return function cleanup() {\n      abortController?.abort();\n    };\n  }, [abortController]);\n\n  /**\n   * Functions\n   */\n\n  async function verifyApplicantKYC() {\n    try {\n      if (!abortController?.signal) return;\n\n      if (!daoRegistryContract || !ethAddress || defaultChainError) {\n        setKYCCheckCertificate(undefined);\n        setKYCCheckError(undefined);\n        setKYCCheckStatus(AsyncStatus.STANDBY);\n\n        return;\n      }\n\n      setKYCCheckMessageJSX(CHECK_IN_PROGRESS_JSX);\n      setKYCCheckStatus(AsyncStatus.PENDING);\n\n      const response = await fetch(\n        `${KYC_BACKEND_URL}/${daoRegistryContract.contractAddress}/${ethAddress}`,\n        {signal: abortController.signal}\n      );\n\n      const responseJSON = await response.json();\n\n      if (response.status === 404) {\n        setKYCCheckCertificate(undefined);\n        setKYCCheckMessageJSX(REDIRECT_IN_PROGRESS_JSX);\n        setKYCCheckStatus(AsyncStatus.REJECTED);\n        setShouldRedirect(true);\n\n        return;\n      }\n\n      if (!response.ok) {\n        if (responseJSON.message.includes('pending verification')) {\n          setKYCCheckCertificate(undefined);\n          setKYCCheckMessageJSXWithDelay(PENDING_VERIFICATION_JSX);\n          setKYCCheckStatus(AsyncStatus.REJECTED);\n\n          return;\n        } else {\n          throw new Error(responseJSON.message);\n        }\n      }\n\n      // If the whitelist flag is set, check if the verified address is\n      // whitelisted\n      if (\n        !responseJSON.isWhitelisted &&\n        featureFlags?.joinIsWhitelisted &&\n        response.ok\n      ) {\n        setKYCCheckCertificate(undefined);\n        setKYCCheckMessageJSXWithDelay(NOT_WHITELISTED_JSX);\n        setKYCCheckStatus(AsyncStatus.FULFILLED);\n\n        return;\n      }\n\n      if (!isMountedRef.current) return;\n\n      setKYCCheckCertificate(responseJSON);\n      setKYCCheckError(undefined);\n      setKYCCheckMessageJSX(undefined);\n      setKYCCheckStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      const e = error as Error;\n\n      setKYCCheckCertificate(undefined);\n      setKYCCheckError(e);\n      setKYCCheckStatus(AsyncStatus.REJECTED);\n    }\n  }\n\n  return {\n    kycCheckCertificate,\n    kycCheckError,\n    kycCheckMessageJSX,\n    kycCheckStatus,\n    setKYCCheckETHAddress: setETHAddress,\n    setKYCCheckRedirect: setRedirectWithDelay,\n  };\n}\n","import {AbiItem, fromWei, toBN} from 'web3-utils';\nimport {toChecksumAddress, toWei} from 'web3-utils';\nimport {Contract as Web3Contract} from 'web3-eth-contract/types';\nimport {useCallback, useEffect, useState} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {useForm, Controller} from 'react-hook-form';\n\nimport {\n  formatNumber,\n  getValidationError,\n  normalizeString,\n} from '../../util/helpers';\nimport {featureFlags} from '../../util/features';\nimport {\n  useContractSend,\n  useETHGasPrice,\n  useIsDefaultChain,\n  useWeb3Modal,\n} from '../../components/web3/hooks';\nimport {AsyncStatus} from '../../util/types';\nimport {ContractDAOConfigKeys, Web3TxStatus} from '../../components/web3/types';\nimport {CycleEllipsis} from '../../components/feedback';\nimport {FormFieldErrors} from '../../util/enums';\nimport {getConnectedMember} from '../../store/actions';\nimport {getDAOConfigEntry} from '../../components/web3/helpers';\nimport {isEthAddressValid} from '../../util/validation';\nimport {\n  ETH_TOKEN_ADDRESS,\n  KYC_FORMS_URL,\n  ONBOARDING_TOKEN_ADDRESS,\n} from '../../config';\nimport {ReduxDispatch, StoreState} from '../../store/types';\nimport {TX_CYCLE_MESSAGES} from '../../components/web3/config';\nimport {useCheckApplicant} from '../../components/proposals/hooks';\nimport {useDaoTokenDetails} from '../../components/dao-token/hooks';\nimport {useVerifyKYCApplicant} from '../../components/kyc-onboarding';\nimport CycleMessage from '../../components/feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport EtherscanURL from '../../components/web3/EtherscanURL';\nimport FadeIn from '../../components/common/FadeIn';\nimport InputError from '../../components/common/InputError';\nimport Loader from '../../components/feedback/Loader';\nimport Slider from '../../components/common/Slider';\nimport Wrap from '../../components/common/Wrap';\n\nenum Fields {\n  ethAddress = 'ethAddress',\n  amount = 'amount',\n}\n\ntype FormInputs = {\n  ethAddress: string;\n  amount: string;\n};\n\ntype OnboardEthArguments = [\n  dao: string, // `dao`\n  kycedMember: string, // `kycedMember`\n  signature: string // `signature`\n];\n\ntype OnboardERC20Arguments = [\n  dao: string, // `dao`\n  kycedMember: string, // `kycedMember`\n  tokenAddr: string, // `tokenAddr`\n  amount: string, // `amount`\n  signature: string // `signature`\n];\n\ntype TokenApproveArguments = [\n  spender: string, // `spender`\n  amount: string // `amount`\n];\n\ntype KycOnboardingConfigs = {\n  chunkSize: string;\n  maximumChunks: string;\n  maxMembers: string;\n  unitsPerChunk: string;\n};\n\ntype ERC20Details = {\n  symbol: string;\n  decimals: number;\n};\n\ntype BN = ReturnType<typeof toBN>;\n\nconst PLACEHOLDER = '\\u2014'; /* em dash */\n\nconst isERC20Onboarding = ONBOARDING_TOKEN_ADDRESS !== ETH_TOKEN_ADDRESS;\n\nfunction renderUserAccountBalance(userAccountBalance: string | undefined) {\n  if (!userAccountBalance) {\n    return '---';\n  }\n\n  return formatNumber(userAccountBalance);\n}\n\nfunction renderUnauthorizedMessage({\n  defaultChainError,\n  isConnected,\n}: {\n  defaultChainError: Error | undefined;\n  isConnected: boolean;\n}) {\n  // user is not connected\n  if (!isConnected) {\n    return 'Connect your wallet to get started.';\n  }\n\n  // user is on wrong network\n  if (defaultChainError) {\n    return defaultChainError.message;\n  }\n}\n\nfunction renderSubmitStatus({\n  txEtherscanURL,\n  txStatus,\n  txEtherscanURLTokenApprove,\n  txStatusTokenApprove,\n}: {\n  txEtherscanURL: string;\n  txStatus: Web3TxStatus;\n  txEtherscanURLTokenApprove: string;\n  txStatusTokenApprove: string;\n}): React.ReactNode {\n  // token approve transaction statuses\n  if (txStatusTokenApprove === Web3TxStatus.AWAITING_CONFIRM) {\n    return (\n      <>\n        Confirm to transfer your tokens\n        <CycleEllipsis intervalMs={500} />\n      </>\n    );\n  }\n\n  if (txStatusTokenApprove === Web3TxStatus.PENDING) {\n    return (\n      <>\n        <div>\n          Approving your tokens for transfer\n          <CycleEllipsis intervalMs={500} />\n        </div>\n\n        <EtherscanURL url={txEtherscanURLTokenApprove} isPending />\n      </>\n    );\n  }\n\n  // onboard transaction statuses\n  switch (txStatus) {\n    case Web3TxStatus.AWAITING_CONFIRM:\n      return (\n        <>\n          Awaiting your confirmation\n          <CycleEllipsis intervalMs={500} />\n        </>\n      );\n    case Web3TxStatus.PENDING:\n      return (\n        <>\n          <CycleMessage\n            intervalMs={2000}\n            messages={TX_CYCLE_MESSAGES}\n            useFirstItemStart\n            render={(message) => {\n              return <FadeIn key={message}>{message}</FadeIn>;\n            }}\n          />\n\n          <EtherscanURL url={txEtherscanURL} isPending />\n        </>\n      );\n    case Web3TxStatus.FULFILLED:\n      return (\n        <>\n          <div>Onboarding done!</div>\n\n          <EtherscanURL url={txEtherscanURL} />\n        </>\n      );\n    default:\n      return null;\n  }\n}\n\nexport default function KycOnboardingForm() {\n  /**\n   * Selectors\n   */\n\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n\n  const kycOnboardingContract = useSelector(\n    (s: StoreState) => s.contracts.KycOnboardingContract\n  );\n\n  const isActiveMember = useSelector(\n    (s: StoreState) => s.connectedMember?.isActiveMember\n  );\n\n  const isAddressDelegated = useSelector(\n    (s: StoreState) => s.connectedMember?.isAddressDelegated\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  const {connected, account, web3Instance} = useWeb3Modal();\n\n  const {txEtherscanURL, txIsPromptOpen, txSend, txStatus} = useContractSend();\n\n  const {\n    txEtherscanURL: txEtherscanURLTokenApprove,\n    txIsPromptOpen: txIsPromptOpenTokenApprove,\n    txSend: txSendTokenApprove,\n    txStatus: txStatusTokenApprove,\n  } = useContractSend();\n\n  const {average: gasPrice} = useETHGasPrice();\n\n  const {daoTokenDetails} = useDaoTokenDetails();\n\n  const {\n    kycCheckCertificate,\n    kycCheckError,\n    kycCheckMessageJSX,\n    kycCheckStatus,\n    setKYCCheckETHAddress,\n    setKYCCheckRedirect,\n  } = useVerifyKYCApplicant();\n\n  /**\n   * Their hooks\n   */\n\n  const form = useForm<FormInputs>({\n    mode: 'onBlur',\n    reValidateMode: 'onChange',\n  });\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n\n  const [userAccountBalance, setUserAccountBalance] = useState<string>();\n\n  const [sliderStep, setSliderStep] = useState<number>();\n\n  const [sliderMin, setSliderMin] = useState<number>();\n\n  const [sliderMax, setSliderMax] = useState<number>();\n\n  const [kycOnboardingConfigs, setKycOnboardingConfigs] =\n    useState<KycOnboardingConfigs>();\n\n  const [erc20Contract, setERC20Contract] = useState<Web3Contract>();\n\n  const [erc20Details, setERC20Details] = useState<ERC20Details>();\n\n  /**\n   * Variables\n   */\n\n  const {\n    clearErrors,\n    control,\n    errors,\n    getValues,\n    register,\n    setValue,\n    trigger,\n    watch,\n  } = form;\n\n  const ethAddressValue = watch(Fields.ethAddress);\n\n  const amountValue = watch(Fields.amount);\n\n  const kycOnboardingError = submitError;\n\n  const isConnected: boolean = connected && account ? true : false;\n\n  const isInProcess =\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING ||\n    txStatusTokenApprove === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatusTokenApprove === Web3TxStatus.PENDING;\n\n  const isDone = txStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone =\n    isInProcess || isDone || txIsPromptOpen || txIsPromptOpenTokenApprove;\n\n  const submitDisabled: boolean =\n    !kycCheckCertificate ||\n    isInProcessOrDone ||\n    kycCheckStatus === AsyncStatus.PENDING ||\n    kycCheckStatus === AsyncStatus.REJECTED;\n\n  const {\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n  } = useCheckApplicant(ethAddressValue);\n\n  const maxMembersText = kycOnboardingConfigs\n    ? formatNumber(Number(kycOnboardingConfigs.maxMembers) - 2) // accounts for config being set to max actual members + 1 DAO creator + 1 DaoFactory\n    : PLACEHOLDER;\n\n  const minUnitsText = kycOnboardingConfigs\n    ? formatNumber(kycOnboardingConfigs.unitsPerChunk)\n    : PLACEHOLDER;\n\n  const minAmountText = sliderMin ? formatNumber(sliderMin) : PLACEHOLDER;\n\n  const maxUnitsText = kycOnboardingConfigs\n    ? formatNumber(\n        String(\n          toBN(kycOnboardingConfigs.unitsPerChunk).mul(\n            toBN(kycOnboardingConfigs.maximumChunks)\n          )\n        )\n      )\n    : PLACEHOLDER;\n\n  const maxAmountText = sliderMax ? formatNumber(sliderMax) : PLACEHOLDER;\n\n  const amountUnit = isERC20Onboarding ? erc20Details?.symbol : 'ETH';\n\n  /**\n   * Cached callbacks\n   */\n\n  const getUserAccountBalanceCached = useCallback(getUserAccountBalance, [\n    account,\n    defaultChainError,\n    erc20Contract,\n    web3Instance,\n  ]);\n\n  const setSliderConfigsCached = useCallback(setSliderConfigs, [\n    daoRegistryContract,\n    defaultChainError,\n    erc20Details,\n    kycOnboardingConfigs,\n    setValue,\n  ]);\n\n  const getKycOnboardingConfigsCached = useCallback(getKycOnboardingConfigs, [\n    daoRegistryContract,\n    defaultChainError,\n  ]);\n\n  const getERC20ContractCached = useCallback(getERC20Contract, [\n    defaultChainError,\n    web3Instance,\n  ]);\n\n  const getERC20DetailsCached = useCallback(getERC20Details, [\n    defaultChainError,\n    erc20Contract,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getUserAccountBalanceCached();\n  }, [getUserAccountBalanceCached, isDone]);\n\n  // Set the value of `ethAddress` if the `account` changes\n  useEffect(() => {\n    if (defaultChainError) return;\n\n    setValue(Fields.ethAddress, account && toChecksumAddress(account));\n  }, [account, defaultChainError, setValue]);\n\n  // Set the address to check JTC\n  useEffect(() => {\n    setKYCCheckETHAddress(ethAddressValue);\n  }, [ethAddressValue, setKYCCheckETHAddress]);\n\n  // Set the redirect URL to the KYC form.\n  useEffect(() => {\n    if (!ethAddressValue || !KYC_FORMS_URL || defaultChainError) {\n      return;\n    }\n\n    setKYCCheckRedirect(KYC_FORMS_URL);\n  }, [defaultChainError, ethAddressValue, setKYCCheckRedirect]);\n\n  useEffect(() => {\n    setSliderConfigsCached();\n  }, [setSliderConfigsCached, kycCheckCertificate]);\n\n  useEffect(() => {\n    setSubmitError(undefined);\n    clearErrors();\n  }, [clearErrors, ethAddressValue]);\n\n  useEffect(() => {\n    getKycOnboardingConfigsCached();\n  }, [getKycOnboardingConfigsCached]);\n\n  useEffect(() => {\n    if (isERC20Onboarding) {\n      getERC20ContractCached();\n    }\n  }, [getERC20ContractCached]);\n\n  useEffect(() => {\n    if (isERC20Onboarding) {\n      getERC20DetailsCached();\n    }\n  }, [getERC20DetailsCached]);\n\n  /**\n   * Functions\n   */\n\n  async function getERC20Contract() {\n    if (!web3Instance || defaultChainError) {\n      setERC20Contract(undefined);\n      return;\n    }\n\n    try {\n      if (!ONBOARDING_TOKEN_ADDRESS) {\n        throw new Error(\n          'No Onboarding ERC20 address was found. Are you sure it is set?'\n        );\n      }\n\n      const {default: lazyERC20ABI} = await import(\n        '../../abis/external/ERC20.json'\n      );\n      const erc20Contract: AbiItem[] = lazyERC20ABI as any;\n      const instance = new web3Instance.eth.Contract(\n        erc20Contract,\n        ONBOARDING_TOKEN_ADDRESS\n      );\n\n      setERC20Contract(instance);\n    } catch (error) {\n      console.error(error);\n      setERC20Contract(undefined);\n    }\n  }\n\n  async function getERC20Details() {\n    if (!erc20Contract || defaultChainError) {\n      setERC20Details(undefined);\n      return;\n    }\n\n    try {\n      const symbol = await erc20Contract.methods.symbol().call();\n      const decimals = await erc20Contract.methods.decimals().call();\n      setERC20Details({symbol, decimals: Number(decimals)});\n    } catch (error) {\n      console.error(error);\n      setERC20Details(undefined);\n    }\n  }\n\n  function setSliderConfigs() {\n    try {\n      if (!daoRegistryContract || defaultChainError || !kycOnboardingConfigs) {\n        setSliderStep(undefined);\n        setSliderMin(undefined);\n        setSliderMax(undefined);\n        setValue(Fields.amount, PLACEHOLDER);\n\n        return;\n      }\n\n      if (isERC20Onboarding) {\n        // ERC20 onboarding\n        if (!erc20Details) {\n          setSliderStep(undefined);\n          setSliderMin(undefined);\n          setSliderMax(undefined);\n          setValue(Fields.amount, PLACEHOLDER);\n\n          return;\n        }\n\n        const divisor = toBN(10).pow(toBN(erc20Details.decimals));\n        const beforeDecimal = toBN(kycOnboardingConfigs.chunkSize).div(divisor);\n        const afterDecimal = toBN(kycOnboardingConfigs.chunkSize).mod(divisor);\n        const stepAmount: number = afterDecimal.eq(toBN(0))\n          ? Number(String(beforeDecimal))\n          : Number(`${String(beforeDecimal)}.${String(afterDecimal)}`);\n        setSliderStep(stepAmount);\n\n        setSliderMax(stepAmount * Number(kycOnboardingConfigs.maximumChunks));\n\n        setSliderMin(stepAmount);\n\n        setValue(Fields.amount, String(stepAmount));\n      } else {\n        // ETH onboarding\n        setSliderStep(Number(fromWei(kycOnboardingConfigs.chunkSize, 'ether')));\n\n        setSliderMax(\n          Number(\n            fromWei(\n              toBN(kycOnboardingConfigs.chunkSize).mul(\n                toBN(kycOnboardingConfigs.maximumChunks)\n              ),\n              'ether'\n            )\n          )\n        );\n\n        setSliderMin(Number(fromWei(kycOnboardingConfigs.chunkSize, 'ether')));\n\n        setValue(\n          Fields.amount,\n          fromWei(kycOnboardingConfigs.chunkSize, 'ether')\n        );\n      }\n    } catch (error) {\n      setSliderStep(undefined);\n      setSliderMin(undefined);\n      setSliderMax(undefined);\n      setValue(Fields.amount, PLACEHOLDER);\n\n      console.error(error);\n    }\n  }\n\n  async function getKycOnboardingConfigs() {\n    try {\n      if (!daoRegistryContract || defaultChainError) return;\n\n      const chunkSize = await getDAOConfigEntry(\n        daoRegistryContract.instance,\n        ContractDAOConfigKeys.kycOnboardingChunkSize,\n        ONBOARDING_TOKEN_ADDRESS\n      );\n      const maximumChunks = await getDAOConfigEntry(\n        daoRegistryContract.instance,\n        ContractDAOConfigKeys.kycOnboardingMaximumChunks,\n        ONBOARDING_TOKEN_ADDRESS\n      );\n      const maxMembers = await getDAOConfigEntry(\n        daoRegistryContract.instance,\n        ContractDAOConfigKeys.kycOnboardingMaxMembers,\n        ONBOARDING_TOKEN_ADDRESS\n      );\n      const unitsPerChunk = await getDAOConfigEntry(\n        daoRegistryContract.instance,\n        ContractDAOConfigKeys.kycOnboardingUnitsPerChunk,\n        ONBOARDING_TOKEN_ADDRESS\n      );\n      setKycOnboardingConfigs({\n        chunkSize,\n        maximumChunks,\n        maxMembers,\n        unitsPerChunk,\n      });\n    } catch (error) {\n      console.error(error);\n\n      setKycOnboardingConfigs(undefined);\n    }\n  }\n\n  async function getUserAccountBalance() {\n    try {\n      if (!account || defaultChainError) {\n        setUserAccountBalance(undefined);\n\n        return;\n      }\n\n      if (isERC20Onboarding) {\n        // ERC20 onboarding\n        if (!erc20Contract) {\n          setUserAccountBalance(undefined);\n\n          return;\n        }\n\n        const balance = await erc20Contract.methods.balanceOf(account).call();\n        const balanceBN = toBN(balance);\n        const decimals = await erc20Contract.methods.decimals().call();\n        const divisor = toBN(10).pow(toBN(decimals));\n        const beforeDecimal = balanceBN.div(divisor);\n        const afterDecimal = balanceBN.mod(divisor);\n        const balanceReadable = afterDecimal.eq(toBN(0))\n          ? String(beforeDecimal)\n          : `${String(beforeDecimal)}.${String(afterDecimal)}`;\n\n        setUserAccountBalance(balanceReadable);\n      } else {\n        // ETH onboarding\n        if (!web3Instance) {\n          setUserAccountBalance(undefined);\n\n          return;\n        }\n\n        // Ether wallet balance\n        setUserAccountBalance(\n          web3Instance.utils.fromWei(\n            await web3Instance.eth.getBalance(account),\n            'ether'\n          )\n        );\n      }\n    } catch (error) {\n      console.error(error);\n      setUserAccountBalance(undefined);\n    }\n  }\n\n  async function handleSubmitTokenApprove(erc20AmountWithDecimals: BN) {\n    try {\n      if (!kycOnboardingContract) {\n        throw new Error('No KYC Onboarding contract was found.');\n      }\n\n      if (!erc20Contract) {\n        throw new Error('No ERC20Contract found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      // Value to check if adapter is allowed to spend amount of tokens on\n      // behalf of owner. If allowance is not sufficient, the owner will approve\n      // the adapter to spend the amount of tokens needed for the owner to\n      // provide the full onboarding amount.\n      const allowance = await erc20Contract.methods\n        .allowance(account, kycOnboardingContract.contractAddress)\n        .call();\n\n      const allowanceBN = toBN(allowance);\n\n      if (erc20AmountWithDecimals.gt(allowanceBN)) {\n        const difference = erc20AmountWithDecimals.sub(allowanceBN);\n        const approveAmount = allowanceBN.add(difference);\n        const tokenApproveArguments: TokenApproveArguments = [\n          kycOnboardingContract.contractAddress,\n          String(approveAmount),\n        ];\n        const txArguments = {\n          from: account || '',\n          ...(gasPrice ? {gasPrice} : null),\n        };\n\n        // Execute contract call for `approve`\n        await txSendTokenApprove(\n          'approve',\n          erc20Contract.methods,\n          tokenApproveArguments,\n          txArguments\n        );\n      }\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async function handleSubmit(values: FormInputs) {\n    try {\n      if (!daoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      if (!kycOnboardingContract) {\n        throw new Error('No KYC Onboarding contract was found.');\n      }\n\n      if (!isConnected) {\n        throw new Error(\n          'No user account was found. Please make sure your wallet is connected.'\n        );\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      if (checkApplicantError) {\n        // Just log the error (don't throw). The applicant address validity will\n        // be checked as part of the `onboard` tx (via the internal\n        // `potentialNewMember` call).\n        console.warn(\n          `Error checking if the applicant address is valid: ${checkApplicantError.message}`\n        );\n      }\n\n      if (\n        checkApplicantStatus === AsyncStatus.FULFILLED &&\n        !isApplicantValid &&\n        checkApplicantInvalidMsg\n      ) {\n        throw new Error(checkApplicantInvalidMsg);\n      }\n\n      if (!kycCheckCertificate) {\n        throw new Error('No KYC validation certificate found.');\n      }\n\n      // If the whitelist flag is set, check if the verified address is\n      // whitelisted\n      if (\n        featureFlags?.joinIsWhitelisted &&\n        !kycCheckCertificate.isWhitelisted\n      ) {\n        throw new Error(\n          'The applicant address has been KYC verified, but has not been authorized to join yet.'\n        );\n      }\n\n      if (isActiveMember || isAddressDelegated) {\n        throw new Error('The applicant address is already a member.');\n      }\n\n      const {ethAddress, amount} = values;\n      const ethAddressToChecksum = toChecksumAddress(ethAddress);\n\n      let txReceipt;\n\n      if (isERC20Onboarding) {\n        // ERC20 onboarding\n        if (!erc20Details) {\n          throw new Error('No ERC20 details found.');\n        }\n\n        if (!Number.isInteger(Number(amount))) {\n          throw new Error('The amount must be an integer for an ERC20 token.');\n        }\n\n        const multiplier = toBN(10).pow(toBN(erc20Details.decimals));\n        const erc20AmountWithDecimals = toBN(amount).mul(multiplier);\n\n        await handleSubmitTokenApprove(erc20AmountWithDecimals);\n\n        const onboardERC20Arguments: OnboardERC20Arguments = [\n          daoRegistryContract.contractAddress,\n          ethAddressToChecksum,\n          ONBOARDING_TOKEN_ADDRESS,\n          String(erc20AmountWithDecimals),\n          kycCheckCertificate.signature,\n        ];\n\n        const txArguments = {\n          from: account || '',\n          ...(gasPrice ? {gasPrice} : null),\n        };\n\n        txReceipt = await txSend(\n          'onboard',\n          kycOnboardingContract.instance.methods,\n          onboardERC20Arguments,\n          txArguments\n        );\n      } else {\n        // ETH onboarding\n        const ethAmountInWei = toWei(amount, 'ether');\n\n        const onboardEthArguments: OnboardEthArguments = [\n          daoRegistryContract.contractAddress,\n          ethAddressToChecksum,\n          kycCheckCertificate.signature,\n        ];\n\n        const txArguments = {\n          from: account || '',\n          value: ethAmountInWei,\n          ...(gasPrice ? {gasPrice} : null),\n        };\n\n        txReceipt = await txSend(\n          'onboardEth',\n          kycOnboardingContract.instance.methods,\n          onboardEthArguments,\n          txArguments\n        );\n      }\n\n      if (txReceipt) {\n        // if connected account is the applicant (the address that will receive\n        // the membership units)\n        if (normalizeString(ethAddress) === normalizeString(account)) {\n          // re-fetch member\n          await dispatch(\n            getConnectedMember({\n              account,\n              daoRegistryContract,\n              web3Instance,\n            })\n          );\n\n          // suggest adding DAO token to wallet\n          await addTokenToWallet();\n        }\n      }\n    } catch (error) {\n      // Set any errors from Web3 utils or explicitly set above.\n      const e = error as Error;\n\n      setSubmitError(e);\n    }\n  }\n\n  async function addTokenToWallet() {\n    if (!daoTokenDetails) return;\n\n    try {\n      await window?.ethereum?.request({\n        method: 'wallet_watchAsset',\n        params: {\n          type: 'ERC20',\n          options: daoTokenDetails,\n        },\n      });\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  // Render unauthorized message\n  if (!isConnected || defaultChainError) {\n    return (\n      <RenderWrapper>\n        <div className=\"form__description\">\n          <p>\n            Tribute DAO will have up to {maxMembersText} initial members. Each\n            member can purchase {minUnitsText} units for {minAmountText}{' '}\n            {amountUnit} (up to {maxUnitsText} units for {maxAmountText}{' '}\n            {amountUnit}).\n          </p>\n          <p>\n            Please put your preferred ETH address below and the amount of{' '}\n            {amountUnit} you&apos;d like to contribute.\n          </p>\n        </div>\n\n        <div className=\"form__description--unauthorized\">\n          <p>\n            {renderUnauthorizedMessage({\n              defaultChainError,\n              isConnected,\n            })}\n          </p>\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      <div className=\"form__description\">\n        {/* KYC CHECK STATUS MESSAGE */}\n        {kycCheckMessageJSX && (\n          <div className=\"form__header\">\n            <FadeIn>\n              <p>{kycCheckMessageJSX}</p>\n            </FadeIn>\n          </div>\n        )}\n\n        <p>\n          Tribute DAO will have up to {maxMembersText} initial members. Each\n          member can purchase {minUnitsText} units for {minAmountText}{' '}\n          {amountUnit} (up to {maxUnitsText} units for {maxAmountText}{' '}\n          {amountUnit}).\n        </p>\n        <p>\n          Please put your preferred ETH address below and the amount of{' '}\n          {amountUnit} you&apos;d like to contribute.\n        </p>\n      </div>\n\n      <form className=\"form\" onSubmit={(e) => e.preventDefault()}>\n        {/* ETH ADDRESS */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\" htmlFor={Fields.ethAddress}>\n            Applicant Address\n          </label>\n          <div className=\"form__input-row-fieldwrap\">\n            {/* @note We don't need the default value as it's handled in the useEffect above. */}\n            <input\n              aria-describedby={`error-${Fields.ethAddress}`}\n              aria-invalid={errors.ethAddress ? 'true' : 'false'}\n              id={Fields.ethAddress}\n              name={Fields.ethAddress}\n              ref={register({\n                validate: (ethAddress: string): string | boolean => {\n                  return !ethAddress\n                    ? FormFieldErrors.REQUIRED\n                    : !isEthAddressValid(ethAddress)\n                    ? FormFieldErrors.INVALID_ETHEREUM_ADDRESS\n                    : true;\n                },\n              })}\n              type=\"text\"\n              disabled={isInProcessOrDone}\n            />\n\n            <InputError\n              error={getValidationError(Fields.ethAddress, errors)}\n              id={`error-${Fields.ethAddress}`}\n            />\n          </div>\n        </div>\n\n        {/* AMOUNT SLIDER */}\n        <div className=\"form__input-row\">\n          <label\n            className=\"form__input-row-label\"\n            htmlFor={Fields.amount}\n            id={`${Fields.amount}-label`}>\n            Amount\n          </label>\n          <div className=\"form__input-row-fieldwrap--narrow\">\n            <Controller\n              render={({onChange}) => (\n                <Slider\n                  aria-labelledby={`${Fields.amount}-label`}\n                  defaultValue={sliderMin || 0}\n                  id={Fields.amount}\n                  max={sliderMax || 0}\n                  min={sliderMin || 0}\n                  step={sliderStep || 0}\n                  onChange={onChange}\n                  disabled={isInProcessOrDone}\n                />\n              )}\n              defaultValue={sliderMin || 0}\n              control={control}\n              name={Fields.amount}\n              rules={{\n                validate: (value: string): string | boolean => {\n                  const amount = Number(value);\n\n                  return amount > Number(userAccountBalance)\n                    ? `Insufficient funds. ${renderUserAccountBalance(\n                        userAccountBalance\n                      )} ${amountUnit} available.`\n                    : true;\n                },\n              }}\n            />\n\n            <InputError\n              error={getValidationError(Fields.amount, errors)}\n              id={`error-${Fields.amount}`}\n            />\n          </div>\n          <div className=\"form__input-addon\">\n            {formatNumber(amountValue)} {amountUnit}\n          </div>\n        </div>\n\n        {/* SUBMIT */}\n        <button\n          aria-label={isInProcess ? 'Submitting your proposal.' : ''}\n          className=\"button\"\n          disabled={submitDisabled}\n          onClick={\n            submitDisabled\n              ? () => {}\n              : async () => {\n                  if (!(await trigger())) {\n                    return;\n                  }\n\n                  handleSubmit(getValues());\n                }\n          }\n          type=\"submit\">\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Submit'}\n        </button>\n\n        {/* SUBMIT STATUS */}\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus({\n              txEtherscanURL,\n              txStatus,\n              txEtherscanURLTokenApprove,\n              txStatusTokenApprove,\n            })}\n          </div>\n        )}\n\n        {/* SUBMIT ERROR */}\n        {kycOnboardingError && (\n          <div className=\"form__submit-error-container\">\n            <ErrorMessageWithDetails\n              renderText=\"Something went wrong with the submission.\"\n              error={kycOnboardingError}\n              detailsProps={{open: true}}\n            />\n          </div>\n        )}\n\n        {/* KYC CHECK ERROR */}\n        {kycCheckError && (\n          <div className=\"form__submit-error-container\">\n            <ErrorMessageWithDetails\n              renderText=\"There is a KYC check error.\"\n              error={kycCheckError}\n              detailsProps={{open: true}}\n            />\n          </div>\n        )}\n      </form>\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Join</h2>\n        </div>\n\n        <div className=\"form-wrapper\">\n          {/* RENDER CHILDREN */}\n          {props.children}\n        </div>\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {SVGAttributes} from 'react';\n\nexport default function CopySVG(props: SVGAttributes<HTMLOrSVGElement>) {\n  return (\n    <svg\n      aria-hidden=\"true\"\n      focusable=\"false\"\n      data-icon=\"copy\"\n      role=\"img\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 448 512\"\n      {...props}>\n      <path\n        fill=\"currentColor\"\n        d=\"M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z\"></path>\n    </svg>\n  );\n}\n","import React from 'react';\n\nexport default function ArrowsSVG(props: React.SVGAttributes<SVGElement>) {\n  return (\n    <svg\n      aria-hidden=\"true\"\n      focusable=\"false\"\n      data-icon=\"wallet\"\n      role=\"img\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 512 512\"\n      {...props}>\n      <path\n        fill=\"currentColor\"\n        d=\"M461.2 128H80c-8.84 0-16-7.16-16-16s7.16-16 16-16h384c8.84 0 16-7.16 16-16 0-26.51-21.49-48-48-48H64C28.65 32 0 60.65 0 96v320c0 35.35 28.65 64 64 64h397.2c28.02 0 50.8-21.53 50.8-48V176c0-26.47-22.78-48-50.8-48zM416 336c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z\"></path>\n    </svg>\n  );\n}\n","import ReactTooltip from 'react-tooltip';\n\nimport {CopyWithTooltip} from '../common/CopyWithTooltip';\nimport {truncateEthAddress} from '../../util/helpers/truncateEthAddress';\nimport CopySVG from '../../assets/svg/CopySVG';\nimport WalletSVG from '../../assets/svg/WalletSVG';\n\nexport type ERC20RegisterDetails = {\n  address: string;\n  symbol: string;\n  decimals: number;\n  image: string;\n};\n\ntype DaoTokenProps = {\n  daoTokenDetails?: ERC20RegisterDetails;\n};\n\nexport default function DaoToken({\n  daoTokenDetails,\n}: DaoTokenProps): JSX.Element {\n  /**\n   * Functions\n   */\n\n  async function addTokenToWallet() {\n    if (!daoTokenDetails) return;\n\n    try {\n      await window.ethereum.request({\n        method: 'wallet_watchAsset',\n        params: {\n          type: 'ERC20',\n          options: daoTokenDetails,\n        },\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  if (daoTokenDetails) {\n    return (\n      <div>\n        Token:{' '}\n        <CopyWithTooltip\n          render={({elementRef, isCopied, setCopied, tooltipID}) => (\n            <span\n              data-for={tooltipID}\n              data-tip={isCopied ? 'copied!' : daoTokenDetails.address}\n              onClick={setCopied}\n              ref={elementRef}>\n              {truncateEthAddress(daoTokenDetails.address, 5)}\n            </span>\n          )}\n          textToCopy={daoTokenDetails.address}\n        />\n        <ReactTooltip effect=\"solid\" id=\"daotoken-address\" />\n        {/* Copy */}\n        <CopyWithTooltip\n          render={({elementRef, isCopied, setCopied, tooltipID}) => (\n            <button\n              className=\"daotoken__button\"\n              data-for={tooltipID}\n              data-tip={isCopied ? 'copied!' : 'copy address'}\n              onClick={setCopied}\n              ref={elementRef}>\n              <CopySVG aria-label=\"copy address\" />\n            </button>\n          )}\n          textToCopy={daoTokenDetails.address}\n        />\n        {/* Wallet */}\n        <button\n          className=\"daotoken__button\"\n          data-for=\"daotoken-wallet\"\n          data-tip=\"add to wallet\"\n          onClick={addTokenToWallet}>\n          <WalletSVG aria-label=\"add to wallet\" />\n        </button>\n        <ReactTooltip delayShow={200} effect=\"solid\" id=\"daotoken-wallet\" />\n      </div>\n    );\n  }\n\n  return <></>;\n}\n","import React, {Fragment} from 'react';\n\ninterface IProps {\n  checked: boolean;\n  id: string;\n  label: string;\n  name: string;\n  onChange: (event: React.ChangeEvent<HTMLInputElement>) => void;\n}\n\ntype OtherProps = {[key: string]: any; size?: CheckboxSize};\n\nexport enum CheckboxSize {\n  LARGE = 'large',\n  SMALL = 'small',\n}\n\nexport default function Checkbox({size, ...props}: IProps & OtherProps) {\n  return (\n    <Fragment>\n      <input\n        {...props}\n        aria-checked={props.checked}\n        checked={props.checked}\n        className={`checkbox-input ${props.className || ''} `}\n        id={props.id}\n        name={props.name}\n        onChange={props.onChange}\n        type=\"checkbox\"\n      />\n\n      <label className={`checkbox-label`} htmlFor={props.id}>\n        <span className={`checkbox-box ${size || CheckboxSize.SMALL}`}></span>\n        <span className={`checkbox-text`}>{props.label}</span>\n      </label>\n    </Fragment>\n  );\n}\n","import {useState, useEffect, useCallback} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {useForm} from 'react-hook-form';\nimport {toChecksumAddress} from 'web3-utils';\n\nimport {BURN_ADDRESS} from '../../util/constants';\nimport {CheckboxSize} from '../../components/common/Checkbox';\nimport {FormFieldErrors} from '../../util/enums';\nimport {getConnectedMember} from '../../store/actions';\nimport {\n  getValidationError,\n  normalizeString,\n  truncateEthAddress,\n} from '../../util/helpers';\nimport {isEthAddressValid} from '../../util/validation';\nimport {ReduxDispatch, StoreState} from '../../store/types';\nimport {TX_CYCLE_MESSAGES} from '../../components/web3/config';\nimport {\n  useWeb3Modal,\n  useContractSend,\n  useETHGasPrice,\n} from '../../components/web3/hooks';\nimport {Web3TxStatus} from '../../components/web3/types';\nimport CycleMessage from '../../components/feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport EtherscanURL from '../../components/web3/EtherscanURL';\nimport FadeIn from '../../components/common/FadeIn';\nimport InputError from '../../components/common/InputError';\nimport Loader from '../../components/feedback/Loader';\nimport Modal from '../../components/common/Modal';\nimport TimesSVG from '../../assets/svg/TimesSVG';\nimport UserSVG from '../../assets/svg/UserSVG';\n\nenum DelegationStatus {\n  DELEGATE = 'Delegate',\n  REVOKE_DELEGATION = 'Revoke Delegation',\n  UPDATE_DELEGATE = 'Update Delegate',\n}\n\nenum DelegationStep {\n  SET_DELEGATION = 'setDelegation',\n  REVOKE_DELEGATION = 'revokeDelegation',\n  UPDATE_DELEGATION = 'updateDelegation',\n}\n\nenum Fields {\n  delegateAddress = 'delegateAddress',\n  confirmDelegation = 'confirmDelegation',\n}\n\ntype Steps = 'setDelegation' | 'revokeDelegation' | 'updateDelegation';\n\ntype StepsType = {[S in Steps]: () => JSX.Element};\n\ntype FormInputs = {\n  delegateAddress: string;\n  confirmDelegation: boolean;\n};\n\ntype UpdateDelegateKeyArguments = [\n  dao: string, // `dao`\n  delegateKey: string // `delegateKey`\n];\n\ntype DelegationModalProps = {\n  isOpen: boolean;\n  closeHandler: () => void;\n  currentStep: string;\n};\n\nfunction DelegationModal({\n  isOpen,\n  closeHandler,\n  currentStep,\n}: DelegationModalProps): JSX.Element {\n  /**\n   * Selectors\n   */\n\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n  const daoRegistryAdapterContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryAdapterContract\n  );\n  const connectedMember = useSelector((s: StoreState) => s.connectedMember);\n\n  /**\n   * Our hooks\n   */\n\n  const {account, web3Instance} = useWeb3Modal();\n  const {average: gasPrice} = useETHGasPrice();\n\n  const {txError, txEtherscanURL, txIsPromptOpen, txSend, txStatus} =\n    useContractSend();\n\n  /**\n   * Their hooks\n   */\n\n  const form = useForm<FormInputs>({\n    mode: 'onBlur',\n    reValidateMode: 'onChange',\n  });\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n\n  /**\n   * Variables\n   */\n\n  const {errors, getValues, register, trigger, watch} = form;\n  const isInProcess =\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING;\n  const isDone = txStatus === Web3TxStatus.FULFILLED;\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n  const delegateError = submitError || txError;\n\n  const delegateAddressValue = watch(Fields.delegateAddress);\n  const confirmDelegationValue = watch(Fields.confirmDelegation);\n  const isFormFieldEmpty = !delegateAddressValue || !confirmDelegationValue;\n  const steps: StepsType = {\n    setDelegation: renderSetDelegation,\n    revokeDelegation: renderRevokeDelegation,\n    updateDelegation: renderUpdateDelegation,\n  };\n\n  /**\n   * Functions\n   */\n\n  function renderCurrentStep() {\n    return steps[currentStep]();\n  }\n\n  function renderSetDelegation() {\n    return (\n      <>\n        {/* TITLE */}\n        <div className=\"modal__title\">Delegate</div>\n\n        <p>Transfer your member rights</p>\n        <div className=\"delegation-modal__arrow-down\">&darr;</div>\n        <form className=\"form\" onSubmit={(e) => e.preventDefault()}>\n          {/* DELEGATE ADDRESS */}\n          <div className=\"form__input-row\">\n            <div className=\"form__input-row-fieldwrap\">\n              <input\n                aria-describedby={`error-${Fields.delegateAddress}`}\n                aria-invalid={errors.delegateAddress ? 'true' : 'false'}\n                name={Fields.delegateAddress}\n                ref={register({\n                  validate: (delegateAddress: string): string | boolean => {\n                    return !delegateAddress\n                      ? FormFieldErrors.REQUIRED\n                      : !isEthAddressValid(delegateAddress) ||\n                        delegateAddress === BURN_ADDRESS\n                      ? FormFieldErrors.INVALID_ETHEREUM_ADDRESS\n                      : true;\n                  },\n                })}\n                type=\"text\"\n                disabled={isInProcessOrDone}\n                placeholder=\"Enter delegate address\"\n              />\n\n              {getValidationError(Fields.delegateAddress, errors).includes(\n                'invalid'\n              ) && (\n                <InputError\n                  error={getValidationError(Fields.delegateAddress, errors)}\n                  id={`error-${Fields.delegateAddress}`}\n                />\n              )}\n            </div>\n          </div>\n\n          {/* CONFIRM DELEGATION */}\n          <div className=\"form__input-row\" style={{marginTop: 0}}>\n            <div className=\"form__input-row-fieldwrap\">\n              <input\n                className=\"checkbox-input\"\n                aria-describedby={`error-${Fields.confirmDelegation}`}\n                aria-invalid={errors.confirmDelegation ? 'true' : 'false'}\n                id={Fields.confirmDelegation}\n                name={Fields.confirmDelegation}\n                ref={register({\n                  required: FormFieldErrors.REQUIRED,\n                })}\n                type=\"checkbox\"\n                disabled={isInProcessOrDone}\n              />\n\n              <label\n                className=\"checkbox-label\"\n                htmlFor={Fields.confirmDelegation}>\n                <span className={`checkbox-box ${CheckboxSize.SMALL}`}></span>\n                <span className=\"checkbox-text\">\n                  Confirm delegation to the above address. You can revoke this\n                  at any time from your profile.\n                </span>\n              </label>\n            </div>\n          </div>\n\n          {/* SUBMIT */}\n          <button\n            aria-label={isInProcess ? 'Updating your delegate key...' : ''}\n            className=\"button\"\n            disabled={isInProcessOrDone || isFormFieldEmpty}\n            onClick={async () => {\n              if (isInProcessOrDone) return;\n\n              if (!(await trigger())) {\n                return;\n              }\n\n              handleConfirmDelegation(getValues());\n            }}\n            type=\"submit\">\n            {isInProcess ? <Loader /> : isDone ? 'Done' : 'Confirm'}\n          </button>\n\n          {/* SUBMIT STATUS */}\n          {isInProcessOrDone && (\n            <div className=\"form__submit-status-container\">\n              {renderSubmitStatus()}\n            </div>\n          )}\n\n          {/* SUBMIT ERROR */}\n          {delegateError && (\n            <div className=\"form__submit-error-container\">\n              <ErrorMessageWithDetails\n                renderText=\"Something went wrong with your delegation.\"\n                error={delegateError}\n              />\n            </div>\n          )}\n        </form>\n      </>\n    );\n  }\n\n  function renderRevokeDelegation() {\n    if (connectedMember) {\n      return (\n        <>\n          {/* TITLE */}\n          <div className=\"modal__title\">Revoke Delegation</div>\n\n          <p>{truncateEthAddress(connectedMember.delegateKey, 7)}</p>\n          <div className=\"delegation-modal__arrow-down\">&darr;</div>\n          <p>\n            <UserSVG />\n            Back to you\n          </p>\n          <div className=\"delegation-modal__text\">\n            You&apos;ll be able to resume member actions from your account. You\n            can delegate again at any time from your profile.\n          </div>\n\n          {/* SUBMIT */}\n          <button\n            aria-label={isInProcess ? 'Updating your delegate key...' : ''}\n            className=\"button\"\n            disabled={isInProcessOrDone}\n            onClick={handleRevokeDelegation}>\n            {isInProcess ? <Loader /> : isDone ? 'Done' : 'Confirm'}\n          </button>\n\n          {/* SUBMIT STATUS */}\n          {isInProcessOrDone && (\n            <div className=\"form__submit-status-container\">\n              {renderSubmitStatus()}\n            </div>\n          )}\n\n          {/* SUBMIT ERROR */}\n          {delegateError && (\n            <div className=\"form__submit-error-container\">\n              <ErrorMessageWithDetails\n                renderText=\"Something went wrong with your revocation.\"\n                error={delegateError}\n              />\n            </div>\n          )}\n        </>\n      );\n    }\n\n    return <></>;\n  }\n\n  function renderUpdateDelegation() {\n    return (\n      <>\n        {/* TITLE */}\n        <div className=\"modal__title\">Update Delegate</div>\n\n        <p>Transfer your member rights</p>\n        <div className=\"delegation-modal__arrow-down\">&darr;</div>\n        <form className=\"form\" onSubmit={(e) => e.preventDefault()}>\n          {/* DELEGATE ADDRESS */}\n          <div className=\"form__input-row\">\n            <div className=\"form__input-row-fieldwrap\">\n              <input\n                aria-describedby={`error-${Fields.delegateAddress}`}\n                aria-invalid={errors.delegateAddress ? 'true' : 'false'}\n                name={Fields.delegateAddress}\n                ref={register({\n                  validate: (delegateAddress: string): string | boolean => {\n                    return !delegateAddress\n                      ? FormFieldErrors.REQUIRED\n                      : !isEthAddressValid(delegateAddress) ||\n                        delegateAddress === BURN_ADDRESS\n                      ? FormFieldErrors.INVALID_ETHEREUM_ADDRESS\n                      : true;\n                  },\n                })}\n                type=\"text\"\n                disabled={isInProcessOrDone}\n                placeholder=\"Enter delegate address\"\n              />\n\n              {getValidationError(Fields.delegateAddress, errors).includes(\n                'invalid'\n              ) && (\n                <InputError\n                  error={getValidationError(Fields.delegateAddress, errors)}\n                  id={`error-${Fields.delegateAddress}`}\n                />\n              )}\n            </div>\n          </div>\n\n          {/* CONFIRM DELEGATION */}\n          <div className=\"form__input-row\" style={{marginTop: 0}}>\n            <div className=\"form__input-row-fieldwrap\">\n              <input\n                className=\"checkbox-input\"\n                aria-describedby={`error-${Fields.confirmDelegation}`}\n                aria-invalid={errors.confirmDelegation ? 'true' : 'false'}\n                id={Fields.confirmDelegation}\n                name={Fields.confirmDelegation}\n                ref={register({\n                  required: FormFieldErrors.REQUIRED,\n                })}\n                type=\"checkbox\"\n                disabled={isInProcessOrDone}\n              />\n\n              <label\n                className=\"checkbox-label\"\n                htmlFor={Fields.confirmDelegation}>\n                <span className={`checkbox-box ${CheckboxSize.SMALL}`}></span>\n                <span className=\"checkbox-text\">\n                  Confirm delegation to the above address. You will no longer be\n                  a delegate with member rights.\n                </span>\n              </label>\n            </div>\n          </div>\n\n          {/* SUBMIT */}\n          <button\n            aria-label={isInProcess ? 'Updating the delegate key...' : ''}\n            className=\"button\"\n            disabled={isInProcessOrDone || isFormFieldEmpty}\n            onClick={async () => {\n              if (isInProcessOrDone) return;\n\n              if (!(await trigger())) {\n                return;\n              }\n\n              handleConfirmDelegation(getValues());\n            }}\n            type=\"submit\">\n            {isInProcess ? <Loader /> : isDone ? 'Done' : 'Confirm'}\n          </button>\n\n          {/* SUBMIT STATUS */}\n          {isInProcessOrDone && (\n            <div className=\"form__submit-status-container\">\n              {renderSubmitStatus()}\n            </div>\n          )}\n\n          {/* SUBMIT ERROR */}\n          {delegateError && (\n            <div className=\"form__submit-error-container\">\n              <ErrorMessageWithDetails\n                renderText=\"Something went wrong with updating the delegate.\"\n                error={delegateError}\n              />\n            </div>\n          )}\n        </form>\n      </>\n    );\n  }\n\n  async function handleConfirmDelegation(values: FormInputs) {\n    try {\n      if (!daoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      if (!daoRegistryAdapterContract) {\n        throw new Error('No DAO Registry Adapter contract was found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      const {delegateAddress} = values;\n\n      const updateDelegateKeyArguments: UpdateDelegateKeyArguments = [\n        daoRegistryContract.contractAddress,\n        toChecksumAddress(delegateAddress),\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(gasPrice ? {gasPrice} : null),\n      };\n\n      // Execute contract call for `updateDelegateKey`\n      const tx = await txSend(\n        'updateDelegateKey',\n        daoRegistryAdapterContract.instance.methods,\n        updateDelegateKeyArguments,\n        txArguments\n      );\n\n      if (tx) {\n        setTimeout(async () => {\n          // re-fetch member\n          await dispatch(\n            getConnectedMember({\n              account,\n              daoRegistryContract,\n              web3Instance,\n            })\n          );\n\n          closeHandler();\n        }, 2000);\n      }\n    } catch (error) {\n      const e = error as Error;\n\n      console.log(e);\n      let parsedError = e;\n\n      if (\n        e.message.includes('cannot overwrite existing delegated keys') ||\n        e.message.includes('address already taken as delegated key')\n      ) {\n        parsedError = new Error(\n          'The provided address cannot be another member or already in use as a delegate.'\n        );\n      }\n\n      setSubmitError(parsedError);\n    }\n  }\n\n  async function handleRevokeDelegation() {\n    try {\n      if (!daoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      if (!daoRegistryAdapterContract) {\n        throw new Error('No DAO Registry Adapter contract was found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      const updateDelegateKeyArguments: UpdateDelegateKeyArguments = [\n        daoRegistryContract.contractAddress,\n        toChecksumAddress(account),\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(gasPrice ? {gasPrice} : null),\n      };\n\n      // Execute contract call for `updateDelegateKey`\n      const tx = await txSend(\n        'updateDelegateKey',\n        daoRegistryAdapterContract.instance.methods,\n        updateDelegateKeyArguments,\n        txArguments\n      );\n\n      if (tx) {\n        setTimeout(async () => {\n          // re-fetch member\n          await dispatch(\n            getConnectedMember({\n              account,\n              daoRegistryContract,\n              web3Instance,\n            })\n          );\n\n          closeHandler();\n        }, 2000);\n      }\n    } catch (error) {\n      const e = error as Error;\n\n      console.log(e);\n\n      setSubmitError(e);\n    }\n  }\n\n  function renderSubmitStatus(): React.ReactNode {\n    switch (txStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return 'Awaiting your confirmation\\u2026';\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>Submitted!</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Modal\n      keyProp=\"delegation\"\n      isOpen={isOpen}\n      // Require user to click on close button to avoid accidental modal close\n      // during transaction\n      isOpenHandler={() => {}}\n      modalClassNames=\"delegation-modal\">\n      {/* MODEL CLOSE BUTTON */}\n      <span\n        className=\"modal__close-button\"\n        onClick={() => {\n          closeHandler();\n        }}>\n        <TimesSVG />\n      </span>\n      {renderCurrentStep()}\n    </Modal>\n  );\n}\n\nexport default function Delegation() {\n  /**\n   * Selectors\n   */\n\n  const connectedMember = useSelector((s: StoreState) => s.connectedMember);\n\n  /**\n   * Our hooks\n   */\n\n  const {account} = useWeb3Modal();\n\n  /**\n   * State\n   */\n\n  const [currentStep, setCurrentStep] = useState<string>(\n    DelegationStep.SET_DELEGATION\n  );\n  const [delegationStatus, setDelegationStatus] = useState<string>('');\n  const [showDelegationModal, setShowDelegationModal] =\n    useState<boolean>(false);\n\n  /**\n   * Cached callbacks\n   */\n\n  const fetchDelegationInfoCached = useCallback(fetchDelegationInfo, [\n    account,\n    connectedMember,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    fetchDelegationInfoCached();\n  }, [fetchDelegationInfoCached]);\n\n  /**\n   * Functions\n   */\n\n  function fetchDelegationInfo() {\n    if (!connectedMember || !account) return;\n\n    const {delegateKey, isAddressDelegated, isActiveMember, memberAddress} =\n      connectedMember;\n\n    if (\n      // NO CURRENT DELEGATION VIEWED BY MEMBER\n      isActiveMember &&\n      !isAddressDelegated &&\n      normalizeString(account) === normalizeString(memberAddress)\n    ) {\n      setCurrentStep(DelegationStep.SET_DELEGATION);\n      setDelegationStatus(DelegationStatus.DELEGATE);\n    } else if (\n      // CURRENT DELEGATION VIEWED BY MEMBER\n      !isActiveMember &&\n      isAddressDelegated &&\n      normalizeString(account) === normalizeString(memberAddress)\n    ) {\n      setCurrentStep(DelegationStep.REVOKE_DELEGATION);\n      setDelegationStatus(DelegationStatus.REVOKE_DELEGATION);\n    } else if (\n      // CURRENT DELEGATION VIEWED BY DELEGATE\n      isActiveMember &&\n      !isAddressDelegated &&\n      normalizeString(account) === normalizeString(delegateKey)\n    ) {\n      setCurrentStep(DelegationStep.UPDATE_DELEGATION);\n      setDelegationStatus(DelegationStatus.UPDATE_DELEGATE);\n    }\n  }\n\n  function renderDelegationStatus(): JSX.Element {\n    if (!connectedMember) return <></>;\n\n    switch (delegationStatus) {\n      case DelegationStatus.DELEGATE:\n        // NO CURRENT DELEGATION VIEWED BY MEMBER\n        return (\n          <>\n            You can delegate your member rights to a different ETH address. The\n            address cannot be another member or already in use as a delegate.\n          </>\n        );\n      case DelegationStatus.REVOKE_DELEGATION:\n        // CURRENT DELEGATION VIEWED BY MEMBER\n        return (\n          <>\n            Your member rights have been delegated to{' '}\n            <span className=\"delegation__delegate-address-text\">\n              {truncateEthAddress(connectedMember.delegateKey, 7)}\n            </span>\n            . You can revoke this at any time.\n          </>\n        );\n      case DelegationStatus.UPDATE_DELEGATE:\n        // CURRENT DELEGATION VIEWED BY DELEGATE\n        return (\n          <>\n            The member rights have been delegated to you{' '}\n            <span className=\"delegation__delegate-address-text\">\n              {truncateEthAddress(connectedMember.delegateKey, 7)}\n            </span>\n            . You can update this at any time.\n          </>\n        );\n      default:\n        return <></>;\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  if (connectedMember) {\n    return (\n      <>\n        {delegationStatus !== '' && (\n          <>\n            <div className=\"memberprofile__action-description\">\n              {renderDelegationStatus()}\n            </div>\n\n            {/* OPEN DELEGATION MODAL BUTTON */}\n            <button\n              className=\"memberprofile__action-button\"\n              onClick={() => setShowDelegationModal(true)}>\n              {delegationStatus}\n            </button>\n          </>\n        )}\n\n        {showDelegationModal && (\n          <DelegationModal\n            isOpen={showDelegationModal}\n            closeHandler={() => {\n              setShowDelegationModal(false);\n            }}\n            currentStep={currentStep}\n          />\n        )}\n      </>\n    );\n  }\n\n  return <></>;\n}\n","import {SVGAttributes} from 'react';\n\nexport default function UserSVG(props: SVGAttributes<HTMLOrSVGElement>) {\n  return (\n    <svg\n      aria-hidden=\"true\"\n      focusable=\"false\"\n      data-icon=\"user\"\n      role=\"img\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 448 512\"\n      {...props}>\n      <path\n        fill=\"currentColor\"\n        d=\"M313.6 304c-28.7 0-42.5 16-89.6 16-47.1 0-60.8-16-89.6-16C60.2 304 0 364.2 0 438.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-25.6c0-74.2-60.2-134.4-134.4-134.4zM400 464H48v-25.6c0-47.6 38.8-86.4 86.4-86.4 14.6 0 38.3 16 89.6 16 51.7 0 74.9-16 89.6-16 47.6 0 86.4 38.8 86.4 86.4V464zM224 288c79.5 0 144-64.5 144-144S303.5 0 224 0 80 64.5 80 144s64.5 144 144 144zm0-240c52.9 0 96 43.1 96 96s-43.1 96-96 96-96-43.1-96-96 43.1-96 96-96z\"></path>\n    </svg>\n  );\n}\n","import {AbiItem, toBN, toChecksumAddress} from 'web3-utils';\nimport {useCallback, useEffect, useState} from 'react';\nimport {useLazyQuery} from '@apollo/react-hooks';\nimport {useSelector} from 'react-redux';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {GET_MEMBERS} from '../../../gql';\nimport {Member} from '../types';\nimport {multicall, MulticallTuple} from '../../../components/web3/helpers';\nimport {normalizeString} from '../../../util/helpers';\nimport {StoreState} from '../../../store/types';\nimport {SubgraphNetworkStatus} from '../../../store/subgraphNetworkStatus/types';\nimport {UNITS_ADDRESS} from '../../../config';\nimport {useENSName, useWeb3Modal} from '../../../components/web3/hooks';\n\ntype UseMembersReturn = {\n  members: Member[];\n  membersError: Error | undefined;\n  membersStatus: AsyncStatus;\n};\n\n/**\n * useMembers\n *\n * Gets DAO members from subgraph with direct onchain fallback.\n *\n * @returns {UseMembersReturn} An object with the members and the current async status.\n */\nexport default function useMembers(): UseMembersReturn {\n  /**\n   * Selectors\n   */\n\n  const DaoRegistryContract = useSelector(\n    (state: StoreState) => state.contracts.DaoRegistryContract\n  );\n\n  const BankExtensionContract = useSelector(\n    (state: StoreState) => state.contracts.BankExtensionContract\n  );\n\n  const subgraphNetworkStatus = useSelector(\n    (state: StoreState) => state.subgraphNetworkStatus.status\n  );\n\n  const connectedMember = useSelector(\n    (state: StoreState) => state.connectedMember\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  const [ensReverseResolvedAddresses, setAddressesToENSReverseResolve] =\n    useENSName(web3Instance);\n\n  /**\n   * GQL Query\n   */\n\n  const [getMembersFromSubgraphResult, {called, loading, data, error}] =\n    useLazyQuery(GET_MEMBERS, {\n      variables: {\n        daoAddress: DaoRegistryContract?.contractAddress.toLowerCase(),\n      },\n    });\n\n  /**\n   * State\n   */\n\n  const [members, setMembers] = useState<Member[]>([]);\n  const [membersError, setMembersError] = useState<Error>();\n\n  const [membersStatus, setMembersStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n\n  /**\n   * Cached callbacks\n   */\n\n  const getMembersFromRegistryCached = useCallback(getMembersFromRegistry, [\n    BankExtensionContract,\n    DaoRegistryContract,\n    setAddressesToENSReverseResolve,\n    web3Instance,\n  ]);\n\n  const getMembersFromSubgraphCached = useCallback(getMembersFromSubgraph, [\n    data,\n    error,\n    getMembersFromRegistryCached,\n    setAddressesToENSReverseResolve,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!called) {\n      getMembersFromSubgraphResult();\n    }\n  }, [called, getMembersFromSubgraphResult]);\n\n  useEffect(() => {\n    if (subgraphNetworkStatus === SubgraphNetworkStatus.OK) {\n      if (called && !loading && DaoRegistryContract?.contractAddress) {\n        getMembersFromSubgraphCached();\n      }\n    } else {\n      // If there is a subgraph network error fallback to fetching members info\n      // directly from smart contracts\n      getMembersFromRegistryCached();\n    }\n  }, [\n    DaoRegistryContract?.contractAddress,\n    called,\n    getMembersFromRegistryCached,\n    getMembersFromSubgraphCached,\n    loading,\n    subgraphNetworkStatus,\n  ]);\n\n  useEffect(() => {\n    connectedMember && getMembersFromRegistryCached();\n  }, [connectedMember, getMembersFromRegistryCached]);\n\n  /**\n   * Set `Member.addressENS`\n   *\n   * Will be the same as the `Member.address` if no ENS reverse resolution found.\n   */\n  useEffect(() => {\n    if (membersStatus !== AsyncStatus.FULFILLED) return;\n\n    setMembers((members) =>\n      members.map(\n        (m, i): Member => ({...m, addressENS: ensReverseResolvedAddresses[i]})\n      )\n    );\n  }, [ensReverseResolvedAddresses, membersStatus]);\n\n  /**\n   * Functions\n   */\n\n  function getMembersFromSubgraph() {\n    try {\n      setMembersStatus(AsyncStatus.PENDING);\n\n      if (data) {\n        // extract members from gql data\n        const {members} = data.tributeDaos[0] as Record<string, any>;\n\n        // Filter out any member that has fully ragequit (no positive balance in\n        // UNITS)\n        const filteredMembers = members.filter(\n          (member: Record<string, any>) => !member.didFullyRagequit\n        );\n\n        const filteredMembersWithDetails = filteredMembers.map(\n          (member: Record<string, any>) => {\n            // remove gql data that is no longer needed\n            const {createdAt, didFullyRagequit, ...parsedMember} = member;\n\n            return {\n              ...parsedMember,\n              // use formatted addresses\n              address: toChecksumAddress(member.address),\n              delegateKey: toChecksumAddress(member.delegateKey),\n            };\n          }\n        );\n\n        setMembersStatus(AsyncStatus.FULFILLED);\n        setMembers(filteredMembersWithDetails);\n\n        setAddressesToENSReverseResolve(\n          filteredMembersWithDetails.map((m: Member) => m.address)\n        );\n      } else {\n        if (error) {\n          throw new Error(`subgraph query error: ${error.message}`);\n        } else if (typeof data === 'undefined') {\n          // Additional case to catch `{\"errors\":{\"message\":\"No indexers found\n          // for subgraph deployment\"}}` which does not get returned as an error\n          // by the graph query call.\n          throw new Error('subgraph query error: data is undefined');\n        }\n      }\n    } catch (error) {\n      const {message} = error as Error;\n\n      // If there is a subgraph query error fallback to fetching members info\n      // directly from smart contracts\n      console.log(message);\n\n      getMembersFromRegistryCached();\n    }\n  }\n\n  async function getMembersFromRegistry() {\n    if (!DaoRegistryContract || !BankExtensionContract || !web3Instance) {\n      return;\n    }\n\n    try {\n      setMembersStatus(AsyncStatus.PENDING);\n\n      const {\n        abi: daoRegistryABI,\n        contractAddress: daoRegistryAddress,\n        instance: {methods: daoRegistryMethods},\n      } = DaoRegistryContract;\n\n      const nbMembers = await daoRegistryMethods.getNbMembers().call();\n\n      if (Number(nbMembers) > 0) {\n        // Build calls to get list of member addresses\n        const getMemberAddressABI = daoRegistryABI.find(\n          (item) => item.name === 'getMemberAddress'\n        );\n\n        const getMemberAddressCalls = [...Array(Number(nbMembers)).keys()].map(\n          (index): MulticallTuple => [\n            daoRegistryAddress,\n            getMemberAddressABI as AbiItem,\n            [index.toString()],\n          ]\n        );\n\n        const memberAddresses: string[] = await multicall({\n          calls: getMemberAddressCalls,\n          web3Instance,\n        });\n\n        // Build calls to get list of delegate addresses by member addresses\n        const getCurrentDelegateKeyABI = daoRegistryABI.find(\n          (item) => item.name === 'getCurrentDelegateKey'\n        );\n\n        const getCurrentDelegateKeyCalls = memberAddresses.map(\n          (address): MulticallTuple => [\n            daoRegistryAddress,\n            getCurrentDelegateKeyABI as AbiItem,\n            [address],\n          ]\n        );\n\n        const delegateKeys: string[] = await multicall({\n          calls: getCurrentDelegateKeyCalls,\n          web3Instance,\n        });\n\n        // Build calls to get member balances in UNITS\n        const {abi: bankABI, contractAddress: bankAddress} =\n          BankExtensionContract;\n\n        const balanceOfABI = bankABI.find((item) => item.name === 'balanceOf');\n        const unitsBalanceOfCalls = memberAddresses.map(\n          (address): MulticallTuple => [\n            bankAddress,\n            balanceOfABI as AbiItem,\n            [address, UNITS_ADDRESS],\n          ]\n        );\n\n        const unitsBalances: string[] = await multicall({\n          calls: unitsBalanceOfCalls,\n          web3Instance,\n        });\n\n        const membersWithDetails = memberAddresses.map((address, index) => ({\n          address,\n          delegateKey: delegateKeys[index],\n          isDelegated:\n            normalizeString(address) !== normalizeString(delegateKeys[index]),\n          units: unitsBalances[index],\n        }));\n\n        // Filter out any member addresses that don't have a positive balance in\n        // UNITS\n        const filteredMembersWithDetails = membersWithDetails\n          .filter((member) => toBN(member.units).gt(toBN(0)))\n          // display in descending order of when the member joined (e.g., newest\n          // member first)\n          .reverse();\n\n        setMembers(filteredMembersWithDetails);\n\n        setAddressesToENSReverseResolve(\n          filteredMembersWithDetails.map((m: Member) => m.address)\n        );\n      }\n\n      setMembersStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      const e = error as Error;\n\n      setMembersStatus(AsyncStatus.REJECTED);\n      setMembers([]);\n      setMembersError(e);\n    }\n  }\n\n  return {members, membersError, membersStatus};\n}\n","import {useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {useHistory, useParams} from 'react-router-dom';\n\nimport {useIsDefaultChain, useWeb3Modal} from '../../components/web3/hooks';\nimport {StoreState} from '../../store/types';\nimport {AsyncStatus} from '../../util/types';\nimport {CopyWithTooltip} from '../../components/common/CopyWithTooltip';\nimport {formatNumber, normalizeString} from '../../util/helpers';\nimport {Member} from './types';\nimport {useDaoTokenDetails} from '../../components/dao-token/hooks';\nimport {useDaoTotalUnits} from '../../hooks';\nimport DaoToken from '../../components/dao-token/DaoToken';\nimport Delegation from './Delegation';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderLarge from '../../components/feedback/LoaderLarge';\nimport useMembers from './hooks/useMembers';\nimport Wrap from '../../components/common/Wrap';\n\nexport default function MemberProfile() {\n  /**\n   * Selectors\n   */\n\n  const ERC20ExtensionContract = useSelector(\n    (state: StoreState) => state.contracts?.ERC20ExtensionContract\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account} = useWeb3Modal();\n  const {daoTokenDetails, daoTokenDetailsStatus} = useDaoTokenDetails();\n  const {defaultChainError} = useIsDefaultChain();\n  const {members, membersError, membersStatus} = useMembers();\n  const {totalUnitsIssued, totalUnitsStatus} = useDaoTotalUnits();\n\n  /**\n   * Their hooks\n   */\n\n  // Get ethereumAddress for fetching the member.\n  const {ethereumAddress} = useParams<{ethereumAddress: string}>();\n\n  /**\n   * State\n   */\n\n  const [memberDetails, setMemberDetails] = useState<Member>();\n  const [memberNotFound, setMemberNotFound] = useState<boolean>(false);\n\n  /**\n   * Effects\n   */\n\n  // Set member details\n  useEffect(() => {\n    if (membersStatus !== AsyncStatus.FULFILLED) return;\n\n    const activeMember = members.find(\n      (member) =>\n        normalizeString(member.address) === normalizeString(ethereumAddress)\n    );\n\n    setMemberDetails(activeMember);\n\n    if (!activeMember) {\n      setMemberNotFound(true);\n    }\n  }, [ethereumAddress, members, membersStatus]);\n\n  /**\n   * Variables\n   */\n\n  const error: Error | undefined = membersError || defaultChainError;\n  const isLoadingDone: boolean = membersStatus === AsyncStatus.FULFILLED;\n\n  const ensNameFound: boolean =\n    memberDetails?.addressENS &&\n    normalizeString(memberDetails?.addressENS) !==\n      normalizeString(memberDetails?.address)\n      ? true\n      : false;\n\n  const isLoading: boolean =\n    membersStatus === AsyncStatus.STANDBY ||\n    membersStatus === AsyncStatus.PENDING ||\n    (ERC20ExtensionContract && daoTokenDetailsStatus === AsyncStatus.STANDBY) ||\n    daoTokenDetailsStatus === AsyncStatus.PENDING ||\n    totalUnitsStatus === AsyncStatus.STANDBY ||\n    totalUnitsStatus === AsyncStatus.PENDING;\n\n  const isCurrentMemberConnected: boolean =\n    account &&\n    memberDetails &&\n    normalizeString(account) === normalizeString(memberDetails.address)\n      ? true\n      : false;\n\n  const isCurrentMemberOrDelegateConnected: boolean =\n    account &&\n    memberDetails &&\n    (normalizeString(account) === normalizeString(memberDetails.address) ||\n      normalizeString(account) === normalizeString(memberDetails.delegateKey))\n      ? true\n      : false;\n\n  const votingWeight =\n    memberDetails && typeof totalUnitsIssued === 'number'\n      ? ((Number(memberDetails.units) / totalUnitsIssued) * 100).toFixed(2)\n      : '';\n\n  /**\n   * Functions\n   */\n\n  function renderMemberInfo() {\n    if (!memberDetails) return;\n\n    return (\n      <div>\n        <div className=\"memberprofile__info-item\">\n          {daoTokenDetails ? (\n            <>\n              <div>DAO Tokens</div>\n              <div>{`${formatNumber(memberDetails.units)} ${\n                daoTokenDetails.symbol || 'tokens'\n              }`}</div>\n              {isCurrentMemberConnected && (\n                <small>\n                  <DaoToken daoTokenDetails={daoTokenDetails} />\n                </small>\n              )}\n            </>\n          ) : (\n            <>\n              <div>Membership Units</div>\n              <div>{formatNumber(memberDetails.units)}</div>\n            </>\n          )}\n        </div>\n        <div className=\"memberprofile__info-item\">\n          <div>Voting Weight</div>\n          <div>{`${votingWeight}%`}</div>\n        </div>\n      </div>\n    );\n  }\n\n  function renderMemberActions() {\n    if (isCurrentMemberOrDelegateConnected) {\n      return (\n        <div>\n          <div className=\"memberprofile__action\">\n            <div className=\"memberprofile__action-header\">Delegation</div>\n            <Delegation />\n          </div>\n        </div>\n      );\n    } else {\n      return (\n        <div className=\"memberprofile__actions-unavailable\">\n          Connect your wallet with this member address (or its delegate) to view\n          available actions.\n        </div>\n      );\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <RenderWrapper>\n        <div className=\"loader--large-container\">\n          <LoaderLarge />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center\">\n          <ErrorMessageWithDetails\n            error={error}\n            renderText=\"Something went wrong while getting the member.\"\n          />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render no member found\n  if (memberNotFound && isLoadingDone) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center error-message\">\n          <p>Member not found.</p>\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      {memberDetails ? (\n        <>\n          <div className=\"memberprofile__header\">Member Profile</div>\n          <div className=\"proposaldetails\">\n            {/* LEFT COLUMN */}\n\n            <div className=\"memberprofile__left-column\">\n              {/* MEMBER ADDRESS */}\n              <CopyWithTooltip\n                render={({elementRef, isCopied, setCopied, tooltipID}) => (\n                  <h3 onClick={setCopied}>\n                    <span\n                      data-for={tooltipID}\n                      data-tip={\n                        isCopied\n                          ? 'copied!'\n                          : ensNameFound\n                          ? `${memberDetails.addressENS} (${memberDetails.address})`\n                          : 'copy'\n                      }\n                      ref={elementRef}>\n                      {memberDetails.addressENS || memberDetails.address}\n                    </span>\n                  </h3>\n                )}\n                textToCopy={memberDetails.address}\n              />\n\n              {/* MEMBER INFO */}\n              {renderMemberInfo()}\n            </div>\n\n            {/* RIGHT COLUMN */}\n            <div className=\"memberprofile__right-column\">\n              {/* MEMBER ACTIONS */}\n              {renderMemberActions()}\n            </div>\n          </div>\n        </>\n      ) : (\n        // Render nothing. Should never reach this case.\n        <></>\n      )}\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function viewAll(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n    history.push('/members');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Members</h2>\n          <button className=\"titlebar__action\" onClick={viewAll}>\n            View all\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {Link} from 'react-router-dom';\nimport {v4 as uuidv4} from 'uuid';\n\nimport {\n  formatNumber,\n  formatNumberAbbreviated,\n  normalizeString,\n} from '../../util/helpers';\nimport {Member} from './types';\nimport {useRef} from 'react';\nimport {useWeb3Modal} from '../../components/web3/hooks';\nimport ReactTooltip from 'react-tooltip';\n\ntype MemberCardProps = {\n  member: Member;\n  to?: string;\n};\n\nconst DEFAULT_CARD_LINK: string = '#';\nconst TOOLTIP_DELAY: number = 200;\n\n/**\n * Shows a preview of a member's profile\n *\n * @param {MemberCardProps} props\n * @returns {JSX.Element}\n */\nexport default function MemberCard(props: MemberCardProps): JSX.Element {\n  const {member, to = DEFAULT_CARD_LINK} = props;\n\n  /**\n   * Our hooks\n   */\n\n  const {account} = useWeb3Modal();\n\n  /**\n   * Refs\n   */\n\n  const ensTooltipIDRef = useRef<string>(uuidv4());\n  const titleTooltipIDRef = useRef<string>(uuidv4());\n  const unitsTooltipIDRef = useRef<string>(uuidv4());\n\n  /**\n   * Variables\n   */\n\n  const {units} = member;\n  const unitAbbreviated: string = formatNumberAbbreviated(Number(units));\n  const unitsFormatted: string = formatNumber(units);\n\n  const ensNameFound: boolean =\n    member?.addressENS &&\n    normalizeString(member?.addressENS) !== normalizeString(member?.address)\n      ? true\n      : false;\n\n  const addressTooltipText: string = ensNameFound\n    ? `${member.addressENS} (${member.address})`\n    : member.address;\n\n  /**\n   * Render\n   */\n\n  return (\n    <Link className={'membercard__link'} to={to}>\n      <div\n        className={`membercard ${\n          account &&\n          (normalizeString(account) === normalizeString(member.address) ||\n            normalizeString(account) === normalizeString(member.delegateKey))\n            ? `membercard--connected-account`\n            : ''\n        }`}>\n        {/* ROW 1 */}\n        <div className=\"membercard__row\">\n          {/* TITLE */}\n          <h3\n            className=\"membercard__title\"\n            data-for={titleTooltipIDRef.current}\n            data-tip={addressTooltipText}>\n            {member.address}\n          </h3>\n\n          <ReactTooltip\n            delayShow={TOOLTIP_DELAY}\n            effect=\"solid\"\n            id={titleTooltipIDRef.current}\n          />\n\n          {/* UNITS */}\n          <span\n            className=\"membercard__units\"\n            data-for={unitsTooltipIDRef.current}\n            data-tip={`${unitsFormatted} unit${\n              Number(units) === 1 ? '' : 's'\n            }`}>\n            {unitAbbreviated}\n          </span>\n\n          <ReactTooltip\n            delayShow={TOOLTIP_DELAY}\n            effect=\"solid\"\n            id={unitsTooltipIDRef.current}\n          />\n        </div>\n\n        {/* ROW 2 */}\n        {ensNameFound && member?.addressENS && (\n          <div className=\"membercard__row\">\n            {/* ENS */}\n            <span\n              className=\"membercard__ens\"\n              data-for={ensTooltipIDRef.current}\n              data-tip={addressTooltipText}>\n              {member?.addressENS}\n            </span>\n\n            <ReactTooltip\n              delayShow={TOOLTIP_DELAY}\n              effect=\"solid\"\n              id={ensTooltipIDRef.current}\n            />\n          </div>\n        )}\n      </div>\n    </Link>\n  );\n}\n","import {AsyncStatus} from '../../util/types';\nimport {Member} from './types';\nimport {useIsDefaultChain} from '../../components/web3/hooks';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderLarge from '../../components/feedback/LoaderLarge';\nimport MemberCard from './MemberCard';\nimport useMembers from './hooks/useMembers';\nimport Wrap from '../../components/common/Wrap';\n\nfunction renderMemberCards(members: Member[]): JSX.Element[] {\n  return members.map((member) => {\n    return (\n      <MemberCard\n        key={member.address}\n        to={`/members/${member.address}`}\n        member={member}\n      />\n    );\n  });\n}\n\nexport default function Members() {\n  /**\n   * Our hooks\n   */\n\n  const {members, membersError, membersStatus} = useMembers();\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const isLoading: boolean =\n    membersStatus === AsyncStatus.STANDBY ||\n    membersStatus === AsyncStatus.PENDING;\n\n  const isLoadingDone: boolean = membersStatus === AsyncStatus.FULFILLED;\n\n  const error: Error | undefined = membersError || defaultChainError;\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <RenderWrapper>\n        <div className=\"loader--large-container\">\n          <LoaderLarge />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center\">\n          <ErrorMessageWithDetails\n            error={error}\n            renderText=\"Something went wrong while getting the members.\"\n          />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render no members\n  if (!Object.values(members).length && isLoadingDone) {\n    return (\n      <RenderWrapper>\n        <p className=\"text-center\">No members, yet!</p>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      <div className=\"grid--fluid grid-container\">\n        {/* ACTIVE MEMBERS */}\n        <div>\n          <div className=\"grid__header\">Active Members</div>\n          <div className=\"grid__cards\">{renderMemberCards(members)}</div>\n        </div>\n      </div>\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Members</h2>\n        </div>\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {Fragment, useEffect, useMemo, useState} from 'react';\n\nimport {\n  DaoAdapterConstants,\n  VotingAdapterName,\n} from '../adapters-extensions/enums';\nimport {\n  calculateVotingTimeRanges,\n  proposalHasFlag,\n  proposalHasVotingState,\n} from './helpers';\nimport {AsyncStatus} from '../../util/types';\nimport {BURN_ADDRESS} from '../../util/constants';\nimport {ContractDAOConfigKeys} from '../web3/types';\nimport {normalizeString} from '../../util/helpers';\nimport {OffchainVotingStatus} from './voting';\nimport {ProposalData, ProposalFlag} from './types';\nimport {ProposalHeaderNames} from '../../util/enums';\nimport {useDaoConfigurations} from '../../hooks';\nimport {useIsDefaultChain} from '../web3/hooks';\nimport {useProposals, useOffchainVotingResults} from './hooks';\nimport {VotingState} from './voting/types';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport LoaderLarge from '../feedback/LoaderLarge';\nimport ProposalCard from './ProposalCard';\n\ntype ProposalsProps = {\n  adapterName: DaoAdapterConstants;\n  /**\n   * Optionally provide a click handler for `ProposalCard`.\n   * The proposal's id (in the DAO) will be provided as an argument.\n   * Defaults to noop: `() => {}`\n   */\n  onProposalClick?: (id: string) => void;\n  /**\n   * The path to link to. Defaults to `${location.pathname}/${proposalOnClickId}`.\n   */\n  proposalLinkPath?: Parameters<typeof ProposalCard>['0']['linkPath'];\n  /**\n   * Optionally render a custom proposal card.\n   */\n  renderProposalCard?: (data: {proposalData: ProposalData}) => React.ReactNode;\n  /**\n   * To handle proposal types where the first step is creating a snapshot\n   * draft/offchain proposal only (no onchain proposal exists)\n   */\n  includeProposalsExistingOnlyOffchain?: boolean;\n};\n\ntype FilteredProposals = {\n  failedProposals: ProposalData[];\n  nonsponsoredProposals: ProposalData[];\n  passedProposals: ProposalData[];\n  votingProposals: ProposalData[];\n};\n\nconst configurationKeysToGet: ContractDAOConfigKeys[] = [\n  ContractDAOConfigKeys.offchainVotingVotingPeriod,\n  ContractDAOConfigKeys.offchainVotingGracePeriod,\n];\n\nexport default function Proposals(props: ProposalsProps): JSX.Element {\n  const {\n    adapterName,\n    onProposalClick = () => {},\n    proposalLinkPath,\n    renderProposalCard,\n    includeProposalsExistingOnlyOffchain = false,\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [proposalsForVotingResults, setProposalsForVotingResults] = useState<\n    ProposalData['snapshotProposal'][]\n  >([]);\n\n  const [filteredProposals, setFilteredProposals] = useState<FilteredProposals>(\n    {\n      failedProposals: [],\n      nonsponsoredProposals: [],\n      passedProposals: [],\n      votingProposals: [],\n    }\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {\n    daoConfigurations: [offchainVotingPeriod, offchainGracePeriod],\n  } = useDaoConfigurations(configurationKeysToGet);\n\n  const {proposals, proposalsError, proposalsStatus} = useProposals(\n    useMemo(\n      () => ({\n        adapterName,\n        includeProposalsExistingOnlyOffchain,\n      }),\n      [adapterName, includeProposalsExistingOnlyOffchain]\n    )\n  );\n\n  const {\n    offchainVotingResults,\n    offchainVotingResultsError,\n    offchainVotingResultsStatus,\n  } = useOffchainVotingResults(proposalsForVotingResults);\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const {\n    failedProposals,\n    nonsponsoredProposals,\n    passedProposals,\n    votingProposals,\n  } = filteredProposals;\n\n  const isLoading: boolean =\n    proposalsStatus === AsyncStatus.STANDBY ||\n    proposalsStatus === AsyncStatus.PENDING ||\n    // Getting ready to fetch using `useOffchainVotingResults`; helps to show\n    // continuous loader.\n    (offchainVotingResultsStatus === AsyncStatus.STANDBY &&\n      proposalsForVotingResults.length > 0) ||\n    offchainVotingResultsStatus === AsyncStatus.PENDING;\n\n  const error: Error | undefined =\n    proposalsError || offchainVotingResultsError || defaultChainError;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    setProposalsForVotingResults(proposals.map((p) => p.snapshotProposal));\n  }, [proposals]);\n\n  // Separate proposals into categories: non-sponsored, voting, passed, failed\n  useEffect(() => {\n    if (proposalsStatus !== AsyncStatus.FULFILLED) return;\n\n    const filteredProposalsToSet: FilteredProposals = {\n      failedProposals: [],\n      nonsponsoredProposals: [],\n      passedProposals: [],\n      votingProposals: [],\n    };\n\n    proposals.forEach((p) => {\n      const {\n        daoProposal,\n        daoProposalVotingState: voteState,\n        daoProposalVote: votesData,\n      } = p;\n\n      if (!daoProposal) return;\n\n      const noSnapshotVotes: boolean = p.snapshotProposal?.votes?.length === 0;\n\n      const offchainResultNotYetSubmitted: boolean =\n        voteState !== undefined &&\n        (proposalHasVotingState(VotingState.GRACE_PERIOD, voteState) ||\n          proposalHasVotingState(VotingState.TIE, voteState)) &&\n        proposalHasFlag(ProposalFlag.SPONSORED, daoProposal.flags) &&\n        votesData?.OffchainVotingContract?.reporter === BURN_ADDRESS;\n\n      // Non-sponsored proposal\n      if (voteState === undefined) {\n        if (includeProposalsExistingOnlyOffchain) {\n          filteredProposalsToSet.nonsponsoredProposals.push(p);\n        } else if (proposalHasFlag(ProposalFlag.EXISTS, daoProposal.flags)) {\n          filteredProposalsToSet.nonsponsoredProposals.push(p);\n        }\n\n        return;\n      }\n\n      // Passed proposal\n      if (\n        voteState !== undefined &&\n        proposalHasVotingState(VotingState.PASS, voteState) &&\n        (proposalHasFlag(ProposalFlag.SPONSORED, daoProposal.flags) ||\n          proposalHasFlag(ProposalFlag.PROCESSED, daoProposal.flags))\n      ) {\n        filteredProposalsToSet.passedProposals.push(p);\n\n        return;\n      }\n\n      const offchainResult = offchainVotingResults.find(\n        ([proposalHash, _result]) =>\n          normalizeString(proposalHash) ===\n          normalizeString(p.snapshotProposal?.idInDAO || '')\n      )?.[1];\n\n      // Did the vote pass by a simple majority?\n      const didPassSimpleMajority: boolean = offchainResult\n        ? offchainResult.Yes.units > offchainResult.No.units\n        : false;\n\n      /**\n       * Voting proposal: voting has ended, off-chain result was not submitted,\n       * and there are votes with a passing result (need to submit to get true\n       * \"passed\" result).\n       *\n       * @note For now, we can assume across all adapters that if the vote did\n       * not pass then the result does not need to be submitted (proposal would\n       * fall back to \"failed\" logic).\n       *\n       * @note Should be placed before \"failed\" logic.\n       */\n      if (\n        offchainResultNotYetSubmitted &&\n        noSnapshotVotes === false &&\n        didPassSimpleMajority\n      ) {\n        filteredProposalsToSet.votingProposals.push(p);\n\n        return;\n      }\n\n      // Failed proposal\n      if (\n        voteState !== undefined &&\n        (proposalHasVotingState(VotingState.NOT_PASS, voteState) ||\n          proposalHasVotingState(VotingState.TIE, voteState)) &&\n        (proposalHasFlag(ProposalFlag.SPONSORED, daoProposal.flags) ||\n          proposalHasFlag(ProposalFlag.PROCESSED, daoProposal.flags))\n      ) {\n        filteredProposalsToSet.failedProposals.push(p);\n\n        return;\n      }\n\n      // Failed proposal: no Snapshot votes\n      if (\n        voteState !== undefined &&\n        offchainResultNotYetSubmitted &&\n        noSnapshotVotes\n      ) {\n        filteredProposalsToSet.failedProposals.push(p);\n\n        return;\n      }\n\n      // Failed proposal: result not submitted; vote did not pass\n      if (\n        voteState !== undefined &&\n        offchainResultNotYetSubmitted &&\n        !didPassSimpleMajority\n      ) {\n        filteredProposalsToSet.failedProposals.push(p);\n\n        return;\n      }\n\n      // Voting proposal\n      if (\n        voteState !== undefined &&\n        (proposalHasVotingState(VotingState.GRACE_PERIOD, voteState) ||\n          proposalHasVotingState(VotingState.IN_PROGRESS, voteState)) &&\n        proposalHasFlag(ProposalFlag.SPONSORED, daoProposal.flags)\n      ) {\n        filteredProposalsToSet.votingProposals.push(p);\n\n        return;\n      }\n    });\n\n    setFilteredProposals((prevState) => ({\n      ...prevState,\n      ...filteredProposalsToSet,\n    }));\n  }, [\n    includeProposalsExistingOnlyOffchain,\n    offchainVotingResults,\n    proposals,\n    proposalsStatus,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  function renderProposalCards(\n    proposals: ProposalData[]\n  ): React.ReactNode | null {\n    return proposals.map((proposal) => {\n      const {\n        daoProposalVote,\n        daoProposalVotingAdapter,\n        snapshotDraft,\n        snapshotProposal,\n      } = proposal;\n\n      const proposalId = snapshotDraft?.idInDAO || snapshotProposal?.idInDAO;\n      const votingAdapterName = daoProposalVotingAdapter?.votingAdapterName;\n\n      let gracePeriodEndMs: number = 0;\n      let gracePeriodStartMs: number = 0;\n      let voteEndMs: number = 0;\n      let voteStartMs: number = 0;\n\n      switch (votingAdapterName) {\n        case VotingAdapterName.OffchainVotingContract:\n          const {startingTime, gracePeriodStartingTime} =\n            daoProposalVote?.[VotingAdapterName.OffchainVotingContract] || {};\n\n          const times = calculateVotingTimeRanges({\n            gracePeriodLength: offchainGracePeriod,\n            gracePeriodStartingTime,\n            votePeriodLength: offchainVotingPeriod,\n            voteStartingTime: startingTime,\n          });\n\n          gracePeriodEndMs = times.gracePeriodEndMs;\n          gracePeriodStartMs = times.gracePeriodStartMs;\n          voteEndMs = times.voteEndMs;\n          voteStartMs = times.voteStartMs;\n\n          break;\n\n        // @todo On-chain Voting\n        // case VotingAdapterName.VotingContract:\n        //   return <></>\n        default:\n          break;\n      }\n\n      if (!proposalId) return null;\n\n      if (renderProposalCard) {\n        return (\n          <Fragment key={proposalId}>\n            {renderProposalCard({proposalData: proposal})}\n          </Fragment>\n        );\n      }\n\n      const proposalName =\n        snapshotDraft?.msg.payload.name ||\n        snapshotProposal?.msg.payload.name ||\n        '';\n\n      const votingResult = offchainVotingResults.find(\n        ([proposalHash, _result]) =>\n          normalizeString(proposalHash) === normalizeString(proposalId)\n      )?.[1];\n\n      return (\n        <ProposalCard\n          key={proposalId}\n          linkPath={proposalLinkPath}\n          name={proposalName}\n          onClick={onProposalClick}\n          proposalOnClickId={proposalId}\n          renderStatus={() => {\n            switch (votingAdapterName) {\n              case VotingAdapterName.OffchainVotingContract:\n                return (\n                  <OffchainVotingStatus\n                    countdownGracePeriodEndMs={gracePeriodEndMs}\n                    countdownGracePeriodStartMs={gracePeriodStartMs}\n                    countdownVotingEndMs={voteEndMs}\n                    countdownVotingStartMs={voteStartMs}\n                    votingResult={votingResult}\n                  />\n                );\n              // @todo On-chain Voting\n              // case VotingAdapterName.VotingContract:\n              //   return <></>\n              default:\n                return <></>;\n            }\n          }}\n        />\n      );\n    });\n  }\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <div className=\"loader--large-container\">\n        <LoaderLarge />\n      </div>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <div className=\"text-center\">\n        <ErrorMessageWithDetails\n          error={error}\n          renderText=\"Something went wrong while getting the proposals.\"\n        />\n      </div>\n    );\n  }\n\n  // Render no proposals\n  if (\n    !Object.values(filteredProposals).flatMap((p) => p).length &&\n    proposalsStatus === AsyncStatus.FULFILLED\n  ) {\n    return <p className=\"text-center\">No proposals, yet!</p>;\n  }\n\n  // Render proposals\n  return (\n    <div className=\"grid--fluid grid-container\">\n      {/* VOTING PROPOSALS */}\n      {votingProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.VOTING}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(votingProposals)}\n          </div>\n        </>\n      )}\n\n      {/* PENDING PROPOSALS (DRAFTS, NOT SPONSORED) */}\n      {nonsponsoredProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.REQUESTS}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(nonsponsoredProposals)}\n          </div>\n        </>\n      )}\n\n      {/* PASSED PROPOSALS */}\n      {passedProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.PASSED}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(passedProposals)}\n          </div>\n        </>\n      )}\n\n      {/* FAILED PROPOSALS */}\n      {failedProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.FAILED}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(failedProposals)}\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n","import React from 'react';\nimport {useHistory} from 'react-router-dom';\n\nimport {DaoAdapterConstants} from '../../components/adapters-extensions/enums';\nimport FadeIn from '../../components/common/FadeIn';\nimport Proposals from '../../components/proposals/Proposals';\nimport Wrap from '../../components/common/Wrap';\n\nexport default function Onboarding() {\n  /**\n   * Functions\n   */\n\n  function proposalLinkPath(id: string) {\n    return `/onboarding/${id}`;\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <RenderWrapper>\n      <Proposals\n        adapterName={DaoAdapterConstants.ONBOARDING}\n        proposalLinkPath={proposalLinkPath}\n        includeProposalsExistingOnlyOffchain={true}\n      />\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function goToNewProposal(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n    history.push('/onboard');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Onboarding</h2>\n          <button className=\"titlebar__action\" onClick={goToNewProposal}>\n            Onboard\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {useState, useRef, useEffect, useCallback} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {AbiItem, toBN} from 'web3-utils';\n\nimport {CycleEllipsis} from '../feedback';\nimport {ETH_TOKEN_ADDRESS, ONBOARDING_TOKEN_ADDRESS} from '../../config';\nimport {getConnectedMember} from '../../store/actions';\nimport {ProposalData, SnapshotProposal} from './types';\nimport {ReduxDispatch, StoreState} from '../../store/types';\nimport {TX_CYCLE_MESSAGES} from '../web3/config';\nimport {useContractSend, useETHGasPrice, useWeb3Modal} from '../web3/hooks';\nimport {useDaoTokenDetails} from '../dao-token/hooks';\nimport {useMemberActionDisabled} from '../../hooks';\nimport {Web3TxStatus} from '../web3/types';\nimport CycleMessage from '../feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport EtherscanURL from '../web3/EtherscanURL';\nimport FadeIn from '../common/FadeIn';\nimport Loader from '../feedback/Loader';\n\ntype ProcessArguments = [\n  dao: string, // `dao`\n  proposalId: string // `proposalId`\n];\n\ntype TokenApproveArguments = [\n  spender: string, // `spender`\n  amount: string // `amount`\n];\n\ntype ProcessActionOnboardingProps = {\n  disabled?: boolean;\n  proposal: ProposalData;\n};\n\ntype BN = ReturnType<typeof toBN>;\n\ntype ActionDisabledReasons = {\n  notProposerMessage: string;\n};\n\n/**\n * Cached outside the component to prevent infinite re-renders.\n *\n * The same can be accomplished inside the component using\n * `useState`, `useRef`, etc., depending on the use case.\n */\nconst useMemberActionDisabledProps = {\n  // Anyone can process a proposal - it's just a question of gas payment.\n  skipIsActiveMemberCheck: true,\n};\n\nconst isERC20Onboarding = ONBOARDING_TOKEN_ADDRESS !== ETH_TOKEN_ADDRESS;\n\nfunction renderSubmitStatus({\n  txEtherscanURL,\n  txStatus,\n  txEtherscanURLTokenApprove,\n  txStatusTokenApprove,\n}: {\n  txEtherscanURL: string;\n  txStatus: Web3TxStatus;\n  txEtherscanURLTokenApprove: string;\n  txStatusTokenApprove: string;\n}): React.ReactNode {\n  // token approve transaction statuses\n  if (txStatusTokenApprove === Web3TxStatus.AWAITING_CONFIRM) {\n    return (\n      <>\n        Confirm to transfer your tokens\n        <CycleEllipsis intervalMs={500} />\n      </>\n    );\n  }\n\n  if (txStatusTokenApprove === Web3TxStatus.PENDING) {\n    return (\n      <>\n        <div>\n          Approving your tokens for transfer\n          <CycleEllipsis intervalMs={500} />\n        </div>\n\n        <EtherscanURL url={txEtherscanURLTokenApprove} isPending />\n      </>\n    );\n  }\n\n  // process proposal transaction statuses\n  switch (txStatus) {\n    case Web3TxStatus.AWAITING_CONFIRM:\n      return (\n        <>\n          Confirm to process the proposal\n          <CycleEllipsis intervalMs={500} />\n        </>\n      );\n    case Web3TxStatus.PENDING:\n      return (\n        <>\n          <CycleMessage\n            intervalMs={2000}\n            messages={TX_CYCLE_MESSAGES}\n            useFirstItemStart\n            render={(message) => {\n              return <FadeIn key={message}>{message}</FadeIn>;\n            }}\n          />\n\n          <EtherscanURL url={txEtherscanURL} isPending />\n        </>\n      );\n    case Web3TxStatus.FULFILLED:\n      return (\n        <>\n          <div>Proposal processed!</div>\n\n          <EtherscanURL url={txEtherscanURL} />\n        </>\n      );\n    default:\n      return null;\n  }\n}\n\nexport default function ProcessActionOnboarding(\n  props: ProcessActionOnboardingProps\n) {\n  const {\n    disabled: propsDisabled,\n    proposal: {snapshotProposal},\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n\n  const [onboardingProposalAmount, setOnboardingProposalAmount] =\n    useState<string>();\n\n  /**\n   * Refs\n   */\n\n  const actionDisabledReasonsRef = useRef<ActionDisabledReasons>({\n    notProposerMessage: '',\n  });\n\n  /**\n   * Selectors\n   */\n\n  const OnboardingContract = useSelector(\n    (s: StoreState) => s.contracts?.OnboardingContract\n  );\n\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account, web3Instance} = useWeb3Modal();\n\n  const {txEtherscanURL, txIsPromptOpen, txSend, txStatus} = useContractSend();\n\n  const {average: gasPrice} = useETHGasPrice();\n\n  const {\n    txEtherscanURL: txEtherscanURLTokenApprove,\n    txIsPromptOpen: txIsPromptOpenTokenApprove,\n    txSend: txSendTokenApprove,\n    txStatus: txStatusTokenApprove,\n  } = useContractSend();\n\n  const {\n    isDisabled,\n    openWhyDisabledModal,\n    WhyDisabledModal,\n    setOtherDisabledReasons,\n  } = useMemberActionDisabled(useMemberActionDisabledProps);\n\n  const {daoTokenDetails} = useDaoTokenDetails();\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * Variables\n   */\n\n  const isInProcess =\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING ||\n    txStatusTokenApprove === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatusTokenApprove === Web3TxStatus.PENDING;\n\n  const isDone = txStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone =\n    isInProcess || isDone || txIsPromptOpen || txIsPromptOpenTokenApprove;\n\n  const areSomeDisabled = isDisabled || isInProcessOrDone || propsDisabled;\n\n  /**\n   * Cached callbacks\n   */\n\n  const getOnboardingProposalAmountCached = useCallback(\n    getOnboardingProposalAmount,\n    [OnboardingContract, daoRegistryContract?.contractAddress, snapshotProposal]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getOnboardingProposalAmountCached();\n  }, [getOnboardingProposalAmountCached]);\n\n  useEffect(() => {\n    // 1. Determine and set reasons why action would be disabled\n\n    // Reason: For some proposal types, a passed proposal can only be\n    // processed by its original proposer (e.g., the owner of the asset to be\n    // transferred)\n\n    // Proposals with this restriction will have this value stored in its\n    // snapshot metadata.\n    const {accountAuthorizedToProcessPassedProposal} = (\n      snapshotProposal as SnapshotProposal\n    ).msg.payload.metadata;\n\n    if (accountAuthorizedToProcessPassedProposal && account) {\n      actionDisabledReasonsRef.current = {\n        ...actionDisabledReasonsRef.current,\n        notProposerMessage:\n          accountAuthorizedToProcessPassedProposal.toLowerCase() !==\n          account.toLowerCase()\n            ? 'Only the original proposer can process the proposal.'\n            : '',\n      };\n    }\n\n    // 2. Set reasons\n    setOtherDisabledReasons(Object.values(actionDisabledReasonsRef.current));\n  }, [account, setOtherDisabledReasons, snapshotProposal]);\n\n  /**\n   * Functions\n   */\n\n  async function getOnboardingProposalAmount() {\n    try {\n      if (\n        !daoRegistryContract?.contractAddress ||\n        !OnboardingContract ||\n        !snapshotProposal\n      ) {\n        return;\n      }\n\n      const proposalDetails = await OnboardingContract.instance.methods\n        .proposals(\n          daoRegistryContract.contractAddress,\n          snapshotProposal.idInDAO\n        )\n        .call();\n\n      setOnboardingProposalAmount(proposalDetails.amount);\n    } catch (error) {\n      console.error(error);\n      setOnboardingProposalAmount(undefined);\n    }\n  }\n\n  async function handleSubmitTokenApprove(erc20AmountBN: BN) {\n    try {\n      if (!ONBOARDING_TOKEN_ADDRESS) {\n        throw new Error(\n          'No Onboarding ERC20 address was found. Are you sure it is set?'\n        );\n      }\n\n      if (!OnboardingContract) {\n        throw new Error('No OnboardingContract found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      const {default: lazyERC20ABI} = await import(\n        '../../abis/external/ERC20.json'\n      );\n      const erc20Contract: AbiItem[] = lazyERC20ABI as any;\n\n      const erc20Instance = new web3Instance.eth.Contract(\n        erc20Contract,\n        ONBOARDING_TOKEN_ADDRESS\n      );\n\n      // Value to check if adapter is allowed to spend amount of tribute tokens\n      // on behalf of owner. If allowance is not sufficient, the owner will\n      // approve the adapter to spend the amount of tokens needed for the owner\n      // to provide the full tribute amount.\n      const allowance = await erc20Instance.methods\n        .allowance(account, OnboardingContract.contractAddress)\n        .call();\n\n      const allowanceBN = toBN(allowance);\n\n      if (erc20AmountBN.gt(allowanceBN)) {\n        const difference = erc20AmountBN.sub(allowanceBN);\n        const approveAmount = allowanceBN.add(difference);\n        const tokenApproveArguments: TokenApproveArguments = [\n          OnboardingContract.contractAddress,\n          String(approveAmount),\n        ];\n        const txArguments = {\n          from: account || '',\n          ...(gasPrice ? {gasPrice} : null),\n        };\n\n        // Execute contract call for `approve`\n        await txSendTokenApprove(\n          'approve',\n          erc20Instance.methods,\n          tokenApproveArguments,\n          txArguments\n        );\n      }\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async function handleSubmit() {\n    try {\n      if (!daoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      if (!snapshotProposal) {\n        throw new Error('No Snapshot proposal was found.');\n      }\n\n      if (!OnboardingContract) {\n        throw new Error('No OnboardingContract found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      if (!onboardingProposalAmount) {\n        throw new Error('No proposal amount found.');\n      }\n\n      if (isERC20Onboarding) {\n        // ERC20 onboarding\n        const erc20AmountBN = toBN(onboardingProposalAmount);\n        await handleSubmitTokenApprove(erc20AmountBN);\n      }\n\n      const processArguments: ProcessArguments = [\n        daoRegistryContract.contractAddress,\n        snapshotProposal.idInDAO,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(gasPrice ? {gasPrice} : null),\n        ...(isERC20Onboarding ? null : {value: onboardingProposalAmount}),\n      };\n\n      const txReceipt = await txSend(\n        'processProposal',\n        OnboardingContract.instance.methods,\n        processArguments,\n        txArguments\n      );\n\n      if (txReceipt) {\n        // re-fetch member\n        await dispatch(\n          getConnectedMember({\n            account,\n            daoRegistryContract,\n            web3Instance,\n          })\n        );\n\n        // if connected account is the applicant (the address that will receive\n        // the membership units) suggest adding DAO token to wallet\n        if (\n          account.toLowerCase() ===\n          snapshotProposal.msg.payload.metadata.submitActionArgs[0].toLowerCase()\n        ) {\n          await addTokenToWallet();\n        }\n      }\n    } catch (error) {\n      // Set any errors from Web3 utils or explicitly set above.\n      const e = error as Error;\n\n      setSubmitError(e);\n    }\n  }\n\n  async function addTokenToWallet() {\n    if (!daoTokenDetails) return;\n\n    try {\n      await window.ethereum.request({\n        method: 'wallet_watchAsset',\n        params: {\n          type: 'ERC20',\n          options: daoTokenDetails,\n        },\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      <div>\n        <button\n          className=\"proposaldetails__button\"\n          disabled={areSomeDisabled}\n          onClick={areSomeDisabled ? () => {} : handleSubmit}>\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Process'}\n        </button>\n\n        <ErrorMessageWithDetails\n          error={submitError}\n          renderText=\"Something went wrong\"\n        />\n\n        {/* SUBMIT STATUS */}\n\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus({\n              txEtherscanURL,\n              txStatus,\n              txEtherscanURLTokenApprove,\n              txStatusTokenApprove,\n            })}\n          </div>\n        )}\n\n        {isDisabled && (\n          <button\n            className=\"button--help-centered\"\n            onClick={openWhyDisabledModal}>\n            Why is processing disabled?\n          </button>\n        )}\n      </div>\n\n      <WhyDisabledModal title=\"Why is processing disabled?\" />\n    </>\n  );\n}\n","import {lazy, Suspense} from 'react';\nimport {useSelector} from 'react-redux';\n\nimport {ContractAdapterNames} from '../web3/types';\nimport {CycleEllipsis} from '../feedback';\nimport {ProposalData, RenderActionPropArguments} from './types';\nimport {StoreState} from '../../store/types';\nimport {VotingAdapterName} from '../adapters-extensions/enums';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\n\ntype ProposalActionsProps = {\n  adapterName: ContractAdapterNames;\n  proposal: ProposalData;\n  /**\n   * A render prop which can render any action desired.\n   * It is passed inner state and data from\n   * the child action wrapper component.\n   *\n   * - If it renders `null`, it will fall back to the component's actions.\n   * - If it renders `<></>` (`React.Fragment`) then nothing is shown in the UI.\n   */\n  renderAction?: (data: RenderActionPropArguments) => React.ReactNode;\n};\n\n/**\n * Lazy load action component tree\n */\nconst ProposalWithOffchainVoteActions = lazy(\n  () => import('./ProposalWithOffchainVoteActions')\n);\n\nconst fadeInProps = {duration: 150};\nconst cycleEllipsisStyles = {\n  display: 'inline-block',\n  width: '100%',\n  fontSize: '1.5rem',\n};\n\n/**\n * ProposalActions\n *\n * A container for various propsal action flows.\n * Which flow is chosen is determined by either the proposal's,\n * or the DAO's, voting adapter name.\n *\n * @param {ProposalActionsProps} props\n * @returns {JSX.Element}\n */\nexport default function ProposalActions(\n  props: ProposalActionsProps\n): JSX.Element {\n  const {adapterName, proposal, renderAction} = props;\n\n  /**\n   * Selectors\n   */\n\n  const daoVotingAdapterName = useSelector(\n    (s: StoreState) => s.contracts.VotingContract?.adapterOrExtensionName\n  ) as VotingAdapterName | undefined;\n\n  /**\n   * Variables\n   */\n\n  // Use the proposal's voting adapter (has been sponsored), or fall back to the DAO's (not-yet-sponsored).\n  const votingAdapterName: VotingAdapterName | undefined =\n    proposal.daoProposalVotingAdapter?.votingAdapterName ||\n    daoVotingAdapterName;\n\n  /**\n   * Functions\n   */\n\n  function renderActions() {\n    if (!votingAdapterName) {\n      return <></>;\n    }\n\n    switch (votingAdapterName) {\n      case VotingAdapterName.OffchainVotingContract:\n        return (\n          <ProposalWithOffchainVoteActions\n            adapterName={adapterName}\n            proposal={proposal}\n            renderAction={renderAction}\n          />\n        );\n\n      // @todo On-chain Voting\n      case VotingAdapterName.VotingContract:\n        return <></>;\n\n      default:\n        return (\n          <ErrorMessageWithDetails\n            error={\n              new Error(\n                `\"${votingAdapterName}\" is not a valid voting adapter name.`\n              )\n            }\n            renderText=\"Something went wrong\"\n          />\n        );\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Suspense\n      fallback={\n        <span className=\"text-center\" style={cycleEllipsisStyles}>\n          <CycleEllipsis intervalMs={200} fadeInProps={fadeInProps} />\n        </span>\n      }>\n      {renderActions()}\n    </Suspense>\n  );\n}\n","type ProposalAmountProps = {\n  amount: string;\n  amountUnit: string;\n  amount2?: string;\n  amount2Unit?: string;\n};\n\nexport default function ProposalAmount(props: ProposalAmountProps) {\n  const {amount, amountUnit, amount2, amount2Unit} = props;\n\n  /**\n   * Render\n   */\n\n  return (\n    <div className=\"proposaldetails__amount\">\n      <span>\n        {`${amount} ${amountUnit}`}\n        {/* assumes second amount is value requested from the DAO */}\n        {amount2 && (\n          <>\n            <br />\n            <small>for</small>\n            <br />\n            {`${amount2} ${amount2Unit}`}\n          </>\n        )}\n      </span>\n    </div>\n  );\n}\n","import React from 'react';\nimport {useHistory, useParams} from 'react-router-dom';\n\nimport {\n  ProposalFlowStatus,\n  RenderActionPropArguments,\n} from '../../components/proposals/types';\nimport {AsyncStatus} from '../../util/types';\nimport {ContractAdapterNames} from '../../components/web3/types';\nimport {useIsDefaultChain} from '../../components/web3/hooks';\nimport {useProposalOrDraft} from '../../components/proposals/hooks';\nimport {VotingState} from '../../components/proposals/voting/types';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderLarge from '../../components/feedback/LoaderLarge';\nimport NotFound from '../subpages/NotFound';\nimport ProcessActionOnboarding from '../../components/proposals/ProcessActionOnboarding';\nimport ProposalActions from '../../components/proposals/ProposalActions';\nimport SubmitAction from '../../components/proposals/SubmitAction';\nimport ProposalAmount from '../../components/proposals/ProposalAmount';\nimport ProposalDetails from '../../components/proposals/ProposalDetails';\nimport Wrap from '../../components/common/Wrap';\n\nconst PLACEHOLDER = '\\u2014'; /* em dash */\n\nexport default function OnboardingDetails() {\n  /**\n   * @todo\n   *\n   * 1. Fetch proposal by ID from the subgraph.\n   * 2. Determine if sponsored\n   * 3. Get Snapshot data\n   *   3.1 If sponsored, get data about proposal from Snapshot (use flag to also search by draft hash).\n   *   3.2 If not sponsored, get data about draft from Snapshot.\n   */\n\n  /**\n   * Their hooks\n   */\n\n  // Get hash for fetching the proposal.\n  const {proposalId} = useParams<{proposalId: string}>();\n\n  /**\n   * @todo Get subgraph proposal and determine if it has been sponsored\n   *   so we know how to search snapshot-hub.\n   */\n\n  // ...\n\n  /**\n   * Our hooks\n   */\n\n  // @todo Use dynamic `SnapshotType` depending on subgraph data for `type` arg.\n  const {proposalData, proposalError, proposalNotFound, proposalStatus} =\n    useProposalOrDraft(proposalId);\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const isLoading: boolean = proposalStatus === AsyncStatus.PENDING;\n  const error: Error | undefined = proposalError || defaultChainError;\n\n  /**\n   * Functions\n   */\n\n  // Render any adapter-specific actions\n  function renderAction(data: RenderActionPropArguments): React.ReactNode {\n    const {\n      OffchainVotingContract: {daoProposalVoteResult, proposal, status},\n    } = data;\n\n    // Submit/Sponsor button (for proposals that have not been submitted onchain yet)\n    if (status === ProposalFlowStatus.Submit) {\n      const {snapshotDraft} = proposal;\n      const applicant = snapshotDraft?.msg.payload.metadata.submitActionArgs[0];\n\n      return <SubmitAction checkApplicant={applicant} proposal={proposal} />;\n    }\n\n    // Process button\n    if (\n      status === ProposalFlowStatus.Process ||\n      status === ProposalFlowStatus.OffchainVotingGracePeriod\n    ) {\n      if (\n        daoProposalVoteResult &&\n        VotingState[daoProposalVoteResult] !== VotingState[VotingState.PASS]\n      ) {\n        // Return a React.Fragment to hide the process button if proposal failed.\n        return <></>;\n      }\n\n      return (\n        <ProcessActionOnboarding\n          // Show during DAO proposal grace period, but set to disabled\n          disabled={status === ProposalFlowStatus.OffchainVotingGracePeriod}\n          proposal={proposal}\n        />\n      );\n    }\n\n    // Return `null` to signal to use default actions\n    return null;\n  }\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <RenderWrapper>\n        <div className=\"loader--large-container\">\n          <LoaderLarge />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render 404 no proposal found\n  if (proposalNotFound) {\n    return (\n      <RenderWrapper>\n        <NotFound />\n      </RenderWrapper>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center\">\n          <ErrorMessageWithDetails\n            error={error}\n            renderText=\"Something went wrong while getting the proposal.\"\n          />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render proposal\n  if (proposalData) {\n    const commonData = proposalData.getCommonSnapshotProposalData();\n\n    // Handle just in case metadata was not properly set\n    let tributeAmount = PLACEHOLDER;\n    let tributeAmountUnit = '';\n    try {\n      ({tributeAmount, tributeAmountUnit} =\n        commonData?.msg.payload.metadata.proposalAmountValues);\n    } catch (error) {\n      tributeAmount = PLACEHOLDER;\n      tributeAmountUnit = '';\n    }\n\n    return (\n      <RenderWrapper>\n        <ProposalDetails\n          proposal={proposalData}\n          renderAmountBadge={() => (\n            <ProposalAmount\n              amount={tributeAmount}\n              amountUnit={tributeAmountUnit}\n            />\n          )}\n          renderActions={() => (\n            <ProposalActions\n              adapterName={ContractAdapterNames.onboarding}\n              proposal={proposalData}\n              renderAction={renderAction}\n            />\n          )}\n        />\n      </RenderWrapper>\n    );\n  }\n\n  // Render nothing. Should never reach this case.\n  return <></>;\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function goToAll(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n\n    history.push('/onboarding');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Onboarding</h2>\n          <button className=\"titlebar__action\" onClick={goToAll}>\n            View all\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {useState, useEffect} from 'react';\n\ntype LoaderWithEmojiProps = {\n  emoji: string;\n  // Show waiting effect after some time has elapsed. Prevents the \"sudden\n  // spinner\" UI/UX no-no. Esp. if we could have cached data.\n  showAfterMs?: number;\n};\n\nexport default function LoaderWithEmoji(props: LoaderWithEmojiProps) {\n  const {showAfterMs} = props;\n  const [showLoaderAfterMs, setShowLoaderAfterMs] = useState<boolean>(false);\n\n  useEffect(() => {\n    /* 200ms is approx. the time a user will notice a stalled, blank screen */\n    const timeoutId =\n      showAfterMs && setTimeout(() => setShowLoaderAfterMs(true), showAfterMs);\n\n    return function cleanup() {\n      timeoutId && clearTimeout(timeoutId);\n    };\n  }, [showAfterMs]);\n\n  return !showAfterMs || (showAfterMs && showLoaderAfterMs) ? (\n    <div className=\"loader--emoji\">\n      <span role=\"img\" aria-label=\"Loading content...\">\n        {props.emoji}\n      </span>\n    </div>\n  ) : null;\n}\n","import {useRef, useEffect} from 'react';\nimport {toChecksumAddress} from 'web3-utils';\n\nimport {CycleEllipsis} from '../../components/feedback/CycleEllipsis';\nimport CycleMessage from '../../components/feedback/CycleMessage';\nimport EtherscanURL from '../../components/web3/EtherscanURL';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport Loader from '../../components/feedback/Loader';\nimport DaoToken, {\n  ERC20RegisterDetails,\n} from '../../components/dao-token/DaoToken';\nimport {useCheckApplicant} from '../../components/proposals/hooks';\nimport {useRedeemCoupon, FetchStatus} from '../../hooks/useRedeemCoupon';\nimport {useMemberActionDisabled} from '../../hooks';\nimport {formatNumber, truncateEthAddress} from '../../util/helpers';\nimport {Web3TxStatus} from '../../components/web3/types';\nimport {TX_CYCLE_MESSAGES} from '../../components/web3/config';\nimport {AsyncStatus} from '../../util/types';\n\ntype RedeemManagerProps = {\n  redeemables: Record<string, any>;\n  daoTokenDetails?: ERC20RegisterDetails;\n};\n\ntype RedeemCardProps = {\n  redeemable: Record<string, any>;\n  daoTokenDetails?: ERC20RegisterDetails;\n};\n\ntype ActionDisabledReasons = {\n  invalidApplicantMessage: string;\n};\n\n/**\n * Cached outside the component to prevent infinite re-renders.\n *\n * The same can be accomplished inside the component using\n * `useState`, `useRef`, etc., depending on the use case.\n */\nconst useMemberActionDisabledProps = {\n  // Anyone can process a proposal - it's just a question of gas payment.\n  skipIsActiveMemberCheck: true,\n};\n\nexport default function RedeemManager({\n  redeemables,\n  daoTokenDetails,\n}: RedeemManagerProps) {\n  /**\n   *  Render\n   */\n\n  // show the redeem card, if only one coupon available\n  return (\n    <RenderWrapper>\n      <RedeemCard\n        redeemable={redeemables[0]}\n        daoTokenDetails={daoTokenDetails}\n      />\n    </RenderWrapper>\n  );\n}\n\nfunction RedeemCard({redeemable, daoTokenDetails}: RedeemCardProps) {\n  /**\n   * Refs\n   */\n\n  const actionDisabledReasonsRef = useRef<ActionDisabledReasons>({\n    invalidApplicantMessage: '',\n  });\n\n  /**\n   * Our hooks\n   */\n\n  const {\n    redeemCoupon,\n    submitStatus,\n    submitError,\n    txStatus,\n    txEtherscanURL,\n    txIsPromptOpen,\n  } = useRedeemCoupon();\n\n  const {\n    isDisabled,\n    openWhyDisabledModal,\n    WhyDisabledModal,\n    setOtherDisabledReasons,\n  } = useMemberActionDisabled(useMemberActionDisabledProps);\n\n  const {\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n  } = useCheckApplicant(redeemable.recipient);\n\n  /**\n   * Variables\n   */\n\n  const isInProcess =\n    submitStatus === FetchStatus.PENDING ||\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING;\n  const isDone =\n    submitStatus === FetchStatus.FULFILLED ||\n    txStatus === Web3TxStatus.FULFILLED ||\n    redeemable.isRedeemd;\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (redeemable.recipient) {\n      // 1. Determine and set reasons why action would be disabled\n\n      // Reason: If the applicant address is invalid (see `useCheckApplicant`\n      // hook for reasons) the `submitProposal` smart contract transaction will\n      // fail.\n      if (checkApplicantError) {\n        console.warn(\n          `Error checking if the applicant address '${redeemable.recipient}' is valid: ${checkApplicantError.message}`\n        );\n      }\n\n      if (\n        checkApplicantStatus === AsyncStatus.FULFILLED &&\n        !isApplicantValid &&\n        checkApplicantInvalidMsg\n      ) {\n        actionDisabledReasonsRef.current = {\n          ...actionDisabledReasonsRef.current,\n          invalidApplicantMessage: checkApplicantInvalidMsg,\n        };\n      }\n\n      // 2. Set reasons\n      setOtherDisabledReasons(Object.values(actionDisabledReasonsRef.current));\n    }\n  }, [\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n    redeemable.recipient,\n    setOtherDisabledReasons,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  function renderSubmitStatus(): React.ReactNode {\n    // Only for chain tx\n    switch (txStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return (\n          <>\n            Awaiting your confirmation\n            <CycleEllipsis />\n          </>\n        );\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message: string) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>{'Finalized!'}</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      <div\n        className={`redeemcard redeemcard__content ${\n          isDone ? 'fireworks' : ''\n        } `}>\n        <p className=\"redeemcard__recipient\">\n          Recipient:{' '}\n          {truncateEthAddress(toChecksumAddress(redeemable.recipient), 7)}\n        </p>\n        <p className=\"redeemcard__unit\">\n          {formatNumber(redeemable.amount)}\n          <sup>\n            <small>{daoTokenDetails?.symbol || 'tokens'}</small>\n          </sup>\n        </p>\n\n        <DaoToken daoTokenDetails={daoTokenDetails} />\n\n        {isDone && (\n          <p className=\"redeemcard__redeemed\">\n            <span\n              className=\"pulse\"\n              role=\"img\"\n              aria-label=\"Redeemed!\"\n              style={{display: 'inline-block'}}>\n              \n            </span>\n          </p>\n        )}\n\n        <button\n          className=\"button\"\n          style={{marginTop: isDone ? '1rem' : '1.5rem'}}\n          onClick={async () => {\n            await redeemCoupon(redeemable, daoTokenDetails);\n          }}\n          disabled={isDisabled || isInProcessOrDone}>\n          {isInProcess ? <Loader /> : isDone ? 'Redeemed!' : 'Redeem'}\n        </button>\n\n        {/* SUBMIT STATUS */}\n        {isInProcessOrDone && !redeemable.isRedeemd && (\n          <div\n            className=\"form__submit-status-container\"\n            style={{marginTop: '1rem'}}>\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {isDisabled && (\n          <button\n            className=\"button--help-centered\"\n            onClick={openWhyDisabledModal}\n            style={{margin: '1rem auto 0'}}>\n            Why is redeeming disabled?\n          </button>\n        )}\n\n        {/* SUBMIT ERROR */}\n        {submitError && (\n          <div className=\"form__submit-error-container\">\n            <ErrorMessageWithDetails\n              renderText=\"Something went wrong while redeeming the coupon.\"\n              error={submitError}\n            />\n          </div>\n        )}\n      </div>\n\n      <WhyDisabledModal title=\"Why is redeeming disabled?\" />\n    </>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  return (\n    <FadeIn>\n      <div className=\"grid--fluid grid-container\">\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </div>\n    </FadeIn>\n  );\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {useLocation} from 'react-router-dom';\n\nimport {StoreState} from '../../store/types';\nimport {AsyncStatus} from '../../util/types';\nimport {COUPON_API_URL} from '../../config';\nimport {useAbortController} from '../../hooks';\nimport {useIsDefaultChain, useWeb3Modal} from '../../components/web3/hooks';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderWithEmoji from '../../components/feedback/LoaderWithEmoji';\nimport RedeemManager from './RedeemManager';\nimport Wrap from '../../components/common/Wrap';\nimport {useDaoTokenDetails} from '../../components/dao-token/hooks';\n\ntype RedeemCouponType = {\n  amount: number;\n  dao: {daoAddress: string};\n  isRedeemed: boolean;\n  nonce: number;\n  recipient: string;\n  signature: string;\n};\n\nexport default function RedeemCoupon() {\n  /**\n   * Selectors\n   */\n\n  const ERC20ExtensionContract = useSelector(\n    (state: StoreState) => state.contracts?.ERC20ExtensionContract\n  );\n\n  /**\n   * State\n   */\n\n  const [redeemableCoupon, setReedemableCoupon] = useState<RedeemCouponType[]>(\n    []\n  );\n  const [couponStatus, setCouponStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {connected, account} = useWeb3Modal();\n  const {defaultChainError} = useIsDefaultChain();\n  const {abortController, isMountedRef} = useAbortController();\n  const {daoTokenDetails, daoTokenDetailsStatus} = useDaoTokenDetails();\n\n  /**\n   * Their hooks\n   */\n\n  const location = useLocation<{coupon: string}>();\n\n  /**\n   * Variables\n   */\n\n  const coupon = new URLSearchParams(location.search).get('coupon');\n\n  const isInProcess =\n    couponStatus === AsyncStatus.STANDBY ||\n    couponStatus === AsyncStatus.PENDING ||\n    (ERC20ExtensionContract && daoTokenDetailsStatus === AsyncStatus.STANDBY) ||\n    daoTokenDetailsStatus === AsyncStatus.PENDING;\n\n  /**\n   * Cached callbacks\n   */\n\n  const checkBySigOrAddrCached = useCallback(checkBySigOrAddr, [\n    abortController?.signal,\n    coupon,\n    isMountedRef,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!account || !connected || defaultChainError) return;\n\n    checkBySigOrAddrCached();\n  }, [account, connected, checkBySigOrAddrCached, defaultChainError]);\n\n  /**\n   * Functions\n   */\n\n  // check using signature or eth addr\n  async function checkBySigOrAddr() {\n    try {\n      if (!abortController?.signal) return;\n\n      setCouponStatus(AsyncStatus.PENDING);\n\n      // handle adding new authorized user to thee `auth` tbl\n      const response = await fetch(`${COUPON_API_URL}/api/coupon/redeem`, {\n        method: 'POST',\n        body: JSON.stringify({\n          signature: coupon,\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        signal: abortController.signal,\n      });\n\n      if (!isMountedRef.current) return;\n\n      const coupons = await response.json();\n\n      setReedemableCoupon(coupons);\n      setCouponStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      setCouponStatus(AsyncStatus.REJECTED);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  // check if user doesn't have a connected wallet\n  if (!connected) {\n    return (\n      <RenderWrapper>\n        <p className=\"color-brightsalmon\">\n          Connect your wallet to view the coupon.\n        </p>\n      </RenderWrapper>\n    );\n  }\n\n  if (defaultChainError) {\n    return (\n      <RenderWrapper>\n        <p className=\"color-brightsalmon\">{defaultChainError.message}</p>\n      </RenderWrapper>\n    );\n  }\n\n  if (connected && isInProcess) {\n    return (\n      <RenderWrapper>\n        <LoaderWithEmoji emoji={''} />\n        <p>Checking&hellip; please wait.</p>\n      </RenderWrapper>\n    );\n  }\n\n  if (coupon === undefined || !coupon) {\n    return (\n      <RenderWrapper>\n        <p className=\"color-brightsalmon\">Coupon signature missing.</p>\n      </RenderWrapper>\n    );\n  }\n\n  if (!redeemableCoupon || !redeemableCoupon.length) {\n    return (\n      <RenderWrapper>\n        <p className=\"color-brightsalmon\">Coupon not found.</p>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      <RedeemManager\n        daoTokenDetails={daoTokenDetails}\n        redeemables={redeemableCoupon}\n      />\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Redeem Coupon</h2>\n        </div>\n\n        <div className=\"form-wrapper\">\n          <div className=\"form__description\">\n            <p>Redeem coupon to issue the membership tokens.</p>\n          </div>\n\n          {/* RENDER CHILDREN */}\n          {props.children}\n        </div>\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {useEffect, useState, useRef} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\n\nimport {CycleEllipsis} from '../feedback';\nimport {getConnectedMember} from '../../store/actions';\nimport {ProposalData, DistributionStatus} from './types';\nimport {ReduxDispatch, StoreState} from '../../store/types';\nimport {TX_CYCLE_MESSAGES} from '../web3/config';\nimport {useContractSend, useETHGasPrice, useWeb3Modal} from '../web3/hooks';\nimport {useMemberActionDisabled} from '../../hooks';\nimport {Web3TxStatus} from '../web3/types';\nimport CycleMessage from '../feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport EtherscanURL from '../web3/EtherscanURL';\nimport FadeIn from '../common/FadeIn';\nimport Loader from '../feedback/Loader';\n\ntype DistributeArguments = [\n  string, // `dao`\n  string // `toIndex`\n];\n\ntype PostProcessActionTransferProps = {\n  proposal: ProposalData;\n};\n\ntype ActionDisabledReasons = {\n  alreadyCompletedMessage: string;\n};\n\nexport default function PostProcessActionTransfer(\n  props: PostProcessActionTransferProps\n) {\n  const {\n    proposal: {snapshotProposal},\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n\n  /**\n   * Refs\n   */\n\n  const actionDisabledReasonsRef = useRef<ActionDisabledReasons>({\n    alreadyCompletedMessage: '',\n  });\n\n  /**\n   * Selectors\n   */\n\n  const DistributeContract = useSelector(\n    (s: StoreState) => s.contracts?.DistributeContract\n  );\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account, web3Instance} = useWeb3Modal();\n  const {txEtherscanURL, txIsPromptOpen, txSend, txStatus} = useContractSend();\n  const {average: gasPrice} = useETHGasPrice();\n\n  const {\n    isDisabled,\n    openWhyDisabledModal,\n    WhyDisabledModal,\n    setOtherDisabledReasons,\n  } = useMemberActionDisabled();\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * Variables\n   */\n\n  const isInProcess =\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING;\n\n  const isDone = txStatus === Web3TxStatus.FULFILLED;\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n  const areSomeDisabled = isDisabled || isInProcessOrDone;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    async function getActionDisabledReasons() {\n      // 1. Determine and set reasons why action would be disabled\n\n      // Reason: distribution already completed\n      try {\n        if (!snapshotProposal) {\n          throw new Error('No Snapshot proposal was found.');\n        }\n\n        if (!daoRegistryContract) {\n          throw new Error('No DAO Registry contract was found.');\n        }\n\n        if (!DistributeContract) {\n          throw new Error('No DistributeContract found.');\n        }\n\n        const distributeProposal = await DistributeContract.instance.methods\n          .distributions(\n            daoRegistryContract.contractAddress,\n            snapshotProposal.idInDAO\n          )\n          .call();\n\n        actionDisabledReasonsRef.current = {\n          ...actionDisabledReasonsRef.current,\n          alreadyCompletedMessage:\n            DistributionStatus[distributeProposal.status] !==\n            DistributionStatus[DistributionStatus.IN_PROGRESS]\n              ? 'The transfer has already been completed.'\n              : '',\n        };\n      } catch (error) {\n        console.error(error);\n      }\n\n      // 2. Set reasons\n      setOtherDisabledReasons(Object.values(actionDisabledReasonsRef.current));\n    }\n\n    getActionDisabledReasons();\n  }, [\n    DistributeContract,\n    daoRegistryContract,\n    setOtherDisabledReasons,\n    snapshotProposal,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  async function handleSubmit() {\n    try {\n      if (!daoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      if (!snapshotProposal) {\n        throw new Error('No Snapshot proposal was found.');\n      }\n\n      if (!DistributeContract) {\n        throw new Error('No DistributeContract found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      let toIndexArg = '0';\n\n      const isTypeAllMembers =\n        snapshotProposal?.msg.payload.metadata.isTypeAllMembers;\n\n      if (isTypeAllMembers) {\n        try {\n          const nbMembers = await daoRegistryContract.instance.methods\n            .getNbMembers()\n            .call();\n          toIndexArg = nbMembers.toString();\n        } catch (error) {\n          throw new Error('Error while retrieving number of DAO members');\n        }\n      }\n\n      const distributeArguments: DistributeArguments = [\n        daoRegistryContract.contractAddress,\n        toIndexArg,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(gasPrice ? {gasPrice} : null),\n      };\n\n      const tx = await txSend(\n        'distribute',\n        DistributeContract.instance.methods,\n        distributeArguments,\n        txArguments\n      );\n\n      if (tx) {\n        // re-fetch member\n        await dispatch(\n          getConnectedMember({\n            account,\n            daoRegistryContract,\n            web3Instance,\n          })\n        );\n      }\n    } catch (error) {\n      const e = error as Error;\n\n      setSubmitError(e);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  function renderSubmitStatus(): React.ReactNode {\n    // distribute transaction statuses\n    switch (txStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return (\n          <>\n            Confirm to transfer assets\n            <CycleEllipsis />\n          </>\n        );\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>Assets transferred!</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  return (\n    <>\n      <div>\n        <button\n          className=\"proposaldetails__button\"\n          disabled={areSomeDisabled}\n          onClick={areSomeDisabled ? () => {} : handleSubmit}>\n          {isInProcess ? (\n            <Loader />\n          ) : isDone ? (\n            'Transfer done'\n          ) : (\n            'Transfer assets'\n          )}\n        </button>\n\n        <ErrorMessageWithDetails\n          error={submitError}\n          renderText=\"Something went wrong\"\n        />\n\n        {/* SUBMIT STATUS */}\n\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {isDisabled && (\n          <button\n            className=\"button--help-centered\"\n            onClick={openWhyDisabledModal}>\n            Why is action disabled?\n          </button>\n        )}\n      </div>\n\n      <WhyDisabledModal title=\"Why is transfer disabled?\" />\n    </>\n  );\n}\n","import React from 'react';\nimport {useHistory, useParams} from 'react-router-dom';\n\nimport {\n  ProposalFlowStatus,\n  RenderActionPropArguments,\n} from '../../components/proposals/types';\nimport {AsyncStatus} from '../../util/types';\nimport {ContractAdapterNames} from '../../components/web3/types';\nimport {useIsDefaultChain} from '../../components/web3/hooks';\nimport {useProposalOrDraft} from '../../components/proposals/hooks';\nimport {VotingState} from '../../components/proposals/voting/types';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderLarge from '../../components/feedback/LoaderLarge';\nimport NotFound from '../subpages/NotFound';\nimport PostProcessActionTransfer from '../../components/proposals/PostProcessActionTransfer';\nimport ProposalActions from '../../components/proposals/ProposalActions';\nimport ProposalAmount from '../../components/proposals/ProposalAmount';\nimport ProposalDetails from '../../components/proposals/ProposalDetails';\nimport Wrap from '../../components/common/Wrap';\n\nconst PLACEHOLDER = '\\u2014'; /* em dash */\n\nexport default function TransferDetails() {\n  /**\n   * @todo\n   *\n   * 1. Fetch proposal by ID from the subgraph.\n   * 2. Determine if sponsored\n   * 3. Get Snapshot data\n   *   3.1 If sponsored, get data about proposal from Snapshot (use flag to also search by draft hash).\n   *   3.2 If not sponsored, get data about draft from Snapshot.\n   */\n\n  /**\n   * Their hooks\n   */\n\n  // Get hash for fetching the proposal.\n  const {proposalId} = useParams<{proposalId: string}>();\n\n  /**\n   * @todo Get subgraph proposal and determine if it has been sponsored\n   *   so we know how to search snapshot-hub.\n   */\n\n  // ...\n\n  /**\n   * Our hooks\n   */\n\n  // @todo Use dynamic `SnapshotType` depending on subgraph data for `type` arg.\n  const {proposalData, proposalError, proposalNotFound, proposalStatus} =\n    useProposalOrDraft(proposalId);\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const isLoading: boolean = proposalStatus === AsyncStatus.PENDING;\n  const error: Error | undefined = proposalError || defaultChainError;\n\n  /**\n   * Functions\n   */\n\n  // Render any adapter-specific actions\n  function renderAction(data: RenderActionPropArguments): React.ReactNode {\n    const {\n      OffchainVotingContract: {daoProposalVoteResult, proposal, status},\n    } = data;\n\n    //  The Distribute adapter has an additional action after a passed proposal\n    //  is processed to handle the actual asset distribution.\n    if (\n      status === ProposalFlowStatus.Completed &&\n      daoProposalVoteResult &&\n      VotingState[daoProposalVoteResult] === VotingState[VotingState.PASS]\n    ) {\n      return <PostProcessActionTransfer proposal={proposal} />;\n    }\n\n    // Return `null` to signal to use default actions\n    return null;\n  }\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <RenderWrapper>\n        <div className=\"loader--large-container\">\n          <LoaderLarge />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render 404 no proposal found\n  if (proposalNotFound) {\n    return (\n      <RenderWrapper>\n        <NotFound />\n      </RenderWrapper>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center\">\n          <ErrorMessageWithDetails\n            error={error}\n            renderText=\"Something went wrong.\"\n          />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render proposal\n  if (proposalData) {\n    const commonData = proposalData.getCommonSnapshotProposalData();\n\n    // Handle just in case metadata was not properly set\n    let transferAmount = PLACEHOLDER;\n    let transferAmountUnit = '';\n    try {\n      ({transferAmount, transferAmountUnit} =\n        commonData?.msg.payload.metadata.proposalAmountValues);\n    } catch (error) {\n      transferAmount = PLACEHOLDER;\n      transferAmountUnit = '';\n    }\n\n    return (\n      <RenderWrapper>\n        <ProposalDetails\n          proposal={proposalData}\n          renderAmountBadge={() => (\n            <ProposalAmount\n              amount={transferAmount}\n              amountUnit={transferAmountUnit}\n            />\n          )}\n          renderActions={() => (\n            <ProposalActions\n              adapterName={ContractAdapterNames.distribute}\n              proposal={proposalData}\n              renderAction={renderAction}\n            />\n          )}\n        />\n      </RenderWrapper>\n    );\n  }\n\n  // Render nothing. Should never reach this case.\n  return <></>;\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function goToAll(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n\n    history.push('/transfers');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Transfers</h2>\n          <button className=\"titlebar__action\" onClick={goToAll}>\n            View all\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import React from 'react';\nimport {useHistory} from 'react-router-dom';\n\nimport {DaoAdapterConstants} from '../../components/adapters-extensions/enums';\nimport FadeIn from '../../components/common/FadeIn';\nimport Proposals from '../../components/proposals/Proposals';\nimport Wrap from '../../components/common/Wrap';\n\nexport default function Transfers() {\n  /**\n   * Functions\n   */\n\n  function proposalLinkPath(id: string) {\n    return `/transfers/${id}`;\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <RenderWrapper>\n      <Proposals\n        adapterName={DaoAdapterConstants.DISTRIBUTE}\n        proposalLinkPath={proposalLinkPath}\n      />\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function goToNewProposal(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n    history.push('/transfer');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Transfers</h2>\n          <button className=\"titlebar__action\" onClick={goToNewProposal}>\n            Make Transfer\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {toBN, AbiItem} from 'web3-utils';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {useState, useRef, useEffect, useCallback} from 'react';\n\nimport {CycleEllipsis} from '../feedback';\nimport {ERC20} from '../../abis/types/ERC20';\nimport {getConnectedMember} from '../../store/actions';\nimport {ProposalData, SnapshotProposal} from './types';\nimport {ReduxDispatch, StoreState} from '../../store/types';\nimport {TX_CYCLE_MESSAGES} from '../web3/config';\nimport {useContractSend, useETHGasPrice, useWeb3Modal} from '../web3/hooks';\nimport {useDaoTokenDetails} from '../dao-token/hooks';\nimport {useMemberActionDisabled} from '../../hooks';\nimport {Web3TxStatus} from '../web3/types';\nimport CycleMessage from '../feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport EtherscanURL from '../web3/EtherscanURL';\nimport FadeIn from '../common/FadeIn';\nimport Loader from '../feedback/Loader';\n\ntype ProcessArguments = [\n  string, // `dao`\n  string // `proposalId`\n];\n\ntype TokenApproveArguments = [\n  string, // `spender`\n  string // `value`\n];\n\ntype TributeProposalDetails = {\n  tokenAddress: string;\n  tributeAmount: string;\n};\n\ntype ProcessActionTributeProps = {\n  disabled?: boolean;\n  proposal: ProposalData;\n};\n\ntype ActionDisabledReasons = {\n  notProposerMessage: string;\n};\n\n/**\n * Cached outside the component to prevent infinite re-renders.\n *\n * The same can be accomplished inside the component using\n * `useState`, `useRef`, etc., depending on the use case.\n */\nconst useMemberActionDisabledProps = {\n  // Anyone can process a proposal - it's just a question of gas payment.\n  skipIsActiveMemberCheck: true,\n};\n\nexport default function ProcessActionTribute(props: ProcessActionTributeProps) {\n  const {\n    disabled: propsDisabled,\n    proposal: {snapshotProposal},\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n\n  const [tributeProposalDetails, setTributeProposalDetails] =\n    useState<TributeProposalDetails>();\n\n  /**\n   * Refs\n   */\n\n  const actionDisabledReasonsRef = useRef<ActionDisabledReasons>({\n    notProposerMessage: '',\n  });\n\n  /**\n   * Selectors\n   */\n\n  const TributeContract = useSelector(\n    (s: StoreState) => s.contracts?.TributeContract\n  );\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account, web3Instance} = useWeb3Modal();\n  const {txEtherscanURL, txIsPromptOpen, txSend, txStatus} = useContractSend();\n  const {average: gasPrice} = useETHGasPrice();\n\n  const {\n    txEtherscanURL: txEtherscanURLTokenApprove,\n    txIsPromptOpen: txIsPromptOpenTokenApprove,\n    txSend: txSendTokenApprove,\n    txStatus: txStatusTokenApprove,\n  } = useContractSend();\n\n  const {\n    isDisabled,\n    openWhyDisabledModal,\n    WhyDisabledModal,\n    setOtherDisabledReasons,\n  } = useMemberActionDisabled(useMemberActionDisabledProps);\n\n  const {daoTokenDetails} = useDaoTokenDetails();\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * Variables\n   */\n\n  const isInProcess =\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING ||\n    txStatusTokenApprove === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatusTokenApprove === Web3TxStatus.PENDING;\n\n  const isDone = txStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone =\n    isInProcess || isDone || txIsPromptOpen || txIsPromptOpenTokenApprove;\n\n  const areSomeDisabled = isDisabled || isInProcessOrDone || propsDisabled;\n\n  /**\n   * Cached callbacks\n   */\n\n  const getTributeProposalDetailsCached = useCallback(\n    getTributeProposalDetails,\n    [TributeContract, daoRegistryContract?.contractAddress, snapshotProposal]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getTributeProposalDetailsCached();\n  }, [getTributeProposalDetailsCached]);\n\n  useEffect(() => {\n    // 1. Determine and set reasons why action would be disabled\n\n    // Reason: For some proposal types, a passed proposal can only be\n    // processed by its original proposer (e.g., the owner of the asset to be\n    // transferred)\n\n    // Proposals with this restriction will have this value stored in its\n    // snapshot metadata.\n    const {accountAuthorizedToProcessPassedProposal} = (\n      snapshotProposal as SnapshotProposal\n    ).msg.payload.metadata;\n\n    if (accountAuthorizedToProcessPassedProposal && account) {\n      actionDisabledReasonsRef.current = {\n        ...actionDisabledReasonsRef.current,\n        notProposerMessage:\n          accountAuthorizedToProcessPassedProposal.toLowerCase() !==\n          account.toLowerCase()\n            ? 'Only the original proposer can process the proposal.'\n            : '',\n      };\n    }\n\n    // 2. Set reasons\n    setOtherDisabledReasons(Object.values(actionDisabledReasonsRef.current));\n  }, [account, setOtherDisabledReasons, snapshotProposal]);\n\n  /**\n   * Functions\n   */\n\n  async function getTributeProposalDetails() {\n    try {\n      if (\n        !daoRegistryContract?.contractAddress ||\n        !snapshotProposal ||\n        !TributeContract\n      ) {\n        return;\n      }\n\n      const proposalDetails = await TributeContract.instance.methods\n        .proposals(\n          daoRegistryContract.contractAddress,\n          snapshotProposal.idInDAO\n        )\n        .call();\n\n      const {token: tokenAddress, tributeAmount} = proposalDetails;\n\n      setTributeProposalDetails({tokenAddress, tributeAmount});\n    } catch (error) {\n      console.error(error);\n      setTributeProposalDetails(undefined);\n    }\n  }\n\n  async function handleSubmitTokenApprove() {\n    try {\n      if (!tributeProposalDetails) {\n        throw new Error('No Tribute proposal details found.');\n      }\n\n      if (!TributeContract) {\n        throw new Error('No TributeContract found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      const {tokenAddress, tributeAmount} = tributeProposalDetails;\n\n      const {default: lazyERC20ABI} = await import(\n        '../../abis/external/ERC20.json'\n      );\n      const erc20Contract: AbiItem[] = lazyERC20ABI as any;\n\n      const erc20Instance = new web3Instance.eth.Contract(\n        erc20Contract,\n        tokenAddress\n      ) as any as ERC20; // TypeChain: for Web3 we need to cast\n\n      // Value to check if adapter is allowed to spend amount of tribute tokens\n      // on behalf of owner. If allowance is not sufficient, the owner will approve the adapter to spend the amount of\n      // tokens needed for the owner to provide the full tribute amount.\n      const allowance = await erc20Instance.methods\n        .allowance(account, TributeContract.contractAddress)\n        .call();\n\n      const tributeAmountBN = toBN(tributeAmount);\n      const allowanceBN = toBN(allowance);\n\n      if (tributeAmountBN.gt(allowanceBN)) {\n        try {\n          const difference = tributeAmountBN.sub(allowanceBN);\n          const approveValue = allowanceBN.add(difference);\n          const tokenApproveArguments: TokenApproveArguments = [\n            TributeContract.contractAddress,\n            approveValue.toString(),\n          ];\n          const txArguments = {\n            from: account || '',\n            ...(gasPrice ? {gasPrice} : null),\n          };\n\n          // Execute contract call for `approve`\n          await txSendTokenApprove(\n            'approve',\n            erc20Instance.methods,\n            tokenApproveArguments,\n            txArguments\n          );\n        } catch (error) {\n          throw error;\n        }\n      }\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async function handleSubmit() {\n    try {\n      if (!daoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      if (!snapshotProposal) {\n        throw new Error('No Snapshot proposal was found.');\n      }\n\n      if (!TributeContract) {\n        throw new Error('No TributeContract found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      await handleSubmitTokenApprove();\n\n      const processArguments: ProcessArguments = [\n        daoRegistryContract.contractAddress,\n        snapshotProposal.idInDAO,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(gasPrice ? {gasPrice} : null),\n      };\n\n      const tx = await txSend(\n        'processProposal',\n        TributeContract.instance.methods,\n        processArguments,\n        txArguments\n      );\n\n      if (tx) {\n        // re-fetch member\n        await dispatch(\n          getConnectedMember({\n            account,\n            daoRegistryContract,\n            web3Instance,\n          })\n        );\n\n        // if connected account is the applicant (the address that will receive\n        // the membership units) suggest adding DAO token to wallet\n        if (\n          account.toLowerCase() ===\n          snapshotProposal.msg.payload.metadata.submitActionArgs[0].toLowerCase()\n        ) {\n          await addTokenToWallet();\n        }\n      }\n    } catch (error) {\n      const e = error as Error;\n\n      setSubmitError(e);\n    }\n  }\n\n  async function addTokenToWallet() {\n    if (!daoTokenDetails) return;\n\n    try {\n      await window.ethereum.request({\n        method: 'wallet_watchAsset',\n        params: {\n          type: 'ERC20',\n          options: daoTokenDetails,\n        },\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  function renderSubmitStatus(): React.ReactNode {\n    // token approve transaction statuses\n    if (txStatusTokenApprove === Web3TxStatus.AWAITING_CONFIRM) {\n      return (\n        <>\n          Confirm to transfer your tokens\n          <CycleEllipsis />\n        </>\n      );\n    }\n\n    if (txStatusTokenApprove === Web3TxStatus.PENDING) {\n      return (\n        <>\n          <div>\n            Approving your tokens for transfer\n            <CycleEllipsis />\n          </div>\n          <EtherscanURL url={txEtherscanURLTokenApprove} isPending />\n        </>\n      );\n    }\n\n    // process proposal transaction statuses\n    switch (txStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return (\n          <>\n            Confirm to process the proposal\n            <CycleEllipsis />\n          </>\n        );\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>Proposal processed!</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  return (\n    <>\n      <div>\n        <button\n          className=\"proposaldetails__button\"\n          disabled={areSomeDisabled}\n          onClick={areSomeDisabled ? () => {} : handleSubmit}>\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Process'}\n        </button>\n\n        <ErrorMessageWithDetails\n          error={submitError}\n          renderText=\"Something went wrong\"\n        />\n\n        {/* SUBMIT STATUS */}\n\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {isDisabled && (\n          <button\n            className=\"button--help-centered\"\n            onClick={openWhyDisabledModal}>\n            Why is processing disabled?\n          </button>\n        )}\n      </div>\n\n      <WhyDisabledModal title=\"Why is processing disabled?\" />\n    </>\n  );\n}\n","import React from 'react';\nimport {useHistory, useParams} from 'react-router-dom';\n\nimport {\n  RenderActionPropArguments,\n  ProposalFlowStatus,\n} from '../../components/proposals/types';\nimport {AsyncStatus} from '../../util/types';\nimport {ContractAdapterNames} from '../../components/web3/types';\nimport {useIsDefaultChain} from '../../components/web3/hooks';\nimport {useProposalOrDraft} from '../../components/proposals/hooks';\nimport {VotingState} from '../../components/proposals/voting/types';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderLarge from '../../components/feedback/LoaderLarge';\nimport NotFound from '../subpages/NotFound';\nimport ProcessActionTribute from '../../components/proposals/ProcessActionTribute';\nimport ProposalActions from '../../components/proposals/ProposalActions';\nimport SubmitAction from '../../components/proposals/SubmitAction';\nimport ProposalAmount from '../../components/proposals/ProposalAmount';\nimport ProposalDetails from '../../components/proposals/ProposalDetails';\nimport Wrap from '../../components/common/Wrap';\n\nconst PLACEHOLDER = '\\u2014'; /* em dash */\n\nexport default function TributeDetails() {\n  /**\n   * @todo\n   *\n   * 1. Fetch proposal by ID from the subgraph.\n   * 2. Determine if sponsored\n   * 3. Get Snapshot data\n   *   3.1 If sponsored, get data about proposal from Snapshot (use flag to also search by draft hash).\n   *   3.2 If not sponsored, get data about draft from Snapshot.\n   */\n\n  /**\n   * Their hooks\n   */\n\n  // Get hash for fetching the proposal.\n  const {proposalId} = useParams<{proposalId: string}>();\n\n  /**\n   * @todo Get subgraph proposal and determine if it has been sponsored\n   *   so we know how to search snapshot-hub.\n   */\n\n  // ...\n\n  /**\n   * Our hooks\n   */\n\n  // @todo Use dynamic `SnapshotType` depending on subgraph data for `type` arg.\n  const {proposalData, proposalError, proposalNotFound, proposalStatus} =\n    useProposalOrDraft(proposalId);\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const isLoading: boolean = proposalStatus === AsyncStatus.PENDING;\n  const error: Error | undefined = proposalError || defaultChainError;\n\n  /**\n   * Functions\n   */\n\n  // Render any adapter-specific actions\n  function renderAction(data: RenderActionPropArguments): React.ReactNode {\n    const {\n      OffchainVotingContract: {daoProposalVoteResult, proposal, status},\n    } = data;\n\n    // Submit/Sponsor button (for proposals that have not been submitted onchain yet)\n    if (status === ProposalFlowStatus.Submit) {\n      const {snapshotDraft} = proposal;\n      const applicant = snapshotDraft?.msg.payload.metadata.submitActionArgs[0];\n\n      return <SubmitAction checkApplicant={applicant} proposal={proposal} />;\n    }\n\n    // Process button\n    if (\n      status === ProposalFlowStatus.Process ||\n      status === ProposalFlowStatus.OffchainVotingGracePeriod\n    ) {\n      if (\n        daoProposalVoteResult &&\n        VotingState[daoProposalVoteResult] !== VotingState[VotingState.PASS]\n      ) {\n        // Return a React.Fragment to hide the process button if proposal failed.\n        return <></>;\n      }\n\n      return (\n        <ProcessActionTribute\n          // Show during DAO proposal grace period, but set to disabled\n          disabled={status === ProposalFlowStatus.OffchainVotingGracePeriod}\n          proposal={proposal}\n        />\n      );\n    }\n\n    // Return `null` to signal to use default actions\n    return null;\n  }\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <RenderWrapper>\n        <div className=\"loader--large-container\">\n          <LoaderLarge />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render 404 no proposal found\n  if (proposalNotFound) {\n    return (\n      <RenderWrapper>\n        <NotFound />\n      </RenderWrapper>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center\">\n          <ErrorMessageWithDetails\n            error={error}\n            renderText=\"Something went wrong.\"\n          />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render proposal\n  if (proposalData) {\n    const commonData = proposalData.getCommonSnapshotProposalData();\n\n    // Handle just in case metadata was not properly set\n    let tributeAmount = PLACEHOLDER;\n    let tributeAmountUnit = '';\n    let requestAmount = PLACEHOLDER;\n    let requestAmountUnit = '';\n    try {\n      ({tributeAmount, tributeAmountUnit, requestAmount, requestAmountUnit} =\n        commonData?.msg.payload.metadata.proposalAmountValues);\n    } catch (error) {\n      tributeAmount = PLACEHOLDER;\n      tributeAmountUnit = '';\n      requestAmount = PLACEHOLDER;\n      requestAmountUnit = '';\n    }\n\n    return (\n      <RenderWrapper>\n        <ProposalDetails\n          proposal={proposalData}\n          renderAmountBadge={() => (\n            <ProposalAmount\n              amount={tributeAmount}\n              amountUnit={tributeAmountUnit}\n              amount2={requestAmount}\n              amount2Unit={requestAmountUnit}\n            />\n          )}\n          renderActions={() => (\n            <ProposalActions\n              adapterName={ContractAdapterNames.tribute}\n              proposal={proposalData}\n              renderAction={renderAction}\n            />\n          )}\n        />\n      </RenderWrapper>\n    );\n  }\n\n  // Render nothing. Should never reach this case.\n  return <></>;\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function goToAll(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n\n    history.push('/tributes');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Tributes</h2>\n          <button className=\"titlebar__action\" onClick={goToAll}>\n            View all\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import React from 'react';\nimport {useHistory} from 'react-router-dom';\n\nimport {DaoAdapterConstants} from '../../components/adapters-extensions/enums';\nimport FadeIn from '../../components/common/FadeIn';\nimport Proposals from '../../components/proposals/Proposals';\nimport Wrap from '../../components/common/Wrap';\n\nexport default function Tributes() {\n  /**\n   * Functions\n   */\n\n  function proposalLinkPath(id: string) {\n    return `/tributes/${id}`;\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <RenderWrapper>\n      <Proposals\n        adapterName={DaoAdapterConstants.TRIBUTE}\n        proposalLinkPath={proposalLinkPath}\n        includeProposalsExistingOnlyOffchain={true}\n      />\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function goToNewProposal(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n    history.push('/tribute');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Tributes</h2>\n          <button className=\"titlebar__action\" onClick={goToNewProposal}>\n            Provide Tribute\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {Link} from 'react-router-dom';\n\nimport {LeftLogo} from './logo';\nimport Nav from './Nav';\n\nexport default function Header() {\n  /**\n   * Functions\n   */\n\n  // Render the location with a link\n  function RenderLogo(props: React.PropsWithChildren<any>) {\n    return <Link to=\"/\">{props.children}</Link>;\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <header className=\"header\">\n      <RenderLogo>\n        <LeftLogo />\n      </RenderLogo>\n\n      <div className=\"header__nav-container\">\n        <Nav />\n      </div>\n    </header>\n  );\n}\n","import SocialMedia from './common/SocialMedia';\n\nexport default function Footer() {\n  return (\n    <div className=\"footer\">\n      <SocialMedia />\n    </div>\n  );\n}\n","import {Route, Switch, HashRouter} from 'react-router-dom';\n\nimport {ENABLE_KYC_ONBOARDING} from './config';\n// import AdapterOrExtensionManager from './components/adapters-extensions/AdapterOrExtensionManager';\nimport CreateGovernanceProposal from './pages/governance/CreateGovernanceProposal';\nimport CreateOnboardingProposal from './pages/onboarding/CreateOnboardingProposal';\nimport CreateTransferProposal from './pages/transfers/CreateTransferProposal';\nimport CreateTributeProposal from './pages/tributes/CreateTributeProposal';\nimport GetStarted from './pages/start/GetStarted';\nimport GovernanceProposalDetails from './pages/governance/GovernanceProposalDetails';\nimport GovernanceProposals from './pages/governance/GovernanceProposals';\nimport KycOnboardingForm from './pages/kyc-onboarding/KycOnboardingForm';\nimport MemberProfile from './pages/members/MemberProfile';\nimport Members from './pages/members/Members';\nimport Onboarding from './pages/onboarding/Onboarding';\nimport OnboardingDetails from './pages/onboarding/OnboardingDetails';\nimport NotFound from './pages/subpages/NotFound';\nimport Redeem from './pages/redeem/Redeem';\nimport TransferDetails from './pages/transfers/TransferDetails';\nimport Transfers from './pages/transfers/Transfers';\nimport TributeDetails from './pages/tributes/TributeDetails';\nimport Tributes from './pages/tributes/Tributes';\n\nimport Header from './components/Header';\nimport Footer from './components/Footer';\n\nconst proposalIdParameter: string = ':proposalId';\n\nexport default function Routes() {\n  return (\n    <HashRouter>\n      {[\n        // Index page\n        <Route key=\"splash\" exact path=\"/\" render={() => <GetStarted />} />,\n        ENABLE_KYC_ONBOARDING && (\n          <Route\n            key=\"join\"\n            exact\n            path=\"/join\"\n            render={() => <KycOnboardingForm />}\n          />\n        ),\n        <Route\n          key=\"onboard\"\n          exact\n          path=\"/onboard\"\n          render={() => <CreateOnboardingProposal />}\n        />,\n\n        <Route\n          key=\"onboarding\"\n          exact\n          path=\"/onboarding\"\n          render={() => <Onboarding />}\n        />,\n        <Route\n          key=\"onboarding-details\"\n          exact\n          path={`/onboarding/${proposalIdParameter}`}\n          render={() => <OnboardingDetails />}\n        />,\n        <Route\n          key=\"transfer\"\n          exact\n          path=\"/transfer\"\n          render={() => <><Header /><CreateTransferProposal /><Footer /></>}\n        />,\n        <Route\n          key=\"transfers\"\n          exact\n          path=\"/transfers\"\n          render={() => <><Header /><Transfers /><Footer /></>}\n        />,\n        <Route\n          key=\"transfer-details\"\n          exact\n          path={`/transfers/${proposalIdParameter}`}\n          render={() => <><Header /><TransferDetails /><Footer /></>}\n        />,\n        <Route\n          key=\"tribute\"\n          exact\n          path=\"/tribute\"\n          render={() => <><Header /><CreateTributeProposal /><Footer /></>}\n        />,\n        <Route\n          key=\"tributes\"\n          exact\n          path=\"/tributes\"\n          render={() => <><Header /><Tributes /><Footer /></>}\n        />,\n        <Route\n          key=\"tribute-details\"\n          exact\n          path={`/tributes/${proposalIdParameter}`}\n          render={() => <><Header /><TributeDetails /><Footer /></>}\n        />,\n        <Route\n          key=\"governance-proposal\"\n          exact\n          path=\"/governance-proposal\"\n          render={() => <><Header /><CreateGovernanceProposal /><Footer /></>}\n        />,\n        <Route\n          key=\"governance-proposals\"\n          exact\n          path=\"/governance\"\n          render={() => <><Header /><GovernanceProposals /><Footer /></>}\n        />,\n        <Route\n          key=\"governance-proposal-details\"\n          exact\n          path={`/governance/${proposalIdParameter}`}\n          render={() => <><Header /><GovernanceProposalDetails /><Footer /></>}\n        />,\n        <Route\n          key=\"members\"\n          exact\n          path=\"/members\"\n          render={() => <><Header /><Members /><Footer /></>}\n        />,\n        <Route\n          key=\"member-profile\"\n          exact\n          path=\"/members/:ethereumAddress\"\n          render={() => <><Header /><MemberProfile /><Footer /></>}\n        />,\n        // @note Disabling DAO Manager for now because we paused on maintaining\n        // it.\n        // <Route\n        //   key=\"dao-manager\"\n        //   exact\n        //   path=\"/dao-manager\"\n        //   render={() => <AdapterOrExtensionManager />}\n        // />,\n        <Route key=\"redeem\" exact path=\"/redeem\" render={() => <Redeem />} />,\n        // 404 component (note: does not redirect to a route to maintain original path)\n\n      ]}\n    </HashRouter>\n  );\n}\n","import React, {useCallback, useEffect, useState} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {getApiStatus as getSnapshotAPIStatus} from '@openlaw/snapshot-js-erc712';\n\nimport {AsyncStatus} from './util/types';\nimport {getConnectedMember} from './store/actions';\nimport {ReduxDispatch, StoreState} from './store/types';\nimport {SNAPSHOT_HUB_API_URL} from './config';\nimport {useInitContracts, useIsDefaultChain} from './components/web3/hooks';\nimport {useIsMounted} from './hooks';\nimport {useWeb3Modal} from './components/web3/hooks';\n\ntype InitPropsRenderProps = {\n  error: Error | undefined;\n  isInitComplete: boolean;\n};\n\ntype InitProps = {\n  render: (p: InitPropsRenderProps) => React.ReactElement | null;\n};\n\n/**\n * Register any new async process names here.\n * It is mainly to check their progress before rendering.\n *\n * If the app is not dependent on a process before starting\n * do not add it here.\n */\nenum ProcessName {\n  initSnapshotAPI = 'initSnapshotAPI',\n}\n\n/**\n * Init Component\n *\n * Init will run any designated sync/async\n * setup processes and then render any child component\n * upon completion.\n *\n * In our case the children prop component to render is our app.\n *\n * @param {InitProps} props\n */\nexport default function Init(props: InitProps) {\n  const {render} = props;\n\n  /**\n   * Selectors\n   */\n\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n\n  /**\n   * State\n   */\n\n  const [error, setError] = useState<Error>();\n  const [isInitComplete, setIsInitComplete] = useState<boolean>(false);\n  const [processReadyMap, setProcessReadyMap] = useState<\n    Record<ProcessName, AsyncStatus>\n  >({\n    [ProcessName.initSnapshotAPI]: AsyncStatus.STANDBY,\n  });\n\n  /**\n   * Our hooks\n   */\n\n  const {account, web3Instance} = useWeb3Modal();\n  const {isDefaultChain} = useIsDefaultChain();\n  const {isMountedRef} = useIsMounted();\n  const initContracts = useInitContracts();\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * Cached callbacks\n   */\n\n  const handleInitContractsCached = useCallback(handleInitContracts, [\n    initContracts,\n    isDefaultChain,\n    web3Instance,\n  ]);\n\n  const handleGetMemberCached = useCallback(handleGetMember, [\n    account,\n    daoRegistryContract,\n    dispatch,\n    isDefaultChain,\n    web3Instance,\n  ]);\n\n  const handleGetSnapshotAPIStatusCached = useCallback(\n    handleGetSnapshotAPIStatus,\n    [isMountedRef]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    setIsInitComplete(\n      Object.values(processReadyMap).every((fs) => fs === AsyncStatus.FULFILLED)\n    );\n  }, [processReadyMap]);\n\n  useEffect(() => {\n    handleInitContractsCached();\n  }, [handleInitContractsCached, web3Instance]);\n\n  useEffect(() => {\n    handleGetMemberCached();\n  }, [handleGetMemberCached]);\n\n  useEffect(() => {\n    handleGetSnapshotAPIStatusCached();\n  }, [handleGetSnapshotAPIStatusCached]);\n\n  /**\n   * Functions\n   */\n\n  async function handleGetSnapshotAPIStatus() {\n    try {\n      if (!SNAPSHOT_HUB_API_URL) {\n        throw new Error('No Snapshot Hub API URL was found.');\n      }\n      const {data} = await getSnapshotAPIStatus(SNAPSHOT_HUB_API_URL);\n\n      // Choosing a slice of the data to make sure we have a response, not just 200 OK.\n      if (!data.version) {\n        throw new Error('Snapshot API is not ready.');\n      }\n\n      if (!isMountedRef.current) return;\n\n      setProcessReadyMap((p) => ({\n        ...p,\n        [ProcessName.initSnapshotAPI]: AsyncStatus.FULFILLED,\n      }));\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      setError(new Error('Snapshot API is not responding.'));\n    }\n  }\n\n  async function handleInitContracts() {\n    try {\n      if (!isDefaultChain || !web3Instance) {\n        return;\n      }\n\n      await initContracts({web3Instance});\n    } catch (error) {\n      const e = error as Error;\n\n      setError(e);\n    }\n  }\n\n  async function handleGetMember() {\n    try {\n      if (\n        !account ||\n        !daoRegistryContract ||\n        !isDefaultChain ||\n        !web3Instance\n      ) {\n        return;\n      }\n\n      await dispatch(\n        getConnectedMember({\n          account,\n          daoRegistryContract,\n          web3Instance,\n        })\n      );\n    } catch (error) {\n      const e = error as Error;\n\n      setError(e);\n    }\n  }\n\n  // Render children\n  return render({error, isInitComplete});\n}\n","import {useLocation} from 'react-router-dom';\n\nimport Footer from './components/Footer';\nimport GlobalConnectWalletModal from './GlobalConnectWalletModal';\nimport Head from './Head';\nimport Header from './components/Header';\nimport Routes from './Routes';\n\ntype AppProps = {\n  /**\n   * Optionally provide a component to render for the main content.\n   */\n  renderMainContent?: () => React.ReactNode;\n};\n\nexport default function App(props?: AppProps) {\n  /**\n   * Their hooks\n   */\n\n  const {pathname} = useLocation();\n\n  /**\n   * Variables\n   */\n\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      {/* HTML `<head>` (react-helmet) */}\n      <Head />\n\n      {/* CONTENT */}\n\n        <Routes />\n    \n\n      {/* GLOBAL MODALS */}\n      <GlobalConnectWalletModal />\n    </>\n  );\n}\n","import ErrorMessageWithDetails from './components/common/ErrorMessageWithDetails';\nimport FadeIn from './components/common/FadeIn';\n\ntype InitErrorProps = {\n  error: Error;\n};\n\n/**\n * InitError\n *\n * An error component that is meant to be used if the <Init /> component\n * could not complete any of its processes to provide the app with vital data.\n *\n * @param {InitErrorProps} props\n */\nexport default function InitError(props: InitErrorProps) {\n  const {error} = props;\n\n  return (\n    <FadeIn>\n      <div\n        style={{\n          padding: '2em 1em 1em',\n          textAlign: 'center',\n        }}>\n        <h1 style={{fontSize: '2rem'}}>\n          <span\n            className=\"pulse\"\n            role=\"img\"\n            aria-label=\"Emoji with eyes crossed out.\"\n            style={{display: 'inline-block'}}>\n            \n          </span>{' '}\n          Oops, something went wrong.\n        </h1>\n      </div>\n\n      <div\n        style={{\n          textAlign: 'center',\n          maxWidth: 600,\n          display: 'block',\n          margin: '0 auto',\n        }}>\n        <ErrorMessageWithDetails error={error} renderText=\"\" />\n      </div>\n    </FadeIn>\n  );\n}\n","import {ReportHandler} from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({getCLS, getFID, getFCP, getLCP, getTTFB}) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import {render} from 'react-dom';\nimport {Store} from 'redux';\nimport {Provider} from 'react-redux';\nimport {BrowserRouter} from 'react-router-dom';\nimport {ApolloProvider} from '@apollo/react-hooks';\nimport {\n  ApolloClient,\n  concat,\n  InMemoryCache,\n  NormalizedCacheObject,\n  HttpLink,\n  split,\n} from '@apollo/client';\nimport {QueryClient, QueryClientProvider} from 'react-query';\n\nimport {\n  ENVIRONMENT,\n  GRAPH_API_SERVICE_NAME,\n  GRAPH_API_URL,\n  WALLETCONNECT_PROVIDER_OPTIONS,\n} from './config';\nimport {clearConnectedMember, clearContracts} from './store/actions';\nimport {disableReactDevTools} from './util/helpers';\nimport {handleSubgraphError} from './gql';\nimport {store} from './store';\nimport App from './App';\nimport Init from './Init';\nimport InitError from './InitError';\nimport reportWebVitals from './reportWebVitals';\nimport Web3ModalManager from './components/web3/Web3ModalManager';\n\nimport './assets/scss/style.scss';\n\nconst root = document.getElementById('root');\n\n// disable React dev tools for production\nENVIRONMENT === 'production' && disableReactDevTools();\n\n// will be deprecated eventually, for now we set it to false to silence the\n// console warning\nwindow.ethereum &&\n  window.ethereum.autoRefreshOnNetworkChange &&\n  (window.ethereum.autoRefreshOnNetworkChange = false);\n\n// Set graphql endpoints for `ApolloClient`\nconst defaultGraphqlEndpoint = new HttpLink({\n  uri: ({operationName}) => `${GRAPH_API_URL.CORE}?${operationName}`,\n});\nconst couponOnboardingGraphqlEndpoint = new HttpLink({\n  uri: ({operationName}) =>\n    `${GRAPH_API_URL.COUPON_ONBOARDING}?${operationName}`,\n});\nconst nftExtensionGraphqlEndpoint = new HttpLink({\n  uri: ({operationName}) => `${GRAPH_API_URL.NFT_EXTENSION}?${operationName}`,\n});\n\n// Apollo link directional composition (https://www.apollographql.com/docs/react/api/link/introduction/#directional-composition) can be chained to allow for more than two endpoints.\nconst graphqlEndpoints = split(\n  (operation) =>\n    operation.getContext().serviceName ===\n    GRAPH_API_SERVICE_NAME.COUPON_ONBOARDING,\n  couponOnboardingGraphqlEndpoint,\n  split(\n    (operation) =>\n      operation.getContext().serviceName ===\n      GRAPH_API_SERVICE_NAME.NFT_EXTENSION,\n    nftExtensionGraphqlEndpoint,\n    defaultGraphqlEndpoint\n  )\n);\n\n// Create `ApolloClient`\nexport const getApolloClient = (\n  store: Store\n): ApolloClient<NormalizedCacheObject> =>\n  new ApolloClient({\n    link: concat(handleSubgraphError(store), graphqlEndpoints),\n    cache: new InMemoryCache({\n      // Cache data may be lost when replacing the `adapters|extensions`\n      // field of a Query object. To address this problem\n      // (which is not a bug in Apollo Client), define a custom\n      // merge function for the Query.adapters|extensions field, so\n      // InMemoryCache can safely merge these objects\n      // https://www.apollographql.com/docs/react/caching/cache-field-behavior/#the-merge-function\n      typePolicies: {\n        Adapter: {\n          fields: {\n            adapters: {\n              merge(existing = [], incoming: any[]) {\n                return [...existing, ...incoming];\n              },\n            },\n          },\n        },\n        Extension: {\n          fields: {\n            extensions: {\n              merge(existing = [], incoming: any[]) {\n                return [...existing, ...incoming];\n              },\n            },\n          },\n        },\n      },\n    }),\n  });\n\n// Create `QueryClient`\nconst queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      refetchOnWindowFocus: false,\n    },\n  },\n});\n\nif (root !== null) {\n  render(\n    <Provider store={store}>\n      <BrowserRouter>\n        <Web3ModalManager\n          onBeforeDisconnect={() => {\n            // Clear out `connectedMember` and `contracts` Redux state\n            store.dispatch(clearConnectedMember());\n            store.dispatch(clearContracts());\n          }}\n          onBeforeConnect={() => {\n            // Clear out `contracts` Redux state\n            store.dispatch(clearContracts());\n          }}\n          providerOptions={WALLETCONNECT_PROVIDER_OPTIONS}>\n          <ApolloProvider client={getApolloClient(store)}>\n            <QueryClientProvider client={queryClient}>\n              <Init\n                render={({error, isInitComplete}) =>\n                  error ? (\n                    <App\n                      renderMainContent={() => <InitError error={error} />}\n                    />\n                  ) : isInitComplete ? (\n                    <App />\n                  ) : null\n                }\n              />\n            </QueryClientProvider>\n          </ApolloProvider>\n        </Web3ModalManager>\n      </BrowserRouter>\n    </Provider>,\n    root\n  );\n}\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","/**\n * chooseRandom\n *\n * Choose a random item from an array.\n *\n * @param {array} array - The array to choose from.\n * @param doNotChooseItem - An item to not choose (e.g. previously chosen item)\n */\nexport function chooseRandom<T>(array: T[], doNotChooseItem?: T) {\n  const arrayToUse =\n    doNotChooseItem !== undefined\n      ? array.filter((a) => a !== doNotChooseItem)\n      : array;\n\n  return arrayToUse[Math.floor(Math.random() * arrayToUse.length)];\n}\n","/**\n * disableReactDevTools\n *\n * Run before the app mounts to disable React dev tools.\n * Ideally, this is run conditionally based on environment.\n *\n * @see: https://github.com/facebook/react-devtools/issues/191#issuecomment-443607190\n */\nexport function disableReactDevTools() {\n  const noop = (): void => undefined;\n  const DEV_TOOLS = (window as any).__REACT_DEVTOOLS_GLOBAL_HOOK__;\n\n  if (typeof DEV_TOOLS === 'object') {\n    for (const [key, value] of Object.entries(DEV_TOOLS)) {\n      DEV_TOOLS[key] = typeof value === 'function' ? noop : null;\n    }\n  }\n}\n","/**\n * dontCloseWindowWarning\n *\n * Warns user not to close the window.\n *\n * @returns {() => void} unsubscribe function to stop listening, and the callback from firing.\n */\nexport function dontCloseWindowWarning(): () => void {\n  // @see: https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeunload#Example\n  const callback = (event: BeforeUnloadEvent) => {\n    // Cancel the event\n    event.preventDefault();\n    // Chrome requires returnValue to be set\n    event.returnValue = '';\n  };\n\n  window.addEventListener('beforeunload', callback);\n\n  return function unsubscribe() {\n    window.removeEventListener('beforeunload', callback);\n  };\n}\n","/**\n * formatNumber\n *\n * Formats a number (U.S. region) with commas (e.g. 1000 -> 1,000).\n *\n * If an error occurs while converting to a `Number` the original value\n * is attempted to be converted to a `string` and returned.\n *\n * @param {string | number} value\n * @returns {string}\n */\nexport const formatNumber = (value: number | string): string => {\n  const number: number = Number(value ?? undefined);\n\n  if (isNaN(number)) {\n    return '';\n  }\n\n  return number.toLocaleString('en-US');\n};\n","/**\n * formatNumberAbbreviated\n *\n * Formats a `number` to abbreviated `string` for display.\n *\n * Has better browser support than using the newer options in `Intl.NumberFormat`.\n *\n * e.g. 1000000 likes->1M likes\n *\n * @param value `number`\n * @returns `string`\n *\n * @see https://stackoverflow.com/questions/25611937/abbreviate-a-localized-number-in-javascript-for-thousands-1k-and-millions-1m\n * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat/NumberFormat#scientific_engineering_or_compact_notations\n */\nexport function formatNumberAbbreviated(value: number): string {\n  const intlFormat = (v: number): string =>\n    new Intl.NumberFormat().format(Math.round(v * 10) / 10);\n\n  // Trillions\n  if (value >= 1000000000000) return intlFormat(value / 1000000000000) + 'T';\n  // Billions\n  if (value >= 1000000000) return intlFormat(value / 1000000000) + 'B';\n  // Millions\n  if (value >= 1000000) return intlFormat(value / 1000000) + 'M';\n  // Thousands\n  if (value >= 1000) return intlFormat(value / 1000) + 'k';\n\n  // Fallthrough\n  return intlFormat(value);\n}\n","import {CHAIN_NAME, CHAINS, DEFAULT_CHAIN} from '../../config';\n\ntype AlchemyAPIURL = `https://eth-${\n  | typeof CHAIN_NAME['1']\n  | typeof CHAIN_NAME['3']\n  | typeof CHAIN_NAME['4']\n  | typeof CHAIN_NAME['42']\n  | typeof CHAIN_NAME['5']}.alchemyapi.io/v2/${string}`;\n\n/**\n * Alchemy API URL\n *\n * @note Some services (i.e. Transfers) only work on certain network IDs.\n *\n * @param networkID `typeof CHAINS[keyof typeof CHAINS]`\n * @return `AlchemyAPIURL`\n */\nexport function getAlchemyURL(\n  networkID: typeof CHAINS[keyof typeof CHAINS] = DEFAULT_CHAIN\n): AlchemyAPIURL | undefined {\n  if (\n    // Alchemy does not support the following networks\n    networkID === CHAINS.GANACHE ||\n    networkID === CHAINS.HARMONY_MAIN ||\n    networkID === CHAINS.HARMONY_TEST ||\n    // @todo Separate handling for Polygon URL as it's a bit different.\n    networkID === CHAINS.POLYGON ||\n    networkID === CHAINS.POLYGON_TEST ||\n    networkID === CHAINS.AVALANCHE_TEST ||\n    networkID === CHAINS.AVALANCHE_MAIN\n  ) {\n    return;\n  }\n\n  if (!process.env.REACT_APP_ALCHEMY_API_KEY) {\n    console.warn('No Alchemy API key was found.');\n\n    return;\n  }\n\n  return `https://eth-${CHAIN_NAME[networkID]}.alchemyapi.io/v2/${\n    process.env.REACT_APP_ALCHEMY_API_KEY || ''\n  }`;\n}\n","type TimeRemaining = {\n  days: number;\n  hours: number;\n  minutes: number;\n  seconds: number;\n  total: number;\n};\n\nconst DEFAULT_REMAINING: TimeRemaining = {\n  days: 0,\n  hours: 0,\n  minutes: 0,\n  seconds: 0,\n  total: 0,\n};\n\nexport function getTimeRemaining(endTime: Date): TimeRemaining {\n  const nowDate: Date = new Date();\n\n  if (endTime <= nowDate) {\n    return DEFAULT_REMAINING;\n  }\n\n  const total: number = endTime.getTime() - nowDate.getTime();\n  const seconds: number = Math.floor((total / 1000) % 60);\n  const minutes: number = Math.floor((total / 1000 / 60) % 60);\n  const hours: number = Math.floor((total / (1000 * 60 * 60)) % 24);\n  const days: number = Math.floor(total / (1000 * 60 * 60 * 24));\n\n  return {\n    days,\n    hours,\n    minutes,\n    seconds,\n    total,\n  };\n}\n","/**\n * getValidationError\n *\n * Used with react-hook-form (mostly to solve a TS incorrect behavior)\n * Gets the associated error message with a field.\n *\n * @param {string} field\n * @param {Record<string, any>} errors\n * @returns string\n */\nexport function getValidationError(\n  field: string,\n  errors: Record<string, any>\n): string {\n  return errors[field] && 'message' in errors[field]\n    ? (errors[field].message as string)\n    : '';\n}\n","/**\n * normalizeString\n *\n * Converts string case to lowerCase and trims whitespace.\n *\n * @param {string} stringToNormalize\n * @returns {string} The normalized string lowercased and trimmed.\n */\nexport function normalizeString(stringToNormalize: string = ''): string {\n  return stringToNormalize.toLowerCase().trim();\n}\n","import {providers} from 'ethers';\n\nimport {normalizeString} from './normalizeString';\n\n/**\n * isPossibleContractWallet\n *\n * When passing a connected ethereum address, if there is bytecode at the address,\n * there is a good chance that it's a contract wallet. This is not 100% accurate, but it's\n * good enough to make a guess and do something trivial in the UI.\n *\n * @param address\n * @param provider\n * @returns `boolean`\n */\nexport async function isPossibleContractWallet(\n  /**\n   * Ethereum wallet address to check\n   */\n  address: string,\n  /**\n   * Ethers provider\n   *\n   * E.g. `new JsonRpcProvider(...)`\n   */\n  provider: providers.Provider\n): Promise<boolean> {\n  try {\n    const bytecode = await provider.getCode(normalizeString(address));\n\n    // It's a bit easier to detect an EOA (typical public/private key crypto wallet)\n    const addressIsExernallyOwnedAccount: boolean =\n      !bytecode ||\n      bytecode === '0x' ||\n      bytecode === '0x0' ||\n      bytecode === '0x00';\n\n    return addressIsExernallyOwnedAccount === false;\n  } catch (error) {\n    throw error;\n  }\n}\n","/**\n * numberRangeArray\n *\n * Outputs an array sequence of numbers given a total size and starting offset.\n * e.g. Years 1920..2002\n *\n * @param {size} number - Maximum number and last value of array. Default is 1.\n * @param {startAt} number - Offset to begin from. Default is 0.\n * @returns {number[]}\n */\nexport function numberRangeArray(size = 1, startAt = 0): number[] {\n  const adjustedSize = size + 1 - startAt;\n\n  return [...Array(adjustedSize)].map((_, i) => startAt + i);\n}\n","/**\n * stripFormatNumber\n *\n * Strips a number string formatting (via `formatNumber`) (e.g. 10,000 -> 10000).\n *\n * @param {string} value Number string to strip formatting (via `formatNumber`) from.\n * @returns {string} A Number string without any formatting form `formatNumber`.\n *\n * @todo maybe a more friendly way via Intl API in JS core?\n */\nexport const stripFormatNumber = (value: string): string =>\n  value.toString().replace(/,/g, '');\n","import {gql} from '@apollo/client';\n\nexport const GET_DAO = gql`\n  query GetDao($id: ID) {\n    tributeDaos(where: {id: $id}) {\n      id # dao address\n      daoAddress\n      name\n      totalUnits\n      totalUnitsIssued\n    }\n  }\n`;\n","import {gql} from '@apollo/client';\n\nexport const GET_MEMBERS = gql`\n  query GetMembers($daoAddress: String) {\n    tributeDaos(where: {daoAddress: $daoAddress}) {\n      members(orderBy: createdAt, orderDirection: desc) {\n        createdAt\n        address: memberAddress\n        delegateKey\n        isDelegated\n        units\n        didFullyRagequit\n      }\n    }\n  }\n`;\n","import {gql} from '@apollo/client';\n\nexport const GET_ADAPTERS_AND_EXTENSIONS = gql`\n  query GetAdaptersAndExtensions($daoAddress: String) {\n    tributeDaos(where: {daoAddress: $daoAddress}) {\n      daoAddress\n      adapters {\n        id\n        acl\n        adapterId\n        adapterAddress\n      }\n      extensions {\n        id\n        extensionId\n        extensionAddress\n      }\n    }\n  }\n`;\n","import {gql} from '@apollo/client';\n\nexport const GET_TOKEN_HOLDER_BALANCES = gql`\n  query GetTokenHolderBalances($tokenAddress: String!) {\n    tokens(where: {tokenAddress: $tokenAddress}) {\n      symbol\n      tokenAddress\n      holders {\n        balance\n        member {\n          id\n          delegateKey\n        }\n      }\n    }\n  }\n`;\n","import {ApolloLink} from '@apollo/client';\nimport {onError} from '@apollo/client/link/error';\nimport {Store} from 'redux';\n\nimport {setSubgraphNetworkStatus} from '../store/actions';\nimport {SubgraphNetworkStatus} from '../store/subgraphNetworkStatus/types';\nimport {StoreState} from '../store/types';\n\n/**\n * handleSubgraphError\n *\n * Handles an error from The Graph's GQL server at the Apollo\n * Link level.\n *\n * Handles network errors from The Graph's GQL server.\n *\n * About network errors from the Apollo Docs:\n *\n *   \"Network errors occur \"These are errors encountered while attempting\n *    to communicate with your GraphQL server, usually resulting in a\n *    4xx or 5xx response status code (and no data).\"\n *\n * We do not handle GQL errors that arise from individual queries.\n * Perhaps it best to handle those inside of the concerned components\n * (i.e. IF query error || subgraph is down THEN fallback)\n *\n * About GQL errors from the Apollo Docs:\n *\n *  - Syntax errors (e.g., a query was malformed)\n *  - Validation errors (e.g., a query included a schema field that doesn't exist)\n *  - Resolver errors (e.g., an error occurred while attempting to populate a query field)\n *\n * @param {Store} store\n * @returns {ApolloLink}\n * @link https://www.apollographql.com/docs/react/data/error-handling\n */\nexport function handleSubgraphError(store: Store): ApolloLink {\n  return onError(({/* graphQLErrors */ networkError}) => {\n    if (networkError) {\n      const reduxStateNotYetSet =\n        (store.getState() as StoreState).subgraphNetworkStatus.status !==\n        SubgraphNetworkStatus.ERR;\n\n      if (reduxStateNotYetSet) {\n        store.dispatch(\n          setSubgraphNetworkStatus({status: SubgraphNetworkStatus.ERR})\n        );\n\n        // Show error once\n        console.error(`[Subgraph network error]: ${networkError}`);\n      }\n    }\n\n    // Reset when there's no more network error\n    if (!networkError) {\n      const reduxStateNotYetSet =\n        (store.getState() as StoreState).subgraphNetworkStatus.status !==\n        SubgraphNetworkStatus.OK;\n\n      if (reduxStateNotYetSet) {\n        store.dispatch(\n          setSubgraphNetworkStatus({status: SubgraphNetworkStatus.OK})\n        );\n      }\n    }\n  });\n}\n","import {config as dotenvConfig} from 'dotenv';\nimport {IProviderOptions} from 'web3modal';\nimport {isMobile} from '@walletconnect/browser-utils';\nimport {resolve} from 'path';\nimport WalletConnectProvider from '@walletconnect/web3-provider';\n\nimport {EnvironmentName} from './util/types';\nimport {isEthAddressValid} from './util/validation';\n\ndotenvConfig({path: resolve(__dirname, '../.env')});\n\n/**\n * Global DApp Config\n */\n\nconst {\n  REACT_APP_COUPON_API_URL,\n  REACT_APP_DAO_REGISTRY_CONTRACT_ADDRESS,\n  REACT_APP_DEFAULT_CHAIN_NAME_LOCAL,\n  REACT_APP_ENABLE_KYC_ONBOARDING,\n  REACT_APP_ENVIRONMENT,\n  REACT_APP_GRAPH_CORE_URL,\n  REACT_APP_GRAPH_COUPON_ONBOARDING_URL,\n  REACT_APP_GRAPH_NFT_EXTENSION_URL,\n  REACT_APP_INFURA_PROJECT_ID_DEV,\n  REACT_APP_INFURA_PROJECT_ID_LOCAL,\n  REACT_APP_INFURA_PROJECT_ID_PROD,\n  REACT_APP_KYC_BACKEND_URL,\n  REACT_APP_KYC_FORMS_URL,\n  REACT_APP_MULTICALL_CONTRACT_ADDRESS,\n  REACT_APP_ONBOARDING_TOKEN_ADDRESS,\n  REACT_APP_SNAPSHOT_HUB_API_URL,\n  REACT_APP_SNAPSHOT_SPACE,\n} = process.env;\n\nconsole.log(process.env);\n\nexport const ENVIRONMENT = REACT_APP_ENVIRONMENT as EnvironmentName | undefined;\n\n/**\n * SNAPSHOT_HUB_API_URL\n *\n * @note For `ENVIRONMENT=localhost` we need to use CRA's local proxy\n *   so that we can communicate with our develop Snapshot Hub API\n *   without any CORS issues.\n *\n * @see src/setupProxy.js\n */\nexport const SNAPSHOT_HUB_API_URL: string | undefined =\n  ENVIRONMENT === 'localhost'\n    ? '/snapshot-hub'\n    : REACT_APP_SNAPSHOT_HUB_API_URL;\n\n// Coupon Manager API URL (for coupon onboarding)\nexport const COUPON_API_URL: string | undefined = REACT_APP_COUPON_API_URL;\n\n// KYC Onboarding feature\nexport const ENABLE_KYC_ONBOARDING: boolean =\n  REACT_APP_ENABLE_KYC_ONBOARDING === 'true';\n\n// KYC Backend URL (for KYC onboarding)\nexport const KYC_BACKEND_URL: string | undefined = REACT_APP_KYC_BACKEND_URL;\n\n// KYC Forms URL (for redirecting to separate moloch v2 instance that will be\n// used for KYC verification)\nexport const KYC_FORMS_URL: string | undefined = REACT_APP_KYC_FORMS_URL;\n\n// The Graph API URLs\nexport const GRAPH_API_URL = {\n  CORE: REACT_APP_GRAPH_CORE_URL,\n  COUPON_ONBOARDING: REACT_APP_GRAPH_COUPON_ONBOARDING_URL,\n  NFT_EXTENSION: REACT_APP_GRAPH_NFT_EXTENSION_URL,\n};\n\n// The Graph API service names\nexport const GRAPH_API_SERVICE_NAME = {\n  CORE: 'core',\n  COUPON_ONBOARDING: 'coupon-onboarding',\n  NFT_EXTENSION: 'nft-extension',\n};\n\n// Network IDs, when users change wallet networks\nexport const CHAINS = {\n  MAINNET: 1,\n  ROPSTEN: 3,\n  RINKEBY: 4,\n  GOERLI: 5,\n  KOVAN: 42,\n  GANACHE: 1337,\n  HARMONY_TEST: 1666700000,\n  HARMONY_MAIN: 1666600000,\n  POLYGON_TEST: 80001,\n  POLYGON: 137,\n  AVALANCHE_TEST: 43113,\n  AVALANCHE_MAIN: 43114,\n} as const;\n\n// Network names\nexport const CHAIN_NAME = {\n  [CHAINS.MAINNET]: 'mainnet',\n  [CHAINS.ROPSTEN]: 'ropsten',\n  [CHAINS.RINKEBY]: 'rinkeby',\n  [CHAINS.GOERLI]: 'goerli',\n  [CHAINS.KOVAN]: 'kovan',\n  [CHAINS.GANACHE]: 'ganache',\n  [CHAINS.HARMONY_TEST]: 'harmony-testnet',\n  [CHAINS.HARMONY_MAIN]: 'harmony-mainnet',\n  [CHAINS.POLYGON]: 'polygon-mainnet',\n  [CHAINS.POLYGON_TEST]: 'polygon-testnet',\n  [CHAINS.AVALANCHE_TEST]: 'avalanche-fuji',\n  [CHAINS.AVALANCHE_MAIN]: 'avalanche-mainnet',\n} as const;\n\n// Network names verbose\nexport const CHAIN_NAME_FULL = {\n  [CHAINS.MAINNET]: 'Main Ethereum Network',\n  [CHAINS.ROPSTEN]: 'Ropsten Test Network',\n  [CHAINS.RINKEBY]: 'Rinkeby Test Network',\n  [CHAINS.GOERLI]: 'Grli Test Network',\n  [CHAINS.KOVAN]: 'Kovan Test Network',\n  [CHAINS.GANACHE]: 'Ganache Test Network',\n  [CHAINS.HARMONY_TEST]: 'Harmony Test Network',\n  [CHAINS.HARMONY_MAIN]: 'Harmony Main Network',\n  [CHAINS.POLYGON_TEST]: 'Polygon Test Network',\n  [CHAINS.POLYGON]: 'Polygon Main Network',\n  [CHAINS.AVALANCHE_TEST]: 'Avalanche Fuji Test Network',\n  [CHAINS.AVALANCHE_MAIN]: 'Avalanche Main Network',\n};\n\nexport const DEFAULT_CHAIN: typeof CHAINS[keyof typeof CHAINS] =\n  REACT_APP_ENVIRONMENT === 'production'\n    ? CHAINS.MAINNET\n    : REACT_APP_ENVIRONMENT === 'development'\n    ? CHAINS.RINKEBY\n    : REACT_APP_DEFAULT_CHAIN_NAME_LOCAL // Set this to change local development chain\n    ? CHAINS[REACT_APP_DEFAULT_CHAIN_NAME_LOCAL]\n    : CHAINS.GANACHE; // Defaults to a Ganache private network (1337)\n\nexport const ETHERSCAN_URLS: {[chainId: number]: string} = {\n  [CHAINS.MAINNET]: `https://etherscan.io`,\n  [CHAINS.ROPSTEN]: `https://ropsten.etherscan.io`,\n  [CHAINS.RINKEBY]: `https://rinkeby.etherscan.io`,\n  [CHAINS.GOERLI]: `https://goerli.etherscan.io`,\n  [CHAINS.KOVAN]: `https://kovan.etherscan.io`,\n  [CHAINS.HARMONY_TEST]: `https://explorer.pops.one`,\n  [CHAINS.HARMONY_MAIN]: `https://explorer.harmony.one`,\n  [CHAINS.POLYGON_TEST]: `https://mumbai.polygonscan.com`,\n  [CHAINS.POLYGON]: `https://polygonscan.com`,\n  [CHAINS.AVALANCHE_TEST]: `https://testnet.snowtrace.io`,\n  [CHAINS.AVALANCHE_MAIN]: `https://snowtrace.io`,\n};\n\nexport const INFURA_WS_URLS: {[chainId: number]: string} = {\n  [CHAINS.MAINNET]: `wss://mainnet.infura.io/ws/v3`,\n  [CHAINS.ROPSTEN]: `wss://ropsten.infura.io/ws/v3`,\n  [CHAINS.RINKEBY]: `wss://rinkeby.infura.io/ws/v3`,\n  [CHAINS.GOERLI]: `wss://goerli.infura.io/ws/v3`,\n  [CHAINS.KOVAN]: `wss://kovan.infura.io/ws/v3`,\n  [CHAINS.HARMONY_TEST]: `wss://ws.s0.pops.one`,\n  [CHAINS.HARMONY_MAIN]: `wss://ws.s0.t.hmny.io`,\n  [CHAINS.POLYGON_TEST]: `wss://ws-matic-mumbai.chainstacklabs.com`,\n  [CHAINS.POLYGON]: `wss://ws-matic-mainnet.chainstacklabs.com`,\n  [CHAINS.AVALANCHE_TEST]: `wss://api.avax-test.network:9650/ext/bc/C/ws`,\n  [CHAINS.AVALANCHE_MAIN]: `wss://api.avax.network:9650/ext/bc/C/ws`,\n};\n\n// Infura Project Id\nexport const INFURA_PROJECT_ID =\n  REACT_APP_ENVIRONMENT === 'production'\n    ? REACT_APP_INFURA_PROJECT_ID_PROD\n    : REACT_APP_ENVIRONMENT === 'development'\n    ? REACT_APP_INFURA_PROJECT_ID_DEV\n    : REACT_APP_INFURA_PROJECT_ID_LOCAL;\n\n// Ethereum Provider URL\nexport const ETHEREUM_PROVIDER_URL: string = INFURA_WS_URLS[DEFAULT_CHAIN]\n  ? INFURA_PROJECT_ID\n    ? `${INFURA_WS_URLS[DEFAULT_CHAIN]}/${INFURA_PROJECT_ID}`\n    : INFURA_WS_URLS[DEFAULT_CHAIN]\n  : DEFAULT_CHAIN === CHAINS.GANACHE\n  ? /**\n     * Ganache over WebSocket should work. @note Is not tested, yet.\n     * Attempting to be consistent with a WebSocket URL to avoid more logic.\n     *\n     * @link https://www.trufflesuite.com/docs/truffle/reference/configuration#networks\n     */\n    'ws://127.0.0.1:7545'\n  : '';\n\n/**\n * Wallet Connect config\n */\n\n/**\n * Tell Web3modal what providers we have available.\n *\n * The built-in web browser provider (only one can exist at a time),\n * MetaMask, Brave or Opera is added automatically by Web3modal\n */\nexport const WALLETCONNECT_PROVIDER_OPTIONS: IProviderOptions = {\n  // Injected providers\n  injected: {\n    display: {\n      name: 'MetaMask',\n      description: 'Connect with the provider in your Browser',\n    },\n    package: null,\n  },\n  // WalletConnect provider\n  walletconnect: {\n    display: {\n      name: 'WalletConnect',\n      description: 'Connect with your mobile wallet',\n    },\n    package: WalletConnectProvider,\n    options: {\n      infuraId: INFURA_PROJECT_ID, // required\n      qrcodeModalOptions: {\n        mobileLinks: isMobile()\n          ? ['rainbow', 'metamask', 'argent', 'trust']\n          : [],\n      },\n    },\n  },\n};\n\n/**\n * CORE CONTRACTS\n * @note as per https://github.com/openlawteam/tribute-contracts#architecture\n *\n * - DAO Registry (@note uses dao address for the contract address)\n * - DAO Factory\n */\n\n// If developing locally, include your DaoRegistry contract address in your `.env` file.\nexport const DAO_REGISTRY_CONTRACT_ADDRESS =\n  REACT_APP_DAO_REGISTRY_CONTRACT_ADDRESS;\n\nexport const DAO_FACTORY_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x76F5D63243AE3b176128Ab8C0451Ff347391f56e',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x6d92a8E4aB80adcBbFDA44ef69fe847f82def641',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const BANK_FACTORY_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x80feBc0872aB9CEC472663C0fE33fA1e19C0D3BF',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0xcD1639FD072113CC86e15f65f1505C6D58Aa7412',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\n// @todo\nexport const NFT_COLLECTION_FACTORY_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xd0A4b78719e44fF94FB57702699c1655Ef6ca5DF',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0xcF34FFFBba648719DAe106202674949f1679772B',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\n// @todo\nexport const ERC20_TOKEN_FACTORY_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x8a3FF22C8E4589d73BA48a6Ee01f6Fa21C5F1a46',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x862d71d6E9Be8a7495EfEBa6f2b657b00E629c95',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\n/**\n * ADAPTER CONTRACTS\n * @note as per https://github.com/openlawteam/tribute-contracts#architecture\n *\n * - Configuration\n * - CouponOnboardingContract\n * - Managing\n * - Onboarding\n * - Voting\n * - Offchain voting\n * - Financing\n * - Tribute\n * - Distribute\n * - Rage quit\n * - Guild kick\n * - BankAdapter\n * - TributeNFT\n * - DaoRegistryAdapter\n * - KycOnboarding\n */\n\nexport const VOTING_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xc079A93B9852eAa146de2Ea1057c5174ACdaDbCa',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0xfB4E7C2FD8Ceb2757D2C4cE4749ebE326fc369D4',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const CONFIGURATION_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x63B788B55cA25ECAf202066651d0287a59Bd8472',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x65CaCA9F2638Fb2B245E9694f00343F0b6CB6F77',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const RAGEQUIT_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x7eEfF2b586793f8399d59b15585d32b6364B4CeE',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x314C824Ea4586798DF8B46121E881Defa40CB47E',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const MANAGING_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xD84AB37f3c7b381e36BCa500fBCfB0699f21696B',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0xeD025b5BA14b8f3A085057b9D7Baa13998343aA8',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const FINANCING_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xc95e94250ABB136B4DbdC5726A68747DB65CbcED',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x4a7A5946567672c577EaF2b866BCeBc177E455E8',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const ONBOARDING_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x581234019E087B6F1d038157e9Ad05E7858C079e',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x4e1Ccf6Bca8d14B670478d8C4e2aEc9f6277A7f5',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const GUILDKICK_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xBa4FDDeEBd4Dd23fC503a591E41E8D386c1c16c3',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x72a011Aa67F8214a146A162A99B322017ad763fD',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const DAO_REGISTRY_ADAPTER_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x864E2A55d776749A7612D091c4553dA667543F01',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x4d4243f2d605282CBd27C8391f05b77316d1a561',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const BANK_ADAPTER_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x23ec156efF19ddB55fcBAd0A49488Dd1FB26a041',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0xA8EA078cF1D3837a025329c46A4E0F441Cb2eE87',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const COUPONONBOARDING_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x374a5DEA375320513B630B7cA2946F740A33B90d',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x9A2E533FBa58Ec8b0dA34438154C48E295C80576',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const TRIBUTE_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x59914E5BBEe0E55119cD2DC2a4e08E18435271A2',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0xa7D723BFc4deC341da03E70Af4026B3926b1E8Db',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const DISTRIBUTE_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xc71538123fC6FED3607ccBc6D52Cc7882f66f5d0',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x6749b9151B654A77ddA3Fa8f2b259E0E592065F6',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const TRIBUTE_NFT_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x4939D7Ff53AcDbDC1BbC18bDd2F5E5aaD0087Bc9',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x4Df3729e7B952EBE6d18b52132D2A8af2F2D167A',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const OFFCHAINVOTING_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x914eFbA7885f151AAe0665629F33Aff1Aa4Fe65d',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0xae02a075290D2efD74F0D3fE2DfE64831320855a',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\nexport const KYC_ONBOARDING_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x596ADA187E2374352187479fB12e592Ae3E2f85e',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '',\n  [CHAINS.HARMONY_TEST]: '',\n  [CHAINS.HARMONY_MAIN]: '',\n  [CHAINS.POLYGON_TEST]: '',\n  [CHAINS.POLYGON]: '',\n  [CHAINS.AVALANCHE_TEST]: '',\n  [CHAINS.AVALANCHE_MAIN]: '',\n};\n\n// If developing locally, include your Multicall contract address in your `.env`\n// file.\nexport const MULTICALL_CONTRACT_ADDRESS: string | undefined =\n  REACT_APP_MULTICALL_CONTRACT_ADDRESS;\n\n/**\n * These addresses are important as the contracts use them in their configs.\n *\n * @todo Remove and get from the chain/subgraph?\n *\n * @see https://github.com/openlawteam/tribute-contracts/blob/master/utils/contract-util.js\n */\nexport const GUILD_ADDRESS: string =\n  '0x000000000000000000000000000000000000dead';\nexport const TOTAL_ADDRESS: string =\n  '0x000000000000000000000000000000000000babe';\nexport const UNITS_ADDRESS: string =\n  '0x00000000000000000000000000000000000FF1CE';\nexport const LOOT_ADDRESS: string =\n  '0x00000000000000000000000000000000B105F00D';\nexport const MEMBER_COUNT_ADDRESS: string =\n  '0x00000000000000000000000000000000DECAFBAD';\nexport const ETH_TOKEN_ADDRESS: string =\n  '0x0000000000000000000000000000000000000000';\nexport const DAI_TOKEN_ADDRESS: string =\n  '0x95b58a6bff3d14b7db2f5cb5f0ad413dc2940658';\nexport const ESCROW_ADDRESS: string =\n  '0x0000000000000000000000000000000000004bec';\n\n/**\n * `SPACE` is used inside Snapshot Hub for matching a `space`\n * with its own proposals and votes.\n */\nexport const SPACE: string | undefined = REACT_APP_SNAPSHOT_SPACE;\n\n/**\n * POLLING INTERVAL FOR GQL QUERIES\n * localhost | development - ms, poll every 5sec = 5000\n * production - ms, poll every 10sec = 10000\n */\nexport const GQL_QUERY_POLLING_INTERVAL: number =\n  REACT_APP_ENVIRONMENT === 'production' ? 10000 : 5000;\n\n/**\n * The address of the token that will be contributed to onboard. If optional\n * ERC20 token address has not been set or if that address is invalid, ETH will\n * be used as default.\n */\nexport const ONBOARDING_TOKEN_ADDRESS: string =\n  REACT_APP_ONBOARDING_TOKEN_ADDRESS &&\n  isEthAddressValid(REACT_APP_ONBOARDING_TOKEN_ADDRESS)\n    ? REACT_APP_ONBOARDING_TOKEN_ADDRESS\n    : ETH_TOKEN_ADDRESS;\n","import {\n  createVote,\n  getVoteResultRootDomainDefinition,\n  prepareVoteResult,\n  signMessage,\n  VoteChoicesIndex,\n} from '@openlaw/snapshot-js-erc712';\nimport {useSelector} from 'react-redux';\nimport {useState} from 'react';\nimport {VoteEntry} from '@openlaw/snapshot-js-erc712/dist/types';\n\nimport {\n  DEFAULT_CHAIN,\n  MEMBER_COUNT_ADDRESS,\n  TOTAL_ADDRESS,\n  UNITS_ADDRESS,\n} from '../../../config';\nimport {\n  getAdapterAddressFromContracts,\n  multicall,\n  MulticallTuple,\n} from '../../web3/helpers';\nimport {BadNodeError} from './types';\nimport {ContractAdapterNames, Web3TxStatus} from '../../web3/types';\nimport {getOffchainVotingProof, submitOffchainVotingProof} from '../helpers';\nimport {normalizeString, numberRangeArray} from '../../../util/helpers';\nimport {OffchainVotingContract} from '../../../abis/types/OffchainVotingContract';\nimport {PRIMARY_TYPE_ERC712, TX_CYCLE_MESSAGES} from '../../web3/config';\nimport {ProposalData} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useMemberActionDisabled} from '../../../hooks';\nimport {useWeb3Modal, useContractSend, useETHGasPrice} from '../../web3/hooks';\nimport CycleMessage from '../../feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../../common/ErrorMessageWithDetails';\nimport EtherscanURL from '../../web3/EtherscanURL';\nimport FadeIn from '../../common/FadeIn';\nimport Loader from '../../feedback/Loader';\n\ntype Node = Parameters<\n  OffchainVotingContract['methods']['submitVoteResult']\n>['4'];\n\ntype OffchainVotingSubmitResultActionProps = {\n  adapterName: ContractAdapterNames;\n  proposal: ProposalData;\n};\n\ntype SubmitVoteResultArguments = [\n  daoAddress: string,\n  proposalId: string,\n  resultRoot: string,\n  reporter: string,\n  lastResult: Node,\n  rootSig: string\n];\n\nexport function OffchainOpRollupVotingSubmitResultAction(\n  props: OffchainVotingSubmitResultActionProps\n) {\n  const {\n    adapterName,\n    proposal: {daoProposalVotingAdapter, snapshotProposal},\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [signatureStatus, setSignatureStatus] = useState<Web3TxStatus>(\n    Web3TxStatus.STANDBY\n  );\n\n  const [submitError, setSubmitError] = useState<Error>();\n\n  /**\n   * Selectors\n   */\n\n  const bankExtensionAddress = useSelector(\n    (s: StoreState) => s.contracts.BankExtensionContract?.contractAddress\n  );\n\n  const bankExtensionMethods = useSelector(\n    (s: StoreState) => s.contracts.BankExtensionContract?.instance.methods\n  );\n\n  const getPriorAmountABI = useSelector((s: StoreState) =>\n    s.contracts.BankExtensionContract?.abi.find(\n      (ai) => ai.name === 'getPriorAmount'\n    )\n  );\n\n  const daoRegistryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n\n  const getMemberAddressABI = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.abi\n  )?.find((ai) => ai.name === 'getMemberAddress');\n\n  const contracts = useSelector((s: StoreState) => s.contracts);\n\n  /**\n   * Our hooks\n   */\n\n  const {account, provider, web3Instance} = useWeb3Modal();\n  const {txEtherscanURL, txIsPromptOpen, txSend, txStatus} = useContractSend();\n  const {average: gasPrice} = useETHGasPrice();\n\n  const {isDisabled, openWhyDisabledModal, WhyDisabledModal} =\n    useMemberActionDisabled();\n\n  /**\n   * Variables\n   */\n\n  const votingAdapterMethods =\n    daoProposalVotingAdapter?.getWeb3VotingAdapterContract<OffchainVotingContract>()\n      .methods;\n\n  const isInProcess =\n    signatureStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    signatureStatus === Web3TxStatus.PENDING ||\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING;\n\n  const isDone =\n    txStatus === Web3TxStatus.FULFILLED &&\n    signatureStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n\n  /**\n   * Functions\n   */\n\n  async function handleSubmit() {\n    try {\n      if (!daoRegistryAddress) {\n        throw new Error('No DAO Registry address was found.');\n      }\n\n      if (!bankExtensionAddress) {\n        throw new Error('No Bank Extension address was found.');\n      }\n\n      if (!getMemberAddressABI) {\n        throw new Error('No ABI for `getMemberAddress` was found.');\n      }\n\n      if (!getPriorAmountABI) {\n        throw new Error('No ABI for `getPriorAmount` was found.');\n      }\n\n      if (!snapshotProposal) {\n        throw new Error('No Snapshot proposal was found.');\n      }\n\n      if (!snapshotProposal.votes) {\n        throw new Error('No Snapshot proposal votes Array was found.');\n      }\n\n      if (!votingAdapterMethods) {\n        throw new Error('No \"OffchainVotingContract\" methods were found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      if (!bankExtensionMethods) {\n        throw new Error('No BankExtension methods were found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      setSignatureStatus(Web3TxStatus.AWAITING_CONFIRM);\n\n      const {idInDAO: proposalHash} = snapshotProposal;\n\n      const snapshot: string = snapshotProposal.msg.payload.snapshot.toString();\n\n      const adapterAddress = getAdapterAddressFromContracts(\n        adapterName,\n        contracts\n      );\n\n      // Get total number of potential and admitted members in the DAO at the snapshot\n      const numberOfDAOMembersAtSnapshot: string = await bankExtensionMethods\n        .getPriorAmount(TOTAL_ADDRESS, MEMBER_COUNT_ADDRESS, snapshot)\n        .call();\n\n      const getMemberAddressCalls: MulticallTuple[] = numberRangeArray(\n        Number(numberOfDAOMembersAtSnapshot) - 1,\n        0\n      ).map(\n        (memberIndex): MulticallTuple => [\n          daoRegistryAddress,\n          getMemberAddressABI,\n          [memberIndex.toString()],\n        ]\n      );\n\n      // Get all member addresses in the DAO based on the member count\n      const memberAddresses: string[] = await multicall({\n        calls: getMemberAddressCalls,\n        web3Instance,\n      });\n\n      const memberBalanceCalls: MulticallTuple[] = memberAddresses.map(\n        (m): MulticallTuple => [\n          bankExtensionAddress,\n          getPriorAmountABI,\n          [m, UNITS_ADDRESS, snapshot],\n        ]\n      );\n\n      // Get all member balances\n      const memberBalancesAtSnapshot: string[] = await multicall({\n        calls: memberBalanceCalls,\n        web3Instance,\n      });\n\n      // Create vote entries\n      const votes: VoteEntry[] = memberAddresses.map((memberAddress, i) => {\n        const voteData = Object.values(\n          snapshotProposal.votes?.find(\n            (v) =>\n              normalizeString(memberAddress) ===\n              normalizeString(\n                Object.values(v)[0].msg.payload.metadata.memberAddress\n              )\n          ) || {}\n        )[0];\n\n        // Create votes based on whether `voteData` was found for `memberAddress`\n        return createVote({\n          proposalId: proposalHash,\n          sig: voteData?.sig || '0x',\n          timestamp: voteData ? Number(voteData.msg.timestamp) : 0,\n          voteYes: voteData?.msg.payload.choice === VoteChoicesIndex.Yes,\n          weight: voteData ? memberBalancesAtSnapshot[i] : '0',\n        });\n      });\n\n      // Prepare vote Result\n      const {voteResultTree, result} = await prepareVoteResult({\n        actionId: adapterAddress,\n        chainId: DEFAULT_CHAIN,\n        daoAddress: daoRegistryAddress,\n        votes,\n      });\n\n      const voteResultTreeHexRoot: string = voteResultTree.getHexRoot();\n      // The last of the result node tree steps\n      const resultNodeLast = result[result.length - 1] as any as Node;\n\n      // Validate the vote result node by calling the contract\n      const getBadNodeErrorResponse: string = await votingAdapterMethods\n        .getBadNodeError(\n          daoRegistryAddress,\n          proposalHash,\n          // `bool submitNewVote`\n          true,\n          voteResultTreeHexRoot,\n          snapshot,\n          // `gracePeriodStartingTime` should be `0` as `submitNewVote` is `true`\n          0,\n          numberOfDAOMembersAtSnapshot,\n          resultNodeLast\n        )\n        .call();\n\n      if (Number(getBadNodeErrorResponse) !== BadNodeError.OK) {\n        throw new Error(\n          `Cannot submit off-chain voting result. Node has an error: ${BadNodeError[getBadNodeErrorResponse]}.`\n        );\n      }\n\n      // Prepare to sign root hex result\n      const {domain, types} = getVoteResultRootDomainDefinition(\n        daoRegistryAddress,\n        adapterAddress,\n        DEFAULT_CHAIN\n      );\n\n      const messageParams: string = JSON.stringify({\n        domain,\n        message: {root: voteResultTreeHexRoot},\n        primaryType: PRIMARY_TYPE_ERC712,\n        types,\n      });\n\n      // Sign root hex result message\n      const signature: string = await signMessage(\n        provider,\n        account,\n        messageParams\n      );\n\n      // Check if off-chain proof has already been submitted\n      const snapshotOffchainProofExists: boolean =\n        ((await getOffchainVotingProof(voteResultTreeHexRoot))?.merkle_root\n          .length || '') > 0;\n\n      /**\n       * Send off-chain vote proof silently to Snapshot Hub for storage and later use.\n       *\n       * We're piggy-backing off of the signature async call's status, instead of setting another status.\n       * E.g. It may confuse the user if we were to display text saying we're \"submitting\n       * off-chain proof\", or something to this effect, for a second or two.\n       */\n      if (!snapshotOffchainProofExists) {\n        await submitOffchainVotingProof({\n          actionId: adapterAddress,\n          chainId: DEFAULT_CHAIN,\n          steps: result,\n          merkleRoot: voteResultTreeHexRoot,\n          verifyingContract: daoRegistryAddress,\n        });\n      }\n\n      setSignatureStatus(Web3TxStatus.FULFILLED);\n\n      const submitVoteResultArguments: SubmitVoteResultArguments = [\n        daoRegistryAddress,\n        proposalHash,\n        voteResultTreeHexRoot,\n        account,\n        resultNodeLast,\n        signature,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(gasPrice ? {gasPrice} : null),\n      };\n\n      // Send the tx\n      await txSend(\n        'submitVoteResult',\n        votingAdapterMethods,\n        submitVoteResultArguments,\n        txArguments\n      );\n    } catch (error) {\n      const e = error as Error;\n\n      setSubmitError(e);\n      setSignatureStatus(Web3TxStatus.REJECTED);\n    }\n  }\n\n  function renderSubmitStatus(): React.ReactNode {\n    // Either Snapshot or chain tx\n    if (\n      txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n      signatureStatus === Web3TxStatus.AWAITING_CONFIRM\n    ) {\n      return 'Awaiting your confirmation\\u2026';\n    }\n\n    // Only for chain tx\n    switch (txStatus) {\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>Result submitted!</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      <div>\n        <button\n          className=\"proposaldetails__button\"\n          disabled={isDisabled || isInProcessOrDone}\n          onClick={isDisabled || isInProcessOrDone ? () => {} : handleSubmit}>\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Submit Vote Result'}\n        </button>\n\n        <ErrorMessageWithDetails\n          error={submitError}\n          renderText=\"Something went wrong\"\n        />\n\n        {/* SUBMIT STATUS */}\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {isDisabled && (\n          <button\n            className=\"button--help-centered\"\n            onClick={openWhyDisabledModal}>\n            Why is submitting disabled?\n          </button>\n        )}\n      </div>\n\n      <WhyDisabledModal title=\"Why is this disabled?\" />\n    </>\n  );\n}\n","import {useEffect, useRef, useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {VoteChoices} from '@openlaw/snapshot-js-erc712';\n\nimport {\n  useMemberActionDisabled,\n  useMemberUnitsAtSnapshot,\n} from '../../../hooks';\nimport {AsyncStatus} from '../../../util/types';\nimport {ContractAdapterNames, Web3TxStatus} from '../../web3/types';\nimport {getVoteChosen} from '../helpers';\nimport {ProposalData} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useSignAndSendVote} from '../hooks';\nimport {useWeb3Modal} from '../../web3/hooks';\nimport {VotingActionButtons} from '.';\nimport ErrorMessageWithDetails from '../../common/ErrorMessageWithDetails';\n\ntype OffchainVotingActionProps = {\n  adapterName?: ContractAdapterNames;\n  proposal: ProposalData;\n};\n\ntype VotingDisabledReasons = {\n  alreadyVotedMessage: string;\n  fetchingMembershipAtSnapshotMessage: string;\n  noMembershipAtSnapshotMessage: string;\n  undeterminedMembershipAtSnapshotMessage: string;\n};\n\nconst {FULFILLED, PENDING, REJECTED} = AsyncStatus;\n\n/**\n * OffchainVotingAction\n *\n * An off-chain voting action component which facilitates submitting to Snapshot Hub.\n *\n * @returns {JSX.Element}\n */\nexport function OffchainVotingAction(\n  props: OffchainVotingActionProps\n): JSX.Element | null {\n  const {\n    adapterName,\n    proposal: {snapshotProposal, refetchProposalOrDraft},\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [voteChoiceClicked, setVoteChoiceClicked] = useState<VoteChoices>();\n  const [submitError, setSubmitError] = useState<Error>();\n\n  /**\n   * Refs\n   */\n\n  const votingDisabledReasonsRef = useRef<VotingDisabledReasons>({\n    alreadyVotedMessage: '',\n    fetchingMembershipAtSnapshotMessage: '',\n    noMembershipAtSnapshotMessage: '',\n    undeterminedMembershipAtSnapshotMessage: '',\n  });\n\n  /**\n   * Selectors\n   */\n\n  const memberAddress = useSelector(\n    (s: StoreState) => s.connectedMember?.memberAddress\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account} = useWeb3Modal();\n  const {signAndSendVote, voteDataStatus} = useSignAndSendVote();\n  const voteChosen = getVoteChosen(snapshotProposal?.votes, account || '');\n\n  const {\n    isDisabled,\n    openWhyDisabledModal,\n    setOtherDisabledReasons,\n    WhyDisabledModal,\n  } = useMemberActionDisabled();\n\n  const {\n    hasMembershipAtSnapshot,\n    memberUnitsAtSnapshotError,\n    memberUnitsAtSnapshotStatus,\n  } = useMemberUnitsAtSnapshot(\n    memberAddress,\n    snapshotProposal?.msg.payload.snapshot\n  );\n\n  /**\n   * Variables\n   */\n\n  const snapshot: number | undefined = snapshotProposal?.msg.payload.snapshot;\n  const proposalHash: string = snapshotProposal?.idInDAO || '';\n  const snapshotProposalId: string = snapshotProposal?.idInSnapshot || '';\n\n  const isInProcess =\n    voteDataStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    voteDataStatus === Web3TxStatus.PENDING;\n\n  const isDone = voteDataStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone = isInProcess || isDone;\n\n  const isSubmitDisabled = isDisabled || isInProcessOrDone;\n\n  const voteChoiceProgress: VoteChoices | undefined = isInProcess\n    ? voteChoiceClicked\n    : undefined;\n\n  const error: Error | undefined = submitError || memberUnitsAtSnapshotError;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    // 1. Determine and set local reasons why voting would be disabled\n\n    // Reason: already voted\n    setDisabledReasonHelper(\n      'alreadyVotedMessage',\n      voteChosen ? 'You have already voted.' : ''\n    );\n\n    // Reason: did not hold membership by snapshot\n    setDisabledReasonHelper(\n      'noMembershipAtSnapshotMessage',\n      !hasMembershipAtSnapshot && memberUnitsAtSnapshotStatus === FULFILLED\n        ? `You were not a member when the proposal was sponsored at snapshot ${snapshot}.`\n        : ''\n    );\n\n    // Reason: determining membership by snapshot\n    setDisabledReasonHelper(\n      'fetchingMembershipAtSnapshotMessage',\n      memberUnitsAtSnapshotStatus === PENDING\n        ? `We are waiting on your membership status for when this proposal was sponsored at snapshot ${snapshot}.`\n        : ''\n    );\n\n    // Reason: cannot determine membership by snapshot\n    setDisabledReasonHelper(\n      'undeterminedMembershipAtSnapshotMessage',\n      memberUnitsAtSnapshotStatus === REJECTED\n        ? `Something went wrong. Your membership status when this proposal was sponsored at snapshot ${snapshot} cannot be determined.`\n        : ''\n    );\n\n    // 2. Set reasons\n    setOtherDisabledReasons(Object.values(votingDisabledReasonsRef.current));\n  }, [\n    hasMembershipAtSnapshot,\n    memberUnitsAtSnapshotStatus,\n    setOtherDisabledReasons,\n    snapshot,\n    voteChosen,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  async function handleSubmitVote(choice: VoteChoices) {\n    try {\n      if (!proposalHash) {\n        throw new Error('No proposal hash was found.');\n      }\n\n      if (!snapshotProposalId) {\n        throw new Error('No proposal ID was found.');\n      }\n\n      setVoteChoiceClicked(VoteChoices[choice]);\n\n      await signAndSendVote({\n        ...(adapterName ? {adapterName} : undefined),\n        partialVoteData: {choice},\n        proposalIdInDAO: proposalHash,\n        proposalIdInSnapshot: snapshotProposalId,\n      });\n\n      // Refetch to show the vote the user submitted\n      refetchProposalOrDraft();\n    } catch (error) {\n      const e = error as Error;\n\n      setSubmitError(e);\n    }\n  }\n\n  function setDisabledReasonHelper(\n    key: keyof VotingDisabledReasons,\n    message: string\n  ): void {\n    votingDisabledReasonsRef.current = {\n      ...votingDisabledReasonsRef.current,\n\n      [key]: message,\n    };\n  }\n\n  return (\n    <>\n      <VotingActionButtons\n        onClick={isSubmitDisabled ? () => {} : handleSubmitVote}\n        buttonProps={{\n          disabled: isSubmitDisabled,\n          'aria-disabled': isSubmitDisabled,\n        }}\n        voteChosen={voteChosen}\n        voteProgress={voteChoiceProgress}\n      />\n\n      {isDisabled && (\n        <button\n          className=\"button--help-centered\"\n          onClick={openWhyDisabledModal}>\n          Why is voting disabled?\n        </button>\n      )}\n\n      <ErrorMessageWithDetails\n        error={error}\n        renderText=\"Something went wrong\"\n      />\n\n      <WhyDisabledModal title=\"Why is voting disabled?\" />\n    </>\n  );\n}\n","import {useEffect, useState} from 'react';\n\nimport {getTimeRemaining} from '../../util/helpers';\n\nexport type RenderCountdownTextProps = {\n  formatTimePeriod: typeof formatTimePeriod;\n  showDaysOnly?: boolean;\n} & Pick<\n  ReturnType<typeof getTimeRemaining>,\n  'days' | 'hours' | 'minutes' | 'seconds'\n>;\n\ntype ProposalPeriodCountdownProps = {\n  endedLabel?: React.ReactNode;\n  endLabel?: React.ReactNode;\n  endPeriodMs: number;\n  renderCountdownText?: (p: RenderCountdownTextProps) => React.ReactNode;\n  startLabel?: React.ReactNode;\n  startPeriodMs: number;\n};\n\nfunction displayCountdown({\n  countdownFrom,\n  renderCountdownText,\n  showDaysOnly,\n}: {\n  countdownFrom: Date;\n  renderCountdownText?: ProposalPeriodCountdownProps['renderCountdownText'];\n  showDaysOnly?: boolean;\n}): string | React.ReactNode {\n  const {days, hours, minutes, seconds} = getTimeRemaining(countdownFrom);\n\n  const renderedCountdownText = renderCountdownText?.({\n    days,\n    formatTimePeriod,\n    hours,\n    minutes,\n    seconds,\n    showDaysOnly,\n  });\n\n  const format = formatTimePeriod;\n\n  // Custom\n  if (renderedCountdownText) {\n    return renderedCountdownText;\n  }\n\n  // days\n  if (days > 2 && showDaysOnly) {\n    return `~${days} days`;\n  }\n\n  // days : hrs : min\n  if (days > 0) {\n    return `${format(days, 'day')} : ${format(hours, 'hr')} : ${format(\n      minutes,\n      'min'\n    )}`;\n  }\n\n  // hrs : min\n  if (hours > 0) {\n    return `${format(hours, 'hr')} : ${format(minutes, 'min')}`;\n  }\n\n  // min : sec\n  if (minutes > 0) {\n    return `${format(minutes, 'min')} : ${format(seconds, 'sec')}`;\n  }\n\n  // sec\n  return <span className=\"color-brightsalmon\">{format(seconds, 'sec')}</span>;\n}\n\nfunction formatTimePeriod(time: number, period: 'day' | 'hr' | 'min' | 'sec') {\n  const formattedPeriod = time === 0 || time > 1 ? `${period}s` : period;\n\n  return `${time} ${formattedPeriod}`;\n}\n\nexport default function ProposalPeriodCountdown(\n  props: ProposalPeriodCountdownProps\n) {\n  const {\n    endedLabel,\n    endLabel,\n    endPeriodMs,\n    renderCountdownText,\n    startLabel,\n    startPeriodMs,\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [currentDate, setCurrentDate] = useState<Date>();\n\n  /**\n   * Variables\n   */\n\n  const startDate: Date = new Date(startPeriodMs);\n  const endDate: Date = new Date(endPeriodMs);\n\n  /**\n   * Effects\n   */\n\n  // Every current `Date` each 1000ms (1 second)\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setCurrentDate(new Date());\n    }, 1000);\n\n    return function cleanup() {\n      clearInterval(interval);\n    };\n  }, []);\n\n  /**\n   * Render\n   */\n\n  if (!currentDate) return null;\n\n  // If time period has not yet started\n  if (currentDate < startDate) {\n    return (\n      <div>\n        <span>\n          <span className=\"votingstatus\">{startLabel || 'Starts:'}</span>{' '}\n          <span className=\"votingstatus__timer\">\n            {displayCountdown({\n              countdownFrom: startDate,\n              renderCountdownText,\n              showDaysOnly: true,\n            })}\n          </span>\n        </span>\n      </div>\n    );\n  }\n\n  // If time period is happening now\n  if (currentDate < endDate) {\n    return (\n      <div>\n        <span>\n          <span className=\"votingstatus\">{endLabel || 'Ends:'}</span>{' '}\n          <span className=\"votingstatus__timer\">\n            {displayCountdown({countdownFrom: endDate, renderCountdownText})}\n          </span>\n        </span>\n      </div>\n    );\n  }\n\n  // Default fallthrough: time period has ended\n  return (\n    <div>\n      <span className=\"votingstatus\">{endedLabel || 'Ended'}</span>\n    </div>\n  );\n}\n","import {SVGAttributes} from 'react';\n\nexport default function StopwatchSVG(props: SVGAttributes<HTMLOrSVGElement>) {\n  return (\n    <svg\n      width=\"20px\"\n      height=\"20px\"\n      viewBox=\"0 0 21 24\"\n      version=\"1.1\"\n      {...props}>\n      <defs>\n        <path\n          d=\"M17.6516,6.408 C19.8162,8.36 21,11.02 21,13.844 C21,19.458 16.303,24 10.5,24 C4.69616,24 0,19.457 0,13.844 C0,8.506 4.22802,4.197 9.53077,3.731 L9.53077,1.875 L6.68768,1.875 C6.15238,1.875 5.71845,1.455 5.71845,0.938 C5.71845,0.42 6.15238,0 6.68768,0 L14.3123,0 C14.8476,0 15.2815,0.42 15.2815,0.938 C15.2815,1.455 14.8476,1.875 14.3123,1.875 L11.46923,1.875 L11.46923,3.731 C13.1316,3.877 14.7126,4.398 16.1059,5.252 L17.4392,3.962 C17.8177,3.596 18.4314,3.596 18.8099,3.962 C19.1885,4.328 19.1885,4.922 18.8099,5.288 L17.6516,6.408 Z M10.5,22.125 C15.2208,22.125 19.0615,18.41 19.0615,13.844 C19.0615,9.277 15.2209,5.562 10.5,5.562 C5.77913,5.562 1.93846,9.277 1.93846,13.844 C1.93846,18.41 5.77917,22.125 10.5,22.125 Z M11.46923,8.312 L11.46923,13.844 C11.46923,14.362 11.03531,14.781 10.5,14.781 C9.96469,14.781 9.53077,14.362 9.53077,13.844 L9.53077,8.312 C9.53077,7.795 9.96469,7.375 10.5,7.375 C11.03531,7.375 11.46923,7.795 11.46923,8.312 Z\"\n          id=\"path-1\"></path>\n      </defs>\n      <g\n        id=\"Page-1\"\n        stroke=\"none\"\n        strokeWidth=\"1\"\n        fill=\"none\"\n        fillRule=\"evenodd\">\n        <g id=\"Group-70\">\n          <mask id=\"mask-2\" fill=\"white\">\n            <use xlinkHref=\"#path-1\"></use>\n          </mask>\n          <use id=\"Clip-69\" fill=\"currentColor\" xlinkHref=\"#path-1\"></use>\n        </g>\n      </g>\n    </svg>\n  );\n}\n","import React from 'react';\n\nimport {SquareRootVotingBar} from '.';\nimport ProposalPeriodCountdown from '../ProposalPeriodCountdown';\nimport StopwatchSVG from '../../../assets/svg/StopwatchSVG';\n\ntype VotingStatusProps = {\n  hasVotingEnded: boolean;\n  /**\n   * A render prop to display status to before / after the clock timer is shown.\n   */\n  renderStatus: () => React.ReactNode;\n  /**\n   * A render prop: display the `ProposalPeriod` timer.\n   * `renderTimer` Provides `ProposalPeriod` component as an argument.\n   *\n   * Passing the `ProposalPeriod` component via the render prop\n   * gives the opportunity to easily show a timer for voting, or grace period, for example,\n   * without adding more props.\n   */\n  renderTimer: (component: typeof ProposalPeriodCountdown) => React.ReactNode;\n  /**\n   * Set to `false` to hide percentage data under the voting progress bar.\n   * Defaults to `true`.\n   */\n  showPercentages?: boolean;\n  noUnits: Parameters<typeof SquareRootVotingBar>[0]['noUnits'];\n  totalUnits: Parameters<typeof SquareRootVotingBar>[0]['totalUnits'];\n  yesUnits: Parameters<typeof SquareRootVotingBar>[0]['yesUnits'];\n};\n\nexport function VotingStatus(props: VotingStatusProps) {\n  const {\n    hasVotingEnded,\n    noUnits,\n    renderStatus,\n    renderTimer,\n    showPercentages = true,\n    totalUnits,\n    yesUnits,\n  } = props;\n\n  const renderedStatus = renderStatus();\n\n  return (\n    <>\n      <div className=\"votingstatus-container\">\n        <StopwatchSVG aria-label=\"Proposal status\" role=\"img\" />\n\n        {renderedStatus && (\n          <span className=\"votingstatus\">{renderedStatus}</span>\n        )}\n\n        {renderTimer(ProposalPeriodCountdown)}\n      </div>\n\n      {/* VOTES */}\n      <SquareRootVotingBar\n        yesUnits={yesUnits}\n        noUnits={noUnits}\n        totalUnits={totalUnits}\n        votingExpired={hasVotingEnded}\n        showPercentages={showPercentages}\n      />\n    </>\n  );\n}\n","import {useEffect} from 'react';\n\nimport {CycleEllipsis} from '../../feedback';\nimport {RenderCountdownTextProps} from '../ProposalPeriodCountdown';\nimport {useTimeStartEnd} from '../../../hooks';\nimport {VotingResult} from '../types';\nimport {VotingStatus} from './VotingStatus';\n\nexport type OffchainVotingStatusRenderStatusProps = {\n  countdownGracePeriodEndMs: OffchainVotingStatusProps['countdownGracePeriodEndMs'];\n  countdownGracePeriodStartMs: OffchainVotingStatusProps['countdownGracePeriodStartMs'];\n  countdownVotingEndMs: OffchainVotingStatusProps['countdownVotingEndMs'];\n  countdownVotingStartMs: OffchainVotingStatusProps['countdownVotingStartMs'];\n  didVotePassSimpleMajority: boolean | undefined;\n  gracePeriodStartEndInitReady: boolean;\n  hasGracePeriodEnded: boolean;\n  hasGracePeriodStarted: boolean;\n  hasVotingEnded: boolean;\n  hasVotingStarted: boolean;\n  votingStartEndInitReady: boolean;\n};\n\nexport type OnGracePeriodChangeProps = {\n  hasGracePeriodEnded: boolean;\n  hasGracePeriodStarted: boolean;\n  /**\n   * Helpful if responding to events for multiple proposals\n   */\n  proposalId?: string;\n  gracePeriodStartEndInitReady: boolean;\n};\n\nexport type OnVotingPeriodChangeProps = {\n  hasVotingEnded: boolean;\n  hasVotingStarted: boolean;\n  /**\n   * Helpful if responding to events for multiple proposals\n   */\n  proposalId?: string;\n  votingStartEndInitReady: boolean;\n};\n\ntype OffchainVotingStatusProps = {\n  /**\n   * Voting start time\n   * i.e. calculated from the `OffchainVoting` contract's vote's start time, or Snapshot proposal's start time\n   */\n  countdownVotingStartMs: number | undefined;\n  /**\n   * Voting end time\n   * i.e. calculated from the `OffchainVoting` contract's vote's end time, or Snapshot proposal's end time\n   */\n  countdownVotingEndMs: number | undefined;\n  /**\n   * Grace period start time\n   * i.e. calculated from the `OffchainVoting` contract's vote's start time, or Snapshot proposal's start time\n   */\n  countdownGracePeriodStartMs?: number;\n  /**\n   * Grace period end time\n   * i.e. calculated from the `OffchainVoting` contract's vote's end time, or Snapshot proposal's end time\n   */\n  countdownGracePeriodEndMs?: number;\n  /**\n   * An optional callback to run on grace period time changes\n   */\n  onGracePeriodChange?: (p: OnGracePeriodChangeProps) => void;\n  /**\n   * An optional callback to run on voting time changes\n   */\n  onVotingPeriodChange?: (p: OnVotingPeriodChangeProps) => void;\n  /**\n   * An optional proposal ID if working with multiple proposals (i.e. listing).\n   * Helps when repsonding to events from callbacks like `onVotingPeriodChange` and `onGracePeriodChange`.\n   */\n  proposalId?: string;\n  /**\n   * Render a custom status\n   */\n  renderStatus?: (p: OffchainVotingStatusRenderStatusProps) => React.ReactNode;\n  /**\n   * A single proposal's `VotingResult` (i.e. as provided by `useOffchainVotingResults`)\n   */\n  votingResult: VotingResult | undefined;\n};\n\nfunction renderCountdownText({\n  days,\n  hours,\n  formatTimePeriod: format,\n}: RenderCountdownTextProps) {\n  if (days > 0) {\n    return `${format(days, 'day')} : ${format(hours, 'hr')}`;\n  }\n}\n\n// Grace period label\nconst gracePeriodLabel = <span>Grace period:</span>;\n\nconst cycleEllipsisFadeInProps = {duration: 150};\n\n/**\n * OffchainVotingStatus\n *\n * A read-only component to show voting status information.\n *\n * @param {OffchainVotingStatusProps} props\n * @returns {JSX.Element}\n */\nexport function OffchainVotingStatus({\n  countdownGracePeriodEndMs = 0,\n  countdownGracePeriodStartMs = 0,\n  countdownVotingEndMs = 0,\n  countdownVotingStartMs = 0,\n  onGracePeriodChange,\n  onVotingPeriodChange,\n  proposalId,\n  renderStatus,\n  votingResult,\n}: OffchainVotingStatusProps): JSX.Element {\n  /**\n   * Our hooks\n   */\n\n  const {\n    hasTimeEnded: hasVotingEnded,\n    hasTimeStarted: hasVotingStarted,\n    timeStartEndInitReady: votingStartEndInitReady,\n  } = useTimeStartEnd(\n    countdownVotingStartMs / 1000,\n    countdownVotingEndMs / 1000\n  );\n\n  const {\n    hasTimeEnded: hasGracePeriodEnded,\n    hasTimeStarted: hasGracePeriodStarted,\n    timeStartEndInitReady: gracePeriodStartEndInitReady,\n  } = useTimeStartEnd(\n    countdownGracePeriodStartMs / 1000,\n    countdownGracePeriodEndMs / 1000\n  );\n\n  /**\n   * Variables\n   */\n\n  const isGracePeriodActive: boolean =\n    gracePeriodStartEndInitReady &&\n    hasGracePeriodStarted &&\n    !hasGracePeriodEnded;\n\n  const noUnits: number = votingResult?.No.units || 0;\n  const totalUnits: number = votingResult?.totalUnits || 0;\n  const yesUnits: number = votingResult?.Yes.units || 0;\n\n  // We use `undefined` to indicate that the result has not yet been determined.\n  const didVotePassSimpleMajority: boolean | undefined = hasVotingEnded\n    ? yesUnits > noUnits\n    : undefined;\n\n  const renderedStatusFromProp = renderStatus?.({\n    countdownGracePeriodEndMs,\n    countdownGracePeriodStartMs,\n    countdownVotingEndMs,\n    countdownVotingStartMs,\n    didVotePassSimpleMajority,\n    gracePeriodStartEndInitReady,\n    hasGracePeriodEnded,\n    hasGracePeriodStarted,\n    hasVotingEnded,\n    hasVotingStarted,\n    votingStartEndInitReady,\n  });\n\n  /**\n   * Effects\n   */\n\n  // When voting times are updated, call the `onVotingPeriodChange` callback\n  useEffect(() => {\n    if (!votingStartEndInitReady) return;\n\n    onVotingPeriodChange?.({\n      hasVotingStarted,\n      hasVotingEnded,\n      proposalId,\n      votingStartEndInitReady,\n    });\n  }, [\n    hasVotingEnded,\n    hasVotingStarted,\n    onVotingPeriodChange,\n    proposalId,\n    votingStartEndInitReady,\n  ]);\n\n  // When voting times are updated, call the `onGracePeriodChange` callback\n  useEffect(() => {\n    if (!gracePeriodStartEndInitReady) return;\n\n    onGracePeriodChange?.({\n      hasGracePeriodEnded,\n      hasGracePeriodStarted,\n      proposalId,\n      gracePeriodStartEndInitReady,\n    });\n  }, [\n    gracePeriodStartEndInitReady,\n    hasGracePeriodEnded,\n    hasGracePeriodStarted,\n    onGracePeriodChange,\n    proposalId,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  function renderOffchainVotingStatus(): React.ReactNode {\n    // Render status from prop\n    if (renderedStatusFromProp) {\n      return renderedStatusFromProp;\n    }\n\n    // Loading\n    if (!votingStartEndInitReady) {\n      return (\n        <CycleEllipsis\n          ariaLabel=\"Getting off-chain voting status\"\n          fadeInProps={cycleEllipsisFadeInProps}\n          intervalMs={200}\n        />\n      );\n    }\n\n    // If in grace period, do not show a status.\n    if (isGracePeriodActive) {\n      return '';\n    }\n\n    // If passed on voting period ended\n    if (didVotePassSimpleMajority) {\n      return 'Approved';\n    }\n\n    // If failed on voting period ended\n    if (didVotePassSimpleMajority === false) {\n      return 'Failed';\n    }\n  }\n\n  function renderTimer(\n    ProposalPeriodComponent: Parameters<\n      Parameters<typeof VotingStatus>[0]['renderTimer']\n    >[0]\n  ): React.ReactNode {\n    // Vote countdown timer\n    if (votingStartEndInitReady && hasVotingStarted && !hasVotingEnded) {\n      return (\n        <ProposalPeriodComponent\n          endPeriodMs={countdownVotingEndMs}\n          renderCountdownText={renderCountdownText}\n          startPeriodMs={countdownVotingStartMs}\n        />\n      );\n    }\n\n    // Grace period countdown timer\n    if (isGracePeriodActive) {\n      return (\n        <ProposalPeriodComponent\n          endLabel={gracePeriodLabel}\n          endPeriodMs={countdownGracePeriodEndMs || 0}\n          renderCountdownText={renderCountdownText}\n          startPeriodMs={countdownGracePeriodStartMs || 0}\n        />\n      );\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <VotingStatus\n      hasVotingEnded={hasVotingEnded}\n      noUnits={noUnits}\n      renderStatus={renderOffchainVotingStatus}\n      renderTimer={renderTimer}\n      totalUnits={totalUnits}\n      yesUnits={yesUnits}\n    />\n  );\n}\n","import {SVGAttributes} from 'react';\n\nexport default function CheckSVG(props: SVGAttributes<HTMLOrSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      width=\"18\"\n      height=\"18\"\n      viewBox=\"0 0 512 512\"\n      {...props}>\n      <path\n        fill=\"currentColor\"\n        d=\"M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z\"></path>\n    </svg>\n  );\n}\n","import CheckSVG from '../../../assets/svg/CheckSVG';\n\ntype SquareRootVotingBarProps = {\n  /**\n   * Allow values to not be set as they may not be ready\n   */\n  yesUnits: number | undefined;\n  /**\n   * Allow values to not be set as they may not be ready\n   */\n  noUnits: number | undefined;\n  /**\n   * Allow values to not be set as they may not be ready\n   */\n  totalUnits: number | undefined;\n  votingExpired: boolean;\n  showPercentages: boolean;\n};\n\n/**\n * Provides a formatted number string for display as a percentage.\n * Two decimal places are used, unless the decimals are `.00`,\n * then they are removed.\n *\n * E.g. 50%; 50.77%; 0%\n *\n * @param units\n * @param totalUnits\n * @returns `string`\n */\nfunction getUnitsPercent(units: number, totalUnits: number): string {\n  return ((units / totalUnits) * 100).toFixed(2).replace(/\\.00$/, '');\n}\n\nexport function SquareRootVotingBar({\n  yesUnits = 0,\n  noUnits = 0,\n  totalUnits,\n  votingExpired,\n  showPercentages,\n}: SquareRootVotingBarProps) {\n  /**\n   * Variables\n   */\n\n  const percentYes = totalUnits ? getUnitsPercent(yesUnits, totalUnits) : '0';\n  const percentNo = totalUnits ? getUnitsPercent(noUnits, totalUnits) : '0';\n\n  /**\n   * Render\n   */\n\n  return (\n    <div className=\"votingbar-container\">\n      <div className=\"votingbar\">\n        {/* YES */}\n        <div\n          className=\"votingbar__segment--yes\"\n          aria-label={`${percentYes}% yes votes`}\n          style={{\n            width: `${percentYes}%`,\n          }}\n        />\n\n        {/* NO */}\n        <div\n          className=\"votingbar__segment--no\"\n          aria-label={`${percentNo}% no votes`}\n          style={{\n            width: `${percentNo}%`,\n          }}\n        />\n      </div>\n\n      <div className=\"votingbar__percentages\">\n        {showPercentages && (\n          <>\n            {/* YES */}\n            {votingExpired && yesUnits > noUnits && (\n              <span className=\"yes-check\">\n                <CheckSVG aria-label=\"Vote has passed\" />\n              </span>\n            )}\n            <span className=\"yes-percent\">{percentYes}%</span>\n\n            {/* NO */}\n            <span className=\"no-percent\">{percentNo}%</span>\n            {votingExpired && yesUnits <= noUnits && (\n              <span className=\"no-check\">\n                <CheckSVG aria-label=\"Vote has failed\" />\n              </span>\n            )}\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n","import React, {ButtonHTMLAttributes} from 'react';\nimport {VoteChoices} from '@openlaw/snapshot-js-erc712';\n\nimport CheckSVG from '../../../assets/svg/CheckSVG';\nimport Loader from '../../feedback/Loader';\n\ntype VotingActionButtonsProps = {\n  /**\n   * Common <button /> props for both buttons\n   */\n  buttonProps?: ButtonHTMLAttributes<HTMLButtonElement>;\n  onClick: (choice: VoteChoices) => void;\n  /**\n   * Which vote did the current connected user submit?\n   */\n  voteChosen?: VoteChoices;\n  /**\n   * Shows a loading spinner for a voting button.\n   */\n  voteProgress?: VoteChoices;\n};\n\nexport function VotingActionButtons(\n  props: VotingActionButtonsProps\n): JSX.Element {\n  const {buttonProps, onClick, voteChosen, voteProgress} = props;\n\n  /**\n   * Functions\n   */\n\n  function getButtonARIALabel(\n    choice: VoteChoices\n  ): Partial<React.HTMLAttributes<HTMLElement>> {\n    return voteProgress === choice\n      ? {'aria-label': `Voting ${choice} \\u2026`}\n      : {};\n  }\n\n  function getButtonText(choice: VoteChoices): React.ReactNode {\n    return voteProgress === choice ? (\n      <Loader aria-label={`Currently voting ${choice}...`} role=\"img\" />\n    ) : voteChosen === choice ? (\n      `Voted ${choice}`\n    ) : (\n      `Vote ${choice}`\n    );\n  }\n\n  function handleClick(choice: VoteChoices) {\n    return () => {\n      onClick(choice);\n    };\n  }\n\n  function renderVotedCheck(\n    choice: VoteChoices,\n    ariaLabel: string\n  ): React.ReactNode {\n    return voteChosen === choice ? (\n      <>\n        <CheckSVG aria-label={ariaLabel} />{' '}\n      </>\n    ) : (\n      ''\n    );\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      <button\n        {...buttonProps}\n        {...getButtonARIALabel(VoteChoices.Yes)}\n        className={`proposaldetails__button`}\n        onClick={handleClick(VoteChoices.Yes)}>\n        {renderVotedCheck(VoteChoices.Yes, 'You voted yes')}\n        {getButtonText(VoteChoices.Yes)}\n      </button>\n\n      <button\n        {...buttonProps}\n        {...getButtonARIALabel(VoteChoices.No)}\n        className={`proposaldetails__button`}\n        onClick={handleClick(VoteChoices.No)}>\n        {renderVotedCheck(VoteChoices.No, 'You voted no')}\n        {getButtonText(VoteChoices.No)}\n      </button>\n    </>\n  );\n}\n","import {useState} from 'react';\nimport {TransactionReceipt} from 'web3-core/types';\n\nimport {CHAINS, ETHERSCAN_URLS} from '../../../config';\nimport {contractSend} from '../helpers';\nimport {dontCloseWindowWarning} from '../../../util/helpers';\nimport {useWeb3Modal} from './useWeb3Modal';\nimport {Web3TxStatus} from '../types';\n\ntype UseContractSendReturn = {\n  txError: Error | undefined;\n  txEtherscanURL: string;\n  txIsPromptOpen: boolean;\n  txReceipt: TransactionReceipt | undefined;\n  txSend: (\n    ...p: Parameters<typeof contractSend>\n  ) => Promise<TransactionReceipt | undefined>;\n  txStatus: Web3TxStatus;\n};\n\n/**\n * useContractSend\n *\n * A React hook which encapsulates the call and related values of `contractSend`.\n *\n * @returns {UseContractSendReturn}\n */\nexport function useContractSend(): UseContractSendReturn {\n  const [txError, setTxError] = useState<Error>();\n  const [txEtherscanURL, setTxEtherscanURL] = useState<string>('');\n  const [txIsPromptOpen, setTxIsPromptOpen] = useState<boolean>(false);\n  const [txReceipt, setTxReceipt] = useState<TransactionReceipt>();\n  const [txStatus, setTxStatus] = useState<Web3TxStatus>(Web3TxStatus.STANDBY);\n\n  /**\n   * Our hooks\n   */\n\n  const {networkId} = useWeb3Modal();\n\n  /**\n   * Functions\n   */\n\n  function handleOnTxProcess(callback?: (txh: string) => void) {\n    return (txHash: string) => {\n      setTxStatus(Web3TxStatus.PENDING);\n      setTxIsPromptOpen(false);\n\n      // Ganache transactions do not show on Etherscan.\n      if (networkId && networkId !== CHAINS.GANACHE) {\n        setTxEtherscanURL(`${ETHERSCAN_URLS[networkId]}/tx/${txHash}`);\n      }\n\n      callback && callback(txHash);\n    };\n  }\n\n  async function txSend(\n    ...contractSendParams: Parameters<typeof contractSend>\n  ) {\n    // Activate \"don't close window\" warning\n    const unsubscribeDontCloseWindow = dontCloseWindowWarning();\n\n    try {\n      // Reset state in case trying again after error.\n      setTxError(undefined);\n      setTxEtherscanURL('');\n\n      setTxStatus(Web3TxStatus.AWAITING_CONFIRM);\n      setTxIsPromptOpen(true);\n\n      // Intercept the on process callback to allow us to set our internal state.\n      contractSendParams[4] = handleOnTxProcess(contractSendParams[4]);\n\n      const receipt = await contractSend(...contractSendParams);\n\n      setTxReceipt(receipt);\n      setTxStatus(Web3TxStatus.FULFILLED);\n\n      unsubscribeDontCloseWindow();\n\n      return receipt;\n    } catch (error) {\n      const e = error as Error;\n\n      setTxError(e);\n      setTxStatus(Web3TxStatus.REJECTED);\n      setTxIsPromptOpen(false);\n\n      unsubscribeDontCloseWindow();\n\n      throw error;\n    }\n  }\n\n  return {\n    txError,\n    txEtherscanURL,\n    txIsPromptOpen,\n    txReceipt,\n    txSend,\n    txStatus,\n  };\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport Web3 from 'web3';\n\nimport {reverseResolveENS} from '../helpers';\n\n/**\n * A hook to reverse resolve ENS addresses by setting\n * the addresses, using the returned callback, and then receving\n * the response.\n *\n * @param web3Instance `Web3`\n * @returns `[state: string[], setState: (a: string[]) => void]`\n */\nexport function useENSName(\n  web3Instance: Web3 | undefined\n): [state: string[], setState: (a: string[]) => void] {\n  /**\n   * State\n   */\n\n  const [addresses, setAddresses] = useState<string[]>([]);\n\n  const [reverseResolvedAddresses, setReverseResolvedAddresses] = useState<\n    string[]\n  >([]);\n\n  /**\n   * Cached callbacks\n   */\n\n  const handleGetENSNamesCached = useCallback(handleGetENSNames, []);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!web3Instance || !addresses.length) return;\n\n    handleGetENSNamesCached(addresses, web3Instance);\n  }, [addresses, handleGetENSNamesCached, web3Instance]);\n\n  /**\n   * Functions\n   */\n\n  async function handleGetENSNames(a: string[], web3Instance: Web3) {\n    try {\n      setReverseResolvedAddresses(await reverseResolveENS(a, web3Instance));\n    } catch (error) {\n      setReverseResolvedAddresses(a);\n    }\n  }\n\n  return [reverseResolvedAddresses, setAddresses];\n}\n","import {toWei} from 'web3-utils';\nimport {useCallback, useEffect, useState} from 'react';\nimport BigNumber from 'bignumber.js';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {ENVIRONMENT} from '../../../config';\nimport {useAbortController} from '../../../hooks';\nimport {useWeb3Modal} from './useWeb3Modal';\n\ntype GasStationResponse = {\n  average: number;\n  avgWait: number;\n  block_time: number;\n  blockNum: number;\n  fast: number;\n  fastest: number;\n  fastestWait: number;\n  fastWait: number;\n  gasPriceRange: Record<string, number>;\n  safeLow: number;\n  safeLowWait: number;\n  speed: number;\n};\n\ntype GasPrices = {\n  average: string | undefined;\n  fast: string | undefined;\n  fastest: string | undefined;\n  safeLow: string | undefined;\n};\n\ntype UseETHGasPriceReturn = GasPrices & {\n  gasPriceError: Error | undefined;\n  gasPriceStatus: AsyncStatus;\n};\n\nconst URL = 'https://ethgasstation.info/json/ethgasAPI.json';\n\n/**\n * To prepare the provided ETHGasStation values for conversion from Gwei->wei,\n * first divide by `10`, per the API docs.\n *\n * @see https://docs.ethgasstation.info/gas-price#gas-price\n */\nfunction convertGasToWEI(gasStationPrice: number) {\n  const gasPriceToWEI: string = toWei(\n    new BigNumber((gasStationPrice / 10).toFixed(4)).toString(),\n    'Gwei'\n  );\n\n  return gasPriceToWEI;\n}\n\nconst INITIAL_GAS_PRICES: GasPrices = {\n  average: undefined,\n  fast: undefined,\n  fastest: undefined,\n  safeLow: undefined,\n};\n\n/**\n * useETHGasPrice\n *\n * Returns the latest mainnet gas prices, converted to WEI string from ETHGasStation.\n *\n * @returns {UseETHGasPriceReturn}\n * @see https://ethgasstation.info/json/ethgasAPI.json\n */\nexport function useETHGasPrice(props?: {\n  ignoreEnvironment?: boolean;\n  /**\n   * The network is EIP-1559 compatible and we do not want to use the gas price.\n   *\n   * The gas station prices can still be used for EIP-1559.\n   * For example, to set `maxFeePerGas` (base fee plus tip).\n   */\n  noRunIfEIP1559?: boolean;\n}): UseETHGasPriceReturn {\n  const {ignoreEnvironment = false, noRunIfEIP1559 = false} = props || {};\n\n  /**\n   * State\n   */\n\n  const [gasPrices, setGasPrices] = useState<GasPrices>(INITIAL_GAS_PRICES);\n  const [gasPriceError, setGasPriceError] = useState<Error>();\n\n  const [gasPriceStatus, setGasPriceStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n  const {abortController, isMountedRef} = useAbortController();\n\n  /**\n   * Variables\n   */\n\n  // Sometimes using mainnet gas prices for testnets won't work well with wallets.\n  const shouldExitIfNotProduction: boolean =\n    ignoreEnvironment === false && ENVIRONMENT !== 'production';\n\n  /**\n   * Cached callbacks\n   */\n\n  const handleGetGasPricesCached = useCallback(handleGetGasPrices, [\n    abortController,\n    isMountedRef,\n    noRunIfEIP1559,\n    shouldExitIfNotProduction,\n    web3Instance,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    handleGetGasPricesCached();\n\n    return function cleanup() {\n      abortController?.abort();\n    };\n  }, [abortController, handleGetGasPricesCached]);\n\n  /**\n   * Functions\n   */\n\n  async function handleGetGasPrices() {\n    if (!abortController?.signal) return;\n\n    if (!web3Instance) return;\n\n    setGasPriceError(undefined);\n\n    if (shouldExitIfNotProduction) {\n      setGasPriceStatus(AsyncStatus.FULFILLED);\n\n      return;\n    }\n\n    if (noRunIfEIP1559) {\n      // Check EIP-1559 support\n      const {isEIP1559Compatible} = await import(\n        '../helpers/isEIP1559Compatible'\n      );\n\n      if (await isEIP1559Compatible(web3Instance)) {\n        setGasPriceStatus(AsyncStatus.FULFILLED);\n\n        return;\n      }\n    }\n\n    setGasPriceStatus(AsyncStatus.PENDING);\n\n    try {\n      const response = await fetch(URL, {signal: abortController.signal});\n\n      if (!response.ok) {\n        throw new Error(\n          'Something went wrong while getting the latest gas price.'\n        );\n      }\n\n      const responseJSON: GasStationResponse = await response.json();\n\n      if (!isMountedRef.current) return;\n\n      const {average, fast, fastest, safeLow} = responseJSON;\n\n      setGasPrices({\n        average: convertGasToWEI(average),\n        fast: convertGasToWEI(fast),\n        fastest: convertGasToWEI(fastest),\n        safeLow: convertGasToWEI(safeLow),\n      });\n\n      setGasPriceStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      const e = error as Error;\n\n      setGasPriceError(e);\n      setGasPrices(INITIAL_GAS_PRICES);\n      setGasPriceStatus(AsyncStatus.REJECTED);\n    }\n  }\n\n  /**\n   * Result\n   */\n\n  return {...gasPrices, gasPriceError, gasPriceStatus};\n}\n","import {useCallback} from 'react';\nimport {useDispatch} from 'react-redux';\nimport Web3 from 'web3';\n\nimport {\n  initContractBankAdapter,\n  initContractBankExtension,\n  initContractBankFactory,\n  initContractConfiguration,\n  initContractCouponOnboarding,\n  initContractDaoFactory,\n  initContractDaoRegistry,\n  initContractDaoRegistryAdapter,\n  initContractDistribute,\n  initContractERC20Extension,\n  initContractFinancing,\n  initContractGuildKick,\n  initContractKycOnboarding,\n  initContractManaging,\n  initContractNFTExtension,\n  initContractOnboarding,\n  initContractRagequit,\n  initContractTribute,\n  initContractTributeNFT,\n  initRegisteredVotingAdapter,\n} from '../../../store/actions';\nimport {ReduxDispatch} from '../../../store/types';\n\n/**\n * useInitContracts\n *\n * Initiates all contracts used in the app.\n *\n * @todo Use subgraph to pass the address to each init function, so it skips chain calls.\n */\nexport function useInitContracts(): (data: {\n  web3Instance: Web3;\n}) => Promise<void> {\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * Cached callbacks\n   */\n\n  const initContractsCached = useCallback(initContracts, [dispatch]);\n\n  /**\n   * Init contracts\n   */\n  async function initContracts({web3Instance}: {web3Instance: Web3}) {\n    try {\n      // Must init registry first\n      await dispatch(initContractDaoRegistry(web3Instance));\n\n      await dispatch(initContractBankAdapter(web3Instance));\n      await dispatch(initContractBankExtension(web3Instance));\n      await dispatch(initContractBankFactory(web3Instance));\n      await dispatch(initContractConfiguration(web3Instance));\n      await dispatch(initContractCouponOnboarding(web3Instance));\n      await dispatch(initContractDaoFactory(web3Instance));\n      await dispatch(initContractDaoRegistryAdapter(web3Instance));\n      await dispatch(initContractDistribute(web3Instance));\n      await dispatch(initContractERC20Extension(web3Instance));\n      await dispatch(initContractFinancing(web3Instance));\n      await dispatch(initContractGuildKick(web3Instance));\n      await dispatch(initContractKycOnboarding(web3Instance));\n      await dispatch(initContractManaging(web3Instance));\n      await dispatch(initContractNFTExtension(web3Instance));\n      await dispatch(initContractOnboarding(web3Instance));\n      await dispatch(initContractRagequit(web3Instance));\n      await dispatch(initContractTribute(web3Instance));\n      await dispatch(initContractTributeNFT(web3Instance));\n      await dispatch(initRegisteredVotingAdapter(web3Instance));\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  return initContractsCached;\n}\n","import {useEffect, useState} from 'react';\n\nimport {CHAIN_NAME_FULL, DEFAULT_CHAIN} from '../../../config';\nimport {useWeb3Modal} from './useWeb3Modal';\n\ntype UseIsDefaultChainReturn = {\n  /**\n   * The default chain of the app\n   */\n  defaultChain: number;\n  /**\n   * Any error derived from detecting the default chain\n   */\n  defaultChainError: Error | undefined;\n  /**\n   * Specifies if the curently connected chain matches the app's default chain\n   */\n  isDefaultChain: boolean;\n};\n\n/**\n * useIsDefaultChain\n *\n * Checks if the connected account it connected to the default chain.\n *\n * @returns UseIsDefaultChainReturn\n */\nexport function useIsDefaultChain(): UseIsDefaultChainReturn {\n  /**\n   * Our hooks\n   */\n\n  const {networkId, connected} = useWeb3Modal();\n\n  /**\n   * State\n   */\n\n  const [defaultChainError, setDefaultChainError] = useState<Error>();\n\n  /**\n   * Effects\n   */\n\n  // Determine `defaultChainError`\n  useEffect(() => {\n    // User is already connected to a wallet, and chain is incorrect.\n    if (connected && networkId !== DEFAULT_CHAIN) {\n      setDefaultChainError(\n        new Error(`Please connect to the ${CHAIN_NAME_FULL[DEFAULT_CHAIN]}.`)\n      );\n\n      return;\n    }\n\n    // Reset error after successful checks.\n    setDefaultChainError(undefined);\n  }, [connected, networkId]);\n\n  return {\n    defaultChain: DEFAULT_CHAIN,\n    defaultChainError,\n    isDefaultChain: networkId === DEFAULT_CHAIN,\n  };\n}\n","import {provider} from 'web3-core/types';\nimport {useCallback, useEffect, useState} from 'react';\nimport {Web3Provider} from '@ethersproject/providers';\n\nimport {isPossibleContractWallet} from '../../../util/helpers';\nimport {useIsMounted} from '../../../hooks';\nimport Web3 from 'web3';\n\nconst INITIAL_MAYBE_CONTRACT_WALLET_STATE: boolean = false;\n\nexport function useMaybeContractWallet(\n  account: string | undefined,\n  web3Provider: Web3['currentProvider'] | undefined\n): boolean {\n  /**\n   * State\n   */\n\n  const [maybeContractWallet, setMaybeContractWallet] = useState<boolean>(\n    INITIAL_MAYBE_CONTRACT_WALLET_STATE\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {isMountedRef} = useIsMounted();\n\n  /**\n   * Cached callbacks\n   */\n\n  const handleIsPossibleContractWalletCached = useCallback(\n    handleIsPossibleContractWallet,\n    [isMountedRef]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!web3Provider || !account) return;\n\n    handleIsPossibleContractWalletCached(account, web3Provider);\n  }, [account, handleIsPossibleContractWalletCached, web3Provider]);\n\n  /**\n   * Functions\n   */\n\n  async function handleIsPossibleContractWallet(\n    account: string,\n    web3Provider: provider\n  ): Promise<void> {\n    try {\n      const response = await isPossibleContractWallet(\n        account,\n        /**\n         * Web3 `provider` doesn't provide the correct types to satisfy `Web3Provider`,\n         * but this does work.\n         */\n        new Web3Provider(web3Provider as any)\n      );\n\n      if (!isMountedRef.current) return;\n\n      setMaybeContractWallet(response);\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      setMaybeContractWallet(INITIAL_MAYBE_CONTRACT_WALLET_STATE);\n    }\n  }\n\n  /**\n   * Return\n   */\n\n  return maybeContractWallet;\n}\n","export default function TimesSVG() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      aria-hidden=\"true\"\n      data-icon=\"times\"\n      data-prefix=\"fal\"\n      viewBox=\"0 0 320 512\">\n      <path\n        fill=\"currentColor\"\n        d=\"M193.94 256L296.5 153.44l21.15-21.15c3.12-3.12 3.12-8.19 0-11.31l-22.63-22.63c-3.12-3.12-8.19-3.12-11.31 0L160 222.06 36.29 98.34c-3.12-3.12-8.19-3.12-11.31 0L2.34 120.97c-3.12 3.12-3.12 8.19 0 11.31L126.06 256 2.34 379.71c-3.12 3.12-3.12 8.19 0 11.31l22.63 22.63c3.12 3.12 8.19 3.12 11.31 0L160 289.94 262.56 392.5l21.15 21.15c3.12 3.12 8.19 3.12 11.31 0l22.63-22.63c3.12-3.12 3.12-8.19 0-11.31L193.94 256z\"></path>\n    </svg>\n  );\n}\n","/**\n * Takes a `number` and returns a hex string with a `0x` prefix.\n * If the number is negative, it is converted to positive.\n *\n * @param n `number`\n * @returns `0x${string}`\n */\nexport function numberTo0xHexString(\n  n: number | undefined\n): `0x${string}` | undefined {\n  if (n === undefined || isNaN(n)) return;\n\n  return `0x${Math.abs(n).toString(16)}`;\n}\n","import {useState} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {toChecksumAddress} from 'web3-utils';\n\nimport {\n  useContractSend,\n  useETHGasPrice,\n  useIsDefaultChain,\n  useWeb3Modal,\n} from '../components/web3/hooks';\nimport {COUPON_API_URL} from '../config';\nimport {ERC20RegisterDetails} from '../components/dao-token/DaoToken';\nimport {getConnectedMember} from '../store/actions';\nimport {ReduxDispatch, StoreState} from '../store/types';\nimport {Web3TxStatus} from '../components/web3/types';\nimport {normalizeString} from '../util/helpers';\n\nexport enum FetchStatus {\n  STANDBY = 'STANDBY',\n  PENDING = 'PENDING',\n  FULFILLED = 'FULFILLED',\n  REJECTED = 'REJECTED',\n}\n\ntype RedeemCouponArguments = [\n  string, // `dao`\n  string, // `authorizedMember`\n  string, // `amount`\n  number, // `nonce`\n  string // `signature`\n];\n\ntype ReturnUseRedeemCoupon = {\n  isInProcessOrDone: boolean;\n  redeemCoupon: (\n    {redeemableCoupon}: Record<string, any>,\n    erc20Details?: ERC20RegisterDetails\n  ) => Promise<void>;\n  submitStatus: FetchStatus;\n  submitError: Error | undefined;\n  txStatus: Web3TxStatus;\n  txError: Error | undefined;\n  txEtherscanURL: string;\n  txIsPromptOpen: boolean;\n};\n\nexport function useRedeemCoupon(): ReturnUseRedeemCoupon {\n  /**\n   * Selectors\n   */\n\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n\n  const couponOnboardingContract = useSelector(\n    (s: StoreState) => s.contracts.CouponOnboardingContract\n  );\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n  const [submitStatus, setSubmitStatus] = useState<FetchStatus>(\n    FetchStatus.STANDBY\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account, web3Instance} = useWeb3Modal();\n  const {defaultChainError} = useIsDefaultChain();\n  const {average: gasPrice} = useETHGasPrice();\n\n  const {txError, txEtherscanURL, txIsPromptOpen, txSend, txStatus} =\n    useContractSend();\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * Variables\n   */\n\n  const isInProcessOrDone =\n    submitStatus === FetchStatus.PENDING ||\n    submitStatus === FetchStatus.FULFILLED;\n\n  /**\n   * Functions\n   */\n\n  async function handleRedeemCoupon(\n    redeemableCoupon: Record<string, any>,\n    erc20Details?: ERC20RegisterDetails\n  ) {\n    try {\n      if (defaultChainError) {\n        throw new Error('Wrong network connected.');\n      }\n\n      if (!redeemableCoupon) {\n        throw new Error('No coupon data was found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!daoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      if (!couponOnboardingContract) {\n        throw new Error('No Coupon Onboarding contract was found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      setSubmitStatus(FetchStatus.PENDING);\n\n      const applicantAddressToChecksum = toChecksumAddress(\n        redeemableCoupon.recipient\n      );\n\n      // initiate tx\n      const redeemCouponArguments: RedeemCouponArguments = [\n        daoRegistryContract.contractAddress,\n        applicantAddressToChecksum,\n        String(redeemableCoupon.amount),\n        Number(redeemableCoupon.nonce),\n        redeemableCoupon.signature,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(gasPrice ? {gasPrice} : null),\n      };\n\n      // Execute contract call for `redeemCoupon`\n      const txReceipt = await txSend(\n        'redeemCoupon',\n        couponOnboardingContract.instance.methods,\n        redeemCouponArguments,\n        txArguments\n      );\n\n      if (txReceipt) {\n        // update the db and send email\n        const response = await fetch(`${COUPON_API_URL}/api/coupon/redeem`, {\n          method: 'PATCH',\n          body: JSON.stringify({\n            // search by signature\n            signature: redeemableCoupon.signature,\n          }),\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        });\n\n        if (!response.ok) {\n          throw new Error('Something went wrong while updating the coupon.');\n        }\n\n        setSubmitStatus(FetchStatus.FULFILLED);\n\n        // if connected account is the coupon recipient\n        if (\n          normalizeString(redeemableCoupon.recipient) ===\n          normalizeString(account)\n        ) {\n          // re-fetch member\n          await dispatch(\n            getConnectedMember({\n              account,\n              daoRegistryContract,\n              web3Instance,\n            })\n          );\n\n          // suggest adding DAO token to wallet\n          await addTokenToWallet(erc20Details);\n        }\n      }\n    } catch (error) {\n      const e = error as Error;\n\n      setSubmitError(e);\n      setSubmitStatus(FetchStatus.REJECTED);\n    }\n  }\n\n  async function addTokenToWallet(erc20Details?: ERC20RegisterDetails) {\n    if (!erc20Details) return;\n\n    try {\n      await window.ethereum.request({\n        method: 'wallet_watchAsset',\n        params: {\n          type: 'ERC20',\n          options: erc20Details,\n        },\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  return {\n    isInProcessOrDone,\n    redeemCoupon: handleRedeemCoupon,\n    submitError,\n    submitStatus,\n    txStatus,\n    txError,\n    txEtherscanURL,\n    txIsPromptOpen,\n  };\n}\n","import {Dispatch} from 'redux';\nimport Web3 from 'web3';\n\nimport {BURN_ADDRESS} from '../../util/constants';\nimport {ConnectedMemberState} from '../connectedMember/types';\nimport {ContractsStateEntry} from '../contracts/types';\nimport {DaoRegistry} from '../../abis/types/DaoRegistry';\nimport {hasFlag, multicall} from '../../components/web3/helpers';\nimport {MemberFlag} from '../../components/web3/types';\nimport {normalizeString} from '../../util/helpers';\n\nexport const SET_CONNECTED_MEMBER = 'SET_CONNECTED_MEMBER';\nexport const CLEAR_CONNECTED_MEMBER = 'CLEAR_CONNECTED_MEMBER';\n\n/**\n * getConnectedMember\n *\n * Gets information about a connected address from the DAO's `members`. If the\n * user is not a member, the defaults for a non-existent member of the DAO are\n * returned (e.g. \"0x000000...\") and `isActiveMember` will be `false`.\n *\n * The reason state is set for both a member and a non-member is to ensure we're\n * not too restrictive in our Dapp logic and letting the contract do its job.\n */\nexport function getConnectedMember({\n  account,\n  daoRegistryContract,\n  web3Instance,\n}: {\n  account: string;\n  daoRegistryContract: ContractsStateEntry<DaoRegistry>;\n  web3Instance: Web3;\n}) {\n  return async function (dispatch: Dispatch<any>) {\n    const daoRegistryAddress = daoRegistryContract?.contractAddress;\n\n    const daoRegistryInstance = daoRegistryContract?.instance;\n\n    const getAddressIfDelegatedABI = daoRegistryContract?.abi.find(\n      (ai) => ai.name === 'getAddressIfDelegated'\n    );\n    const membersABI = daoRegistryContract?.abi.find(\n      (ai) => ai.name === 'members'\n    );\n    const isActiveMemberABI = daoRegistryContract?.abi.find(\n      (ai) => ai.name === 'isActiveMember'\n    );\n    const getCurrentDelegateKeyABI = daoRegistryContract?.abi.find(\n      (ai) => ai.name === 'getCurrentDelegateKey'\n    );\n\n    if (\n      !account ||\n      !daoRegistryAddress ||\n      !daoRegistryInstance ||\n      !getAddressIfDelegatedABI ||\n      !getCurrentDelegateKeyABI ||\n      !isActiveMemberABI ||\n      !membersABI\n    ) {\n      dispatch(clearConnectedMember());\n\n      return;\n    }\n\n    try {\n      /**\n       * @link https://github.com/openlawteam/tribute-contracts/blob/master/docs/core/DaoRegistry.md\n       */\n\n      const [\n        addressIfDelegated,\n        memberFlag,\n        isActiveMember,\n        currentDelegateKey,\n      ] = await multicall({\n        calls: [\n          [daoRegistryAddress, getAddressIfDelegatedABI, [account]],\n          [daoRegistryAddress, membersABI, [account]],\n          [\n            daoRegistryAddress,\n            isActiveMemberABI,\n            [daoRegistryAddress, account],\n          ],\n          [daoRegistryAddress, getCurrentDelegateKeyABI, [account]],\n        ],\n        web3Instance,\n      });\n\n      // A member can exist in the DAO, yet not be an active member (has units > 0)\n      const doesMemberExist: boolean = hasFlag(MemberFlag.EXISTS, memberFlag);\n\n      // Is this address known to the DAO?\n      const delegateKey: string =\n        isActiveMember || doesMemberExist ? currentDelegateKey : BURN_ADDRESS;\n\n      // Is this address known to the DAO?\n      const memberAddress: string =\n        isActiveMember || doesMemberExist ? addressIfDelegated : BURN_ADDRESS;\n\n      const isAddressDelegated: boolean =\n        normalizeString(account) === normalizeString(memberAddress) &&\n        normalizeString(account) !== normalizeString(delegateKey);\n\n      dispatch(\n        setConnectedMember({\n          delegateKey,\n          isAddressDelegated,\n          isActiveMember,\n          memberAddress,\n        })\n      );\n    } catch (error) {\n      /**\n       * Handle error thrown from multicall caused by `isActiveMember` call,\n       * which is expected if connected user is a member that has set a\n       * delegated address. In this situation, we remove the `isActiveMember`\n       * call from the multicall and handle its thrown error independently.\n       */\n      try {\n        const [addressIfDelegated, memberFlag, currentDelegateKey] =\n          await multicall({\n            calls: [\n              [daoRegistryAddress, getAddressIfDelegatedABI, [account]],\n              [daoRegistryAddress, membersABI, [account]],\n              [daoRegistryAddress, getCurrentDelegateKeyABI, [account]],\n            ],\n            web3Instance,\n          });\n\n        let isActiveMember = false;\n        try {\n          isActiveMember = await daoRegistryInstance.methods\n            .isActiveMember(daoRegistryAddress, account)\n            .call();\n        } catch (error) {\n          const e = error as Error;\n\n          /**\n           * Error message indicates that the member has set a delegate address.\n           * In this situation, the \"active member\" is considered to be the\n           * delegate address (and not the original member address).\n           */\n          if (e.message.includes('call with your delegate key')) {\n            isActiveMember = false;\n          } else {\n            throw error;\n          }\n        }\n\n        // A member can exist in the DAO, yet not be an active member (has units > 0)\n        const doesMemberExist: boolean = hasFlag(MemberFlag.EXISTS, memberFlag);\n\n        // Is this address known to the DAO?\n        const delegateKey: string =\n          isActiveMember || doesMemberExist ? currentDelegateKey : BURN_ADDRESS;\n\n        // Is this address known to the DAO?\n        const memberAddress: string =\n          isActiveMember || doesMemberExist ? addressIfDelegated : BURN_ADDRESS;\n\n        const isAddressDelegated: boolean =\n          normalizeString(account) === normalizeString(memberAddress) &&\n          normalizeString(account) !== normalizeString(delegateKey);\n\n        dispatch(\n          setConnectedMember({\n            delegateKey,\n            isAddressDelegated,\n            isActiveMember,\n            memberAddress,\n          })\n        );\n      } catch (error) {\n        dispatch(clearConnectedMember());\n\n        throw error;\n      }\n    }\n  };\n}\n\nexport function setConnectedMember(payload: ConnectedMemberState) {\n  return {type: SET_CONNECTED_MEMBER, ...payload};\n}\n\nexport function clearConnectedMember() {\n  return {type: CLEAR_CONNECTED_MEMBER};\n}\n","export const CONNECT_MODAL_CLOSE = 'CONNECT_MODAL_CLOSE';\nexport const CONNECT_MODAL_OPEN = 'CONNECT_MODAL_OPEN';\n\nexport function connectModalClose() {\n  return {type: CONNECT_MODAL_CLOSE};\n}\n\nexport function connectModalOpen() {\n  return {type: CONNECT_MODAL_OPEN};\n}\n","import {useReducer, useCallback, useEffect} from 'react';\nimport Web3 from 'web3';\nimport Web3Modal, {IProviderOptions} from 'web3modal';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {DEFAULT_CHAIN} from '../../../config';\nimport {NetworkNames, NetworkIDs} from '../../../util/enums';\n\nexport enum DefaultTheme {\n  DARK = 'dark',\n  LIGHT = 'light',\n}\n\nenum ActionType {\n  CONNECT_WEB3MODAL,\n  DEACTIVATE_PROVIDER_WEB3MODAL,\n  ERROR_WEB3MODAL,\n  INITIAL_CACHED_CONNECTOR_CHECK_STATUS,\n  NEW_WEB3MODAL,\n  UPDATE_ACCOUNT,\n}\n\ninterface Action {\n  type: ActionType;\n  payload?: Partial<Web3ModalManagerState>;\n}\n\nexport enum Web3ModalErrorType {\n  CONNECT = 'CONNECT',\n  DISCONNECT = 'DISCONNECT',\n}\n\nexport type Web3ModalError = {\n  connectorId: string;\n  error: Error;\n  type: Web3ModalErrorType;\n};\n\ntype Web3ModalManagerState = {\n  account?: undefined | string;\n  connected?: boolean;\n  error?: Web3ModalError;\n  initialCachedConnectorCheckStatus?: AsyncStatus;\n  networkId?: number;\n  provider?: any;\n  web3Instance?: Web3;\n  web3Modal?: Web3Modal;\n};\n\ninterface Web3ModalManagerInterface {\n  defaultChain?: number;\n  defaultTheme?: DefaultTheme;\n  onBeforeDisconnect?: () => void;\n  onBeforeConnect?: () => void;\n  providerOptions: IProviderOptions;\n}\n\ntype UseWeb3ModalManagerReturn = {\n  connectWeb3Modal: (connectorId: string) => Promise<void>;\n  disconnectWeb3Modal: () => Promise<void>;\n  providerOptions: Web3ModalManagerInterface['providerOptions'];\n} & Web3ModalManagerState;\n\nconst INITIAL_STATE = {};\n\nfunction reducer(\n  state: Web3ModalManagerState = INITIAL_STATE,\n  {type, payload}: Action\n): Web3ModalManagerState {\n  switch (type) {\n    case ActionType.CONNECT_WEB3MODAL: {\n      const {provider, networkId, account, connected, web3Instance} =\n        payload || {};\n\n      return {\n        ...state,\n        account,\n        connected,\n        networkId,\n        provider,\n        web3Instance,\n      };\n    }\n\n    case ActionType.DEACTIVATE_PROVIDER_WEB3MODAL: {\n      return INITIAL_STATE;\n    }\n\n    case ActionType.ERROR_WEB3MODAL: {\n      const {error} = payload || {};\n\n      return {\n        ...state,\n        error,\n      };\n    }\n\n    case ActionType.INITIAL_CACHED_CONNECTOR_CHECK_STATUS: {\n      const {initialCachedConnectorCheckStatus} = payload || {};\n\n      return {\n        ...state,\n        initialCachedConnectorCheckStatus,\n      };\n    }\n\n    case ActionType.NEW_WEB3MODAL: {\n      const {web3Modal} = payload || {};\n      return {web3Modal};\n    }\n\n    case ActionType.UPDATE_ACCOUNT: {\n      const {account} = payload || {};\n\n      return {\n        ...state,\n        account,\n      };\n    }\n\n    default:\n      return INITIAL_STATE;\n  }\n}\n\nexport default function useWeb3ModalManager({\n  defaultChain,\n  defaultTheme,\n  onBeforeConnect,\n  onBeforeDisconnect,\n  providerOptions,\n}: Web3ModalManagerInterface): UseWeb3ModalManagerReturn {\n  /**\n   * Reducers\n   */\n\n  const [state, dispatch] = useReducer<typeof reducer>(reducer, {\n    initialCachedConnectorCheckStatus: AsyncStatus.STANDBY,\n  });\n\n  /**\n   * Variables\n   */\n\n  const web3ModalTheme = defaultTheme;\n  const web3ModalChain: number = defaultChain || DEFAULT_CHAIN;\n\n  /**\n   * Cached callbacks\n   */\n\n  const connectWeb3ModalCached = useCallback(connectWeb3Modal, [\n    onBeforeConnect,\n    state.web3Modal,\n  ]);\n\n  const chainChangedCallbackCached = useCallback(chainChangedCallback, [\n    connectWeb3ModalCached,\n    state.web3Modal?.cachedProvider,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    const provider = state.provider;\n\n    // Subscribe to accounts change\n    provider?.on?.('accountsChanged', accountsChangedCallback);\n\n    // Subscribe to chainId change\n    provider?.on?.('chainChanged', chainChangedCallbackCached);\n\n    return () => {\n      // Remove listeners on unmount\n      provider?.removeListener?.('accountsChanged', accountsChangedCallback);\n      provider?.removeListener?.('chainChanged', chainChangedCallbackCached);\n    };\n  }, [chainChangedCallbackCached, state.provider]);\n\n  // Init Web3Modal\n  useEffect(() => {\n    if (state.web3Modal) return;\n\n    dispatch({\n      type: ActionType.NEW_WEB3MODAL,\n      payload: {\n        web3Modal: new Web3Modal({\n          cacheProvider: true, // optional\n          network: NetworkNames[NetworkIDs[web3ModalChain]], // optional\n          providerOptions, // required\n          theme: web3ModalTheme, // optional; `light` or `dark`. `dark` is default\n        }),\n      },\n    });\n  }, [providerOptions, state.web3Modal, web3ModalChain, web3ModalTheme]);\n\n  // Attempt to initialise connection to a cached provider\n  useEffect(() => {\n    // If the initial check has ran, or is running, exit.\n    if (\n      state.initialCachedConnectorCheckStatus === AsyncStatus.FULFILLED ||\n      state.initialCachedConnectorCheckStatus === AsyncStatus.PENDING\n    ) {\n      return;\n    }\n\n    attemptUpdateFromCachedConnector(\n      state.web3Modal?.cachedProvider,\n      connectWeb3ModalCached\n    );\n  }, [\n    connectWeb3ModalCached,\n    state.initialCachedConnectorCheckStatus,\n    state.web3Modal?.cachedProvider,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  function accountsChangedCallback([account]: string[]) {\n    dispatch({\n      type: ActionType.UPDATE_ACCOUNT,\n      payload: {\n        account,\n      },\n    });\n  }\n\n  function chainChangedCallback(_chainIdHex: string) {\n    if (!state.web3Modal?.cachedProvider) return;\n\n    connectWeb3ModalCached(state.web3Modal?.cachedProvider);\n  }\n\n  /**\n   * attemptUpdateFromCachedConnector\n   *\n   * Will attempt to connect if a `connectorId` (e.g. `\"injected\"`)\n   * and cached provider (via `localStorage`) is available.\n   *\n   * @param connectorId `String | undefined`\n   * @param connectCallback `Function` callback which dispatches an action to connect\n   * @returns void\n   */\n  async function attemptUpdateFromCachedConnector(\n    connectorId: string | undefined,\n    connectCallback: (cid: string) => Promise<void>\n  ): Promise<void> {\n    const statusAction = ActionType.INITIAL_CACHED_CONNECTOR_CHECK_STATUS;\n\n    /**\n     * Wait for the `state.web3Modal` object to be available, as `cachedProvider`\n     * defaults to an empty `String` if not set.\n     */\n    if (typeof connectorId !== 'string') return;\n\n    dispatch({\n      type: statusAction,\n      payload: {initialCachedConnectorCheckStatus: AsyncStatus.PENDING},\n    });\n\n    if (connectorId) {\n      // @note Does not throw\n      await connectCallback(connectorId);\n    }\n\n    dispatch({\n      type: statusAction,\n      payload: {initialCachedConnectorCheckStatus: AsyncStatus.FULFILLED},\n    });\n  }\n\n  /**\n   * Connect to a specfic wallet; get account assets and\n   * subscribe to provider events\n   */\n  async function connectWeb3Modal(connectorId: string): Promise<void> {\n    try {\n      if (!state.web3Modal) return;\n\n      const provider = await state.web3Modal.connectTo(connectorId);\n\n      const web3Instance: Web3 = new Web3(provider);\n\n      // Get index `0` account\n      const [account] = await web3Instance.eth.getAccounts();\n\n      // Run callback if provided\n      await onBeforeConnect?.();\n\n      dispatch({\n        type: ActionType.CONNECT_WEB3MODAL,\n        payload: {\n          account,\n          connected: true,\n          networkId: await web3Instance.eth.net.getId(),\n          provider,\n          web3Instance,\n        },\n      });\n    } catch (error) {\n      dispatch({\n        type: ActionType.ERROR_WEB3MODAL,\n        payload: {\n          error: {\n            connectorId,\n            error: new Error(`Failed to connect to ${connectorId}.`),\n            type: Web3ModalErrorType.CONNECT,\n          },\n        },\n      });\n    }\n  }\n\n  /**\n   * Disconnect wallet button pressed.\n   */\n  async function disconnectWeb3Modal(): Promise<void> {\n    try {\n      await state.provider?.close?.();\n\n      // If the cached provider is not cleared,\n      // WalletConnect will default to the existing session\n      // and does not allow to re-scan the QR code with a new wallet.\n      // Depending on your use case you may want or want not his behaviour.\n      state.web3Modal && (await state.web3Modal.clearCachedProvider());\n\n      // Run callback if provided\n      await onBeforeDisconnect?.();\n\n      // Reset all state\n      dispatch({type: ActionType.DEACTIVATE_PROVIDER_WEB3MODAL});\n    } catch (error) {\n      const connectorId: string = state.web3Modal?.cachedProvider || '';\n\n      dispatch({\n        type: ActionType.ERROR_WEB3MODAL,\n        payload: {\n          error: {\n            connectorId,\n            error: new Error(\n              `Failed to disconnect from ${connectorId || 'provider'}.`\n            ),\n            type: Web3ModalErrorType.DISCONNECT,\n          },\n        },\n      });\n    }\n  }\n\n  return {\n    ...state,\n    connectWeb3Modal,\n    disconnectWeb3Modal,\n    providerOptions,\n  };\n}\n","import {useEffect, useRef} from 'react';\nimport {v4 as uuidv4} from 'uuid';\nimport ReactTooltip from 'react-tooltip';\nimport useClipboard from 'react-use-clipboard';\n\ntype CopyWithTooltipProps = {\n  /**\n   * How long to wait before resetting `isCopied` in milliseconds. Defaults to `3000`.\n   */\n  copySuccessResetMs?: number;\n  render: (p: CopyWithTooltipRenderProps) => JSX.Element;\n  textToCopy: string;\n  /**\n   * Props for `react-tooltip`\n   */\n  tooltipProps?: ReactTooltip['props'];\n};\n\ntype CopyWithTooltipRenderProps = {\n  /**\n   * Ref for attaching to the rendered element's `ref` prop\n   */\n  elementRef: React.RefObject<any>;\n  /**\n   * Whether or not a copy event has completed. Can be reset using `copySuccessResetMs`.\n   */\n  isCopied: boolean;\n  /**\n   * Callback to trigger a copy event\n   */\n  setCopied: ReturnType<typeof useClipboard>[1];\n  /**\n   * ID for attaching to the rendered element's `data-for` prop\n   */\n  tooltipID: string;\n};\n\nconst DELAY_TOOLTIP_SHOW_MS: number = 200;\n\nexport function CopyWithTooltip(props: CopyWithTooltipProps): JSX.Element {\n  const {\n    copySuccessResetMs = 3000,\n    render,\n    textToCopy = '',\n    tooltipProps,\n  } = props;\n\n  /**\n   * Their hooks\n   */\n\n  const [isCopied, setCopied] = useClipboard(textToCopy, {\n    // `isCopied` will go back to `false` after 3 seconds.\n    successDuration: copySuccessResetMs,\n  });\n\n  /**\n   * Effects\n   */\n\n  /**\n   * Workaround to handle tooltip positioning after text update\n   *\n   * @see https://github.com/wwayne/react-tooltip/issues/638\n   */\n  useEffect(() => {\n    if (!elementRef.current) return;\n\n    if (isCopied) {\n      ReactTooltip.show(elementRef.current);\n    }\n\n    if (!isCopied && isTooltipShownRef.current) {\n      ReactTooltip.show(elementRef.current);\n    }\n  }, [isCopied]);\n\n  /**\n   * Refs\n   */\n\n  const elementRef = useRef<any>(null);\n  const isTooltipShownRef = useRef<boolean>(false);\n  const tooltipIDRef = useRef<string>(uuidv4());\n\n  return (\n    <>\n      {render({\n        elementRef,\n        isCopied,\n        setCopied,\n        tooltipID: tooltipIDRef.current,\n      })}\n\n      <ReactTooltip\n        delayShow={DELAY_TOOLTIP_SHOW_MS}\n        effect=\"solid\"\n        {...tooltipProps}\n        afterHide={(args) => {\n          isTooltipShownRef.current = false;\n\n          tooltipProps?.afterHide?.(args);\n        }}\n        afterShow={(args) => {\n          isTooltipShownRef.current = true;\n\n          tooltipProps?.afterShow?.(args);\n        }}\n        id={tooltipIDRef.current}\n      />\n    </>\n  );\n}\n","import {isEthAddressValid} from '../validation';\n\n/**\n * truncateEthAddress\n *\n * Truncates Ethereum address.\n *\n * @param {string} addr\n * @param {number} [maxLength=5]\n * @returns {string}\n */\nexport function truncateEthAddress(\n  address: string,\n  maxLength: number = 5\n): string {\n  // Fallback if empty `address`\n  if (!address) return '---';\n\n  // In case `address` is not an Ethereum address\n  if (!isEthAddressValid(address)) {\n    return address;\n  }\n\n  const firstSegment = address.substring(0, maxLength);\n  const secondPart = address.substring(address.length - 4);\n\n  return `${firstSegment}...${secondPart}`;\n}\n","import Web3 from 'web3';\n\nimport {ContractExtensionNames} from '../types';\nimport {DaoRegistry} from '../../../abis/types/DaoRegistry';\n\nexport async function getExtensionAddress(\n  extensionName: ContractExtensionNames,\n  daoContractInstance: DaoRegistry | undefined\n): Promise<string> {\n  try {\n    if (!daoContractInstance) {\n      throw new Error('No DaoRegistry contract instance provided.');\n    }\n\n    const extensionNameSha3 = Web3.utils.sha3(extensionName);\n\n    if (!extensionNameSha3) {\n      throw new Error('No sha3 extension name was returned.');\n    }\n\n    return await daoContractInstance.methods\n      .getExtensionAddress(extensionNameSha3)\n      .call();\n  } catch (error) {\n    throw error;\n  }\n}\n","import {SubgraphNetworkStatusState} from './types';\n\nexport const SET_SUBGRAPH_NETWORK_STATUS = 'SET_SUBGRAPH_NETWORK_STATUS';\n\nexport function setSubgraphNetworkStatus(payload: SubgraphNetworkStatusState) {\n  return {type: SET_SUBGRAPH_NETWORK_STATUS, ...payload};\n}\n","import React, {useState, useEffect, CSSProperties} from 'react';\nimport FadeIn from '../common/FadeIn';\n\ntype CycleEllipsisProps = {\n  ariaLabel?: string;\n  /**\n   * What is the interval of cycling the message?\n   */\n  intervalMs?: number;\n  /**\n   * Optional settings for the inner `<FadeIn />` component.\n   */\n  fadeInProps?: Parameters<typeof FadeIn>[0];\n};\n\nconst MESSAGES = ['', '.', '.', '.'];\nconst rootStyles = {position: 'absolute'} as CSSProperties;\nconst nbspStyles = {\n  height: 1,\n  width: 1,\n} as CSSProperties;\n\nexport function CycleEllipsis(props: CycleEllipsisProps) {\n  const {ariaLabel, intervalMs = 1000, fadeInProps} = props;\n  const fadeInPropsMerged = {...fadeInProps, inline: true};\n\n  const [upToIndex, setUpToIndex] = useState<number>(1);\n\n  useEffect(() => {\n    const intervalId = setInterval(\n      () => setUpToIndex((prevIndex) => (prevIndex + 1) % MESSAGES.length),\n      intervalMs\n    );\n\n    return () => {\n      clearInterval(intervalId);\n    };\n  }, [intervalMs]);\n\n  return (\n    <>\n      <span aria-label={ariaLabel} style={rootStyles}>\n        <span>{upToIndex >= 0 && MESSAGES[0]}</span>\n        <span>\n          {upToIndex >= 1 && (\n            <FadeIn {...fadeInPropsMerged}>{MESSAGES[1]}</FadeIn>\n          )}\n        </span>\n        <span>\n          {upToIndex >= 2 && (\n            <FadeIn {...fadeInPropsMerged}>{MESSAGES[2]}</FadeIn>\n          )}\n        </span>\n        <span>\n          {upToIndex >= 3 && (\n            <FadeIn {...fadeInPropsMerged}>{MESSAGES[3]}</FadeIn>\n          )}\n        </span>\n      </span>\n      {/* @note Keep as it's an alignment fallback in certain CSS situations when no other text is a sibiling */}\n      <span style={nbspStyles}>&nbsp;</span>\n    </>\n  );\n}\n","import {useState, useRef, useEffect} from 'react';\nimport {useSelector} from 'react-redux';\nimport {\n  CoreProposalVoteChoices,\n  prepareVoteProposalData,\n  SnapshotType,\n} from '@openlaw/snapshot-js-erc712';\n\nimport {AsyncStatus} from '../../util/types';\nimport {getContractByAddress} from '../web3/helpers';\nimport {ProposalData} from './types';\nimport {SPACE} from '../../config';\nimport {StoreState} from '../../store/types';\nimport {TX_CYCLE_MESSAGES, VOTE_CHOICES} from '../web3/config';\nimport {useCheckApplicant, useSignAndSubmitProposal} from './hooks';\nimport {useContractSend, useETHGasPrice, useWeb3Modal} from '../web3/hooks';\nimport {useMemberActionDisabled} from '../../hooks';\nimport {Web3TxStatus} from '../web3/types';\nimport CycleMessage from '../feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport EtherscanURL from '../web3/EtherscanURL';\nimport FadeIn from '../common/FadeIn';\nimport Loader from '../feedback/Loader';\n\ntype SubmitArguments = [\n  string, // `dao`\n  string, // `proposalId`\n  ...any[],\n  string // `proposal data`\n];\n\ntype SubmitActionProps = {\n  checkApplicant?: string;\n  proposal: ProposalData;\n};\n\ntype ActionDisabledReasons = {\n  invalidApplicantMessage: string;\n};\n\ntype ProposalDataForDao = {\n  body: string;\n  choices: CoreProposalVoteChoices;\n  end: number;\n  name: string;\n  sig: string;\n  snapshot: number;\n  space: string;\n  start: number;\n  submitter: string;\n  timestamp: string;\n};\n\nconst {FULFILLED} = AsyncStatus;\nconst {AWAITING_CONFIRM, FULFILLED: WEB3_TX_FULFILLED, PENDING} = Web3TxStatus;\nconst defaultChoices: CoreProposalVoteChoices = VOTE_CHOICES;\n\nexport default function SubmitAction(props: SubmitActionProps) {\n  const {\n    checkApplicant,\n    proposal: {snapshotDraft, snapshotProposal, refetchProposalOrDraft},\n  } = props;\n\n  /**\n   * Default proposal data for submission to the DAO.\n   * This will be used for `proposalDataForDaoRef`.\n   */\n  const {\n    address: signerAddress = '',\n    msg: {\n      payload: {\n        choices: proposalChoices = defaultChoices,\n        name: proposalName = '',\n        body: proposalBody = '',\n        start: proposalStart = 0,\n        end: proposalEnd = 0,\n        snapshot: proposalSnapshot = 0,\n      },\n      timestamp: proposalTimestamp = '',\n    },\n    sig: proposalSig = '',\n  } = snapshotProposal || {msg: {payload: {}}};\n\n  /**\n   * State\n   */\n\n  const [snapshotProposalSubmitted, setSnapshotProposalSubmitted] =\n    useState<boolean>((snapshotProposal?.sig.length || '') > 0);\n\n  const proposalDataForDaoRef = useRef<ProposalDataForDao>({\n    body: proposalBody,\n    choices: proposalChoices,\n    end: proposalEnd,\n    name: proposalName,\n    sig: proposalSig,\n    snapshot: proposalSnapshot,\n    space: SPACE || '',\n    start: proposalStart,\n    submitter: signerAddress,\n    timestamp: proposalTimestamp,\n  });\n\n  const [submitError, setSubmitError] = useState<Error>();\n\n  /**\n   * Refs\n   */\n\n  const actionDisabledReasonsRef = useRef<ActionDisabledReasons>({\n    invalidApplicantMessage: '',\n  });\n\n  /**\n   * Selectors\n   */\n\n  const contracts = useSelector((s: StoreState) => s.contracts);\n\n  const daoRegistryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account, web3Instance} = useWeb3Modal();\n  const {txEtherscanURL, txIsPromptOpen, txSend, txStatus} = useContractSend();\n  const {average: gasPrice} = useETHGasPrice();\n\n  const {\n    isDisabled,\n    openWhyDisabledModal,\n    WhyDisabledModal,\n    setOtherDisabledReasons,\n  } = useMemberActionDisabled();\n\n  const {proposalSignAndSendStatus, signAndSendProposal} =\n    useSignAndSubmitProposal<SnapshotType.proposal>();\n\n  const {\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n  } = useCheckApplicant(checkApplicant);\n\n  /**\n   * Variables\n   */\n\n  const isInProcess =\n    txStatus === AWAITING_CONFIRM ||\n    txStatus === PENDING ||\n    proposalSignAndSendStatus === AWAITING_CONFIRM ||\n    proposalSignAndSendStatus === PENDING;\n\n  const isDone = snapshotProposalSubmitted\n    ? txStatus === WEB3_TX_FULFILLED\n    : txStatus === WEB3_TX_FULFILLED &&\n      proposalSignAndSendStatus === WEB3_TX_FULFILLED;\n\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (checkApplicant && checkApplicantStatus === FULFILLED) {\n      // 1. Determine and set reasons why action would be disabled\n\n      /**\n       * Reason: If the applicant address is invalid (see `useCheckApplicant`\n       * hook for reasons) the `submitProposal` smart contract transaction will\n       * fail.\n       */\n      if (!isApplicantValid && checkApplicantInvalidMsg) {\n        actionDisabledReasonsRef.current = {\n          ...actionDisabledReasonsRef.current,\n          invalidApplicantMessage: checkApplicantInvalidMsg,\n        };\n      }\n\n      // 2. Set reasons\n      setOtherDisabledReasons(Object.values(actionDisabledReasonsRef.current));\n    }\n  }, [\n    checkApplicant,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n    setOtherDisabledReasons,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  async function handleSubmit() {\n    try {\n      if (!daoRegistryAddress) {\n        throw new Error('No DAO Registry address was found.');\n      }\n\n      const actionId: string =\n        (snapshotDraft || snapshotProposal)?.actionId || '';\n\n      const contract = getContractByAddress(actionId, contracts);\n\n      if (!contract) {\n        throw Error(`No contract was found for action id ${actionId}.`);\n      }\n\n      const idForDAO: string =\n        (snapshotDraft || snapshotProposal)?.idInDAO || '';\n\n      const submitActionArgs: any[] = (\n        snapshotDraft?.msg.payload || snapshotProposal?.msg.payload\n      )?.metadata.submitActionArgs;\n\n      // If the Snapshot Proposal has not yet been submitted to Snapshot Hub\n      if (!snapshotProposalSubmitted && snapshotDraft) {\n        const {\n          msg: {\n            payload: {\n              name: draftName,\n              body: draftBody,\n              metadata: draftMetadata,\n            },\n            timestamp: draftTimestamp,\n          },\n        } = snapshotDraft;\n\n        // Sign and submit draft for snapshot-hub\n        const {data, signature, submitter} = await signAndSendProposal({\n          partialProposalData: {\n            name: draftName,\n            body: draftBody,\n            metadata: draftMetadata,\n            timestamp: draftTimestamp,\n          },\n          adapterAddress: contract.contractAddress,\n          type: SnapshotType.proposal,\n        });\n\n        // Set the proposal data for submission to the DAO\n        proposalDataForDaoRef.current = {\n          body: data.payload.body,\n          choices: data.payload.choices,\n          end: data.payload.end,\n          name: data.payload.name,\n          sig: signature,\n          snapshot: data.payload.snapshot,\n          space: data.space,\n          start: data.payload.start,\n          submitter,\n          timestamp: data.timestamp,\n        };\n\n        setSnapshotProposalSubmitted(true);\n      }\n\n      const {\n        body,\n        choices,\n        end,\n        name,\n        sig,\n        snapshot,\n        space,\n        start,\n        submitter,\n        timestamp,\n      } = proposalDataForDaoRef.current;\n\n      /**\n       * Prepare `data` argument for submission to DAO\n       *\n       * For information about which data the smart contract needs for signature verification (e.g. `hashMessage`):\n       * @link https://github.com/openlawteam/tribute-contracts/blob/master/contracts/adapters/voting/OffchainVoting.sol\n       */\n      const preparedVoteVerificationBytes = prepareVoteProposalData(\n        {\n          payload: {\n            body,\n            choices,\n            end,\n            name,\n            snapshot: snapshot.toString(),\n            start,\n          },\n          submitter,\n          sig,\n          space,\n          timestamp: parseInt(timestamp),\n        },\n        web3Instance\n      );\n\n      const submitArguments: SubmitArguments = [\n        daoRegistryAddress,\n        idForDAO,\n        ...(submitActionArgs || []),\n        preparedVoteVerificationBytes,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(gasPrice ? {gasPrice} : null),\n      };\n\n      await txSend(\n        'submitProposal',\n        contract.instance.methods,\n        submitArguments,\n        txArguments\n      );\n\n      // Update the proposal\n      refetchProposalOrDraft();\n    } catch (error) {\n      const e = error as Error;\n\n      setSubmitError(e);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  function renderSubmitStatus(): React.ReactNode {\n    // Either Snapshot or chain tx\n    if (\n      txStatus === AWAITING_CONFIRM ||\n      proposalSignAndSendStatus === AWAITING_CONFIRM\n    ) {\n      return 'Awaiting your confirmation\\u2026';\n    }\n\n    // Only for chain tx\n    switch (txStatus) {\n      case PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case WEB3_TX_FULFILLED:\n        return (\n          <>\n            <div>Proposal submitted!</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  /**\n   * Log-out check applicant error\n   *\n   * @todo Use logging service\n   */\n  if (checkApplicantError) {\n    console.warn(\n      `Error checking if the applicant address is valid: ${checkApplicantError.message}`\n    );\n  }\n\n  return (\n    <>\n      <div>\n        <button\n          className=\"proposaldetails__button\"\n          disabled={isDisabled || isInProcessOrDone}\n          onClick={isDisabled || isInProcessOrDone ? () => {} : handleSubmit}>\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Sponsor'}\n        </button>\n\n        <ErrorMessageWithDetails\n          error={submitError}\n          renderText=\"Something went wrong\"\n        />\n\n        {/* SUBMIT STATUS */}\n\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {isDisabled && (\n          <button\n            className=\"button--help-centered\"\n            onClick={openWhyDisabledModal}>\n            Why is sponsoring disabled?\n          </button>\n        )}\n      </div>\n\n      <WhyDisabledModal title=\"Why is sponsoring disabled?\" />\n    </>\n  );\n}\n","import {createContext, useEffect, useRef, useState} from 'react';\nimport Web3 from 'web3';\nimport Web3Modal, {IProviderOptions} from 'web3modal';\n\nimport useWeb3ModalManager, {\n  DefaultTheme,\n  Web3ModalError,\n} from './hooks/useWeb3ModalManager';\nimport {AsyncStatus} from '../../util/types';\nimport {ETHEREUM_PROVIDER_URL} from '../../config';\nimport {normalizeString} from '../../util/helpers';\nimport {useENSName} from './hooks';\n\ntype Web3ModalProviderArguments = {\n  defaultChain?: number;\n  defaultTheme?: DefaultTheme;\n  /**\n   * Optional: Any action to take after disconnecting from an Ethereum provider.\n   */\n  onBeforeDisconnect?: Parameters<\n    typeof useWeb3ModalManager\n  >[0]['onBeforeDisconnect'];\n  /**\n   * Optional: Any action to take before connecting to an Ethereum provider.\n   */\n  onBeforeConnect?: Parameters<\n    typeof useWeb3ModalManager\n  >[0]['onBeforeConnect'];\n  providerOptions: IProviderOptions; // required\n};\n\ntype Web3ModalManagerProps = {\n  children: JSX.Element;\n} & Web3ModalProviderArguments;\n\nexport type Web3ModalContextValue = {\n  account: string | undefined;\n  accountENS?: string;\n  connected: boolean | undefined;\n  connectWeb3Modal: (providerName: string) => void;\n  disconnectWeb3Modal: () => void;\n  error: Web3ModalError | undefined;\n  initialCachedConnectorCheckStatus: AsyncStatus | undefined;\n  networkId: number | undefined;\n  provider: any;\n  providerOptions: IProviderOptions;\n  web3Instance: Web3 | undefined;\n  web3Modal: Web3Modal | undefined;\n};\n\nexport const Web3ModalContext = createContext<Web3ModalContextValue>(\n  {} as Web3ModalContextValue\n);\n\n/**\n * Web3ModalManager\n *\n * A provider for the `web3modal` wallet connection, provides access to\n * the wallet states, enables connections and disconnections.\n *\n * @example\n * <Web3ModalManager defaultChain={1} defaultTheme={'dark'} providerOptions={...}>\n *   ...\n * </Web3ModalManager>\n *\n * @param children: React.JSX\n * @param defaultChain?: number\n * @param defaultTheme?: DefaultTheme; default is `dark`\n * @param providerOptions: Record<string, any>\n */\n\nexport default function Web3ModalManager({\n  children,\n  defaultChain,\n  defaultTheme = DefaultTheme.DARK,\n  onBeforeConnect,\n  onBeforeDisconnect,\n  providerOptions,\n}: Web3ModalManagerProps) {\n  /**\n   * Refs\n   */\n\n  const defaultWeb3InstanceRef = useRef<Web3 | undefined>(\n    new Web3(new Web3.providers.WebsocketProvider(ETHEREUM_PROVIDER_URL))\n  );\n\n  /**\n   * State\n   */\n\n  const [defaultWeb3NetID, setDefaultWeb3NetID] = useState<\n    number | undefined\n  >();\n\n  /**\n   * Variables\n   */\n\n  const web3ModalProviderArguments: Web3ModalProviderArguments = {\n    defaultChain,\n    defaultTheme,\n    onBeforeConnect,\n    onBeforeDisconnect,\n    providerOptions,\n  };\n\n  /**\n   * Our hooks\n   */\n\n  const {\n    account,\n    connected,\n    connectWeb3Modal,\n    disconnectWeb3Modal,\n    error,\n    initialCachedConnectorCheckStatus,\n    networkId = defaultWeb3NetID,\n    provider = defaultWeb3InstanceRef.current?.currentProvider,\n    web3Instance = defaultWeb3InstanceRef.current,\n    web3Modal,\n  } = useWeb3ModalManager(web3ModalProviderArguments);\n\n  const [ensReverseResolvedAddresses, setAddressesToENSReverseResolve] =\n    useENSName(web3Instance);\n\n  /**\n   * Variables\n   */\n\n  const [ensName] = ensReverseResolvedAddresses;\n\n  const accountENS: string | undefined =\n    ensName && normalizeString(ensName) !== normalizeString(account)\n      ? ensName\n      : undefined;\n\n  /**\n   * Effects\n   */\n\n  // Set network ID when using `defaultWeb3InstanceRef` (i.e. not connected to a wallet)\n  useEffect(() => {\n    if (\n      !connected &&\n      initialCachedConnectorCheckStatus === AsyncStatus.FULFILLED\n    ) {\n      defaultWeb3InstanceRef.current?.eth.net\n        .getId()\n        .then(setDefaultWeb3NetID)\n        .catch(() => setDefaultWeb3NetID(undefined));\n    }\n  }, [connected, initialCachedConnectorCheckStatus]);\n\n  // Set eth addresses to ENS reverse resolve\n  useEffect(() => {\n    if (!account) return;\n\n    setAddressesToENSReverseResolve([account]);\n  }, [account, setAddressesToENSReverseResolve]);\n\n  /**\n   * Render\n   */\n\n  const web3ModalContext: Web3ModalContextValue = {\n    account,\n    accountENS,\n    connected,\n    connectWeb3Modal,\n    disconnectWeb3Modal,\n    error,\n    initialCachedConnectorCheckStatus,\n    networkId,\n    provider,\n    providerOptions,\n    web3Instance,\n    web3Modal,\n  };\n\n  return (\n    <Web3ModalContext.Provider value={web3ModalContext}>\n      {children}\n    </Web3ModalContext.Provider>\n  );\n}\n","import {AbiItem} from 'web3-utils/types';\nimport {Contract as Web3Contract} from 'web3-eth-contract/types';\nimport {Dispatch} from 'redux';\nimport Web3 from 'web3';\n\nimport {\n  ContractAdapterNames,\n  ContractExtensionNames,\n} from '../../components/web3/types';\nimport {\n  DEFAULT_CHAIN,\n  BANK_FACTORY_CONTRACT_ADDRESS,\n  DAO_FACTORY_CONTRACT_ADDRESS,\n  DAO_REGISTRY_CONTRACT_ADDRESS,\n} from '../../config';\nimport {\n  getAdapterAddress,\n  getVotingAdapterName,\n} from '../../components/web3/helpers';\nimport {\n  DaoAdapterConstants,\n  DaoExtensionConstants,\n  VotingAdapterName,\n} from '../../components/adapters-extensions/enums';\nimport {ContractsStateEntry} from './types';\nimport {getExtensionAddress} from '../../components/web3/helpers/getExtensionAddress';\nimport {StoreState} from '../types';\n\ntype ContractAction =\n  | typeof CLEAR_CONTRACTS\n  | typeof CONTRACT_BANK_ADAPTER\n  | typeof CONTRACT_BANK_EXTENSION\n  | typeof CONTRACT_BANK_FACTORY\n  | typeof CONTRACT_CONFIGURATION\n  | typeof CONTRACT_COUPON_ONBOARDING\n  | typeof CONTRACT_DAO_FACTORY\n  | typeof CONTRACT_DAO_REGISTRY\n  | typeof CONTRACT_DAO_REGISTRY_ADAPTER\n  | typeof CONTRACT_DISTRIBUTE\n  | typeof CONTRACT_ERC20_EXTENSION\n  | typeof CONTRACT_FINANCING\n  | typeof CONTRACT_GUILDKICK\n  | typeof CONTRACT_KYC_ONBOARDING\n  | typeof CONTRACT_MANAGING\n  | typeof CONTRACT_NFT_EXTENSION\n  | typeof CONTRACT_ONBOARDING\n  | typeof CONTRACT_RAGEQUIT\n  | typeof CONTRACT_TRIBUTE\n  | typeof CONTRACT_TRIBUTE_NFT\n  | typeof CONTRACT_VOTING\n  | typeof CONTRACT_VOTING_OP_ROLLUP;\n\nexport const CLEAR_CONTRACTS = 'CLEAR_CONTRACTS';\nexport const CONTRACT_BANK_ADAPTER = 'CONTRACT_BANK_ADAPTER';\nexport const CONTRACT_BANK_EXTENSION = 'CONTRACT_BANK_EXTENSION';\nexport const CONTRACT_BANK_FACTORY = 'CONTRACT_BANK_FACTORY';\nexport const CONTRACT_CONFIGURATION = 'CONTRACT_CONFIGURATION';\nexport const CONTRACT_COUPON_ONBOARDING = 'CONTRACT_COUPON_ONBOARDING';\nexport const CONTRACT_DAO_FACTORY = 'CONTRACT_DAO_FACTORY';\nexport const CONTRACT_DAO_REGISTRY = 'CONTRACT_DAO_REGISTRY';\nexport const CONTRACT_DAO_REGISTRY_ADAPTER = 'CONTRACT_DAO_REGISTRY_ADAPTER';\nexport const CONTRACT_DISTRIBUTE = 'CONTRACT_DISTRIBUTE';\nexport const CONTRACT_ERC20_EXTENSION = 'CONTRACT_ERC20_EXTENSION';\nexport const CONTRACT_FINANCING = 'CONTRACT_FINANCING';\nexport const CONTRACT_GUILDKICK = 'CONTRACT_GUILDKICK';\nexport const CONTRACT_KYC_ONBOARDING = 'CONTRACT_KYC_ONBOARDING';\nexport const CONTRACT_MANAGING = 'CONTRACT_MANAGING';\nexport const CONTRACT_NFT_EXTENSION = 'CONTRACT_NFT_EXTENSION';\nexport const CONTRACT_ONBOARDING = 'CONTRACT_ONBOARDING';\nexport const CONTRACT_RAGEQUIT = 'CONTRACT_RAGEQUIT';\nexport const CONTRACT_TRIBUTE = 'CONTRACT_TRIBUTE';\nexport const CONTRACT_TRIBUTE_NFT = 'CONTRACT_TRIBUTE_NFT';\nexport const CONTRACT_VOTING = 'CONTRACT_VOTING';\nexport const CONTRACT_VOTING_OP_ROLLUP = 'CONTRACT_VOTING_OP_ROLLUP';\n\nexport function clearContracts(): Record<'type', typeof CLEAR_CONTRACTS> {\n  return {\n    type: CLEAR_CONTRACTS,\n  };\n}\n\nexport function initContractBankFactory(web3Instance: Web3) {\n  return async function (dispatch: Dispatch<any>) {\n    try {\n      if (web3Instance) {\n        const {default: lazyBankFactoryABI} = await import(\n          '../../abis/tribute-contracts/BankFactory.json'\n        );\n        const bankFactoryContract: AbiItem[] = lazyBankFactoryABI as any;\n        const contractAddress = BANK_FACTORY_CONTRACT_ADDRESS[DEFAULT_CHAIN];\n        const instance = new web3Instance.eth.Contract(\n          bankFactoryContract,\n          contractAddress\n        );\n\n        dispatch(\n          createContractAction({\n            type: CONTRACT_BANK_FACTORY,\n            abi: bankFactoryContract,\n            contractAddress,\n            instance,\n          })\n        );\n      }\n    } catch (error) {\n      throw error;\n    }\n  };\n}\n\nexport function initContractDaoFactory(web3Instance: Web3) {\n  return async function (dispatch: Dispatch<any>) {\n    try {\n      if (web3Instance) {\n        const {default: lazyDaoFactoryABI} = await import(\n          '../../abis/tribute-contracts/DaoFactory.json'\n        );\n        const daoFactoryContract: AbiItem[] = lazyDaoFactoryABI as any;\n        const contractAddress = DAO_FACTORY_CONTRACT_ADDRESS[DEFAULT_CHAIN];\n        const instance = new web3Instance.eth.Contract(\n          daoFactoryContract,\n          contractAddress\n        );\n\n        dispatch(\n          createContractAction({\n            type: CONTRACT_DAO_FACTORY,\n            abi: daoFactoryContract,\n            contractAddress,\n            instance,\n          })\n        );\n      }\n    } catch (error) {\n      throw error;\n    }\n  };\n}\n\nexport function initContractDaoRegistry(web3Instance: Web3) {\n  return async function (dispatch: Dispatch<any>) {\n    try {\n      if (web3Instance) {\n        const {default: lazyDaoRegistryABI} = await import(\n          '../../abis/tribute-contracts/DaoRegistry.json'\n        );\n\n        const daoRegistryContract: AbiItem[] = lazyDaoRegistryABI as any;\n        const contractAddress = DAO_REGISTRY_CONTRACT_ADDRESS;\n\n        if (!contractAddress) {\n          throw new Error('No DAO Registry contract address was found.');\n        }\n\n        const instance = new web3Instance.eth.Contract(\n          daoRegistryContract,\n          contractAddress\n        );\n\n        dispatch(\n          createContractAction({\n            type: CONTRACT_DAO_REGISTRY,\n            abi: daoRegistryContract,\n            contractAddress,\n            instance,\n          })\n        );\n      }\n    } catch (error) {\n      throw error;\n    }\n  };\n}\n\nexport function initContractVoting(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_VOTING,\n    adapterOrExtensionName: ContractAdapterNames.voting,\n    adapterNameForRedux: VotingAdapterName.VotingContract,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/VotingContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractVotingOpRollup(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_VOTING_OP_ROLLUP,\n    adapterOrExtensionName: ContractAdapterNames.voting,\n    adapterNameForRedux: VotingAdapterName.OffchainVotingContract,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/OffchainVotingContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractOnboarding(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_ONBOARDING,\n    adapterNameForRedux: DaoAdapterConstants.ONBOARDING,\n    adapterOrExtensionName: ContractAdapterNames.onboarding,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/OnboardingContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractBankExtension(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_BANK_EXTENSION,\n    adapterNameForRedux: DaoExtensionConstants.BANK,\n    adapterOrExtensionName: ContractExtensionNames.bank,\n    contractAddress,\n    isExtension: true,\n    lazyImport: () => import('../../abis/tribute-contracts/BankExtension.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractTribute(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_TRIBUTE,\n    adapterNameForRedux: DaoAdapterConstants.TRIBUTE,\n    adapterOrExtensionName: ContractAdapterNames.tribute,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/TributeContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractDistribute(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_DISTRIBUTE,\n    adapterNameForRedux: DaoAdapterConstants.DISTRIBUTE,\n    adapterOrExtensionName: ContractAdapterNames.distribute,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/DistributeContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractManaging(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_MANAGING,\n    adapterNameForRedux: DaoAdapterConstants.MANAGING,\n    adapterOrExtensionName: ContractAdapterNames.managing,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/ManagingContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractBankAdapter(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_BANK_ADAPTER,\n    adapterNameForRedux: DaoAdapterConstants.BANK,\n    adapterOrExtensionName: ContractAdapterNames.bank,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/BankAdapterContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractDaoRegistryAdapter(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_DAO_REGISTRY_ADAPTER,\n    adapterNameForRedux: DaoAdapterConstants.DAO_REGISTRY,\n    adapterOrExtensionName: ContractAdapterNames.dao_registry,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/DaoRegistryAdapterContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractRagequit(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_RAGEQUIT,\n    adapterNameForRedux: DaoAdapterConstants.RAGEQUIT,\n    adapterOrExtensionName: ContractAdapterNames.ragequit,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/RagequitContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractGuildKick(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_GUILDKICK,\n    adapterNameForRedux: DaoAdapterConstants.GUILDKICK,\n    adapterOrExtensionName: ContractAdapterNames.guildkick,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/GuildKickContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractFinancing(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_FINANCING,\n    adapterNameForRedux: DaoAdapterConstants.FINANCING,\n    adapterOrExtensionName: ContractAdapterNames.financing,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/FinancingContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractConfiguration(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_CONFIGURATION,\n    adapterNameForRedux: DaoAdapterConstants.CONFIGURATION,\n    adapterOrExtensionName: ContractAdapterNames.configuration,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/ConfigurationContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractTributeNFT(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_TRIBUTE_NFT,\n    adapterNameForRedux: DaoAdapterConstants.TRIBUTE_NFT,\n    adapterOrExtensionName: ContractAdapterNames.tribute_nft,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/TributeNFTContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractCouponOnboarding(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_COUPON_ONBOARDING,\n    adapterNameForRedux: DaoAdapterConstants.COUPON_ONBOARDING,\n    adapterOrExtensionName: ContractAdapterNames.coupon_onboarding,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/CouponOnboardingContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractKycOnboarding(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_KYC_ONBOARDING,\n    adapterNameForRedux: DaoAdapterConstants.KYC_ONBOARDING,\n    adapterOrExtensionName: ContractAdapterNames.kyc_onboarding,\n    contractAddress,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/KycOnboardingContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractNFTExtension(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_NFT_EXTENSION,\n    adapterNameForRedux: DaoExtensionConstants.NFT,\n    adapterOrExtensionName: ContractExtensionNames.nft,\n    contractAddress,\n    isExtension: true,\n    lazyImport: () => import('../../abis/tribute-contracts/NFTExtension.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractERC20Extension(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_ERC20_EXTENSION,\n    adapterNameForRedux: DaoExtensionConstants.ERC20,\n    adapterOrExtensionName: ContractExtensionNames.erc20,\n    contractAddress,\n    isExtension: true,\n    lazyImport: () =>\n      import('../../abis/tribute-contracts/ERC20Extension.json'),\n    web3Instance,\n  });\n}\n\n/**\n * Inits the currently registered `voting` contract.\n *\n * @note The DaoRegistry and Managing contracts must be initialised beforehand.\n */\nexport function initRegisteredVotingAdapter(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return async function (dispatch: Dispatch<any>, getState: () => StoreState) {\n    try {\n      if (web3Instance) {\n        const daoRegistryContract = getState().contracts.DaoRegistryContract;\n\n        if (!daoRegistryContract) {\n          console.warn(\n            'Please init the DaoRegistry contract before the voting contract.'\n          );\n          return;\n        }\n\n        let votingAdapterName: string = '';\n        let address: string = contractAddress || '';\n\n        if (address) {\n          votingAdapterName = await getVotingAdapterName(address, web3Instance);\n        }\n\n        if (!address && !votingAdapterName) {\n          address = await getAdapterAddress(\n            ContractAdapterNames.voting,\n            getState().contracts.DaoRegistryContract?.instance\n          );\n\n          votingAdapterName = await getVotingAdapterName(address, web3Instance);\n        }\n\n        /**\n         * @todo Move voting adapter enum names (see contracts: `ADAPTER_NAME`)\n         *   to an appropriate adapter config file.\n         */\n        switch (votingAdapterName) {\n          case 'VotingContract':\n            return await initContractVoting(web3Instance, address)(\n              dispatch,\n              getState\n            );\n          case 'OffchainVotingContract':\n            return await initContractVotingOpRollup(web3Instance, address)(\n              dispatch,\n              getState\n            );\n          default:\n            throw new Error('Voting contract name could not be found.');\n        }\n      }\n    } catch (error) {\n      console.warn(\n        `The voting contract could not be found in the DAO. Are you sure you meant to add this contract's ABI?`\n      );\n    }\n  };\n}\n\nexport function createContractAction<T = Web3Contract>({\n  type,\n  ...payload\n}: {\n  type: ContractAction;\n} & ContractsStateEntry<T>) {\n  return {\n    type,\n    ...payload,\n  };\n}\n\nexport function initContractThunkFactory({\n  actionType,\n  adapterNameForRedux,\n  adapterOrExtensionName,\n  contractAddress,\n  isExtension = false,\n  lazyImport,\n  web3Instance,\n}: {\n  actionType: ContractAction;\n  adapterOrExtensionName: ContractAdapterNames | ContractExtensionNames;\n  /**\n   * The name to be shown in Redux state as `adapterOrExtensionName`.\n   */\n  adapterNameForRedux?: ContractsStateEntry['adapterOrExtensionName'];\n  contractAddress?: string;\n  /**\n   * If set to `true` an Extenion address will be searched for instead of an Adapter.\n   */\n  isExtension?: boolean;\n  /**\n   * Provide a Dynamic Import wrapped in a function.\n   *\n   * e.g. `() => import('./path/to/import')`\n   */\n  lazyImport: () => any;\n  web3Instance: Web3;\n}) {\n  // Return a Redux Thunk\n  return async function (dispatch: Dispatch<any>, getState: () => StoreState) {\n    try {\n      const {default: lazyABI} = await lazyImport();\n\n      const contractABI: AbiItem[] = lazyABI as any;\n\n      const address =\n        contractAddress ||\n        (isExtension\n          ? await getExtensionAddress(\n              adapterOrExtensionName as any as ContractExtensionNames,\n              getState().contracts.DaoRegistryContract?.instance\n            )\n          : await getAdapterAddress(\n              adapterOrExtensionName as any as ContractAdapterNames,\n              getState().contracts.DaoRegistryContract?.instance\n            ));\n\n      dispatch(\n        createContractAction({\n          type: actionType,\n          abi: contractABI,\n          contractAddress: address,\n          adapterOrExtensionName: adapterNameForRedux,\n          instance: new web3Instance.eth.Contract(contractABI, address),\n        })\n      );\n    } catch (error) {\n      // Warn instead of throwing as we want the Dapp to fail gracefully.\n      console.warn(\n        `The contract \"${adapterOrExtensionName}\" could not be found in the DAO. Are you sure you meant to add this contract's ABI?`\n      );\n    }\n  };\n}\n","// see: http://reactcommunity.org/react-transition-group/transition\nimport React from 'react';\nimport {Transition} from 'react-transition-group';\n\ntype FadeInProps = {\n  children?: React.ReactNode;\n  duration?: number;\n  /**\n   * Defaults to `true`\n   */\n  show?: boolean;\n  /**\n   * Renders a `<span>` wrapper where the animation CSS is applied.\n   */\n  inline?: boolean;\n};\n\nconst DEFAULT_DURATION = 300;\n\nconst defaultStyle = (props: FadeInProps) => ({\n  transition: `opacity ${\n    props.duration || 300\n  }ms cubic-bezier(0, 0.69, 0.32, 0.64)`,\n  opacity: 0,\n});\n\nconst transitionStyles: Record<string, any> = {\n  entering: {opacity: 0},\n  entered: {opacity: 1},\n  exiting: {opacity: 0},\n  exited: {opacity: 0},\n};\n\nexport default function FadeIn(props: FadeInProps) {\n  const {inline} = props;\n\n  return (\n    <Transition\n      appear\n      in={props.show !== undefined ? props.show : true}\n      timeout={props.duration || DEFAULT_DURATION}>\n      {(transition) =>\n        inline ? (\n          <span\n            style={{\n              ...defaultStyle(props),\n              ...transitionStyles[transition],\n            }}>\n            {props.children}\n          </span>\n        ) : (\n          <div\n            style={{\n              ...defaultStyle(props),\n              ...transitionStyles[transition],\n            }}>\n            {props.children}\n          </div>\n        )\n      }\n    </Transition>\n  );\n}\n","import {CHAINS} from '../../../config';\nimport {getAlchemyURL} from '../../../util/helpers';\nimport {numberTo0xHexString} from '../../../util/helpers/numberTo0xHexString';\n\ntype AlchemyGetAssetTransfersCategories =\n  | 'external'\n  | 'internal'\n  | 'token'\n  | 'erc20'\n  | 'erc721'\n  | 'erc1155';\n\ntype GetAssetTransfersParameters = {\n  /**\n   * Will be converted to hex string\n   */\n  fromBlock?: number;\n  /**\n   * Will be converted to hex string\n   */\n  toBlock?: number;\n  fromAddress?: string;\n  toAddress?: string;\n  contractAddresses?: string[];\n  category?: AlchemyGetAssetTransfersCategories[];\n  excludeZeroValue?: boolean;\n  /**\n   * Will be converted to hex string\n   */\n  maxCount?: number;\n  pageKey?: string;\n};\n\ntype AlchemyGetAssetTransfersResult = {\n  asset: string | null;\n  blockNum: string;\n  category: AlchemyGetAssetTransfersCategories;\n  erc1155Metadata: {tokenId: string; value: string}[] | null;\n  erc721TokenId: string | null;\n  from: string;\n  hash: string;\n  rawContract: {\n    address: string | null;\n    decimal: string | null;\n    value: string | null;\n  };\n  to: string | null;\n  value: number | null;\n};\n\ntype AlchemyGetAssetTransfersResponse = {\n  id: string;\n  jsonrpc: number;\n  result: {\n    pageKey: string;\n    transfers: AlchemyGetAssetTransfersResult[];\n  };\n};\n\n/**\n * Gets asset transfers between addresses via Alchemy API.\n *\n * The Alchemy Transfers API only works on mainnet.\n *\n * @param parameters `GetAssetTransfersParameters`\n * @returns\n * @see https://docs.alchemy.com/alchemy/enhanced-apis/transfers-api\n */\nexport async function alchemyFetchAssetTransfers(\n  parameters: GetAssetTransfersParameters = {fromBlock: 0},\n  options: {abortController?: AbortController} = {}\n): Promise<AlchemyGetAssetTransfersResult[]> {\n  const ALCHEMY_URL = getAlchemyURL(CHAINS.MAINNET);\n\n  if (!ALCHEMY_URL) {\n    throw new Error('No Alchemy URL was found.');\n  }\n\n  const {fromBlock = 0, maxCount = 1000} = parameters;\n  const toBlock = numberTo0xHexString(parameters.toBlock) || 'latest';\n\n  const requestOptions = {\n    id: 0,\n    jsonrpc: '2.0',\n    method: 'alchemy_getAssetTransfers',\n    params: [\n      {\n        ...parameters,\n        fromBlock: numberTo0xHexString(fromBlock),\n        maxCount: numberTo0xHexString(maxCount),\n        toBlock,\n      },\n    ],\n  };\n\n  const response = await fetch(ALCHEMY_URL, {\n    body: JSON.stringify(requestOptions),\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    method: 'POST',\n    signal: options?.abortController?.signal,\n  });\n\n  if (!response.ok) {\n    throw new Error(\n      `Something went wrong while fetching alchemy_getAssetTransfers.`\n    );\n  }\n\n  const {result} = (await response.json()) as AlchemyGetAssetTransfersResponse;\n\n  const t = [...result.transfers];\n\n  // Recurse, if paginated\n  if (result.pageKey) {\n    t.push(\n      ...(await alchemyFetchAssetTransfers({\n        ...parameters,\n        pageKey: result.pageKey,\n      }))\n    );\n  }\n\n  return t;\n}\n","import {Contract, SendOptions} from 'web3-eth-contract/types';\nimport {TransactionReceipt} from 'web3-core/types';\nimport BigNumber from 'bignumber.js';\n\n/**\n * contractSend\n *\n * Returns the resolved transaction receipt or error\n *\n * @param {string} methodName\n * @param {Record<string, any>} contractInstanceMethods An object of the methods for the Web3 contract instance.\n * @param {any[]} methodArguments An array of any arguments for the contract's method.\n * @param {Record<string, any>} txArguments\n * @param {(txHash: string) => void} onProcess Callback which runs after a txHash has been received,\n *   but before the transaction is complete.\n * @returns {Promise<TransactionReceipt>} Resolved or rejected transaction.\n */\nexport async function contractSend(\n  methodName: string,\n  contractInstanceMethods: typeof Contract.prototype.methods,\n  methodArguments: any[],\n  txArguments: SendOptions,\n  onProcess?: (txHash: string) => void\n): Promise<TransactionReceipt> {\n  // Promisify so we can both `reject()` inside .on('error') and from transactions.\n  return new Promise<TransactionReceipt>(async (resolve, reject) => {\n    try {\n      const BN = BigNumber;\n      const method = contractInstanceMethods[methodName];\n\n      // estimate gas limit for transaction\n      const gas = await method(...methodArguments).estimateGas({\n        from: txArguments.from,\n        value: txArguments.value,\n      });\n\n      const gastoBN = new BN(gas)\n        .decimalPlaces(0, BigNumber.ROUND_DOWN)\n        .toNumber();\n\n      await method(...methodArguments)\n        .send({\n          ...txArguments,\n          gas: gastoBN,\n        })\n        .on('transactionHash', function (txHash: string) {\n          // Call onProcess with transaction hash\n          onProcess && onProcess(txHash);\n        })\n        .on('receipt', function (receipt: TransactionReceipt) {\n          // resolve on transaction receipt; contains event returnValues\n          resolve(receipt);\n        })\n        .on('error', (error: Error) => {\n          // reject on transaction error\n          reject(error);\n        });\n    } catch (error) {\n      // reject on estimate gas or transaction error\n      reject(error);\n    }\n  });\n}\n","import Web3 from 'web3';\n\nimport {ContractAdapterNames} from '../types';\nimport {DaoRegistry} from '../../../abis/types/DaoRegistry';\n\nexport async function getAdapterAddress(\n  adapterName: ContractAdapterNames,\n  daoContractInstance: DaoRegistry | undefined\n): Promise<string> {\n  try {\n    if (!daoContractInstance) {\n      throw new Error('No DaoRegistry contract instance provided.');\n    }\n\n    const adapterNameSha3 = Web3.utils.sha3(adapterName);\n\n    if (!adapterNameSha3) {\n      throw new Error('No sha3 adapter name was returned.');\n    }\n\n    return await daoContractInstance.methods\n      .getAdapterAddress(adapterNameSha3)\n      .call();\n  } catch (error) {\n    throw error;\n  }\n}\n","import {DaoRegistry} from '../../../abis/types/DaoRegistry';\n\nexport enum DaoState {\n  CREATION = 'CREATION',\n  READY = 'READY',\n}\n\nexport async function getDaoState(\n  daoContractInstance: DaoRegistry | undefined\n): Promise<DaoState> {\n  try {\n    if (!daoContractInstance) {\n      throw new Error('No DaoRegistry contract instance provided.');\n    }\n\n    const state = await daoContractInstance.methods.state().call();\n\n    return Number(state) === 0 ? DaoState.CREATION : DaoState.READY;\n  } catch (error) {\n    throw error;\n  }\n}\n","import {ContractAdapterNames} from '../types';\nimport {ContractsStateEntry} from '../../../store/contracts/types';\nimport {StoreState} from '../../../store/types';\n\nfunction getContractAddressOrThrow(\n  contract: ContractsStateEntry<any> | null\n): string {\n  try {\n    const address = contract?.contractAddress;\n\n    if (!address) {\n      throw new Error(`Contract address was not found in the store.`);\n    }\n\n    return address;\n  } catch (error) {\n    throw error;\n  }\n}\n\n/**\n * getAdapterAddressFromContracts\n *\n * Gets an adapter's address by its name (`type ContractAdapterNames`) from the Redux contracts state slice.\n *\n * @param {string} name\n * @param {StoreState['contracts']} contracts\n */\nexport function getAdapterAddressFromContracts(\n  name: ContractAdapterNames,\n  contracts: StoreState['contracts']\n): string {\n  try {\n    switch (name) {\n      case ContractAdapterNames.configuration:\n        return '';\n      case ContractAdapterNames.distribute:\n        return getContractAddressOrThrow(contracts.DistributeContract);\n      case ContractAdapterNames.financing:\n        return '';\n      case ContractAdapterNames.guildkick:\n        return '';\n      case ContractAdapterNames.kyc_onboarding:\n        return getContractAddressOrThrow(contracts.KycOnboardingContract);\n      case ContractAdapterNames.managing:\n        return getContractAddressOrThrow(contracts.ManagingContract);\n      case ContractAdapterNames.onboarding:\n        return getContractAddressOrThrow(contracts.OnboardingContract);\n      case ContractAdapterNames.ragequit:\n        return '';\n      case ContractAdapterNames.tribute:\n        return getContractAddressOrThrow(contracts.TributeContract);\n      case ContractAdapterNames.tribute_nft:\n        return getContractAddressOrThrow(contracts.TributeNFTContract);\n      case ContractAdapterNames.voting:\n        return getContractAddressOrThrow(contracts.VotingContract);\n      default:\n        throw new Error(`Contract address was not found in the store.`);\n    }\n  } catch (error) {\n    throw error;\n  }\n}\n","import {ContractsStateEntry} from '../../../store/contracts/types';\nimport {normalizeString} from '../../../util/helpers';\nimport {StoreState} from '../../../store/types';\n\n/**\n * getContractByAddress\n *\n * Gets a Contract from the Redux contracts state slice by its `contractAddress`, or throws an Error.\n * A use case for this would be when using ERC712 signing data `actionId` to get\n * the appropriate Contract for submitting on-chain transactions.\n *\n * @param {string} address\n * @param {StoreState['contracts']} contracts\n */\nexport function getContractByAddress(\n  address: string,\n  contracts: StoreState['contracts']\n): ContractsStateEntry<any> {\n  try {\n    const contract = Object.values(contracts).find(\n      (c) =>\n        c?.contractAddress &&\n        normalizeString(c.contractAddress) === normalizeString(address)\n    );\n\n    if (!contract) {\n      throw new Error(`Contract was not found in the store.`);\n    }\n\n    return contract;\n  } catch (error) {\n    throw error;\n  }\n}\n","import Web3 from 'web3';\n\nimport {ContractDAOConfigKeys} from '../types';\nimport {DaoRegistry} from '../../../abis/types/DaoRegistry';\n\nexport async function getDAOAddressConfigEntry(\n  daoContractInstance: DaoRegistry | undefined,\n  configKey: ContractDAOConfigKeys,\n  address?: string // additional argument to get concatenated hash used in some tribute contracts\n): Promise<string> {\n  try {\n    if (!daoContractInstance) {\n      throw new Error('No DaoRegistry contract instance provided.');\n    }\n\n    let configKeySha3 = Web3.utils.sha3(configKey);\n\n    if (address) {\n      const web3 = new Web3();\n\n      configKeySha3 = Web3.utils.sha3(\n        web3.eth.abi.encodeParameters(\n          ['address', 'bytes32'],\n          [address, Web3.utils.sha3(configKey)]\n        )\n      );\n    }\n\n    if (!configKeySha3) {\n      throw new Error('No sha3 config key was returned.');\n    }\n\n    return await daoContractInstance.methods\n      .getAddressConfiguration(configKeySha3)\n      .call();\n  } catch (error) {\n    throw error;\n  }\n}\n","import Web3 from 'web3';\n\nimport {ContractDAOConfigKeys} from '../types';\nimport {DaoRegistry} from '../../../abis/types/DaoRegistry';\n\nexport async function getDAOConfigEntry(\n  daoContractInstance: DaoRegistry | undefined,\n  configKey: ContractDAOConfigKeys,\n  address?: string // additional argument to get concatenated hash used in some tribute contracts\n): Promise<string> {\n  try {\n    if (!daoContractInstance) {\n      throw new Error('No DaoRegistry contract instance provided.');\n    }\n\n    let configKeySha3 = Web3.utils.sha3(configKey);\n\n    if (address) {\n      const web3 = new Web3();\n\n      configKeySha3 = Web3.utils.sha3(\n        web3.eth.abi.encodeParameters(\n          ['address', 'bytes32'],\n          [address, Web3.utils.sha3(configKey)]\n        )\n      );\n    }\n\n    if (!configKeySha3) {\n      throw new Error('No sha3 config key was returned.');\n    }\n\n    return await daoContractInstance.methods\n      .getConfiguration(configKeySha3)\n      .call();\n  } catch (error) {\n    throw error;\n  }\n}\n","import {AbiItem} from 'web3-utils/types';\nimport Web3 from 'web3';\n\nimport {IVoting} from '../../../abis/types/IVoting';\nimport {VotingAdapterName} from '../../adapters-extensions/enums';\n\nexport async function getVotingAdapterName(\n  address: string,\n  web3Instance: Web3\n): Promise<VotingAdapterName> {\n  try {\n    const {default: lazyIVotingABI} = await import(\n      '../../../abis/tribute-contracts/IVoting.json'\n    );\n\n    const votingAdapterName: string = await (\n      new web3Instance.eth.Contract(\n        lazyIVotingABI as AbiItem[],\n        address\n      ) as any as IVoting\n    ).methods\n      .getAdapterName()\n      .call();\n\n    return votingAdapterName as VotingAdapterName;\n  } catch (error) {\n    throw error;\n  }\n}\n","import {MemberFlag} from '../types';\nimport {ProposalFlag} from '../../proposals/types';\n\n/**\n * hasFlag\n *\n * A quicker alternative than calling `getProposalFlag` or `getMemberFlag` using `Multicall` for every possiblity.\n *\n * @todo Though this is faster, we may want to switch to using the contract and Multicall instead of re-creating the logic.\n *\n * @param flagToCheck\n * @param daoProposalFlag\n * @returns {boolean}\n *\n * @see `ProposalFlag` `DaoRegistry.sol`\n * @see `getFlag` `DaoHelper.sol`\n * @see `setFlag` `DaoHelper.sol`\n */\nexport function hasFlag(\n  flagToCheck: ProposalFlag | MemberFlag,\n  daoProposalFlag: number | string\n): boolean {\n  return flagToCheck === Math.log2(Number(daoProposalFlag) + 1) - 1;\n}\n","import {ESCROW_ADDRESS, GUILD_ADDRESS, TOTAL_ADDRESS} from '../../../config';\n\n/**\n * isNotReservedAddress\n *\n * Checks if a given address is reserved.\n *\n * @param address\n * @returns {boolean}\n *\n * @see `isNotReservedAddress` `DaoHelper.sol`\n */\nexport function isNotReservedAddress(address: string): boolean {\n  return (\n    address !== GUILD_ADDRESS &&\n    address !== TOTAL_ADDRESS &&\n    address !== ESCROW_ADDRESS\n  );\n}\n","import {BURN_ADDRESS} from '../../../util/constants';\n\n/**\n * isNotZeroAddress\n *\n * Checks if a given address is zeroed.\n *\n * @param address\n * @returns {boolean}\n *\n * @see `isNotZeroAddress` `DaoHelper.sol`\n */\nexport function isNotZeroAddress(address: string): boolean {\n  return address !== BURN_ADDRESS;\n}\n","import Web3 from 'web3';\nimport {AbiItem} from 'web3-utils/types';\n\nimport {BlockType} from '../../../abis/types/types';\nimport {MULTICALL_CONTRACT_ADDRESS} from '../../../config';\nimport {Multicall} from '../../../abis/types/Multicall';\n\nexport type MulticallTuple = [\n  contractAddress: string,\n  functionABI: AbiItem,\n  parameters: string[]\n];\n\nexport async function multicall<T = any[]>({\n  blockNumber = 'latest',\n  calls,\n  web3Instance,\n}: {\n  /**\n   * Defaults to `latest`\n   */\n  blockNumber?: BlockType;\n  calls: MulticallTuple[];\n  web3Instance: Web3;\n}): Promise<T> {\n  const {default: lazyMulticallABI} = await import(\n    '../../../abis/tribute-contracts/Multicall.json'\n  );\n\n  if (!MULTICALL_CONTRACT_ADDRESS) {\n    throw new Error('No Multicall address was found. Are you sure it is set?');\n  }\n\n  try {\n    const {methods: multicallMethods} = new web3Instance.eth.Contract(\n      lazyMulticallABI as AbiItem[],\n      MULTICALL_CONTRACT_ADDRESS\n    ) as any as Multicall;\n\n    const {returnData} = await multicallMethods\n      .aggregate(\n        calls.map(([address, abi, params]) => [\n          address.toLowerCase(),\n          web3Instance.eth.abi.encodeFunctionCall(abi, params),\n        ])\n      )\n      .call({}, blockNumber);\n\n    return returnData.map((hexString: string, i: number) => {\n      const outputsABIItem = calls[i][1].outputs || [];\n      const decodedOutputs = web3Instance.eth.abi.decodeParameters(\n        outputsABIItem,\n        hexString\n      );\n\n      // Output as single result\n      if (\n        decodedOutputs.__length__ === 1 &&\n        decodedOutputs['0'] !== undefined\n      ) {\n        return decodedOutputs['0'];\n      }\n\n      return web3Instance.eth.abi.decodeParameters(\n        outputsABIItem || [],\n        hexString\n      );\n    }) as any as T;\n  } catch (error) {\n    throw error;\n  }\n}\n","import {AbiItem} from 'web3-utils/types';\nimport namehash from '@ensdomains/eth-ens-namehash';\nimport Web3 from 'web3';\n\nimport {CHAINS, DEFAULT_CHAIN} from '../../../config';\nimport {ReverseRecords} from '../../../abis/types/ReverseRecords';\nimport ReverseRecordsABI from '../../../abis/external/ReverseRecords.json';\n\n/**\n * @see https://github.com/ensdomains/reverse-records#deployed-contract-address\n */\nexport const REVERSE_RECORDS_ADDRESS: Pick<\n  Record<typeof CHAINS[keyof typeof CHAINS], string>,\n  | typeof CHAINS.GOERLI\n  | typeof CHAINS.MAINNET\n  | typeof CHAINS.RINKEBY\n  | typeof CHAINS.ROPSTEN\n> = {\n  [CHAINS.GOERLI]: '0x333Fc8f550043f239a2CF79aEd5e9cF4A20Eb41e',\n  [CHAINS.MAINNET]: '0x3671aE578E63FdF66ad4F3E12CC0c0d71Ac7510C',\n  [CHAINS.RINKEBY]: '0x196eC7109e127A353B709a20da25052617295F6f',\n  [CHAINS.ROPSTEN]: '0x72c33B247e62d0f1927E8d325d0358b8f9971C68',\n};\n\n/**\n * ENS reverse resolution an ethereum address(es).\n * Forward resolution check is handled by the smart contract (see links).\n *\n * @param address `string | string[]`\n * @returns `string[]` The array returned will be the same length as the `addresses` argument.\n *   If the returned name is an empty `string`, or `namehash.normalize` check fails,\n *   the originally provided address `string` will be returned.\n *\n * @see https://docs.ens.domains/dapp-developer-guide/resolving-names#reverse-resolution\n * @see https://github.com/ensdomains/reverse-records\n * @see https://etherscan.io/address/0x3671aE578E63FdF66ad4F3E12CC0c0d71Ac7510C#code#F1#L39\n */\nexport async function reverseResolveENS(\n  addresses: string[],\n  web3Instance: Web3\n): Promise<string[]> {\n  const contractAddress = REVERSE_RECORDS_ADDRESS[DEFAULT_CHAIN];\n\n  if (!contractAddress || !addresses || !addresses.length) {\n    return addresses;\n  }\n\n  const contract = new web3Instance.eth.Contract(\n    ReverseRecordsABI as any as AbiItem[],\n    contractAddress\n  ) as any as ReverseRecords;\n\n  const names = await contract.methods.getNames(addresses).call();\n\n  /**\n   * Compare returned names match normalised names to prevent homograph attack\n   *\n   * @see https://github.com/ensdomains/reverse-records#usage-note\n   */\n  return names.map((n, i) =>\n    n !== '' && namehash.normalize(n) === n ? n : addresses[i]\n  );\n}\n","import {useState} from 'react';\n\nimport {MetaMaskRPCError} from '../../util/types';\nimport {normalizeString} from '../../util/helpers';\nimport FadeIn from './FadeIn';\n\ntype ErrorMessageWithDetailsProps = {\n  detailsProps?: React.DetailsHTMLAttributes<HTMLDetailsElement>;\n  error: Error | (() => React.ReactElement) | undefined;\n  renderText: (() => React.ReactElement) | string;\n};\n\nexport default function ErrorMessageWithDetails(\n  props: ErrorMessageWithDetailsProps\n) {\n  const {error, renderText} = props;\n\n  /**\n   * State\n   */\n\n  const [isExpanded, setIsExpanded] = useState<boolean>(false);\n\n  /**\n   * Variables\n   */\n\n  /**\n   * Some wallets will provide proper error codes. The `4001` is a \"user rejected transaction\".\n   *\n   * @link https://github.com/ethereum/EIPs/blob/master/EIPS/eip-1193.md#provider-errors\n   */\n  const isWalletRejectedRequest =\n    typeof error !== 'function' &&\n    ((error as MetaMaskRPCError)?.code === 4001 ||\n      /^(the )?user rejected (the )?request$/g.test(\n        normalizeString(error?.message || '')\n      ));\n\n  const textToDisplay: React.ReactNode =\n    typeof renderText === 'string' ? renderText : renderText();\n\n  const areErrorMessageAndTextStringSame: boolean =\n    typeof renderText === 'string' &&\n    typeof error !== 'function' &&\n    normalizeString(renderText) === normalizeString(error?.message || '')\n      ? true\n      : false;\n\n  /**\n   * Render\n   */\n\n  if (!error || isWalletRejectedRequest) return null;\n\n  return (\n    <FadeIn>\n      <div className=\"text-center\">\n        <p className=\"error-message\">{textToDisplay}</p>\n\n        {error && !areErrorMessageAndTextStringSame && (\n          <details {...props.detailsProps}>\n            <summary\n              aria-expanded={isExpanded}\n              className=\"error-message\"\n              onClick={() => setIsExpanded(!isExpanded)}\n              style={{cursor: 'pointer', outline: 'none'}}>\n              <small>Details</small>\n            </summary>\n\n            <p className=\"error-message\">\n              <small>\n                {typeof error === 'function' ? error() : error.message}\n              </small>\n            </p>\n          </details>\n        )}\n      </div>\n    </FadeIn>\n  );\n}\n","import {useState, useEffect, useRef} from 'react';\n\ntype UseAbortControllerReturn = {\n  abortController: AbortController | undefined;\n  isMountedRef: React.MutableRefObject<boolean>;\n};\n\n/**\n * useAbortController\n *\n * Provides an `AbortController` to cancel requests.\n * Also provides a helper `isMountedRef` to see if the React component has\n * been unmounted and therefore should not run any setting of state.\n */\nexport function useAbortController(): UseAbortControllerReturn {\n  /**\n   * State\n   */\n\n  const [abortController, setAbortController] = useState<AbortController>();\n\n  /**\n   * Refs\n   */\n\n  const isMountedRef = useRef<boolean>(false);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    isMountedRef.current = true;\n\n    !abortController && setAbortController(new AbortController());\n\n    return () => {\n      isMountedRef.current = false;\n\n      abortController && abortController.abort();\n    };\n  }, [abortController]);\n\n  return {\n    abortController,\n    isMountedRef,\n  };\n}\n","import {useReducer} from 'react';\n\ntype CounterState = {\n  count: number;\n};\n\ntype CounterAction = {\n  type: 'increment';\n};\n\ntype CounterReturn = [number, React.Dispatch<CounterAction>];\n\nconst initialState = {count: 0};\n\nfunction reducer(state: CounterState, action: CounterAction) {\n  switch (action.type) {\n    case 'increment':\n      return {count: state.count + 1};\n    default:\n      return state;\n  }\n}\n\n/**\n * useCounter\n *\n * A counter which is kept track of via a reducer.\n *\n * @note This is mainly to use inside a custom hook's callback resulting in a\n *  changed dependency for consumer's useEffect when a consumer higher up wants to trigger a \"re-run\"\n *  (i.e. re-fetch, refresh some data), similarly to dispatching a Redux action again to update the state.\n */\nexport function useCounter(): CounterReturn {\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  return [state.count, dispatch];\n}\n","import {AbiItem} from 'web3-utils/types';\nimport {useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport Web3 from 'web3';\n\nimport {AsyncStatus} from '../util/types';\nimport {ContractDAOConfigKeys} from '../components/web3/types';\nimport {multicall, MulticallTuple} from '../components/web3/helpers';\nimport {StoreState} from '../store/types';\nimport {useWeb3Modal} from '../components/web3/hooks';\n\ntype ConfigEntriesReturn = {\n  daoConfigurations: string[];\n  daoConfigurationsError: Error | undefined;\n  daoConfigurationsStatus: AsyncStatus;\n};\n\nconst INITIAL_CONFIG_ENTRIES: ConfigEntriesReturn['daoConfigurations'] = [];\n\n/**\n * useDaoConfigurations\n *\n * Pass in an array of plain text DAO configuration names to get\n * and the hook will return their values in an array, in the same order.\n *\n * @param configKeys\n * @returns `ConfigEntriesReturn`\n */\nexport function useDaoConfigurations(\n  /**\n   * The keys of any configuration settings to get from the DAO.\n   */\n  configKeys: ContractDAOConfigKeys[]\n): ConfigEntriesReturn {\n  /**\n   * Selectors\n   */\n\n  const daoRegistryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n\n  const daoRegistryABI = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.abi\n  );\n\n  /**\n   * State\n   */\n\n  const [daoConfigurations, setDaoConfigurations] = useState<\n    ConfigEntriesReturn['daoConfigurations']\n  >(INITIAL_CONFIG_ENTRIES);\n\n  const [daoConfigurationsStatus, setDaoConfigurationsStatus] = useState<\n    ConfigEntriesReturn['daoConfigurationsStatus']\n  >(AsyncStatus.STANDBY);\n\n  const [daoConfigurationsError, setDaoConfigurationsError] =\n    useState<ConfigEntriesReturn['daoConfigurationsError']>();\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  /**\n   * Variables\n   */\n\n  const getConfigurationABI = daoRegistryABI?.find(\n    (ai) => ai.name === 'getConfiguration'\n  );\n\n  /**\n   * Effects\n   */\n\n  // Handle getting the configurations\n  useEffect(() => {\n    if (!daoRegistryAddress || !getConfigurationABI || !web3Instance) {\n      return;\n    }\n\n    handleGetConfigurations({\n      abi: getConfigurationABI,\n      configKeys,\n      contractAddress: daoRegistryAddress,\n      web3Instance,\n    });\n  }, [configKeys, daoRegistryAddress, getConfigurationABI, web3Instance]);\n\n  /**\n   * Functions\n   */\n\n  async function handleGetConfigurations({\n    abi,\n    configKeys,\n    contractAddress,\n    web3Instance,\n  }: {\n    configKeys: ContractDAOConfigKeys[];\n    contractAddress: string;\n    abi: AbiItem;\n    web3Instance: Web3;\n  }) {\n    try {\n      const calls: MulticallTuple[] = configKeys.map((ck) => [\n        contractAddress,\n        abi,\n        [web3Instance.utils.sha3(ck) || ''],\n      ]);\n\n      setDaoConfigurationsError(undefined);\n      setDaoConfigurationsStatus(AsyncStatus.PENDING);\n\n      setDaoConfigurations(await multicall({calls, web3Instance}));\n\n      setDaoConfigurationsStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      const e = error as Error;\n\n      setDaoConfigurations(INITIAL_CONFIG_ENTRIES);\n      setDaoConfigurationsStatus(AsyncStatus.REJECTED);\n      setDaoConfigurationsError(e);\n    }\n  }\n\n  return {\n    daoConfigurations,\n    daoConfigurationsError,\n    daoConfigurationsStatus,\n  };\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useLazyQuery} from '@apollo/react-hooks';\nimport {useSelector} from 'react-redux';\nimport {toBN} from 'web3-utils';\n\nimport {AsyncStatus} from '../util/types';\nimport {StoreState} from '../store/types';\nimport {SubgraphNetworkStatus} from '../store/subgraphNetworkStatus/types';\nimport {GET_DAO} from '../gql';\nimport {GUILD_ADDRESS, TOTAL_ADDRESS, UNITS_ADDRESS} from '../config';\n\ntype UseDaoTotalUnitsReturn = {\n  totalUnits: number | undefined;\n  totalUnitsError: Error | undefined;\n  totalUnitsIssued: number | undefined;\n  totalUnitsStatus: AsyncStatus;\n};\n\n/**\n * useDaoTotalUnits\n *\n * Gets DAO (1) total units minted and (2) total units issued and outstanding\n * from subgraph with direct onchain fallback.\n *\n * @returns {UseDaoTotalUnitsReturn}\n */\nexport function useDaoTotalUnits(): UseDaoTotalUnitsReturn {\n  /**\n   * Selectors\n   */\n\n  const DaoRegistryContract = useSelector(\n    (state: StoreState) => state.contracts.DaoRegistryContract\n  );\n  const BankExtensionContract = useSelector(\n    (state: StoreState) => state.contracts.BankExtensionContract\n  );\n  const subgraphNetworkStatus = useSelector(\n    (state: StoreState) => state.subgraphNetworkStatus.status\n  );\n\n  /**\n   * GQL Query\n   */\n\n  const [getDaoFromSubgraphResult, {called, loading, data, error}] =\n    useLazyQuery(GET_DAO, {\n      variables: {\n        id: DaoRegistryContract?.contractAddress.toLowerCase(),\n      },\n    });\n\n  /**\n   * State\n   */\n\n  const [totalUnits, setTotalUnits] = useState<number>();\n  const [totalUnitsIssued, setTotalUnitsIssued] = useState<number>();\n  const [totalUnitsStatus, setTotalUnitsStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n  const [totalUnitsError, setTotalUnitsError] = useState<Error>();\n\n  /**\n   * Cached callbacks\n   */\n\n  const getTotalUnitsFromExtensionCached = useCallback(\n    getTotalUnitsFromExtension,\n    [BankExtensionContract]\n  );\n\n  const getTotalUnitsFromSubgraphCached = useCallback(\n    getTotalUnitsFromSubgraph,\n    [data, error, getTotalUnitsFromExtensionCached]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!called) {\n      getDaoFromSubgraphResult();\n    }\n  }, [called, getDaoFromSubgraphResult]);\n\n  useEffect(() => {\n    if (subgraphNetworkStatus === SubgraphNetworkStatus.OK) {\n      if (called && !loading && DaoRegistryContract?.contractAddress) {\n        getTotalUnitsFromSubgraphCached();\n      }\n    } else {\n      // If there is a subgraph network error fallback to fetching totalUnits\n      // directly from smart contract\n      getTotalUnitsFromExtensionCached();\n    }\n  }, [\n    DaoRegistryContract?.contractAddress,\n    called,\n    getTotalUnitsFromExtensionCached,\n    getTotalUnitsFromSubgraphCached,\n    loading,\n    subgraphNetworkStatus,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  function getTotalUnitsFromSubgraph() {\n    try {\n      setTotalUnitsStatus(AsyncStatus.PENDING);\n\n      if (data) {\n        // extract totalUnits from gql data\n        const {totalUnits, totalUnitsIssued} = data.tributeDaos[0] as Record<\n          string,\n          any\n        >;\n        setTotalUnits(Number(totalUnits));\n        setTotalUnitsIssued(Number(totalUnitsIssued));\n        setTotalUnitsStatus(AsyncStatus.FULFILLED);\n      } else {\n        if (error) {\n          throw new Error(`subgraph query error: ${error.message}`);\n        } else if (typeof data === 'undefined') {\n          // Additional case to catch `{\"errors\":{\"message\":\"No indexers found\n          // for subgraph deployment\"}}` which does not get returned as an error\n          // by the graph query call.\n          throw new Error('subgraph query error: data is undefined');\n        }\n      }\n    } catch (error) {\n      const {message} = error as Error;\n\n      // If there is a subgraph query error fallback to fetching totalUnits\n      // directly from smart contract\n      console.log(message);\n\n      getTotalUnitsFromExtensionCached();\n    }\n  }\n\n  async function getTotalUnitsFromExtension() {\n    if (!BankExtensionContract) {\n      return;\n    }\n\n    try {\n      setTotalUnitsStatus(AsyncStatus.PENDING);\n\n      // total units minted for the DAO\n      const totalUnitsToSet = await BankExtensionContract.instance.methods\n        .balanceOf(TOTAL_ADDRESS, UNITS_ADDRESS)\n        .call();\n      // balance of units owned by the guild bank\n      const balanceOfGuildUnits = await BankExtensionContract.instance.methods\n        .balanceOf(GUILD_ADDRESS, UNITS_ADDRESS)\n        .call();\n      // total units issued and outstanding (not owned by the guild bank)\n      const totalUnitsIssuedToSet = toBN(totalUnitsToSet).sub(\n        toBN(balanceOfGuildUnits)\n      );\n\n      setTotalUnits(Number(totalUnitsToSet));\n      setTotalUnitsIssued(Number(totalUnitsIssuedToSet));\n      setTotalUnitsStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      const e = error as Error;\n\n      console.log(e);\n      setTotalUnits(undefined);\n      setTotalUnitsIssued(undefined);\n      setTotalUnitsError(e);\n      setTotalUnitsStatus(AsyncStatus.REJECTED);\n    }\n  }\n\n  return {totalUnits, totalUnitsError, totalUnitsIssued, totalUnitsStatus};\n}\n","import {useEffect, useRef} from 'react';\n\ntype UseIsMountedReturn = {\n  isMountedRef: React.MutableRefObject<boolean>;\n};\n\n/**\n * useIsMounted\n *\n * A hook that returns a React Ref which tells if the component is mounted, or not.\n * This is helpful when needing to stop state updates in hooks with effects.\n */\nexport function useIsMounted(): UseIsMountedReturn {\n  /**\n   * Refs\n   */\n\n  const isMountedRef = useRef<boolean>(false);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    isMountedRef.current = true;\n\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n\n  return {\n    isMountedRef,\n  };\n}\n","import {useCallback, useState} from 'react';\nimport ReactModal from 'react-modal';\n\nimport {StoreState} from '../store/types';\nimport {truncateEthAddress} from '../util/helpers';\nimport {useSelector} from 'react-redux';\nimport {useWeb3Modal} from '../components/web3/hooks';\nimport FadeIn from '../components/common/FadeIn';\nimport TimesSVG from '../assets/svg/TimesSVG';\n\n/**\n * Props should be cached somehow to prevent a new object\n * making the hook re-render each time the parent re-renders,\n * causing a continuous loop.\n */\ntype UseMemberActionDisabledProps = {\n  /**\n   * Allows the active member check to be skipped.\n   * e.g. A tx does not require the account to be a member.\n   */\n  skipIsActiveMemberCheck?: boolean;\n};\n\ntype UseMemberActionDisabledReturn = {\n  disabledReason: string;\n  isDisabled: boolean;\n  openWhyDisabledModal: () => void;\n  setOtherDisabledReasons: (r: string[]) => void;\n  WhyDisabledModal: (p: WhyDisabledModalProps) => JSX.Element | null;\n};\n\ntype WhyDisabledModalProps = {\n  title?: string;\n};\n\nconst getDelegatedAddressMessage = (a: string) =>\n  `Your member address is delegated to ${truncateEthAddress(\n    a,\n    7\n  )}. You must use that address.`;\n\n/**\n * useMemberActionDisabled\n *\n * This component covers the most common cases for why a member action button should be disabled.\n * More reasons for disabling the button can be added via props using `setOtherDisabledReasons`.\n *\n * @param {ProposalActionWhyDisabledProps} props\n * @returns {UseMemberActionDisabledReturn}\n */\nexport function useMemberActionDisabled(\n  props?: UseMemberActionDisabledProps\n): UseMemberActionDisabledReturn {\n  const {skipIsActiveMemberCheck = false} = props || {};\n\n  /**\n   * State\n   */\n\n  const [otherDisabledReasons, setOtherDisabledReasons] = useState<string[]>(\n    []\n  );\n  const [shouldShowWhyModal, setShouldShowWhyModal] = useState<boolean>(false);\n\n  /**\n   * Selectors\n   */\n\n  const delegateAddress = useSelector(\n    (s: StoreState) => s.connectedMember?.delegateKey\n  );\n\n  const isAddressDelegated = useSelector(\n    (s: StoreState) => s.connectedMember?.isAddressDelegated\n  );\n\n  const isActiveMember = useSelector(\n    (s: StoreState) => s.connectedMember?.isActiveMember\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {connected} = useWeb3Modal();\n\n  /**\n   * Variables\n   */\n\n  // Get the first index of other reasons.\n  const otherReasonNext =\n    otherDisabledReasons && otherDisabledReasons.find((r) => r);\n  const disabledReason = getDisabledReason();\n  const isDisabled =\n    (disabledReason ? true : false) || (otherReasonNext ? true : false);\n  const canShowDisabledReason = isDisabled && disabledReason ? true : false;\n\n  /**\n   * Cached callbacks\n   */\n\n  const WhyDisabledModalCached = useCallback(WhyDisabledModal, [\n    canShowDisabledReason,\n    disabledReason,\n    shouldShowWhyModal,\n  ]);\n\n  const handleSetOtherDisabledReasonsCached = useCallback(\n    handleSetOtherDisabledReasons,\n    []\n  );\n\n  /**\n   * Functions\n   */\n\n  function handleSetOtherDisabledReasons(otherReasons: string[]) {\n    setOtherDisabledReasons(otherReasons.filter(Boolean));\n  }\n\n  function getDisabledReason() {\n    if (!connected) {\n      return 'Your wallet is not connected.';\n    }\n\n    if (!isActiveMember && !isAddressDelegated && !skipIsActiveMemberCheck) {\n      return 'Either you are not a member, or your membership is not active.';\n    }\n\n    if (delegateAddress && isAddressDelegated && !skipIsActiveMemberCheck) {\n      return getDelegatedAddressMessage(delegateAddress);\n    }\n\n    return otherReasonNext || '';\n  }\n\n  function handleOpenWhyDisabledModal() {\n    setShouldShowWhyModal(true);\n  }\n\n  function WhyDisabledModal(props: WhyDisabledModalProps): JSX.Element | null {\n    if (!canShowDisabledReason) return null;\n\n    const {title} = props;\n\n    return (\n      <ReactModal\n        ariaHideApp={false}\n        className=\"modal-container\"\n        isOpen={shouldShowWhyModal}\n        onRequestClose={() => {\n          setShouldShowWhyModal(false);\n        }}\n        overlayClassName=\"modal-overlay\"\n        role=\"dialog\"\n        style={{overlay: {zIndex: 1000}}}>\n        <FadeIn>\n          <div className=\"modal\">\n            <button\n              className=\"modal__close-button modal__close-button--icon\"\n              onClick={() => {\n                setShouldShowWhyModal(false);\n              }}>\n              <TimesSVG />\n            </button>\n            <div className=\"card\">\n              <h2 className=\"modal__title\">{title || 'Why disabled?'}</h2>\n              <p>{disabledReason}</p>\n            </div>\n          </div>\n        </FadeIn>\n      </ReactModal>\n    );\n  }\n\n  return {\n    disabledReason,\n    isDisabled,\n    openWhyDisabledModal: handleOpenWhyDisabledModal,\n    setOtherDisabledReasons: handleSetOtherDisabledReasonsCached,\n    WhyDisabledModal: WhyDisabledModalCached,\n  };\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport BigNumber from 'bignumber.js';\nimport Web3 from 'web3';\n\nimport {AsyncStatus} from '../util/types';\nimport {ENVIRONMENT, UNITS_ADDRESS} from '../config';\nimport {StoreState} from '../store/types';\nimport {useIsMounted} from './useIsMounted';\nimport {useWeb3Modal} from '../components/web3/hooks';\n\ntype UseMemberUnitsAtSnapshotReturn = {\n  /**\n   * Was the member to check a member of the DAO at the\n   * requested snapshot?\n   */\n  hasMembershipAtSnapshot: boolean;\n  /**\n   * Member units as a `string`.\n   * Convert to a `BigNumber`, if needed for calculation.\n   */\n  memberUnitsAtSnapshot: string | undefined;\n  memberUnitsAtSnapshotError: Error | undefined;\n  memberUnitsAtSnapshotStatus: AsyncStatus;\n};\n\nconst {STANDBY, PENDING, FULFILLED, REJECTED} = AsyncStatus;\n\nconst DEFAULT_POLL_INTERVAL_MS: number =\n  ENVIRONMENT === 'production' ? 15000 : 5000;\n\nconst DEFAULT_BLOCK_CHECK_OFFSET: number = 2;\n\n/**\n * In order for `getPriorAmount` to return without reverting,\n * we must be sending a block number from the past.\n *\n * We must poll to wait until the block is in the past.\n * We could poll `getPriorAmount` until it does not revert, but\n * doing this could hide other errors.\n *\n * @param number `blockToCompare`\n * @param Web3 `web3Instance`\n * @returns `boolean`\n * @see `getPriorAmount` in `tribute-contracts`\n */\nasync function pollUntilBlockInPast({\n  block,\n  blockOffset = DEFAULT_BLOCK_CHECK_OFFSET,\n  isMountedRef,\n  pollInterval = DEFAULT_POLL_INTERVAL_MS,\n  web3Instance,\n}: {\n  block: number;\n  blockOffset?: number;\n  isMountedRef?: React.MutableRefObject<boolean>;\n  pollInterval?: number;\n  web3Instance: Web3;\n}) {\n  return new Promise<boolean>(async (resolve, reject) => {\n    /**\n     * Uses a positive block offset to check if the difference between `block` provided\n     * and `currentBlock` is at least at or greater than the `blockOffset`.\n     *\n     * This is used to limit errors from `getPriorAmount` when the block is not in the past.\n     * If we set an offset, it helps to mitigate issues where the fetched block number\n     * and the `block.number in the contract are not yet aligned.\n     */\n    const blockOffsetCheck = (block: number, currentBlock: number): boolean => {\n      const blockDifference: number = currentBlock - block;\n\n      return blockDifference >= Math.abs(blockOffset);\n    };\n\n    // Check immediately\n    try {\n      if (blockOffsetCheck(block, await web3Instance.eth.getBlockNumber())) {\n        resolve(true);\n\n        return;\n      }\n    } catch (error) {\n      reject(error);\n\n      return;\n    }\n\n    // If the initial check did not succeed, begin to poll.\n    const intervalId = setInterval(async () => {\n      try {\n        if (!isMountedRef?.current) {\n          clearInterval(intervalId);\n\n          return;\n        }\n\n        if (blockOffsetCheck(block, await web3Instance.eth.getBlockNumber())) {\n          clearInterval(intervalId);\n          resolve(true);\n        }\n      } catch (error) {\n        clearInterval(intervalId);\n        reject(error);\n      }\n    }, pollInterval);\n  });\n}\n\nexport function useMemberUnitsAtSnapshot(\n  memberAddress: string | undefined,\n  snapshot: number | undefined,\n  options?: {\n    blockCheckOffset?: number;\n    currentBlockPollIntervalMs?: number;\n  }\n): UseMemberUnitsAtSnapshotReturn {\n  const {blockCheckOffset, currentBlockPollIntervalMs} = options || {};\n\n  /**\n   * Selectors\n   */\n\n  const bankExtensionMethods = useSelector(\n    (s: StoreState) => s.contracts.BankExtensionContract?.instance.methods\n  );\n\n  /**\n   * State\n   */\n\n  const [memberUnitsAtSnapshot, setMemberUnitsAtSnapshot] = useState<string>();\n\n  const [hasMembershipAtSnapshot, setHasMembershipAtSnapshot] =\n    useState<boolean>(false);\n\n  const [memberUnitsAtSnapshotError, setMemberUnitsAtSnapshotError] =\n    useState<Error>();\n\n  const [memberUnitsAtSnapshotStatus, setMemberUnitsAtSnapshotStatus] =\n    useState<AsyncStatus>(STANDBY);\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n  const {isMountedRef} = useIsMounted();\n\n  /**\n   * Cached Callbacks\n   */\n\n  const handleGetPriorUnitsAmountCached = useCallback(\n    handleGetPriorUnitsAmount,\n    [isMountedRef]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    // These parameters may be arriving async and not ready, yet.\n    if (!memberAddress || !snapshot || !bankExtensionMethods || !web3Instance) {\n      return;\n    }\n\n    handleGetPriorUnitsAmountCached({\n      bankExtensionMethods,\n      blockCheckOffset,\n      currentBlockPollIntervalMs,\n      memberAddress,\n      snapshot,\n      web3Instance,\n    });\n  }, [\n    bankExtensionMethods,\n    blockCheckOffset,\n    currentBlockPollIntervalMs,\n    handleGetPriorUnitsAmountCached,\n    memberAddress,\n    snapshot,\n    web3Instance,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  async function handleGetPriorUnitsAmount({\n    bankExtensionMethods,\n    blockCheckOffset,\n    currentBlockPollIntervalMs,\n    memberAddress,\n    snapshot,\n    web3Instance,\n  }: {\n    bankExtensionMethods: any;\n    blockCheckOffset?: number;\n    currentBlockPollIntervalMs?: number;\n    memberAddress: string;\n    snapshot: number;\n    web3Instance: Web3;\n  }): Promise<void> {\n    try {\n      // Reset any error\n      setMemberUnitsAtSnapshotError(undefined);\n      setMemberUnitsAtSnapshotStatus(PENDING);\n\n      /**\n       * Poll until we are at a block in the past.\n       *\n       * For example, in governance votes, this can be an issue for anyone trying\n       * to vote in the same block as the proposal's snapshot,\n       * as `getPriorAmount` will revert if `blockToCheck >= block.number`.\n       *\n       * This is not an issue with on-chain proposals.\n       */\n      await pollUntilBlockInPast({\n        block: snapshot,\n        blockOffset: blockCheckOffset,\n        isMountedRef,\n        pollInterval: currentBlockPollIntervalMs,\n        web3Instance,\n      });\n\n      const memberUnitsAtSnapshot: string = await bankExtensionMethods\n        .getPriorAmount(memberAddress, UNITS_ADDRESS, snapshot)\n        .call();\n\n      if (!isMountedRef.current) return;\n\n      setMemberUnitsAtSnapshot(memberUnitsAtSnapshot);\n\n      setHasMembershipAtSnapshot(\n        new BigNumber(memberUnitsAtSnapshot).isGreaterThan(new BigNumber(0))\n      );\n\n      setMemberUnitsAtSnapshotStatus(FULFILLED);\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      const e = error as Error;\n\n      setHasMembershipAtSnapshot(false);\n      setMemberUnitsAtSnapshot(undefined);\n      setMemberUnitsAtSnapshotError(e);\n      setMemberUnitsAtSnapshotStatus(REJECTED);\n    }\n  }\n\n  return {\n    hasMembershipAtSnapshot,\n    memberUnitsAtSnapshot,\n    memberUnitsAtSnapshotError,\n    memberUnitsAtSnapshotStatus,\n  };\n}\n","import {useEffect, useRef, useState} from 'react';\n\nimport {AsyncStatus} from '../util/types';\n\ntype UseTimeStartEndReturn = {\n  hasTimeEnded: boolean;\n  hasTimeStarted: boolean;\n  /**\n   * Informs if the initial async checks have run.\n   * This helps to tame UI false-positives that can arise when\n   * using only booleans to check status.\n   */\n  timeStartEndInitReady: boolean;\n};\n\ntype StartEndStatus = {start: AsyncStatus; end: AsyncStatus};\n\nconst {FULFILLED, PENDING, STANDBY} = AsyncStatus;\n\nfunction areAllAsyncReady(asyncMapping: Record<string, AsyncStatus>) {\n  return Object.values(asyncMapping).every((s) => s === FULFILLED);\n}\n\n/**\n * Provides `boolean` results when time starts and ends.\n *\n * If either `startSeconds` or `endSeconds` are `undefined`, or `<= 0`\n * the checks will never run; only `timeStartEndInitReady` will ever be `true`.\n *\n * @param startSeconds\n * @param endSeconds\n * @returns `UseTimeStartEndReturn`\n */\nexport function useTimeStartEnd(\n  startSeconds: number | undefined,\n  endSeconds: number | undefined\n): UseTimeStartEndReturn {\n  /**\n   * Refs\n   */\n\n  const startEndStatusRef = useRef<StartEndStatus>({\n    start: STANDBY,\n    end: STANDBY,\n  });\n\n  /**\n   * State\n   */\n\n  const [hasTimeStarted, setHasTimeStarted] = useState<boolean>(false);\n  const [hasTimeEnded, setHasTimeEnded] = useState<boolean>(false);\n\n  const [timeStartEndInitReady, setTimeStartEndInitReady] = useState<boolean>(\n    areAllAsyncReady(startEndStatusRef.current)\n  );\n\n  /**\n   * Variables\n   */\n\n  const shouldNotCheck: boolean =\n    startSeconds === undefined ||\n    endSeconds === undefined ||\n    startSeconds <= 0 ||\n    endSeconds <= 0;\n\n  /**\n   * Effects\n   */\n\n  // Actively check if time has started\n  useEffect(() => {\n    if (hasTimeStarted || shouldNotCheck) {\n      setTimeStartEndInitReady(() => {\n        startEndStatusRef.current.start = FULFILLED;\n        return areAllAsyncReady(startEndStatusRef.current);\n      });\n\n      return;\n    }\n\n    setTimeStartEndInitReady(() => {\n      startEndStatusRef.current.start = PENDING;\n      return areAllAsyncReady(startEndStatusRef.current);\n    });\n\n    // Check if time has started every 1 second\n    const intervalID = setInterval(() => {\n      const hasStartedCheck: boolean =\n        Math.floor(Date.now() / 1000) > (startSeconds ?? 0);\n\n      setHasTimeStarted(hasStartedCheck);\n\n      // The interval async process has run once\n      if (startEndStatusRef.current.start !== FULFILLED) {\n        setTimeStartEndInitReady(() => {\n          startEndStatusRef.current.start = FULFILLED;\n          return areAllAsyncReady(startEndStatusRef.current);\n        });\n      }\n    }, 1000);\n\n    return function cleanup() {\n      if (intervalID) {\n        clearInterval(intervalID);\n      }\n    };\n  }, [hasTimeStarted, shouldNotCheck, startSeconds]);\n\n  // Actively check if time has ended\n  useEffect(() => {\n    if (hasTimeEnded || shouldNotCheck) {\n      setTimeStartEndInitReady(() => {\n        startEndStatusRef.current.end = FULFILLED;\n        return areAllAsyncReady(startEndStatusRef.current);\n      });\n\n      return;\n    }\n\n    setTimeStartEndInitReady(() => {\n      startEndStatusRef.current.end = PENDING;\n      return areAllAsyncReady(startEndStatusRef.current);\n    });\n\n    // Check if time has ended every 1 second\n    const intervalID = setInterval(() => {\n      const hasEndedCheck: boolean =\n        Math.ceil(Date.now() / 1000) > (endSeconds ?? 0);\n\n      setHasTimeEnded(hasEndedCheck);\n\n      // The interval async process has run once\n      if (startEndStatusRef.current.end !== FULFILLED) {\n        setTimeStartEndInitReady(() => {\n          startEndStatusRef.current.end = FULFILLED;\n          return areAllAsyncReady(startEndStatusRef.current);\n        });\n      }\n    }, 1000);\n\n    return function cleanup() {\n      if (intervalID) {\n        clearInterval(intervalID);\n      }\n    };\n  }, [endSeconds, hasTimeEnded, shouldNotCheck]);\n\n  return {\n    hasTimeStarted,\n    hasTimeEnded,\n    timeStartEndInitReady,\n  };\n}\n","/**\n * FOR HIGH REUSE ENUMS\n *\n * For any other more specific enum types, co-locate them in either:\n *\n * 1) The actual code file.\n * 2) In a type file in the location of the code files which mainly use the types.\n *\n * @see https://kentcdodds.com/blog/colocation\n */\n\n/**\n * @see https://chainid.network/\n */\nexport enum NetworkIDs {\n  GOERLI = 5,\n  KOVAN = 42,\n  RINKEBY = 4,\n  ROPSTEN = 3,\n  MAINNET = 1,\n}\n\n/**\n * @see https://chainid.network/\n */\nexport enum NetworkNames {\n  GOERLI = 'goerli',\n  KOVAN = 'kovan',\n  RINKEBY = 'rinkeby',\n  ROPSTEN = 'ropsten',\n  MAINNET = 'mainnet',\n}\n\nexport enum FormFieldErrors {\n  REQUIRED = 'This field is required.',\n  INVALID_BYTES32 = 'The value is not a bytes32.',\n  INVALID_BYTES32_ARRAY = 'The value is not a comma-separated bytes32 format, ie. 0x...,0x...',\n  INVALID_EMAIL = 'The email address is invalid.',\n  INVALID_ETHEREUM_ADDRESS = 'The ethereum address is invalid.',\n  INVALID_NUMBER = 'The value is not a number.',\n  INVALID_NUMBER_ARRAY = 'The value is not a comma-separated number format, ie. 42,5,124',\n}\n\nexport enum ProposalHeaderNames {\n  FAILED = 'Failed',\n  PASSED = 'Passed',\n  REQUESTS = 'Proposals',\n  VOTING = 'Voting',\n}\n","/**\n * Constants as defined in the solidity DaoHelper.sol contract and the available\n * adapters as detailed here: https://github.com/openlawteam/tribute-contracts\n */\nexport enum DaoAdapterConstants {\n  BANK = 'bank',\n  CONFIGURATION = 'configuration',\n  COUPON_ONBOARDING = 'coupon-onboarding',\n  DAO_REGISTRY = 'daoRegistry',\n  DISTRIBUTE = 'distribute',\n  EXECUTION = 'execution',\n  FINANCING = 'financing',\n  GUILDKICK = 'guildkick',\n  KYC_ONBOARDING = 'kyc-onboarding',\n  MANAGING = 'managing',\n  NFT = 'nft',\n  NONVOTING_ONBOARDING = 'nonvoting-onboarding',\n  OFFCHAINVOTING = 'offchainvoting',\n  ONBOARDING = 'onboarding',\n  RAGEQUIT = 'ragequit',\n  TRIBUTE = 'tribute',\n  TRIBUTE_NFT = 'tribute-nft',\n  VOTING = 'voting',\n}\n\nexport enum DaoExtensionConstants {\n  BANK = 'bank',\n  ERC20 = 'erc20-ext',\n  NFT = 'nft',\n}\n\n/**\n * Voting adapter names as defined in the solidity voting adapter contracts\n * i.e. `string public constant ADAPTER_NAME = \"VotingContract\"`.\n *\n * @link https://github.com/openlawteam/tribute-contracts/blob/master/contracts/adapters/voting\n */\nexport enum VotingAdapterName {\n  OffchainVotingContract = 'OffchainVotingContract',\n  VotingContract = 'VotingContract',\n}\n","import {\n  SnapshotDraftData,\n  SnapshotProposalData,\n  SnapshotDraftResponseData,\n  SnapshotProposalResponseData,\n  SnapshotType,\n  VoteChoices,\n} from '@openlaw/snapshot-js-erc712';\nimport {AbiItem} from 'web3-utils/types';\nimport {Contract} from 'web3-eth-contract/types';\n\nimport {ContractAdapterNames} from '../web3/types';\nimport {VotingAdapterName} from '../adapters-extensions/enums';\nimport {VotingState} from './voting/types';\n\n/**\n * ENUMS\n */\n\n/**\n * Mapping of DaoRegistry proposal flags.\n * This should match the enum (including order) in the `DaoRegistry`. If it does not match,\n * the results of checking the proposal's state via flag will be wrong.\n *\n * @see `ProposalFlag` `DaoRegistry.sol`\n * @see `getFlag` `DaoHelper.sol`\n * @see `setFlag` `DaoHelper.sol`\n */\nexport enum ProposalFlag {\n  EXISTS,\n  SPONSORED,\n  PROCESSED,\n}\n\n// @todo Need more information about the vote challenge flow.\nexport enum ProposalFlowStatus {\n  Submit = 'Submit',\n  Sponsor = 'Sponsor',\n  OffchainVoting = 'OffchainVoting',\n  OffchainVotingSubmitResult = 'OffchainVotingSubmitResult',\n  OffchainVotingGracePeriod = 'OffchainVotingGracePeriod',\n  OnchainVoting = 'OnchainVoting',\n  Process = 'Process',\n  Completed = 'Completed',\n}\n\n/**\n * @see `Distribute.sol` in tribute-contracts\n */\nexport enum DistributionStatus {\n  NOT_STARTED,\n  IN_PROGRESS,\n  DONE,\n  FAILED,\n}\n\n/**\n * This is an internal type we use for sending to Snapshot Hub via\n * `metadata: {}` to indicate the proposal is only meant for xyz.\n *\n * @note Only set the `metadata.type` in the case where the proposal's usage\n * cannot be determined by the `actionId` (adapter address) alone.\n */\nexport enum SnapshotMetadataType {\n  Governance = 'Governance',\n}\n\n/**\n * TYPES\n */\n\nexport type Proposal = {\n  adapterAddress: string;\n  flags: string; // unint256 of Proposal's current flag\n};\n\n// Arguments for an optional render prop for `<ProposalActions />` and its child action wrapping components.\nexport type RenderActionPropArguments = {\n  [VotingAdapterName.OffchainVotingContract]: {\n    adapterName: ContractAdapterNames;\n    // An enum name (`string`) of the DAO proposal's `VotingState` index\n    daoProposalVoteResult: typeof VotingState[any] | undefined;\n    daoProposalVote: OffchainVotingAdapterVote | undefined;\n    gracePeriodStartMs: number | undefined;\n    gracePeriodEndMs: number | undefined;\n    proposal: ProposalData;\n    status: ProposalFlowStatus | undefined;\n  };\n};\n\n// @todo Change the type to be precise\nexport type SubgraphProposal = Record<string, any>;\n\n/**\n * We augment the response data to add a few helpful data pieces.\n */\nexport type SnapshotDraft = {\n  /**\n   * The ID used to reference the DAO.\n   */\n  idInDAO: string;\n  /**\n   * An ID helper to reference the Draft hash\n   */\n  idInSnapshot: string;\n} & SnapshotDraftResponseData;\n\n/**\n * We augment the response data to add a few helpful data pieces.\n */\nexport type SnapshotProposal = {\n  /**\n   * The ID used to reference the DAO.\n   */\n  idInDAO: string;\n  /**\n   * An ID helper to reference the Proposal hash\n   */\n  idInSnapshot: string;\n} & SnapshotProposalResponseData;\n\n/**\n * Common data shared between a Snapshot Drafts and Proposals.\n * Helpful when we need to display information which is accessible on both.\n */\nexport type SnapshotProposalCommon = SnapshotDraft | SnapshotProposal;\n\nexport type ProposalData = {\n  // @todo Make non-nullable?\n  idInDAO?: string;\n  // @todo Make non-nullable?\n  daoProposalVotingAdapter?: ProposalVotingAdapterData;\n  // @todo Make non-nullable?\n  daoProposalVote?: ProposalVotesData;\n  // @todo Make non-nullable?\n  daoProposalVotingState?: VotingState;\n  daoProposal: Proposal | undefined;\n  /**\n   * Data for either a Draft or Proposal which is shared between the two types.\n   */\n  getCommonSnapshotProposalData: () => SnapshotProposalCommon | undefined;\n  refetchProposalOrDraft: () => void;\n  snapshotDraft: SnapshotDraft | undefined;\n  snapshotProposal: SnapshotProposal | undefined;\n  snapshotType: ProposalOrDraftSnapshotType | undefined;\n};\n\n/**\n * A conditional helper type for determining which data shape to use.\n *\n * @link https://www.typescriptlang.org/docs/handbook/2/conditional-types.html\n */\nexport type ProposalOrDraftSnapshotData =\n  | SnapshotDraftResponseData\n  | SnapshotProposalResponseData;\n\nexport type ProposalOrDraftSnapshotType =\n  | SnapshotType.proposal\n  | SnapshotType.draft;\n\n/**\n * A conditional helper type for determining which data shape to use based on the `ProposalOrDraftSnapshotType`.\n *\n * @link https://www.typescriptlang.org/docs/handbook/2/conditional-types.html\n */\nexport type ProposalOrDraftSignDataFromType<\n  T extends ProposalOrDraftSnapshotType\n> = T extends SnapshotType.proposal ? SnapshotProposalData : SnapshotDraftData;\n\n/**\n * Voting.sol->Voting\n *\n * @link https://github.com/openlawteam/tribute-contracts/blob/master/contracts/adapters/voting/Voting.sol\n */\nexport type VotingAdapterVotes = {\n  blockNumber: string;\n  nbNo: string;\n  nbYes: string;\n  startingTime: string;\n};\n\n/**\n * OffchainVoting.sol->Voting\n *\n * @link https://github.com/openlawteam/tribute-contracts/blob/master/contracts/adapters/voting/OffchainVoting.sol\n */\nexport type OffchainVotingAdapterVote = {\n  fallbackVotesCount: string;\n  forceFailed: boolean;\n  gracePeriodStartingTime: string;\n  isChallenged: boolean;\n  nbNo: string;\n  nbYes: string;\n  reporter: string;\n  resultRoot: string;\n  snapshot: string;\n  startingTime: string;\n  stepRequested: string;\n};\n\n/**\n * VotingResult\n *\n * A custom result we build to deliver to components.\n * It should accommodate all types of yes/no voting (i.e. on-chain, off-chain).\n */\n\nexport type VoteChoiceResult = {\n  percentage: number;\n  units: number;\n};\n\nexport type VotingResult = {\n  [VoteChoices.Yes]: VoteChoiceResult;\n  [VoteChoices.No]: VoteChoiceResult;\n  totalUnits: number;\n};\n\n/**\n * Proposal's voting adapter data\n */\nexport type ProposalVotingAdapterData = {\n  votingAdapterName: VotingAdapterName;\n  votingAdapterAddress: string;\n  /**\n   * Get the ABI for the proposal.\n   * The object is not included inline to\n   * save from repetitive data (some ABIs can be large).\n   */\n  getVotingAdapterABI: () => AbiItem[];\n  // Helper to use the Web3 Contract directly\n  getWeb3VotingAdapterContract: <T = Contract>() => T;\n};\n\nexport type ProposalVotingAdapterTuple = [\n  proposalId: string,\n  votingAdapterData: ProposalVotingAdapterData\n];\n\n/**\n * Proposal on-chain votes data\n *\n * @see `useProposalsVotes`\n */\nexport type ProposalVotesData = {\n  [VotingAdapterName.OffchainVotingContract]?: OffchainVotingAdapterVote;\n  [VotingAdapterName.VotingContract]?: VotingAdapterVotes;\n};\n","import {useSelector} from 'react-redux';\nimport {useState, useEffect, useCallback} from 'react';\nimport usePreviousDistinct from 'react-use/lib/usePreviousDistinct';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {\n  isNotReservedAddress,\n  isNotZeroAddress,\n} from '../../../components/web3/helpers';\nimport {normalizeString, truncateEthAddress} from '../../../util/helpers';\nimport {StoreState} from '../../../store/types';\nimport {useWeb3Modal} from '../../../components/web3/hooks';\n\ntype UseCheckApplicantReturn = {\n  checkApplicantError: Error | undefined;\n  checkApplicantInvalidMsg: string | undefined;\n  checkApplicantStatus: AsyncStatus;\n  isApplicantValid: boolean | undefined;\n};\n\n/**\n * useCheckApplicant\n *\n * Checks if the provided applicant address is valid to become a potential new member.\n *\n * @export\n * @param {string} [address]\n * @returns {UseCheckApplicantReturn}\n */\nexport function useCheckApplicant(address?: string): UseCheckApplicantReturn {\n  /**\n   * Selectors\n   */\n\n  const daoRegistryInstance = useSelector(\n    (state: StoreState) => state.contracts.DaoRegistryContract?.instance\n  );\n\n  /**\n   * State\n   */\n\n  const [checkApplicantError, setCheckApplicantError] = useState<Error>();\n\n  const [checkApplicantInvalidMsg, setCheckApplicantInvalidMsg] =\n    useState<string>();\n\n  const [checkApplicantStatus, setCheckApplicantStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n\n  const [isApplicantValid, setIsApplicantValid] = useState<boolean>();\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  /**\n   * Their hooks\n   */\n\n  const prevAddress = usePreviousDistinct(address);\n\n  /**\n   * Cached callbacks\n   */\n\n  const checkApplicantValidityCached = useCallback(checkApplicantValidity, [\n    address,\n    daoRegistryInstance,\n    web3Instance,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    // Reset state if no address is detected\n    if (prevAddress && !address) {\n      setCheckApplicantError(undefined);\n      setCheckApplicantInvalidMsg(undefined);\n      setIsApplicantValid(undefined);\n      setCheckApplicantStatus(AsyncStatus.STANDBY);\n    }\n\n    if (address) {\n      checkApplicantValidityCached();\n    }\n  }, [address, checkApplicantValidityCached, prevAddress]);\n\n  /**\n   * Functions\n   */\n\n  async function checkApplicantValidity() {\n    if (!address || !daoRegistryInstance || !web3Instance) return;\n\n    try {\n      setCheckApplicantStatus(AsyncStatus.PENDING);\n\n      const truncatedAddress = truncateEthAddress(address, 7);\n\n      const getAddressIfDelegatedResult = await daoRegistryInstance.methods\n        .getAddressIfDelegated(address)\n        .call();\n\n      if (!isNotReservedAddress(address)) {\n        // Applicant address cannot be a reserved address.\n        setIsApplicantValid(false);\n        setCheckApplicantInvalidMsg(\n          `The applicant address ${truncatedAddress} is invalid because it is a DAO reserved address.`\n        );\n      } else if (!isNotZeroAddress(address)) {\n        // Applicant address cannot be 0x0 address.\n        setIsApplicantValid(false);\n        setCheckApplicantInvalidMsg(\n          `The applicant address ${truncatedAddress} is invalid.`\n        );\n      } else if (\n        normalizeString(address) !==\n        normalizeString(getAddressIfDelegatedResult)\n      ) {\n        // Applicant address cannot already be in use as a delegate key.\n        setIsApplicantValid(false);\n        setCheckApplicantInvalidMsg(\n          `The applicant address ${truncatedAddress} is already in use as a delegate key. The address must be removed as a delegate before it can become a member.`\n        );\n      } else {\n        setIsApplicantValid(true);\n        setCheckApplicantInvalidMsg(undefined);\n      }\n\n      setCheckApplicantStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      const e = error as Error;\n\n      setIsApplicantValid(undefined);\n      setCheckApplicantInvalidMsg(undefined);\n      setCheckApplicantError(e);\n      setCheckApplicantStatus(AsyncStatus.REJECTED);\n    }\n  }\n\n  return {\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n  };\n}\n","import {useEffect, useState, useCallback} from 'react';\nimport {useSelector} from 'react-redux';\nimport {useQuery} from 'react-query';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {multicall, MulticallTuple} from '../../web3/helpers';\nimport {Proposal} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useWeb3Modal} from '../../web3/hooks';\n\ntype DaoProposalEntries = [proposalId: string, proposal: Proposal][];\n\ntype UseDaoProposalsReturn = {\n  daoProposals: DaoProposalEntries;\n  daoProposalsStatus: AsyncStatus;\n  daoProposalsError: Error | undefined;\n};\n\nconst INITIAL_DAO_PROPOSAL_ENTRIES: DaoProposalEntries = [];\n\n/**\n * useDaoProposals\n *\n * Gets `proposals` by their id from the DAO via `multicall`.\n *\n * @param proposalIds\n * @returns `UseDaoProposalsReturn`\n */\nexport function useDaoProposals(proposalIds: string[]): UseDaoProposalsReturn {\n  /**\n   * Selectors\n   */\n\n  const proposalsAbi = useSelector((s: StoreState) =>\n    s.contracts.DaoRegistryContract?.abi.find((a) => a.name === 'proposals')\n  );\n\n  const registryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n\n  /**\n   * State\n   */\n\n  const [daoProposals, setDaoProposals] = useState<DaoProposalEntries>(\n    INITIAL_DAO_PROPOSAL_ENTRIES\n  );\n\n  const [daoProposalsStatus, setDaoProposalsStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n\n  const [daoProposalsError, setDaoProposalsError] = useState<Error>();\n\n  const [safeProposalIds, setSafeProposalIds] = useState<string[]>();\n\n  const [daoProposalsCalls, setDaoProposalsCalls] =\n    useState<MulticallTuple[]>();\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  /**\n   * React Query\n   */\n\n  const {data: daoProposalsData, error: daoProposalsQueryError} = useQuery(\n    ['daoProposals', daoProposalsCalls],\n    async () => {\n      if (!daoProposalsCalls?.length || !web3Instance) {\n        return;\n      }\n\n      return await multicall({\n        calls: daoProposalsCalls,\n        web3Instance,\n      });\n    },\n    {enabled: !!daoProposalsCalls?.length && !!web3Instance}\n  );\n\n  /**\n   * Cached callbacks\n   */\n\n  const handleGetDaoProposalsCached = useCallback(handleGetDaoProposals, [\n    daoProposalsData,\n    daoProposalsQueryError,\n    safeProposalIds,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (\n      !proposalIds.length ||\n      !safeProposalIds ||\n      !proposalsAbi ||\n      !registryAddress ||\n      !web3Instance\n    ) {\n      return;\n    }\n\n    handleGetDaoProposalsCached();\n  }, [\n    handleGetDaoProposalsCached,\n    proposalIds.length,\n    proposalsAbi,\n    registryAddress,\n    safeProposalIds,\n    web3Instance,\n  ]);\n\n  useEffect(() => {\n    if (!proposalIds.length || !web3Instance) {\n      return;\n    }\n\n    // Only use hex (more specifically `bytes32`) id's\n    const safeProposalIdsToSet = proposalIds.filter(\n      web3Instance.utils.isHexStrict\n    );\n\n    setSafeProposalIds(safeProposalIdsToSet);\n  }, [proposalIds, web3Instance]);\n\n  useEffect(() => {\n    if (!proposalsAbi || !registryAddress || !safeProposalIds?.length) return;\n\n    const daoProposalsCallsToSet: MulticallTuple[] = safeProposalIds.map(\n      (id) => [registryAddress, proposalsAbi, [id]]\n    );\n\n    setDaoProposalsCalls(daoProposalsCallsToSet);\n  }, [proposalsAbi, registryAddress, safeProposalIds]);\n\n  /**\n   * Functions\n   */\n\n  async function handleGetDaoProposals() {\n    try {\n      if (!safeProposalIds) return;\n\n      if (!safeProposalIds.length) {\n        setDaoProposalsStatus(AsyncStatus.FULFILLED);\n        setDaoProposals([]);\n\n        return;\n      }\n\n      setDaoProposalsStatus(AsyncStatus.PENDING);\n      // Reset error\n      setDaoProposalsError(undefined);\n\n      if (daoProposalsQueryError) {\n        throw daoProposalsQueryError;\n      }\n\n      if (daoProposalsData) {\n        setDaoProposals(\n          safeProposalIds.map((id, i) => [id, daoProposalsData[i]])\n        );\n        setDaoProposalsStatus(AsyncStatus.FULFILLED);\n      }\n    } catch (error) {\n      const e = error as Error;\n\n      setDaoProposals(INITIAL_DAO_PROPOSAL_ENTRIES);\n      setDaoProposalsError(e);\n      setDaoProposalsStatus(AsyncStatus.REJECTED);\n    }\n  }\n\n  return {\n    daoProposals,\n    daoProposalsStatus,\n    daoProposalsError,\n  };\n}\n","import {AbiItem, toBN} from 'web3-utils';\nimport {useCallback, useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {VoteChoicesIndex} from '@openlaw/snapshot-js-erc712';\nimport Web3 from 'web3';\nimport {useQuery} from 'react-query';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {multicall, MulticallTuple} from '../../web3/helpers';\nimport {SnapshotProposal, VotingResult} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {UNITS_ADDRESS, TOTAL_ADDRESS, GUILD_ADDRESS} from '../../../config';\nimport {useIsMounted} from '../../../hooks';\nimport {useWeb3Modal} from '../../web3/hooks';\nimport {VoteChoices} from '../../web3/types';\n\ntype OffchainVotingResultEntries = [\n  proposalHash: string,\n  votingResult: VotingResult\n][];\n\ntype UseOffchainVotingResultsReturn = {\n  offchainVotingResults: OffchainVotingResultEntries;\n  offchainVotingResultsError: Error | undefined;\n  offchainVotingResultsStatus: AsyncStatus;\n};\n\n/**\n * @todo Polling\n */\nexport function useOffchainVotingResults(\n  /**\n   * Accepts a single `SnapshotProposal` or `SnapshotProposal[]`\n   */\n  proposals: (SnapshotProposal | undefined) | (SnapshotProposal | undefined)[]\n): UseOffchainVotingResultsReturn {\n  /**\n   * Selectors\n   */\n\n  const bankABI = useSelector(\n    (s: StoreState) => s.contracts.BankExtensionContract?.abi\n  );\n  const bankAddress = useSelector(\n    (s: StoreState) => s.contracts.BankExtensionContract?.contractAddress\n  );\n\n  /**\n   * State\n   */\n\n  const [votingResults, setVotingResults] =\n    useState<OffchainVotingResultEntries>([]);\n\n  const [offchainVotingResultsStatus, setOffchainVotingResultsStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  const [offchainVotingResultsError, setOffchainVotingResultsError] = useState<\n    Error | undefined\n  >();\n\n  const [proposalsToMap, setProposalsToMap] = useState<\n    (SnapshotProposal | undefined)[]\n  >([]);\n\n  /**\n   * Variables\n   */\n\n  const getPriorAmountABI = bankABI?.find(\n    (item) => item.name === 'getPriorAmount'\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n  const {isMountedRef} = useIsMounted();\n\n  /**\n   * React Query\n   */\n\n  const {data: votingResultsToSetData, error: votingResultsToSetError} =\n    useQuery(\n      ['votingResultsToSet', proposalsToMap],\n      async () => {\n        if (\n          !bankAddress ||\n          !getPriorAmountABI ||\n          !proposalsToMap.length ||\n          !web3Instance\n        )\n          return;\n\n        return await Promise.all(\n          proposalsToMap.map(async (p) => {\n            const snapshot = p?.msg.payload.snapshot;\n            const idInSnapshot = p?.idInSnapshot;\n\n            if (!idInSnapshot || !snapshot) return;\n\n            const voterEntries = p?.votes?.map((v): [string, number] => {\n              const vote = v[Object.keys(v)[0]];\n\n              return [\n                /**\n                 * Must be the true member's address for calculating voting power.\n                 * This value is (or at least should be) derived from `OffchainVoting.memberAddressesByDelegatedKey`.\n                 */\n                vote.msg.payload.metadata.memberAddress,\n                vote.msg.payload.choice,\n              ];\n            });\n\n            if (!voterEntries || !voterEntries.length) return;\n\n            // Dedupe any duplicate addresses to be safe.\n            const voterAddressesAndChoices = Object.entries(\n              Object.fromEntries(voterEntries)\n            );\n\n            try {\n              const result = await getUnitsPerChoiceCached({\n                bankAddress,\n                getPriorAmountABI,\n                snapshot,\n                voterAddressesAndChoices,\n                web3Instance,\n              });\n\n              return [idInSnapshot, result];\n            } catch (error) {\n              return;\n            }\n          })\n        );\n      },\n      {\n        enabled:\n          !!bankAddress &&\n          !!getPriorAmountABI &&\n          !!proposalsToMap.length &&\n          !!web3Instance,\n      }\n    );\n\n  /**\n   * Cached callbacks\n   */\n\n  const getUnitsPerChoiceCached = useCallback(\n    getUnitsPerChoiceFromContract,\n    []\n  );\n\n  const buildOffchainVotingResultEntriesCached = useCallback(\n    buildOffchainVotingResultEntries,\n    [\n      bankAddress,\n      getPriorAmountABI,\n      isMountedRef,\n      proposalsToMap.length,\n      votingResultsToSetData,\n      votingResultsToSetError,\n      web3Instance,\n    ]\n  );\n\n  /**\n   * Effects\n   */\n\n  // Build result entries of `OffchainVotingResultEntries`\n  useEffect(() => {\n    buildOffchainVotingResultEntriesCached();\n  }, [buildOffchainVotingResultEntriesCached]);\n\n  useEffect(() => {\n    const proposalsToMapToSet = Array.isArray(proposals)\n      ? proposals\n      : [proposals];\n\n    setProposalsToMap(proposalsToMapToSet);\n  }, [proposals]);\n\n  /**\n   * Functions\n   */\n\n  async function buildOffchainVotingResultEntries() {\n    if (\n      !bankAddress ||\n      !getPriorAmountABI ||\n      !proposalsToMap.length ||\n      !web3Instance\n    ) {\n      return;\n    }\n\n    try {\n      setOffchainVotingResultsStatus(AsyncStatus.PENDING);\n\n      if (votingResultsToSetError) {\n        throw votingResultsToSetError;\n      }\n\n      if (votingResultsToSetData) {\n        const filteredVotingResultsToSetData = votingResultsToSetData.filter(\n          (p) => p\n        );\n\n        if (!isMountedRef.current) return;\n\n        setOffchainVotingResultsStatus(AsyncStatus.FULFILLED);\n        setVotingResults(\n          filteredVotingResultsToSetData as OffchainVotingResultEntries\n        );\n        setOffchainVotingResultsError(undefined);\n      }\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      const e = error as Error;\n\n      setOffchainVotingResultsStatus(AsyncStatus.REJECTED);\n      setVotingResults([]);\n      setOffchainVotingResultsError(e);\n    }\n  }\n\n  async function getUnitsPerChoiceFromContract({\n    bankAddress,\n    getPriorAmountABI,\n    snapshot,\n    voterAddressesAndChoices,\n    web3Instance,\n  }: {\n    bankAddress: string;\n    getPriorAmountABI: AbiItem;\n    snapshot: number;\n    voterAddressesAndChoices: [string, number][];\n    web3Instance: Web3;\n  }): Promise<VotingResult> {\n    try {\n      // Create results object to set later\n      const results = {\n        [VoteChoices.Yes]: {\n          percentage: 0,\n          units: 0,\n        },\n        [VoteChoices.No]: {\n          percentage: 0,\n          units: 0,\n        },\n        totalUnits: 0,\n      };\n\n      // Build a call for total units minted for the DAO\n      const totalUnitsCall: MulticallTuple = [\n        bankAddress,\n        getPriorAmountABI,\n        [\n          TOTAL_ADDRESS, // account\n          UNITS_ADDRESS, // tokenAddr\n          snapshot.toString(), // blockNumber\n        ],\n      ];\n\n      // Build a call for balance of units owned by the guild bank\n      const balanceOfGuildUnitsCall: MulticallTuple = [\n        bankAddress,\n        getPriorAmountABI,\n        [\n          GUILD_ADDRESS, // account\n          UNITS_ADDRESS, // tokenAddr\n          snapshot.toString(), // blockNumber\n        ],\n      ];\n\n      // Build calls to Bank contract\n      const unitsCalls = voterAddressesAndChoices.map(\n        ([address]): MulticallTuple => [\n          bankAddress,\n          getPriorAmountABI,\n          [\n            address, // account\n            UNITS_ADDRESS, // tokenAddr\n            snapshot.toString(), // blockNumber\n          ],\n        ]\n      );\n\n      const calls = [totalUnitsCall, balanceOfGuildUnitsCall, ...unitsCalls];\n\n      const [\n        totalUnitsResult,\n        balanceOfGuildResult,\n        ...votingResults\n      ]: string[] = await multicall({\n        calls: calls,\n        web3Instance,\n      });\n\n      // Calculate total units issued and outstanding (not owned by guild bank)\n      const totalUnitsIssued = toBN(totalUnitsResult).sub(\n        toBN(balanceOfGuildResult)\n      );\n\n      // Set Units values for choices\n      votingResults.forEach((units, i) => {\n        const isYes =\n          VoteChoicesIndex[voterAddressesAndChoices[i][1]] ===\n          VoteChoicesIndex[VoteChoicesIndex.Yes];\n        const choice = isYes ? VoteChoices.Yes : VoteChoices.No;\n\n        results[choice].units += Number(units);\n      });\n\n      // Set percentages\n      results[VoteChoices.Yes].percentage =\n        (results[VoteChoices.Yes].units / Number(totalUnitsIssued)) * 100;\n\n      results[VoteChoices.No].percentage =\n        (results[VoteChoices.No].units / Number(totalUnitsIssued)) * 100;\n\n      // Set total units\n      results.totalUnits = Number(totalUnitsIssued);\n\n      return results;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  return {\n    offchainVotingResults: votingResults,\n    offchainVotingResultsError,\n    offchainVotingResultsStatus,\n  };\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {BURN_ADDRESS} from '../../../util/constants';\nimport {getVotingAdapterABI} from '../helpers';\nimport {multicall, MulticallTuple} from '../../web3/helpers';\nimport {ProposalVotingAdapterData} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useWeb3Modal} from '../../web3/hooks';\nimport {VotingAdapterName} from '../../adapters-extensions/enums';\n\ntype ProposalVotingAdapterTuple = [\n  proposalId: string,\n  votingAdapterData: ProposalVotingAdapterData\n];\n\ntype UseProposalsVotingAdapterReturn = {\n  proposalsVotingAdapters: ProposalVotingAdapterTuple[];\n  proposalsVotingAdaptersError: Error | undefined;\n  proposalsVotingAdaptersStatus: AsyncStatus;\n};\n\nconst INITIAL_VOTING_ADAPTERS: ProposalVotingAdapterTuple[] = [];\n\n/**\n * Fetch voting adapter data for proposals by DAO proposal id.\n * Only returns data for proposals of which voting adapters have been assigned (i.e. sponsored).\n *\n * @param {string[]}\n * @returns {UseProposalsVotingAdapterReturn}\n */\nexport function useProposalsVotingAdapter(\n  proposalIds: string[]\n): UseProposalsVotingAdapterReturn {\n  /**\n   * Selectors\n   */\n\n  const registryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n  const registryABI = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.abi\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  /**\n   * State\n   */\n\n  const [proposalsVotingAdapters, setProposalsVotingAdapters] = useState<\n    ProposalVotingAdapterTuple[]\n  >(INITIAL_VOTING_ADAPTERS);\n\n  const [proposalsVotingAdaptersError, setProposalsVotingAdaptersError] =\n    useState<Error | undefined>();\n\n  const [proposalsVotingAdaptersStatus, setProposalsVotingAdaptersStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  /**\n   * Cached callbacks\n   */\n\n  const getProposalsVotingAdaptersOnchainCached = useCallback(\n    getProposalsVotingAdaptersOnchain,\n    [proposalIds, registryABI, registryAddress, web3Instance]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getProposalsVotingAdaptersOnchainCached();\n  }, [getProposalsVotingAdaptersOnchainCached]);\n\n  /**\n   * Functions\n   */\n\n  async function getProposalsVotingAdaptersOnchain(): Promise<void> {\n    if (\n      !proposalIds.length ||\n      !registryABI ||\n      !registryAddress ||\n      !web3Instance\n    ) {\n      return;\n    }\n\n    // Only use hex (more specifically `bytes32`) id's\n    const safeProposalIds = proposalIds.filter(web3Instance.utils.isHexStrict);\n\n    if (!safeProposalIds.length) {\n      setProposalsVotingAdapters(INITIAL_VOTING_ADAPTERS);\n      setProposalsVotingAdaptersStatus(AsyncStatus.FULFILLED);\n\n      return;\n    }\n\n    try {\n      const votingAdapterABI = registryABI.find(\n        (ai) => ai.name === 'votingAdapter'\n      );\n\n      if (!votingAdapterABI) {\n        throw new Error(\n          'No \"votingAdapter\" ABI function was found in the DAO registry ABI.'\n        );\n      }\n\n      // `DaoRegistry.votingAdapter` calls\n      const votingAdapterCalls: MulticallTuple[] = safeProposalIds.map((id) => [\n        registryAddress,\n        votingAdapterABI,\n        [id],\n      ]);\n\n      setProposalsVotingAdaptersStatus(AsyncStatus.PENDING);\n\n      const votingAdapterAddressResults: string[] = await multicall({\n        calls: votingAdapterCalls,\n        web3Instance,\n      });\n\n      const {default: lazyIVotingABI} = await import(\n        '../../../abis/tribute-contracts/IVoting.json'\n      );\n\n      const getAdapterNameABI = (lazyIVotingABI as typeof registryABI).find(\n        (ai) => ai.name === 'getAdapterName'\n      );\n\n      if (!getAdapterNameABI) {\n        throw new Error(\n          'No \"getAdapterName\" ABI function was found in the IVoting ABI.'\n        );\n      }\n\n      /**\n       * Filter out `safeProposalIds` which are not sponsored (i.e. voting adapter address === `BURN_ADDRESS`).\n       * Filter out `votingAdapterAddressResults` which equal the `BURN_ADDRESS`.\n       *\n       * This ensures these two arrays maintain the same length as they rely on indexes for the\n       * proposals to match up to the array of `multicall` results.\n       */\n\n      const filteredProposalIds = safeProposalIds.filter(\n        (_id, i) => votingAdapterAddressResults[i] !== BURN_ADDRESS\n      );\n\n      const filteredVotingAdapterAddressResults =\n        votingAdapterAddressResults.filter((a) => a !== BURN_ADDRESS);\n\n      /**\n       * Exit early if there's no voting adapter addresses.\n       * It means no proposals were found to be sponsored\n       */\n      if (!filteredVotingAdapterAddressResults.length) {\n        setProposalsVotingAdapters(INITIAL_VOTING_ADAPTERS);\n        setProposalsVotingAdaptersStatus(AsyncStatus.FULFILLED);\n\n        return;\n      }\n\n      const votingAdapterNameCalls: MulticallTuple[] =\n        filteredVotingAdapterAddressResults.map((votingAdapterAddress) => [\n          votingAdapterAddress,\n          getAdapterNameABI,\n          [],\n        ]);\n\n      const adapterNameResults: VotingAdapterName[] = await multicall({\n        calls: votingAdapterNameCalls,\n        web3Instance,\n      });\n\n      const votingAdaptersToSet = await Promise.all(\n        filteredProposalIds.map(\n          async (id, i): Promise<ProposalVotingAdapterTuple> => {\n            const votingAdapterABI = await getVotingAdapterABI(\n              adapterNameResults[i]\n            );\n            const votingAdapterAddress = filteredVotingAdapterAddressResults[i];\n\n            return [\n              id,\n              {\n                votingAdapterName: adapterNameResults[i],\n                votingAdapterAddress,\n                getVotingAdapterABI: () => votingAdapterABI,\n                getWeb3VotingAdapterContract: <T>() =>\n                  new web3Instance.eth.Contract(\n                    votingAdapterABI,\n                    votingAdapterAddress\n                  ) as any as T,\n              },\n            ];\n          }\n        )\n      );\n\n      setProposalsVotingAdapters(votingAdaptersToSet);\n      setProposalsVotingAdaptersStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      const e = error as Error;\n\n      setProposalsVotingAdaptersStatus(AsyncStatus.REJECTED);\n      setProposalsVotingAdapters([]);\n      setProposalsVotingAdaptersError(e);\n    }\n  }\n\n  return {\n    proposalsVotingAdapters,\n    proposalsVotingAdaptersError,\n    proposalsVotingAdaptersStatus,\n  };\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {\n  SnapshotDraftResponse,\n  SnapshotProposalResponse,\n  SnapshotType,\n} from '@openlaw/snapshot-js-erc712';\nimport {useQueryClient} from 'react-query';\n\nimport {\n  Proposal,\n  ProposalData,\n  ProposalOrDraftSnapshotType,\n  SnapshotDraft,\n  SnapshotProposal,\n  SnapshotProposalCommon,\n} from '../types';\nimport {AsyncStatus} from '../../../util/types';\nimport {SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {useAbortController, useCounter} from '../../../hooks';\nimport {useProposalsVotingAdapter} from './useProposalsVotingAdapter';\n\ntype UseProposalReturn = {\n  proposalData: ProposalData | undefined;\n  proposalError: Error | undefined;\n  proposalNotFound: boolean;\n  proposalStatus: AsyncStatus;\n};\n\nconst ERROR_PROPOSAL: string =\n  'Something went wrong while getting the proposal.';\nconst ERROR_PROPOSAL_NOT_FOUND: string = 'Proposal was not found.';\n\n/**\n * useProposalOrDraft\n *\n * Fetches a snapshot-hub `proposal` or `draft` type by an ID string.\n *\n * If no `type` argument is provided it will search first for a\n * `proposal`, then if not found, search for a `draft`.\n *\n * @todo Fetch subgraph proposal on mount before a draft or proposal has been fetched.\n *\n * @param {string} id A draft's or a proposal's ID to search for.\n * @param {SnapshotType?} type An optional snapshot-hub `type` to search by.\n * @returns {UseProposalReturn}\n */\nexport function useProposalOrDraft(\n  id: string,\n  type?: ProposalOrDraftSnapshotType\n): UseProposalReturn {\n  /**\n   * State\n   */\n\n  /**\n   * @todo Get subgraph data using useLazyQuery\n   * @link https://www.apollographql.com/docs/react/data/queries/#executing-queries-manually\n   */\n\n  const [daoProposal /* setDAOProposal */] = useState<Proposal>();\n  const [snapshotDraft, setSnapshotDraft] = useState<SnapshotDraft>();\n  const [snapshotProposal, setSnapshotProposal] = useState<SnapshotProposal>();\n  const [proposalNotFound, setProposalNotFound] = useState<boolean>(false);\n  const [proposalError, setProposalError] = useState<Error>();\n  const [proposalStatus, setProposalStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n  const [proposalVotingAdapterId, setProposalVotingAdapterId] = useState<\n    string[]\n  >([id]);\n\n  // The overall status of the async data being fetched\n  const [proposalInclusiveStatus, setProposalInclusiveStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  // Any error of the async data being fetched\n  const [proposalInclusiveError, setProposalInclusiveError] = useState<Error>();\n\n  /**\n   * Our hooks\n   */\n\n  const {abortController, isMountedRef} = useAbortController();\n\n  const [refetchCount, updateRefetchCount] = useCounter();\n\n  /**\n   * Fetch on-chain voting adapter data for proposals.\n   * Only returns data for proposals of which voting adapters have been assigned (i.e. sponsored).\n   */\n  const {\n    proposalsVotingAdapters,\n    proposalsVotingAdaptersError,\n    proposalsVotingAdaptersStatus,\n  } = useProposalsVotingAdapter(proposalVotingAdapterId);\n\n  /**\n   * Their hooks\n   */\n\n  const queryClient = useQueryClient();\n\n  /**\n   * Cached callbacks\n   */\n\n  const handleGetDraftCached = useCallback(handleGetDraft, [\n    abortController?.signal,\n    id,\n    isMountedRef,\n  ]);\n\n  const handleGetProposalCached = useCallback(handleGetProposal, [\n    abortController?.signal,\n    id,\n    isMountedRef,\n    type,\n  ]);\n\n  const handleGetProposalOrDraftCached = useCallback(handleGetProposalOrDraft, [\n    handleGetDraftCached,\n    handleGetProposalCached,\n  ]);\n\n  /**\n   * Variables\n   */\n\n  const snapshotType: ProposalOrDraftSnapshotType | undefined = snapshotProposal\n    ? SnapshotType.proposal\n    : snapshotDraft\n    ? SnapshotType.draft\n    : undefined;\n\n  /**\n   * We need to at least have Snapshot data to provide the proposal,\n   * otherwise we will have nothing to show the user.\n   */\n  const proposalData: UseProposalReturn['proposalData'] =\n    snapshotDraft || snapshotProposal\n      ? {\n          // idInDAO: '',\n          daoProposal,\n          daoProposalVotingAdapter: proposalsVotingAdapters[0]?.[1],\n          getCommonSnapshotProposalData,\n          refetchProposalOrDraft,\n          snapshotDraft,\n          snapshotProposal,\n          snapshotType,\n        }\n      : undefined;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!abortController?.signal) return;\n\n    switch (type) {\n      case SnapshotType.draft:\n        handleGetDraftCached();\n        break;\n      case SnapshotType.proposal:\n        handleGetProposalCached();\n        break;\n      default:\n        handleGetProposalOrDraftCached();\n        break;\n    }\n  }, [\n    abortController?.signal,\n    handleGetDraftCached,\n    handleGetProposalCached,\n    handleGetProposalOrDraftCached,\n    // Required in order to refetch\n    refetchCount,\n    type,\n  ]);\n\n  useEffect(() => {\n    if (refetchCount === 0) return;\n\n    /**\n     * Provide a different Array reference to force a re-render of the\n     * `useProposalsVotingAdapter` hook. If the `id` argument changes, that's\n     * fine as well, but it's unlikely.\n     */\n    setProposalVotingAdapterId([id]);\n  }, [id, refetchCount]);\n\n  useEffect(() => {\n    async function resetQueries() {\n      if (refetchCount === 0) return;\n\n      /**\n       * Reset React Queries when `refetchCount` is incremented (proposal is\n       * sponsored/submitted on chain, proposal is voted on)\n       *\n       * Needed so queries can fetch data that has been updated by the change in\n       * proposal status\n       *\n       */\n      await queryClient.resetQueries();\n    }\n\n    resetQueries();\n  }, [queryClient, refetchCount]);\n\n  // Set overall async status\n  useEffect(() => {\n    const {STANDBY, PENDING, FULFILLED, REJECTED} = AsyncStatus;\n    const statuses = [proposalStatus, proposalsVotingAdaptersStatus];\n\n    /**\n     * Standby\n     *\n     * The other statuses rely on a Snapshot Hub proposal or draft being fetched,\n     * so it's only in `STANDBY` at the point the proposals have\n     * not yet been fetched.\n     */\n    if (proposalStatus === STANDBY) {\n      setProposalInclusiveStatus(STANDBY);\n\n      return;\n    }\n\n    /**\n     * Pending\n     *\n     * Do not trigger pending requests (UI may show loader) for refetches (meant to be silent).\n     */\n    if (statuses.some((s) => s === PENDING) && refetchCount === 0) {\n      setProposalInclusiveStatus(PENDING);\n\n      return;\n    }\n\n    // Fulfilled\n    if (statuses.every((s) => s === FULFILLED)) {\n      setProposalInclusiveStatus(FULFILLED);\n\n      return;\n    }\n\n    // Fulfilled: checked for DAO proposals' voting adapters and none were returned - not sponsored\n    if (\n      proposalStatus === FULFILLED &&\n      proposalsVotingAdaptersStatus === FULFILLED &&\n      !proposalsVotingAdapters.length\n    ) {\n      setProposalInclusiveStatus(FULFILLED);\n\n      return;\n    }\n\n    // Rejected\n    if (statuses.some((s) => s === REJECTED)) {\n      setProposalInclusiveStatus(REJECTED);\n\n      return;\n    }\n  }, [\n    proposalStatus,\n    proposalsVotingAdapters.length,\n    proposalsVotingAdaptersStatus,\n    refetchCount,\n  ]);\n\n  // Set any error from async calls\n  useEffect(() => {\n    const errors = [proposalError, proposalsVotingAdaptersError];\n\n    setProposalInclusiveError(errors.find((e) => e));\n  }, [proposalError, proposalsVotingAdaptersError]);\n\n  /**\n   * Functions\n   */\n\n  async function handleGetDraft(): Promise<SnapshotDraft | undefined> {\n    try {\n      setProposalStatus(AsyncStatus.PENDING);\n\n      const response = await fetch(\n        `${SNAPSHOT_HUB_API_URL}/api/${SPACE}/draft/${id}`,\n        {signal: abortController?.signal}\n      );\n\n      if (!response.ok) {\n        throw new Error(ERROR_PROPOSAL);\n      }\n\n      const responseJSON: SnapshotDraftResponse = await response.json();\n\n      if (!isMountedRef.current) return;\n\n      // @note API does not provide a 404\n      if (!responseJSON || !Object.keys(responseJSON).length) {\n        setProposalNotFound(true);\n\n        throw new Error(ERROR_PROPOSAL_NOT_FOUND);\n      }\n\n      const idKey = Object.keys(responseJSON)[0];\n      // Get the `SnapshotDraftResponseData` by the address key of the single result.\n      const draft: SnapshotDraft = {\n        idInDAO: idKey,\n        idInSnapshot: idKey,\n        ...responseJSON[idKey],\n      };\n\n      setProposalStatus(AsyncStatus.FULFILLED);\n      setSnapshotDraft(draft);\n\n      return draft;\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      const e = error as Error;\n\n      setProposalStatus(AsyncStatus.REJECTED);\n      setProposalError(e);\n    }\n  }\n\n  async function handleGetProposal(): Promise<SnapshotProposal | undefined> {\n    try {\n      setProposalStatus(AsyncStatus.PENDING);\n\n      /**\n       * @note `searchUniqueDraftId` includes the draft id in the search for the proposal\n       *   as a Tribute proposal's ID hash could be the Snapshot Draft's ID.\n       */\n      const response = await fetch(\n        `${SNAPSHOT_HUB_API_URL}/api/${SPACE}/proposal/${id}?searchUniqueDraftId=true&includeVotes=true`,\n        {signal: abortController?.signal}\n      );\n\n      if (!response.ok) {\n        /**\n         * If `type` is set then we know we can determine `handleGetDraft`\n         * will not be called after in `handleGetProposalOrDraft`.\n         */\n        if (type === SnapshotType.proposal) {\n          throw new Error(ERROR_PROPOSAL);\n        }\n\n        return;\n      }\n\n      const responseJSON: SnapshotProposalResponse = await response.json();\n\n      if (!isMountedRef.current) return;\n\n      // @note API does not provide a 404\n      if (!responseJSON || !Object.keys(responseJSON).length) {\n        /**\n         * If `type` is set then we know we can determine `handleGetDraft`\n         * will not be called after in `handleGetProposalOrDraft`.\n         */\n        if (type === SnapshotType.proposal) {\n          setProposalNotFound(true);\n          throw new Error(ERROR_PROPOSAL_NOT_FOUND);\n        }\n\n        return;\n      }\n\n      const idKey = Object.keys(responseJSON)[0];\n      // Determine ID submitted to DAO, i.e. if there's a Draft ID hash, we should use that.\n      const proposalId: string =\n        responseJSON[idKey]?.data.erc712DraftHash || idKey;\n      // Get the `SnapshotProposalResponseData` by the address key of the single result.\n      const proposal: SnapshotProposal = {\n        idInDAO: proposalId,\n        idInSnapshot: idKey,\n        ...responseJSON[idKey],\n      };\n\n      setProposalStatus(AsyncStatus.FULFILLED);\n      setSnapshotProposal(proposal);\n\n      return proposal;\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      const e = error as Error;\n\n      setProposalStatus(AsyncStatus.REJECTED);\n      setProposalError(e);\n    }\n  }\n\n  /**\n   * Searches all possible combinations to return a proposal or a draft:\n   *\n   * 1. Search for a proposal (including by using the `id` as the Draft's ID hash via `searchUniqueDraftId`)\n   * 2. Search for a draft, if nothing is returned for a proposal.\n   */\n  async function handleGetProposalOrDraft() {\n    // 1. Attempt to search for a proposal.\n    const proposal = await handleGetProposalCached();\n\n    if (!proposal) {\n      // 2. If not found, attempt a search for a draft.\n      const draft = await handleGetDraftCached();\n\n      setSnapshotDraft(draft);\n\n      return;\n    }\n\n    setSnapshotProposal(proposal);\n  }\n\n  /**\n   * getCommonSnapshotProposalData\n   *\n   * @returns `SnapshotProposalCommon | undefined` Data for either a Draft or Proposal which is shared between the two types.\n   */\n  function getCommonSnapshotProposalData(): SnapshotProposalCommon | undefined {\n    switch (snapshotType) {\n      case SnapshotType.draft:\n        return snapshotDraft;\n      case SnapshotType.proposal:\n        return snapshotProposal;\n      default:\n        return undefined;\n    }\n  }\n\n  function refetchProposalOrDraft(): void {\n    updateRefetchCount({type: 'increment'});\n  }\n\n  return {\n    proposalData,\n    proposalError: proposalInclusiveError,\n    proposalNotFound,\n    proposalStatus: proposalInclusiveStatus,\n  };\n}\n","import {useEffect, useMemo, useState, useCallback} from 'react';\nimport {useSelector} from 'react-redux';\nimport {\n  SnapshotDraftResponse,\n  SnapshotDraftResponseData,\n  SnapshotProposalResponse,\n  SnapshotProposalResponseData,\n  SnapshotType,\n} from '@openlaw/snapshot-js-erc712';\nimport {useQuery} from 'react-query';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {DaoAdapterConstants} from '../../adapters-extensions/enums';\nimport {normalizeString} from '../../../util/helpers';\nimport {ProposalData, SnapshotDraft, SnapshotProposal} from '../types';\nimport {SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {StoreState} from '../../../store/types';\nimport {useDaoProposals, useProposalsVotingState} from '.';\nimport {useProposalsVotes} from './useProposalsVotes';\nimport {useProposalsVotingAdapter} from './useProposalsVotingAdapter';\n\ntype UseProposalsReturn = {\n  proposals: ProposalData[];\n  proposalsStatus: AsyncStatus;\n  proposalsError: Error | undefined;\n};\n\ntype SnapshotDraftAndProposalEntries = [\n  string,\n  SnapshotDraftResponseData | SnapshotProposalResponseData\n][];\n\nconst INITIAL_ARRAY: any[] = [];\n\n// Gets Drafts (unsponsored Proposals) from Snapshot Hub\nasync function getSnapshotDraftsByAdapterAddress(\n  adapterAddress: string\n): Promise<[string, SnapshotDraftResponseData][]> {\n  try {\n    const baseURL = `${SNAPSHOT_HUB_API_URL}/api/${SPACE}`;\n\n    const drafts = await fetch(`${baseURL}/drafts/${adapterAddress}`);\n\n    if (!drafts.ok) {\n      throw new Error(\n        'Something went wrong while fetching the Snapshot drafts.'\n      );\n    }\n\n    const draftsJSON: SnapshotDraftResponse = await drafts.json();\n\n    // Get Drafts which have not yet been sponsored (Proposal created)\n    const draftEntries = Object.entries(draftsJSON).filter(\n      ([_, d]) => d.data.sponsored === false\n    );\n\n    return draftEntries;\n  } catch (error) {\n    throw error;\n  }\n}\n\n// Gets Proposals from Snapshot Hub\nasync function getSnapshotProposalsByAdapterAddress(\n  adapterAddress: string\n): Promise<[string, SnapshotProposalResponseData][]> {\n  try {\n    const baseURL = `${SNAPSHOT_HUB_API_URL}/api/${SPACE}`;\n\n    const proposals = await fetch(\n      `${baseURL}/proposals/${adapterAddress}?includeVotes=true`\n    );\n\n    if (!proposals.ok) {\n      throw new Error(\n        'Something went wrong while fetching the Snapshot proposals.'\n      );\n    }\n\n    const proposalsJSON: SnapshotProposalResponse = await proposals.json();\n\n    /**\n     * Re-map entries setting the correct id used for the `proposalId` in the DAO.\n     * If it has a draft hash, then this is what was submitted to the DAO, most likely (e.g. submit proposal)\n     */\n    const proposalEntries = Object.entries(proposalsJSON).map(\n      ([id, p]): [string, SnapshotProposalResponseData] => [\n        p.data.erc712DraftHash || id,\n        p,\n      ]\n    );\n\n    return proposalEntries;\n  } catch (error) {\n    throw error;\n  }\n}\n\n/**\n * useProposals\n *\n * @param {string} adapterName Name of the adapter contract to get proposals for.\n * @param {string} includeProposalsExistingOnlyOffchain To handle proposal types where the first step is creating a snapshot draft/offchain proposal only (no onchain proposal exists).\n * @returns `UseProposalsReturn` An object with the proposals, and the current async status.\n */\nexport function useProposals({\n  adapterName,\n  includeProposalsExistingOnlyOffchain = false,\n}: {\n  adapterName: DaoAdapterConstants;\n  includeProposalsExistingOnlyOffchain?: boolean;\n}): UseProposalsReturn {\n  /**\n   * State\n   */\n\n  const [adapterAddress, setAdapterAddress] = useState<string>();\n\n  const [snapshotDraftAndProposals, setSnapshotDraftAndProposals] =\n    useState<SnapshotDraftAndProposalEntries>(INITIAL_ARRAY);\n\n  const [snapshotDraftAndProposalsStatus, setSnapshotDraftAndProposalsStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  const [snapshotDraftAndProposalsError, setSnapshotDraftAndProposalsError] =\n    useState<Error | undefined>();\n\n  const [daoProposalIdsToUse, setDaoProposalIdsToUse] =\n    useState<string[]>(INITIAL_ARRAY);\n\n  const [proposals, setProposals] = useState<ProposalData[]>(INITIAL_ARRAY);\n\n  // The overall status of the async data being fetched\n  const [proposalsInclusiveStatus, setProposalsInclusiveStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  // Any error of the async data being fetched\n  const [proposalsInclusiveError, setProposalsInclusiveError] =\n    useState<Error>();\n\n  /**\n   * Selectors\n   */\n\n  const contracts = useSelector((s: StoreState) => s.contracts);\n\n  /**\n   * Memo\n   */\n\n  const snapshotDraftAndProposalsIds: string[] = useMemo(\n    () => snapshotDraftAndProposals.map((e) => e[0]),\n    [snapshotDraftAndProposals]\n  );\n\n  /**\n   * Our hooks\n   */\n\n  /**\n   * Fetch DAO proposals, if there are `snapshotDraftAndProposals`.\n   *\n   * Dependent upon `snapshotDraftAndProposals`.\n   */\n  const {daoProposals, daoProposalsError, daoProposalsStatus} = useDaoProposals(\n    snapshotDraftAndProposalsIds\n  );\n\n  /**\n   * Fetch on-chain voting adapter data for proposals of which voting adapters have been assigned (i.e. sponsored).\n   *\n   * Dependent upon `daoProposals`.\n   */\n  const {\n    proposalsVotingAdapters,\n    proposalsVotingAdaptersError,\n    proposalsVotingAdaptersStatus,\n  } = useProposalsVotingAdapter(daoProposalIdsToUse);\n\n  /**\n   * Fetch on-chain voting state for proposals of which voting adapters have been assigned (i.e. sponsored).\n   *\n   * Dependent upon `useProposalsVotingAdapter`.\n   */\n  const {\n    proposalsVotingState,\n    proposalsVotingStateError,\n    proposalsVotingStateStatus,\n  } = useProposalsVotingState(proposalsVotingAdapters);\n\n  /**\n   * Fetch on-chain votes data for proposals of which voting adapters have been assigned (i.e. sponsored)\n   *\n   * Dependent upon `useProposalsVotingAdapter`.\n   */\n  const {proposalsVotes, proposalsVotesError, proposalsVotesStatus} =\n    useProposalsVotes(proposalsVotingAdapters);\n\n  /**\n   * React Query\n   */\n\n  const {data: snapshotDraftEntriesData, error: snapshotDraftEntriesError} =\n    useQuery(\n      ['snapshotDraftEntries', adapterAddress],\n      async () => {\n        if (!adapterAddress) return;\n\n        return await getSnapshotDraftsByAdapterAddress(adapterAddress);\n      },\n      {\n        enabled: !!adapterAddress,\n      }\n    );\n\n  const {\n    data: snapshotProposalEntriesData,\n    error: snapshotProposalEntriesError,\n  } = useQuery(\n    ['snapshotProposalEntries', adapterAddress],\n    async () => {\n      if (!adapterAddress) return;\n\n      return await getSnapshotProposalsByAdapterAddress(adapterAddress);\n    },\n    {\n      enabled: !!adapterAddress,\n    }\n  );\n\n  /**\n   * Variables\n   */\n\n  const allSnapshotDraftsAndProposalsError =\n    snapshotDraftEntriesError || snapshotProposalEntriesError;\n\n  /**\n   * Cached callbacks\n   */\n\n  const handleGetAllSnapshotDraftsAndProposalsCached = useCallback(\n    handleGetAllSnapshotDraftsAndProposals,\n    [\n      allSnapshotDraftsAndProposalsError,\n      snapshotDraftEntriesData,\n      snapshotProposalEntriesData,\n    ]\n  );\n\n  /**\n   * Effects\n   */\n\n  // Get and set the adapter address\n  useEffect(() => {\n    // @note We don't use the helper function as we don't want it to throw here.\n    const address = Object.entries(contracts).find(\n      ([_, c]) => c?.adapterOrExtensionName === adapterName\n    )?.[1]?.contractAddress;\n\n    setAdapterAddress(address);\n  }, [adapterAddress, adapterName, contracts]);\n\n  // Get and set all Snapshot drafts and proposal entries\n  useEffect(() => {\n    if (!adapterAddress) return;\n\n    handleGetAllSnapshotDraftsAndProposalsCached();\n  }, [adapterAddress, handleGetAllSnapshotDraftsAndProposalsCached]);\n\n  // Set the DAO proposal IDs we want to work with\n  useEffect(() => {\n    if (!daoProposals.length) return;\n\n    if (includeProposalsExistingOnlyOffchain) {\n      // Do not filter-out proposals which exist only off-chain\n      return setDaoProposalIdsToUse(daoProposals.map(([id]) => id));\n    }\n\n    // Filter-out proposals which do not exist onchain\n    return setDaoProposalIdsToUse(\n      daoProposals.filter(([_, p]) => p.flags !== '0').map(([id]) => id)\n    );\n  }, [daoProposals, includeProposalsExistingOnlyOffchain]);\n\n  // Set `proposals` with any returned data, once overall `AsyncStatus` equals `FULFILLED`\n  useEffect(() => {\n    if (proposalsInclusiveStatus !== AsyncStatus.FULFILLED) {\n      return;\n    }\n\n    const proposalsToSet = daoProposalIdsToUse\n      .map((id): ProposalData => {\n        const [, daoProposal] =\n          daoProposals.find(\n            ([daoProposalId]) =>\n              normalizeString(daoProposalId) === normalizeString(id)\n          ) || [];\n\n        const [snapshotDataId, snapshotData] =\n          snapshotDraftAndProposals.find(\n            ([snapshotId]) =>\n              normalizeString(snapshotId) === normalizeString(id)\n          ) || [];\n\n        const isSnapshotDraft: boolean =\n          snapshotData?.msg.type === SnapshotType.draft;\n\n        const snapshotDraft: SnapshotDraft | undefined =\n          snapshotDataId && isSnapshotDraft\n            ? {\n                ...(snapshotData as SnapshotDraft),\n                // @todo Rename to `idForDAO` as it is more accurate, as the ID may not yet exist in the DAO.\n                idInDAO: id,\n                idInSnapshot: snapshotDataId,\n              }\n            : undefined;\n\n        const snapshotProposal: SnapshotProposal | undefined =\n          snapshotDataId && !isSnapshotDraft\n            ? {\n                ...(snapshotData as SnapshotProposal),\n                // @todo Rename to `idForDAO` as it is more accurate, as the ID may not yet exist in the DAO.\n                idInDAO: id,\n                idInSnapshot: snapshotDataId,\n              }\n            : undefined;\n\n        const daoProposalVotingAdapter = proposalsVotingAdapters.find(\n          ([proposalIdVotingAdapter]) =>\n            normalizeString(proposalIdVotingAdapter) === normalizeString(id)\n        )?.[1];\n\n        const daoProposalVotingState = proposalsVotingState.find(\n          ([proposalIdVotingState]) =>\n            normalizeString(proposalIdVotingState) === normalizeString(id)\n        )?.[1];\n\n        const daoProposalVote = proposalsVotes.find(\n          ([proposalIdVotes]) =>\n            normalizeString(id) === normalizeString(proposalIdVotes)\n        )?.[1];\n\n        return {\n          daoProposal,\n          daoProposalVote,\n          daoProposalVotingAdapter,\n          daoProposalVotingState,\n          /**\n           * @todo Work to remove `idInDAO` on the root. Don't think we use this?\n           */\n          idInDAO: id,\n          snapshotDraft,\n          snapshotProposal,\n          snapshotType: isSnapshotDraft\n            ? SnapshotType.draft\n            : SnapshotType.proposal,\n\n          // @todo Make type optional\n          getCommonSnapshotProposalData: () => undefined,\n          // @todo Make type optional\n          refetchProposalOrDraft: () => {},\n        };\n      })\n      .filter((p) => p.snapshotDraft || p.snapshotProposal);\n\n    // Set proposals\n    setProposals(proposalsToSet);\n  }, [\n    daoProposalIdsToUse,\n    daoProposals,\n    proposalsInclusiveStatus,\n    proposalsVotes,\n    proposalsVotingAdapters,\n    proposalsVotingState,\n    snapshotDraftAndProposals,\n  ]);\n\n  // Set overall async status\n  useEffect(() => {\n    const {STANDBY, PENDING, FULFILLED, REJECTED} = AsyncStatus;\n\n    const statuses = [\n      daoProposalsStatus,\n      proposalsVotingAdaptersStatus,\n      proposalsVotingStateStatus,\n      proposalsVotesStatus,\n      snapshotDraftAndProposalsStatus,\n    ];\n\n    /**\n     * Standby\n     *\n     * The other statuses rely on Snapshot drafts and proposals being fetched,\n     * so it's only in `STANDBY` at the point the Snapshot data has\n     * not yet been fetched.\n     */\n    if (snapshotDraftAndProposalsStatus === STANDBY) {\n      setProposalsInclusiveStatus(STANDBY);\n\n      return;\n    }\n\n    // Pending\n    if (statuses.some((s) => s === PENDING)) {\n      setProposalsInclusiveStatus(PENDING);\n\n      return;\n    }\n\n    // Fulfilled\n    if (statuses.every((s) => s === FULFILLED)) {\n      setProposalsInclusiveStatus(FULFILLED);\n\n      return;\n    }\n\n    /**\n     * Fulfilled: no `snapshotDraftAndProposals` were found.\n     *\n     * Since the other data-fetching hooks rely on `snapshotDraftAndProposals`\n     * their statuses will be in `STANDBY` if `snapshotDraftAndProposals` is empty.\n     */\n    if (\n      snapshotDraftAndProposalsStatus === FULFILLED &&\n      !snapshotDraftAndProposals.length\n    ) {\n      setProposalsInclusiveStatus(FULFILLED);\n\n      return;\n    }\n\n    /**\n     * Fulfilled: No data was returned after running `useProposalsVotingAdapter`.\n     *\n     * The hooks `useProposalsVotingState`, `useProposalsVotes` are dependent upon `proposalsVotingAdapters`,\n     * so if there is no data, at this point, it's safe to return `FULFILLED`.\n     */\n    if (\n      proposalsVotingAdaptersStatus === FULFILLED &&\n      !proposalsVotingAdapters.length\n    ) {\n      setProposalsInclusiveStatus(FULFILLED);\n\n      return;\n    }\n\n    // Rejected\n    if (statuses.some((s) => s === REJECTED)) {\n      setProposalsInclusiveStatus(REJECTED);\n\n      return;\n    }\n  }, [\n    daoProposalIdsToUse.length,\n    daoProposalsStatus,\n    proposalsVotesStatus,\n    proposalsVotingAdapters,\n    proposalsVotingAdaptersStatus,\n    proposalsVotingStateStatus,\n    snapshotDraftAndProposals.length,\n    snapshotDraftAndProposalsStatus,\n  ]);\n\n  // Set any error from async calls\n  useEffect(() => {\n    setProposalsInclusiveError(\n      [\n        daoProposalsError,\n        proposalsVotesError,\n        proposalsVotingAdaptersError,\n        proposalsVotingStateError,\n        snapshotDraftAndProposalsError,\n      ].find((e) => e)\n    );\n  }, [\n    daoProposalsError,\n    proposalsVotesError,\n    proposalsVotingAdaptersError,\n    proposalsVotingStateError,\n    snapshotDraftAndProposalsError,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  async function handleGetAllSnapshotDraftsAndProposals() {\n    try {\n      setSnapshotDraftAndProposalsStatus(AsyncStatus.PENDING);\n      // Reset error\n      setSnapshotDraftAndProposalsError(undefined);\n\n      if (allSnapshotDraftsAndProposalsError) {\n        throw allSnapshotDraftsAndProposalsError;\n      }\n\n      if (snapshotDraftEntriesData && snapshotProposalEntriesData) {\n        const mergedEntries = [\n          ...snapshotDraftEntriesData,\n          ...snapshotProposalEntriesData,\n        ];\n\n        if (!mergedEntries.length) {\n          setSnapshotDraftAndProposalsStatus(AsyncStatus.FULFILLED);\n\n          return;\n        }\n\n        setSnapshotDraftAndProposals(mergedEntries);\n        setSnapshotDraftAndProposalsStatus(AsyncStatus.FULFILLED);\n      }\n    } catch (error) {\n      const e = error as Error;\n\n      setSnapshotDraftAndProposalsStatus(AsyncStatus.REJECTED);\n      setSnapshotDraftAndProposals(INITIAL_ARRAY);\n      setSnapshotDraftAndProposalsError(e);\n    }\n  }\n\n  return {\n    proposals,\n    proposalsError: proposalsInclusiveError,\n    proposalsStatus: proposalsInclusiveStatus,\n  };\n}\n","import {AbiItem} from 'web3-utils/types';\nimport {useCallback, useEffect, useState} from 'react';\nimport {useQuery} from 'react-query';\nimport {useSelector} from 'react-redux';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {multicall, MulticallTuple} from '../../web3/helpers';\nimport {ProposalVotesData, ProposalVotingAdapterTuple} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useWeb3Modal} from '../../web3/hooks';\nimport {VotingAdapterName} from '../../adapters-extensions/enums';\n\ntype ProposalsVotesTuple = [\n  proposalId: string,\n  /**\n   * For each proposal, each result is stored under its adapter name.\n   */\n  adapterData: ProposalVotesData\n];\n\ntype UseProposalsVotesReturn = {\n  proposalsVotes: ProposalsVotesTuple[];\n  proposalsVotesError: Error | undefined;\n  proposalsVotesStatus: AsyncStatus;\n};\n\nexport function useProposalsVotes(\n  /**\n   * A tuple of proposal id's and voting adapter data.\n   * This data is returned by `useProposalsVotingAdapter`.\n   */\n  proposalVotingAdapters: ProposalVotingAdapterTuple[]\n): UseProposalsVotesReturn {\n  /**\n   * Selectors\n   */\n\n  const registryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n\n  /**\n   * State\n   */\n\n  const [proposalsVotes, setProposalsVotes] = useState<ProposalsVotesTuple[]>(\n    []\n  );\n\n  const [proposalsVotesError, setProposalsVotesError] = useState<Error>();\n\n  const [proposalsVotesStatus, setProposalsVotesStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n\n  const [safeProposalVotingAdapters, setSafeProposalVotingAdapters] =\n    useState<ProposalVotingAdapterTuple[]>();\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  /**\n   * React Query\n   */\n\n  const {data: votesDataCallsData, error: votesDataCallsError} = useQuery(\n    ['votesDataCalls', safeProposalVotingAdapters],\n    async (): Promise<MulticallTuple[] | undefined> => {\n      if (!safeProposalVotingAdapters || !registryAddress) return;\n\n      return await Promise.all(\n        safeProposalVotingAdapters.map(\n          async ([\n            proposalId,\n            {votingAdapterAddress, getVotingAdapterABI, votingAdapterName},\n          ]): Promise<MulticallTuple> => [\n            votingAdapterAddress,\n            await getVotesDataABI(votingAdapterName, getVotingAdapterABI()),\n            /**\n             * We build the call arguments the same way for the different voting adapters\n             * (i.e. [dao, proposalId]). If we need to change this we can move it to another function.\n             */\n            [registryAddress, proposalId],\n          ]\n        )\n      );\n    },\n    {\n      enabled:\n        !!proposalVotingAdapters.length &&\n        !!safeProposalVotingAdapters &&\n        !!registryAddress &&\n        !!web3Instance,\n    }\n  );\n\n  const {data: votesDataResults, error: votesDataResultsError} = useQuery(\n    ['votesDataResults', votesDataCallsData?.length],\n    async () => {\n      if (!votesDataCallsData?.length || !web3Instance) {\n        return;\n      }\n\n      return await multicall({\n        calls: votesDataCallsData,\n        web3Instance,\n      });\n    },\n    {enabled: !!votesDataCallsData?.length && !!web3Instance}\n  );\n\n  /**\n   * Cached callbacks\n   */\n\n  const getProposalsVotesOnchainCached = useCallback(getProposalsVotesOnchain, [\n    safeProposalVotingAdapters,\n    votesDataCallsData,\n    votesDataCallsError,\n    votesDataResults,\n    votesDataResultsError,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (\n      !proposalVotingAdapters.length ||\n      !safeProposalVotingAdapters ||\n      !registryAddress ||\n      !web3Instance\n    ) {\n      return;\n    }\n\n    getProposalsVotesOnchainCached();\n  }, [\n    getProposalsVotesOnchainCached,\n    proposalVotingAdapters.length,\n    registryAddress,\n    safeProposalVotingAdapters,\n    web3Instance,\n  ]);\n\n  useEffect(() => {\n    if (!proposalVotingAdapters.length || !web3Instance) {\n      return;\n    }\n\n    // Only use hex (more specifically `bytes32`) id's\n    const safeProposalVotingAdaptersToSet = proposalVotingAdapters.filter(\n      ([id]) => web3Instance.utils.isHexStrict(id)\n    );\n\n    setSafeProposalVotingAdapters(safeProposalVotingAdaptersToSet);\n  }, [proposalVotingAdapters, web3Instance]);\n\n  /**\n   * Functions\n   */\n\n  async function getProposalsVotesOnchain() {\n    if (!safeProposalVotingAdapters) {\n      return;\n    }\n\n    if (!safeProposalVotingAdapters.length) {\n      setProposalsVotesStatus(AsyncStatus.FULFILLED);\n      setProposalsVotes([]);\n\n      return;\n    }\n\n    try {\n      setProposalsVotesStatus(AsyncStatus.PENDING);\n\n      if (votesDataCallsError) {\n        throw votesDataCallsError;\n      }\n\n      // Build votes results\n      if (votesDataCallsData) {\n        if (votesDataResultsError) {\n          throw votesDataResultsError;\n        }\n\n        if (votesDataResults) {\n          setProposalsVotes(\n            safeProposalVotingAdapters.map(\n              ([proposalId, {votingAdapterName}], i) => [\n                proposalId,\n                {\n                  [votingAdapterName]: buildVotesData(\n                    votingAdapterName,\n                    votesDataResults[i]\n                  ),\n                },\n              ]\n            )\n          );\n\n          setProposalsVotesStatus(AsyncStatus.FULFILLED);\n        }\n      }\n    } catch (error) {\n      const e = error as Error;\n\n      setProposalsVotes([]);\n      setProposalsVotesStatus(AsyncStatus.REJECTED);\n      setProposalsVotesError(e);\n    }\n  }\n\n  function buildVotesData(\n    votingAdapterName: VotingAdapterName,\n    votesData: any\n  ) {\n    try {\n      switch (votingAdapterName) {\n        case VotingAdapterName.OffchainVotingContract:\n          return {\n            snapshot: votesData[0],\n            reporter: votesData[1],\n            resultRoot: votesData[2],\n            nbYes: votesData[3],\n            nbNo: votesData[4],\n            startingTime: votesData[5],\n            gracePeriodStartingTime: votesData[6],\n            isChallenged: votesData[7],\n            stepRequested: votesData[8],\n            forceFailed: votesData[9],\n            fallbackVotesCount: votesData[10],\n          };\n\n        case VotingAdapterName.VotingContract:\n          return votesData;\n\n        default:\n          throw new Error(\n            `No voting adapter name was found for \"${votingAdapterName}\".`\n          );\n      }\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  /**\n   * getVotesDataABI\n   *\n   * Gets the ABI for the public mapping getter of voting data.\n   *\n   * @param {VotingAdapterName} votingAdapterName\n   * @returns {Promise<AbiItem>}\n   */\n  async function getVotesDataABI(\n    votingAdapterName: VotingAdapterName,\n    votingAdapterABI: AbiItem[]\n  ): Promise<AbiItem> {\n    try {\n      switch (votingAdapterName) {\n        case VotingAdapterName.OffchainVotingContract:\n          const offchainVotesDataABI = votingAdapterABI.find(\n            (ai) => ai.name === 'getVote'\n          );\n\n          if (!offchainVotesDataABI) {\n            throw new Error(\n              `No \"votes\" function ABI was found for \"${votingAdapterName}\".`\n            );\n          }\n\n          return offchainVotesDataABI;\n\n        case VotingAdapterName.VotingContract:\n          const votingVotesDataABI = votingAdapterABI.find(\n            (ai) => ai.name === 'votes'\n          );\n\n          if (!votingVotesDataABI) {\n            throw new Error(\n              `No \"votes\" function ABI was found for \"${votingAdapterName}\".`\n            );\n          }\n\n          return votingVotesDataABI;\n\n        default:\n          throw new Error(\n            `No voting adapter name was found for \"${votingAdapterName}\".`\n          );\n      }\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  return {\n    proposalsVotes,\n    proposalsVotesError,\n    proposalsVotesStatus,\n  };\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {AbiItem} from 'web3-utils/types';\nimport {useQuery} from 'react-query';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {multicall, MulticallTuple} from '../../web3/helpers';\nimport {ProposalVotingAdapterTuple} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useWeb3Modal} from '../../web3/hooks';\nimport {VotingState} from '../voting/types';\n\ntype ProposalsVotingStateTuples = [\n  proposalId: string,\n  votingState: VotingState\n][];\n\ntype UseProposalsVotingStateReturn = {\n  proposalsVotingState: ProposalsVotingStateTuples;\n  proposalsVotingStateError: Error | undefined;\n  proposalsVotingStateStatus: AsyncStatus;\n};\n\nexport function useProposalsVotingState(\n  /**\n   * A tuple of proposal id's and voting adapter data.\n   * This data is returned by `useProposalsVotingAdapter`.\n   */\n  proposalVotingAdapters: ProposalVotingAdapterTuple[]\n): UseProposalsVotingStateReturn {\n  /**\n   * Selectors\n   */\n\n  const registryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n\n  /**\n   * State\n   */\n\n  const [proposalsVotingState, setProposaslsVotingState] =\n    useState<ProposalsVotingStateTuples>([]);\n\n  const [proposalsVotingStateError, setProposalsVotingStateError] =\n    useState<Error>();\n\n  const [proposalsVotingStateStatus, setProposalsVotingStateStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  const [votingResultABIError, setVotingResultABIError] = useState<Error>();\n\n  const [proposalsVotingStateCalls, setProposalsVotingStateCalls] =\n    useState<MulticallTuple[]>();\n\n  const [safeProposalVotingAdapters, setSafeProposalVotingAdapters] =\n    useState<ProposalVotingAdapterTuple[]>();\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  /**\n   * React Query\n   */\n\n  const {\n    data: proposalsVotingStateResult,\n    error: proposalsVotingStateResultError,\n  } = useQuery(\n    ['proposalsVotingStateResult', proposalsVotingStateCalls],\n    async () => {\n      if (!proposalsVotingStateCalls?.length || !web3Instance) {\n        return;\n      }\n\n      return await multicall({\n        calls: proposalsVotingStateCalls,\n        web3Instance,\n      });\n    },\n    {enabled: !!proposalsVotingStateCalls?.length && !!web3Instance}\n  );\n\n  /**\n   * Cached callbacks\n   */\n\n  const getProposalsVotingStateOnchainCached = useCallback(\n    getProposalsVotingStateOnchain,\n    [\n      proposalVotingAdapters.length,\n      proposalsVotingStateCalls,\n      proposalsVotingStateResult,\n      proposalsVotingStateResultError,\n      registryAddress,\n      safeProposalVotingAdapters,\n      votingResultABIError,\n      web3Instance,\n    ]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getProposalsVotingStateOnchainCached();\n  }, [getProposalsVotingStateOnchainCached]);\n\n  useEffect(() => {\n    if (!proposalVotingAdapters.length || !web3Instance) {\n      return;\n    }\n\n    // Only use hex (more specifically `bytes32`) id's\n    const safeProposalVotingAdaptersToSet = proposalVotingAdapters.filter(\n      ([id]) => web3Instance.utils.isHexStrict(id)\n    );\n\n    setSafeProposalVotingAdapters(safeProposalVotingAdaptersToSet);\n  }, [proposalVotingAdapters, web3Instance]);\n\n  useEffect(() => {\n    async function setProposalsVotingStateCallsPrepData() {\n      if (!registryAddress || !safeProposalVotingAdapters?.length) return;\n\n      const lazyIVotingABI = (\n        await import('../../../abis/tribute-contracts/IVoting.json')\n      ).default as AbiItem[];\n\n      const votingResultABI = lazyIVotingABI.find(\n        (ai) => ai.name === 'voteResult'\n      );\n\n      if (!votingResultABI) {\n        setVotingResultABIError(\n          new Error(\n            'No \"voteResult\" ABI function was found on the \"IVoting\" contract.'\n          )\n        );\n\n        return;\n      }\n\n      const proposalsVotingStateCallsToSet: MulticallTuple[] =\n        safeProposalVotingAdapters.map(\n          ([proposalId, {votingAdapterAddress}]) => [\n            votingAdapterAddress,\n            votingResultABI,\n            [registryAddress, proposalId],\n          ]\n        );\n      setProposalsVotingStateCalls(proposalsVotingStateCallsToSet);\n    }\n\n    setProposalsVotingStateCallsPrepData();\n  }, [registryAddress, safeProposalVotingAdapters]);\n\n  /**\n   * Functions\n   */\n\n  async function getProposalsVotingStateOnchain() {\n    if (\n      !registryAddress ||\n      !proposalVotingAdapters.length ||\n      !safeProposalVotingAdapters ||\n      !web3Instance\n    ) {\n      return;\n    }\n\n    if (!safeProposalVotingAdapters.length) {\n      setProposalsVotingStateStatus(AsyncStatus.FULFILLED);\n\n      return;\n    }\n\n    try {\n      if (votingResultABIError) {\n        throw votingResultABIError;\n      }\n\n      if (!proposalsVotingStateCalls) return;\n\n      setProposalsVotingStateStatus(AsyncStatus.PENDING);\n\n      if (proposalsVotingStateResultError) {\n        throw proposalsVotingStateResultError;\n      }\n\n      if (proposalsVotingStateResult) {\n        setProposalsVotingStateStatus(AsyncStatus.FULFILLED);\n        setProposaslsVotingState(\n          safeProposalVotingAdapters.map(([proposalId], i) => [\n            proposalId,\n            proposalsVotingStateResult[i],\n          ])\n        );\n      }\n    } catch (error) {\n      const e = error as Error;\n\n      setProposalsVotingStateStatus(AsyncStatus.REJECTED);\n      setProposaslsVotingState([]);\n      setProposalsVotingStateError(e);\n    }\n  }\n\n  return {\n    proposalsVotingState,\n    proposalsVotingStateError,\n    proposalsVotingStateStatus,\n  };\n}\n","import {useSelector} from 'react-redux';\nimport {useCallback, useEffect, useRef, useState} from 'react';\nimport {isAddress} from 'web3-utils';\n\nimport {\n  ProposalFlowStatus,\n  ProposalData,\n  ProposalFlag,\n  OffchainVotingAdapterVote,\n} from '../types';\nimport {BURN_ADDRESS} from '../../../util/constants';\nimport {ENVIRONMENT} from '../../../config';\nimport {multicall, MulticallTuple} from '../../web3/helpers';\nimport {normalizeString} from '../../../util/helpers';\nimport {proposalHasFlag} from '../helpers';\nimport {StoreState} from '../../../store/types';\nimport {useTimeStartEnd} from '../../../hooks';\nimport {useWeb3Modal} from '../../web3/hooks';\nimport {VotingState} from '../voting/types';\n\ntype UseProposalWithOffchainVoteStatusReturn = {\n  daoProposal: {adapterAddress: string; flags: number} | undefined;\n  daoProposalVote: OffchainVotingAdapterVote | undefined;\n  /**\n   * An enum name (`string`) of the DAO proposal's `VotingState` index\n   */\n  daoProposalVoteResult: typeof VotingState[any] | undefined;\n  proposalFlowStatusError: Error | undefined;\n  status: ProposalFlowStatus | undefined;\n  stopPollingForStatus: () => void;\n};\n\ntype UseProposalWithOffchainVoteStatusProps = {\n  /**\n   * Voting start time if `useCountdownToCheckInVoting: true`\n   * i.e. calculated from the `OffchainVoting` contract's vote's start time, or Snapshot proposal's start time.\n   *\n   * If not available and/or determined, use `0`.\n   */\n  countdownVotingStartSeconds?: number;\n  /**\n   * Voting end time if `useCountdownToCheckInVoting: true`\n   * i.e. calculated from the `OffchainVoting` contract's vote's end time, or Snapshot proposal's end time\n   *\n   * If not available and/or determined, use `0`.\n   */\n  countdownVotingEndSeconds?: number;\n  proposal: ProposalData;\n  /**\n   * Defaults to `DEFAULT_POLL_INTERVAL_MS`:\n   *  - Production: 15000ms\n   *  - Development: 5000ms\n   */\n  pollInterval?: number;\n  /**\n   * If `true` \"in voting\" will be determined by an internal timer using\n   * `countdownVotingStartSeconds` and `countdownVotingEndSeconds`, and not by the\n   * contract's `VotingState`.\n   */\n  useCountdownToCheckInVoting?: boolean;\n};\n\nconst {\n  Completed,\n  OffchainVotingGracePeriod,\n  OffchainVotingSubmitResult,\n  OffchainVoting,\n  Process,\n  Sponsor,\n  Submit,\n} = ProposalFlowStatus;\n\nconst DEFAULT_POLL_INTERVAL_MS: number =\n  ENVIRONMENT === 'production' ? 15000 : 5000;\n\n/**\n * Derives where in the \"proposal flow\" a proposal currently is.\n *\n * Most flow states are derived from the contract.\n * Determing whether a proposal is in voting works a bit differently, depending\n * on which vote start and end times are to be used (i.e. Snapshot proposal vs. Contract proposal).\n *\n * Therefore, we pass these two timing values as props to be more agnostic.\n *\n * @param UseProposalWithOffchainVoteStatusProps\n * @returns `UseProposalWithOffchainVoteStatusReturn`\n */\nexport function useProposalWithOffchainVoteStatus({\n  countdownVotingEndSeconds = 0,\n  countdownVotingStartSeconds = 0,\n  pollInterval = DEFAULT_POLL_INTERVAL_MS,\n  proposal,\n  useCountdownToCheckInVoting = false,\n}: UseProposalWithOffchainVoteStatusProps): UseProposalWithOffchainVoteStatusReturn {\n  /**\n   * Selectors\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  const daoRegistryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n\n  const daoRegistryABI = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.abi\n  );\n\n  /**\n   * State\n   */\n\n  const [status, setStatus] = useState<ProposalFlowStatus>();\n\n  const [initComplete, setInitComplete] = useState<boolean>(false);\n\n  const [daoProposal, setDAOProposal] =\n    useState<UseProposalWithOffchainVoteStatusReturn['daoProposal']>();\n\n  const [daoProposalVote, setDAOProposalVote] =\n    useState<UseProposalWithOffchainVoteStatusReturn['daoProposalVote']>();\n\n  const [daoProposalVoteResult, setDAOProposalVoteResult] =\n    useState<\n      UseProposalWithOffchainVoteStatusReturn['daoProposalVoteResult']\n    >();\n\n  const [proposalFlowStatusError, setProposalFlowStatusError] =\n    useState<Error>();\n\n  /**\n   * Refs\n   */\n\n  const pollingIntervalIdRef = useRef<NodeJS.Timeout>();\n  const stopPollingRef = useRef<boolean>(false);\n\n  /**\n   * Our hooks\n   */\n\n  const {\n    hasTimeStarted: hasVotingStarted,\n    hasTimeEnded: hasVotingEnded,\n    timeStartEndInitReady,\n  } = useTimeStartEnd(countdownVotingStartSeconds, countdownVotingEndSeconds);\n\n  /**\n   * Variables\n   */\n\n  const initialAsyncChecksCompleted: boolean =\n    initComplete &&\n    (useCountdownToCheckInVoting ? timeStartEndInitReady : true);\n\n  const {daoProposalVotingAdapter, snapshotDraft, snapshotProposal} = proposal;\n  const proposalId = snapshotDraft?.idInDAO || snapshotProposal?.idInDAO;\n\n  const atExistsInDAO = daoProposal\n    ? proposalHasFlag(ProposalFlag.EXISTS, daoProposal.flags)\n    : false;\n\n  const atSponsoredInDAO = daoProposal\n    ? proposalHasFlag(ProposalFlag.SPONSORED, daoProposal.flags)\n    : false;\n\n  const atProcessedInDAO = daoProposal\n    ? proposalHasFlag(ProposalFlag.PROCESSED, daoProposal.flags)\n    : false;\n\n  const offchainVotingAddress = daoProposalVotingAdapter?.votingAdapterAddress;\n  const offchainVotingABI = daoProposalVotingAdapter?.getVotingAdapterABI();\n\n  /**\n   * Check if vote result was submitted.\n   * We can do this by checking if `reporter` and `resultRoot` has been set.\n   *\n   * @see `submitVoteResult` in tribute-contracts off-chain voting adapters\n   */\n  const offchainResultSubmitted: boolean =\n    isAddress(daoProposalVote?.reporter || '') &&\n    normalizeString(daoProposalVote?.reporter || '') !== BURN_ADDRESS;\n\n  const isInVotingFromTimer: boolean = hasVotingStarted && !hasVotingEnded;\n\n  const isInVoting: boolean = useCountdownToCheckInVoting\n    ? isInVotingFromTimer\n    : VotingState[daoProposalVoteResult || ''] ===\n      VotingState[VotingState.IN_PROGRESS];\n\n  const isInVotingGracePeriod: boolean =\n    VotingState[daoProposalVoteResult || ''] ===\n    VotingState[VotingState.GRACE_PERIOD];\n\n  /**\n   * Cached callbacks\n   */\n\n  const getStatusFromContractCached = useCallback(getStatusFromContract, [\n    daoProposalVotingAdapter,\n    daoRegistryABI,\n    daoRegistryAddress,\n    offchainVotingABI,\n    offchainVotingAddress,\n    proposalId,\n    web3Instance,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  // Get status as soon as possible.\n  useEffect(() => {\n    if (initComplete) {\n      return;\n    }\n\n    getStatusFromContractCached().catch((error) => {\n      setProposalFlowStatusError(error);\n    });\n  }, [getStatusFromContractCached, initComplete]);\n\n  // Poll for status, etc.\n  useEffect(() => {\n    /**\n     * Stop polling if processed:\n     * Set our ref to be accessed inside of the polling interval callback\n     */\n    if (atProcessedInDAO) {\n      stopPollingRef.current = true;\n    }\n\n    // Clear any previous intervals\n    handleStopPollingForStatus();\n\n    // Then, poll every `x` Ms\n    const intervalId = setInterval(async () => {\n      try {\n        if (stopPollingRef.current) {\n          handleStopPollingForStatus();\n        }\n\n        await getStatusFromContractCached();\n      } catch (error) {\n        const e = error as Error;\n\n        handleStopPollingForStatus();\n\n        setProposalFlowStatusError(e);\n      }\n    }, pollInterval);\n\n    pollingIntervalIdRef.current = intervalId;\n  }, [atProcessedInDAO, pollInterval, getStatusFromContractCached]);\n\n  // Stop polling if propsal is processed, or on unmount.\n  useEffect(() => {\n    if (atProcessedInDAO) {\n      handleStopPollingForStatus();\n    }\n\n    // Cleanup polling on unmount\n    return function cleanup() {\n      handleStopPollingForStatus();\n    };\n  }, [atProcessedInDAO]);\n\n  // Determine the `status`\n  useEffect(() => {\n    // Status: cannot yet be determined\n    if (!initialAsyncChecksCompleted) {\n      setStatus(undefined);\n\n      return;\n    }\n\n    const isStatusInitial: boolean = status === undefined;\n\n    // Status: Submit\n    if (\n      !atExistsInDAO &&\n      !atSponsoredInDAO &&\n      !atProcessedInDAO &&\n      (status === Submit || isStatusInitial)\n    ) {\n      setStatus(Submit);\n\n      return;\n    }\n\n    /**\n     * Status: Sponsor\n     *\n     * This may never occur for many adapter's proposals as submit and sponsor\n     * take place in 1 transaction.\n     */\n    if (\n      atExistsInDAO &&\n      !isInVoting &&\n      (status === Submit || isStatusInitial)\n    ) {\n      setStatus(Sponsor);\n\n      return;\n    }\n\n    // Status: Off-Chain Voting\n    if (\n      atSponsoredInDAO &&\n      isInVoting &&\n      !offchainResultSubmitted &&\n      (status === Submit || status === Sponsor || isStatusInitial)\n    ) {\n      setStatus(OffchainVoting);\n\n      return;\n    }\n\n    // Status: Ready to Submit Vote Result\n    if (\n      atSponsoredInDAO &&\n      !isInVoting &&\n      !offchainResultSubmitted &&\n      (status === OffchainVoting || isStatusInitial)\n    ) {\n      setStatus(OffchainVotingSubmitResult);\n\n      return;\n    }\n\n    // Status: Grace period\n    if (\n      atSponsoredInDAO &&\n      !isInVoting &&\n      offchainResultSubmitted &&\n      isInVotingGracePeriod &&\n      (status === OffchainVotingSubmitResult || isStatusInitial)\n    ) {\n      setStatus(OffchainVotingGracePeriod);\n\n      return;\n    }\n\n    // Status: Process\n    if (\n      atSponsoredInDAO &&\n      !isInVoting &&\n      offchainResultSubmitted &&\n      !isInVotingGracePeriod &&\n      (status === OffchainVotingGracePeriod || isStatusInitial)\n    ) {\n      setStatus(Process);\n\n      return;\n    }\n\n    // Status: Processed (completed)\n    if (atProcessedInDAO && (status === Process || isStatusInitial)) {\n      setStatus(Completed);\n\n      return;\n    }\n  }, [\n    atExistsInDAO,\n    atProcessedInDAO,\n    atSponsoredInDAO,\n    initialAsyncChecksCompleted,\n    isInVoting,\n    isInVotingGracePeriod,\n    offchainResultSubmitted,\n    status,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  async function getStatusFromContract(): Promise<\n    | Partial<{\n        proposal: typeof daoProposal;\n        voteResult: typeof daoProposalVoteResult;\n        votes: typeof daoProposalVote;\n      }>\n    | undefined\n  > {\n    try {\n      if (\n        !daoRegistryABI ||\n        !daoRegistryAddress ||\n        !proposalId ||\n        !web3Instance\n      ) {\n        return;\n      }\n\n      const proposalsABI = daoRegistryABI.filter(\n        (item) => item.name === 'proposals'\n      )[0];\n\n      /**\n       * If there is no voting adapter (i.e. the proposal is not yet sponsored)\n       * then only call the DAO for the proposal data and exit early.\n       */\n      if (!daoProposalVotingAdapter) {\n        const [proposal] = await multicall({\n          calls: [\n            // DAO proposals call\n            [daoRegistryAddress, proposalsABI, [proposalId]],\n          ],\n          web3Instance,\n        });\n\n        setDAOProposal(proposal);\n        // Set last\n        setInitComplete(true);\n\n        return proposal;\n      }\n\n      if (!offchainVotingABI || !offchainVotingAddress) return;\n\n      const voteResultABI = offchainVotingABI.filter(\n        (item) => item.name === 'voteResult'\n      )[0];\n\n      const voteABI = offchainVotingABI.filter(\n        (item) => item.name === 'getVote'\n      )[0];\n\n      const calls: MulticallTuple[] = [\n        // DAO proposals call\n        [daoRegistryAddress, proposalsABI, [proposalId]],\n        // Vote data call\n        [offchainVotingAddress, voteABI, [daoRegistryAddress, proposalId]],\n        // Vote result (state) call\n        [\n          offchainVotingAddress,\n          voteResultABI,\n          [daoRegistryAddress, proposalId],\n        ],\n      ];\n\n      const [proposal, votes, voteResult] = await multicall({\n        calls,\n        web3Instance,\n      });\n\n      const votesToSet = {\n        snapshot: votes[0],\n        reporter: votes[1],\n        resultRoot: votes[2],\n        nbYes: votes[3],\n        nbNo: votes[4],\n        startingTime: votes[5],\n        gracePeriodStartingTime: votes[6],\n        isChallenged: votes[7],\n        stepRequested: votes[8],\n        forceFailed: votes[9],\n        fallbackVotesCount: votes[10],\n      };\n\n      setDAOProposal(proposal);\n      setDAOProposalVote(votesToSet);\n      setDAOProposalVoteResult(voteResult);\n      // Set last\n      setInitComplete(true);\n\n      return {\n        proposal,\n        voteResult,\n        votes,\n      };\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  function handleStopPollingForStatus() {\n    if (pollingIntervalIdRef.current) {\n      clearInterval(pollingIntervalIdRef.current);\n\n      pollingIntervalIdRef.current = undefined;\n    }\n  }\n\n  /**\n   * Return\n   */\n\n  return {\n    daoProposal,\n    daoProposalVote,\n    daoProposalVoteResult,\n    proposalFlowStatusError,\n    status,\n    stopPollingForStatus: handleStopPollingForStatus,\n  };\n}\n","import {useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {\n  buildVoteMessage,\n  getDomainDefinition,\n  getSpace,\n  prepareVoteMessage,\n  signMessage,\n  SnapshotMessageVote,\n  SnapshotSubmitBaseReturn,\n  SnapshotType,\n  SnapshotVoteData,\n  SnapshotVoteProposal,\n  submitMessage,\n  VoteChoicesIndex,\n} from '@openlaw/snapshot-js-erc712';\n\nimport {BURN_ADDRESS} from '../../../util/constants';\nimport {ContractAdapterNames, Web3TxStatus} from '../../web3/types';\nimport {DEFAULT_CHAIN, SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {getAdapterAddressFromContracts} from '../../web3/helpers';\nimport {PRIMARY_TYPE_ERC712} from '../../web3/config';\nimport {StoreState} from '../../../store/types';\nimport {useWeb3Modal} from '../../web3/hooks/useWeb3Modal';\n\ntype SignAndSendVoteDataParam = {\n  choice: SnapshotMessageVote['choice'];\n  metadata?: Record<string, any>;\n};\n\ntype UseSignAndSendVoteReturn = {\n  signAndSendVote: (data: {\n    partialVoteData: SignAndSendVoteDataParam;\n    // e.g. Governance does not have an adpater name\n    adapterName?: ContractAdapterNames;\n    proposalIdInDAO: SnapshotVoteData['payload']['proposalId'];\n    proposalIdInSnapshot: string;\n  }) => Promise<SignAndSendVoteReturn>;\n  voteData: SignAndSendVoteReturn | undefined;\n  voteDataError: Error | undefined;\n  voteDataStatus: Web3TxStatus;\n};\n\ntype SignAndSendVoteReturn = {\n  data: SnapshotVoteData;\n  signature: string;\n  uniqueId: SnapshotSubmitBaseReturn['uniqueId'];\n};\n\n/**\n * useSignAndSendVote\n *\n * React hook which prepares proposal data for submission\n * to Snapshot and Tribute and signs it (ERC712)\n *\n * @returns {Promise<BuildAndSignProposalDataReturn>} An object with the proposal data and the ERC712 signature string.\n */\nexport function useSignAndSendVote(): UseSignAndSendVoteReturn {\n  /**\n   * Selectors\n   */\n\n  const daoRegistryAddress = useSelector(\n    (state: StoreState) => state.contracts.DaoRegistryContract?.contractAddress\n  );\n\n  const contracts = useSelector((s: StoreState) => s.contracts);\n\n  const memberAddress = useSelector(\n    (s: StoreState) => s.connectedMember?.memberAddress\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account, provider, web3Instance} = useWeb3Modal();\n\n  /**\n   * State\n   */\n\n  const [voteData, setVoteData] = useState<SignAndSendVoteReturn>();\n  const [voteDataError, setVoteDataError] = useState<Error>();\n  const [voteDataStatus, setVoteDataStatus] = useState<Web3TxStatus>(\n    Web3TxStatus.STANDBY\n  );\n\n  /**\n   * Functions\n   */\n\n  /**\n   * signAndSendVote\n   *\n   * Builds the vote data for submission to Snapshot and signs it (ERC712).\n   *\n   * @param {SignAndSendVoteDataParam}\n   * @param {adapterName} ContractAdapterNames - An adapter's contract address this data is related to.\n   *   @note Does not accept voting adapter names.\n   * @param {SnapshotVoteData['payload']['proposalHash']} proposalHash - The unique hash of the proposal from snapshot-hub.\n   * @returns {Promise<BuildAndSignProposalDataReturn>} An object with the vote data and the ERC712 signature string.\n   */\n  async function signAndSendVote({\n    partialVoteData,\n    adapterName,\n    proposalIdInDAO,\n    proposalIdInSnapshot,\n  }: {\n    partialVoteData: SignAndSendVoteDataParam;\n    // e.g. Governance does not have an adpater name\n    adapterName?: ContractAdapterNames;\n    /**\n     * This is the hash of the content as submitted to the DAO.\n     * The hash should be the same as the Snapshot draft's, or\n     * proposal's (if not submitted as a draft), ID.\n     *\n     * We need to make sure this matches what has been submitted to\n     * the DAO for later signature verifications.\n     */\n    proposalIdInDAO: SnapshotVoteData['payload']['proposalId'];\n    /**\n     * Must match a `proposal` type's ID in Snapshot so a `vote` may be attached.\n     */\n    proposalIdInSnapshot: string;\n  }): Promise<SignAndSendVoteReturn> {\n    try {\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      if (!account) {\n        throw new Error('No account was found.');\n      }\n\n      if (!memberAddress) {\n        throw new Error('No member address was found.');\n      }\n\n      if (!daoRegistryAddress) {\n        throw new Error('No \"DaoRegistry\" address was found.');\n      }\n\n      if (!SNAPSHOT_HUB_API_URL) {\n        throw new Error('No \"SNAPSHOT_HUB_API_URL\" was found.');\n      }\n\n      if (!SPACE) {\n        throw new Error('No Snapshot \"SPACE\" was found.');\n      }\n\n      setVoteDataStatus(Web3TxStatus.AWAITING_CONFIRM);\n\n      const adapterAddress = adapterName\n        ? getAdapterAddressFromContracts(adapterName, contracts)\n        : BURN_ADDRESS;\n\n      const {choice, metadata = {}} = partialVoteData;\n\n      const {data: snapshotSpace} = await getSpace(SNAPSHOT_HUB_API_URL, SPACE);\n\n      const voteData: SnapshotMessageVote = {\n        chainId: DEFAULT_CHAIN,\n        choice,\n        metadata: {\n          ...metadata,\n          /**\n           * Must be the true member's address for calculating voting power.\n           * It's safest to use our helper Redux value `memberAddress: string`,\n           * as it uses `OffchainVoting.memberAddressesByDelegatedKey`.\n           */\n          memberAddress,\n        },\n      };\n\n      const voteProposalData: SnapshotVoteProposal = {\n        proposalId: proposalIdInDAO,\n        space: SPACE,\n        token: snapshotSpace.token,\n      };\n\n      // 1. Check proposal type and get appropriate message\n      const message = await buildVoteMessage(\n        voteData,\n        voteProposalData,\n        SNAPSHOT_HUB_API_URL\n      );\n\n      const erc712Message = prepareVoteMessage({\n        timestamp: message.timestamp,\n        payload: {\n          proposalId: message.payload.proposalId,\n          choice: VoteChoicesIndex[choice],\n        },\n      });\n\n      const {domain, types} = getDomainDefinition(\n        {...erc712Message, type: SnapshotType.vote},\n        daoRegistryAddress,\n        adapterAddress,\n        DEFAULT_CHAIN\n      );\n\n      const dataToSign = JSON.stringify({\n        types: types,\n        domain: domain,\n        primaryType: PRIMARY_TYPE_ERC712,\n        message: erc712Message,\n      });\n\n      const signature: string = await signMessage(\n        provider,\n        account,\n        dataToSign\n      );\n\n      setVoteDataStatus(Web3TxStatus.PENDING);\n\n      // 3. Send data to snapshot-hub\n      const {data} = await submitMessage<SnapshotSubmitBaseReturn>(\n        SNAPSHOT_HUB_API_URL,\n        account,\n        {\n          ...message,\n          payload: {...message.payload, proposalId: proposalIdInSnapshot},\n        },\n        signature,\n        {\n          actionId: domain.actionId,\n          chainId: domain.chainId,\n          verifyingContract: domain.verifyingContract,\n          message: erc712Message,\n        }\n      );\n\n      const dataToReturn = {\n        data: message,\n        signature,\n        uniqueId: data.uniqueId,\n      };\n\n      setVoteDataStatus(Web3TxStatus.FULFILLED);\n      setVoteData(dataToReturn);\n\n      return dataToReturn;\n    } catch (error) {\n      const e = error as Error;\n\n      setVoteDataStatus(Web3TxStatus.REJECTED);\n      setVoteDataError(e);\n\n      throw error;\n    }\n  }\n\n  return {\n    signAndSendVote,\n    voteData,\n    voteDataError,\n    voteDataStatus,\n  };\n}\n","import {useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {\n  buildDraftMessage,\n  buildProposalMessage,\n  getDomainDefinition,\n  getSpace,\n  prepareDraftMessage,\n  prepareProposalMessage,\n  signMessage,\n  SnapshotMessageBase,\n  SnapshotMessageProposal,\n  SnapshotProposalData,\n  SnapshotSubmitBaseReturn,\n  SnapshotSubmitProposalReturn,\n  SnapshotType,\n  submitMessage,\n} from '@openlaw/snapshot-js-erc712';\n\nimport {\n  ContractAdapterNames,\n  ContractDAOConfigKeys,\n  Web3TxStatus,\n} from '../../web3/types';\nimport {DEFAULT_CHAIN, SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {\n  getAdapterAddressFromContracts,\n  getDAOConfigEntry,\n} from '../../web3/helpers';\nimport {PRIMARY_TYPE_ERC712} from '../../web3/config';\nimport {\n  ProposalOrDraftSignDataFromType,\n  ProposalOrDraftSnapshotType,\n} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useWeb3Modal} from '../../web3/hooks/useWeb3Modal';\nimport {BURN_ADDRESS} from '../../../util/constants';\n\ntype SignAndSendData<T extends ProposalOrDraftSnapshotType> = {\n  partialProposalData: PrepareAndSignProposalDataParam;\n  adapterAddress?: string;\n  adapterName?: ContractAdapterNames;\n  type: T;\n};\n\ntype PrepareAndSignProposalDataParam = {\n  body: SnapshotProposalData['payload']['body'];\n  name: SnapshotProposalData['payload']['name'];\n  metadata: SnapshotProposalData['payload']['metadata'];\n  /**\n   * Helpful for Proposal types when hashes between created Drafts\n   * and yet to be created Proposals need to match.\n   */\n  timestamp?: SnapshotProposalData['timestamp'];\n};\n\ntype UseSignAndSubmitProposalReturn<T extends ProposalOrDraftSnapshotType> = {\n  signAndSendProposal: (\n    d: SignAndSendData<T>\n  ) => Promise<SignAndSendProposalReturn<T>>;\n  proposalData: SignAndSendProposalReturn<T> | undefined;\n  proposalSignAndSendError: Error | undefined;\n  proposalSignAndSendStatus: Web3TxStatus;\n};\n\ntype SignAndSendProposalReturn<T extends ProposalOrDraftSnapshotType> = {\n  data: ProposalOrDraftSignDataFromType<T>;\n  signature: string;\n  submitter: string;\n  uniqueId: SnapshotSubmitBaseReturn['uniqueId'];\n  uniqueIdDraft: SnapshotSubmitProposalReturn['uniqueIdDraft'];\n};\n\n/**\n * useSignAndSubmitProposal\n *\n * React hook which prepares proposal data for submission\n * to Snapshot and Tribute and signs it (ERC712)\n *\n * @returns {Promise<UseSignAndSubmitProposalReturn>} An object with the proposal data and the ERC712 signature string.\n */\nexport function useSignAndSubmitProposal<\n  T extends ProposalOrDraftSnapshotType\n>(): UseSignAndSubmitProposalReturn<T> {\n  /**\n   * Selectors\n   */\n\n  const daoRegistryAddress = useSelector(\n    (state: StoreState) => state.contracts.DaoRegistryContract?.contractAddress\n  );\n  const daoRegistryInstance = useSelector(\n    (state: StoreState) => state.contracts.DaoRegistryContract?.instance\n  );\n  const contracts = useSelector((state: StoreState) => state.contracts);\n\n  /**\n   * Our hooks\n   */\n\n  const {account, provider, web3Instance} = useWeb3Modal();\n\n  /**\n   * State\n   */\n\n  const [proposalData, setProposalData] =\n    useState<SignAndSendProposalReturn<T>>();\n  const [proposalSignAndSendError, setProposalSignAndSendError] =\n    useState<Error>();\n  const [proposalSignAndSendStatus, setProposalSignAndSendStatus] =\n    useState<Web3TxStatus>(Web3TxStatus.STANDBY);\n\n  /**\n   * Functions\n   */\n\n  /**\n   * A wrapper to clearly separate the running of functions\n   * specific to Proposals.\n   *\n   * @param {SnapshotMessageBase & Partial<SnapshotMessageProposal>} commonData\n   * @returns {Promise<SnapshotProposalData>}\n   */\n  async function buildProposalMessageHelper(\n    commonData: SnapshotMessageBase & Partial<SnapshotMessageProposal>\n  ): Promise<SnapshotProposalData> {\n    if (!SNAPSHOT_HUB_API_URL) {\n      throw new Error('No \"SNAPSHOT_HUB_API_URL\" was found.');\n    }\n\n    if (!web3Instance) {\n      throw new Error('No Web3 instance was found.');\n    }\n\n    const snapshot: number = await web3Instance.eth.getBlockNumber();\n\n    const votingTimeSeconds: number = parseInt(\n      await getDAOConfigEntry(\n        daoRegistryInstance,\n        ContractDAOConfigKeys.offchainVotingVotingPeriod\n      )\n    );\n\n    return await buildProposalMessage(\n      {\n        ...commonData,\n        votingTimeSeconds,\n        snapshot,\n      },\n      SNAPSHOT_HUB_API_URL\n    );\n  }\n\n  /**\n   * signAndSendProposal\n   *\n   * Builds the proposal data for submission to Tribute and Snapshot and signs it (ERC712).\n   *\n   * @returns {Promise<SignAndSendProposalReturn>} An object with the proposal data, signature string, and propsal hash(es) from snapshot-hub.\n   */\n  async function signAndSendProposal({\n    partialProposalData,\n    adapterAddress,\n    adapterName,\n    type,\n  }: SignAndSendData<T>): Promise<SignAndSendProposalReturn<T>> {\n    try {\n      if (!account) {\n        throw new Error('No account was found to send.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      if (!daoRegistryAddress) {\n        throw new Error('No \"DaoRegistry\" address was found.');\n      }\n\n      if (!SNAPSHOT_HUB_API_URL) {\n        throw new Error('No \"SNAPSHOT_HUB_API_URL\" was found.');\n      }\n\n      if (!SPACE) {\n        throw new Error('No Snapshot \"SPACE\" was found.');\n      }\n\n      if (type !== SnapshotType.draft && type !== SnapshotType.proposal) {\n        throw new Error('Handling for type \"vote\" is not implemented.');\n      }\n\n      setProposalSignAndSendStatus(Web3TxStatus.AWAITING_CONFIRM);\n\n      const actionId = adapterAddress\n        ? adapterAddress\n        : adapterName\n        ? getAdapterAddressFromContracts(adapterName, contracts)\n        : BURN_ADDRESS;\n\n      const {body, name, metadata, timestamp} = partialProposalData;\n\n      const {data: snapshotSpace} = await getSpace(SNAPSHOT_HUB_API_URL, SPACE);\n\n      const commonData: SnapshotMessageBase = {\n        name,\n        body,\n        metadata,\n        token: snapshotSpace.token,\n        space: SPACE,\n      };\n\n      // 1. Check proposal type and prepare appropriate message\n      const message = (\n        type === SnapshotType.draft\n          ? await buildDraftMessage(commonData, SNAPSHOT_HUB_API_URL)\n          : await buildProposalMessageHelper({\n              ...commonData,\n              timestamp,\n            })\n      ) as ProposalOrDraftSignDataFromType<T>;\n\n      // 2. Prepare signing data. Snapshot and the contracts will verify this same data against the signature.\n      const erc712Message =\n        type === SnapshotType.draft\n          ? prepareDraftMessage(message)\n          : prepareProposalMessage(message as SnapshotProposalData);\n\n      const {domain, types} = getDomainDefinition(\n        {...erc712Message, type},\n        daoRegistryAddress,\n        actionId,\n        DEFAULT_CHAIN\n      );\n\n      const dataToSign = JSON.stringify({\n        types,\n        domain,\n        primaryType: PRIMARY_TYPE_ERC712,\n        message: erc712Message,\n      });\n\n      // 3. Sign data\n      const signature = await signMessage(provider, account, dataToSign);\n\n      setProposalSignAndSendStatus(Web3TxStatus.PENDING);\n\n      // 3. Send data to snapshot-hub\n      const {data} = await submitMessage<SnapshotSubmitProposalReturn>(\n        SNAPSHOT_HUB_API_URL,\n        account,\n        message,\n        signature,\n        {\n          actionId: domain.actionId,\n          chainId: domain.chainId,\n          verifyingContract: domain.verifyingContract,\n          message: erc712Message,\n        }\n      );\n\n      const dataToReturn = {\n        data: message,\n        signature,\n        submitter: account,\n        uniqueId: data.uniqueId,\n        uniqueIdDraft: data.uniqueIdDraft || '',\n      };\n\n      setProposalSignAndSendStatus(Web3TxStatus.FULFILLED);\n      setProposalData(dataToReturn);\n\n      return dataToReturn;\n    } catch (error) {\n      const e = error as Error;\n\n      setProposalSignAndSendStatus(Web3TxStatus.REJECTED);\n      setProposalSignAndSendError(e);\n\n      throw error;\n    }\n  }\n\n  return {\n    proposalData,\n    proposalSignAndSendError,\n    proposalSignAndSendStatus,\n    signAndSendProposal,\n  };\n}\n","import {ToStepNodeResult} from '@openlaw/snapshot-js-erc712/dist/types';\n\n/**\n * @see `IVoting.sol` in tribute-contracts\n */\nexport enum VotingState {\n  NOT_STARTED,\n  TIE,\n  PASS,\n  NOT_PASS,\n  IN_PROGRESS,\n  GRACE_PERIOD,\n}\n\n/**\n * @see `OffchainVoting.sol->getBadNodeError` in tribute-contracts\n */\nexport enum BadNodeError {\n  OK,\n  WRONG_PROPOSAL_ID,\n  INVALID_CHOICE,\n  AFTER_VOTING_PERIOD,\n  BAD_SIGNATURE,\n  INDEX_OUT_OF_BOUND,\n  VOTE_NOT_ALLOWED,\n}\n\n/**\n * Response when calling `GET snapshot-hub/api/:space/offchain_proof/:merkle_root`\n */\nexport type SnapshotOffchainProofResponse = {\n  merkle_root: string;\n  space: string;\n  steps: ToStepNodeResult[];\n};\n","import {BlockTransactionBase} from 'web3-eth';\nimport Web3 from 'web3';\n\ninterface TemporaryBlockTxType extends BlockTransactionBase {\n  baseFeePerGas?: string;\n}\n\n/**\n * Checks if the block header contains fields that indicate EIP-1559\n * support (i.e. `baseFeePerGas`).\n *\n * @todo Fix types once `web3-eth` types are up-to-date.\n *\n * @returns {Promise<boolean>} true if current network supports EIP-1559\n */\nexport async function isEIP1559Compatible(\n  /**\n   * May be arriving in async (from a hook),\n   * hence the `undefined` type.\n   */\n  web3Instance: Web3 | undefined\n): Promise<boolean> {\n  const latestBlock = (await web3Instance?.eth.getBlock(\n    'latest'\n  )) as TemporaryBlockTxType;\n\n  return latestBlock?.baseFeePerGas !== undefined;\n}\n","import ReactModal from 'react-modal';\n\nimport FadeIn from './FadeIn';\n\ntype ModalProps = {\n  children: React.ReactNode;\n  isOpen: boolean;\n  isOpenHandler: (isOpen: boolean) => void;\n  keyProp: string;\n  modalClassNames?: string;\n  styleProps?: Record<string, string>;\n};\n\nexport default function Modal({\n  children,\n  isOpen,\n  isOpenHandler,\n  keyProp,\n  modalClassNames,\n  styleProps,\n}: ModalProps) {\n  return (\n    <ReactModal\n      key={keyProp}\n      ariaHideApp={false}\n      className={`modal-container ${modalClassNames}`}\n      isOpen={isOpen}\n      onRequestClose={() => {\n        isOpenHandler(isOpen);\n      }}\n      overlayClassName=\"modal-overlay\"\n      role=\"dialog\"\n      style={\n        {\n          overlay: {zIndex: '99'},\n          ...styleProps,\n        } as any\n      }>\n      <FadeIn>\n        <div className=\"modal\">{children}</div>\n      </FadeIn>\n    </ReactModal>\n  );\n}\n","/**\n * BURN_ADDRESS\n *\n * - e.g. Helpful when detecting no address.\n * - e.g. Helpful for ERC-712 signatures which have no action id (like Governance).\n */\nexport const BURN_ADDRESS: '0x0000000000000000000000000000000000000000' =\n  '0x0000000000000000000000000000000000000000';\n","import {lazy, Suspense} from 'react';\n\ntype WalletIconProps = {\n  providerName: string | undefined;\n};\n\n/**\n * Lazy load SVG's\n */\n\nconst MetaMaskSVG = lazy(() => import('../../assets/svg/MetaMaskSVG'));\n\nconst WalletConnectSVG = lazy(\n  () => import('../../assets/svg/WalletConnectSVG')\n);\n\n// Mapping of provider name to lazy component\nconst walletIconMap: Record<string, JSX.Element> = {\n  injected: <MetaMaskSVG />,\n  walletconnect: <WalletConnectSVG />,\n};\n\nexport function WalletIcon({\n  providerName,\n}: WalletIconProps): JSX.Element | null {\n  if (!providerName || !walletIconMap[providerName]) return null;\n\n  return (\n    <Suspense fallback={null}>\n      <span className=\"walletconnect__wallet-icon\">\n        {walletIconMap[providerName]}\n      </span>\n    </Suspense>\n  );\n}\n","export * from './CycleEllipsis';\n","type EtherscanURLProps = {\n  url: string;\n  isPending?: boolean;\n};\n\nexport default function EtherscanURL(props: EtherscanURLProps) {\n  const {url, isPending = false} = props;\n\n  return (\n    <small>\n      <a href={url} rel=\"noopener noreferrer\" target=\"_blank\">\n        {isPending ? 'view progress' : 'view transaction'}\n      </a>\n    </small>\n  );\n}\n","import React, {useEffect, useState} from 'react';\n\ninterface IProps {\n  // Show spinner after some time has elapsed.\n  // Prevents the \"sudden spinner\" UI/UX no-no.\n  // Esp. if we could have cached data.\n  showAfterMs?: number;\n  text?: string;\n  textProps?: {[key: string]: any};\n}\n\nfunction Spinner(props: Partial<IProps>) {\n  return <div className=\"loader\" {...props} />;\n}\n\nconst Loader = (\n  props: IProps & React.PropsWithoutRef<JSX.IntrinsicElements['div']>\n) => {\n  const {showAfterMs, text, textProps, ...loaderProps} = props;\n  const [showLoaderAfterMs, setShowLoaderAfterMs] = useState<boolean>(false);\n\n  useEffect(() => {\n    /* 200ms is approx. the time a user will notice a stalled, blank screen */\n    const timeoutId =\n      showAfterMs && setTimeout(() => setShowLoaderAfterMs(true), showAfterMs);\n\n    return function cleanup() {\n      timeoutId && clearTimeout(timeoutId);\n    };\n  }, [showAfterMs]);\n\n  return (!showAfterMs || (showAfterMs && showLoaderAfterMs)) && props.text ? (\n    <div className=\"loader-container\">\n      <Spinner {...loaderProps} />\n      <span className=\"loader__text\" {...textProps}>\n        {text}\n      </span>\n    </div>\n  ) : (!showAfterMs || (showAfterMs && showLoaderAfterMs)) && !props.text ? (\n    <Spinner {...loaderProps} />\n  ) : null;\n};\n\nexport default Loader;\n","export function calculateVotingTimeRanges({\n  gracePeriodLength,\n  gracePeriodStartingTime,\n  votePeriodLength,\n  voteStartingTime,\n}: {\n  gracePeriodLength: string | undefined;\n  gracePeriodStartingTime: string | undefined;\n  votePeriodLength: string | undefined;\n  voteStartingTime: string | undefined;\n}): {\n  gracePeriodEndMs: number;\n  gracePeriodStartMs: number;\n  voteEndMs: number;\n  voteStartMs: number;\n} {\n  const MS_MULTIPLIER: number = 1000;\n  const toNumber = (value: string | undefined): number => Number(value || 0);\n\n  const gracePeriodStartMs: number =\n    toNumber(gracePeriodStartingTime) * MS_MULTIPLIER;\n\n  const voteStartMs: number = toNumber(voteStartingTime) * MS_MULTIPLIER;\n\n  return {\n    voteEndMs: voteStartMs + toNumber(votePeriodLength) * MS_MULTIPLIER,\n    voteStartMs,\n    gracePeriodEndMs:\n      gracePeriodStartMs + toNumber(gracePeriodLength) * MS_MULTIPLIER,\n    gracePeriodStartMs,\n  };\n}\n","import {SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {SnapshotOffchainProofResponse} from '../voting/types';\n\n/**\n * getOffchainVotingProof\n *\n * Gets a Merkle hex root's steps from Snapshot Hub\n * for verification.\n *\n * @link https://github.com/openlawteam/snapshot-hub\n */\nexport async function getOffchainVotingProof(\n  merkleRootHex: string\n): Promise<SnapshotOffchainProofResponse | undefined> {\n  try {\n    const response = await fetch(\n      `${SNAPSHOT_HUB_API_URL}/api/${SPACE}/offchain_proof/${merkleRootHex}`\n    );\n\n    // Return empty if not found\n    if (response.status === 404) {\n      return undefined;\n    }\n\n    // Some other error occured\n    if (!response.ok) {\n      throw new Error(\n        'Something went wrong while getting the off-chain vote proof.'\n      );\n    }\n\n    return await response.json();\n  } catch (error) {\n    throw error;\n  }\n}\n","import {VoteChoicesIndex} from '@openlaw/snapshot-js-erc712';\n\nimport {normalizeString} from '../../../util/helpers';\nimport {SnapshotProposal} from '../types';\nimport {VoteChoices} from '../../web3/types';\n\nexport function getVoteChosen(\n  votes: SnapshotProposal['votes'],\n  account: string\n): VoteChoices | undefined {\n  const voteEntry = (votes || []).find((ve) =>\n    Object.entries(ve).find(\n      ([address, _voteData]) =>\n        normalizeString(address) === normalizeString(account || '')\n    )\n  );\n\n  if (voteEntry) {\n    const voteData = Object.entries(voteEntry)[0][1];\n    const choice = voteData.msg.payload.choice;\n\n    return choice === VoteChoicesIndex.Yes ? VoteChoices.Yes : VoteChoices.No;\n  }\n\n  return undefined;\n}\n","import {AbiItem} from 'web3-utils/types';\n\nimport {VotingAdapterName} from '../../adapters-extensions/enums';\n\n/**\n * getVotingAdapterABI\n *\n * Gets the ABI for a voting adapter by the adapter's adapter name.\n *\n * @param {VotingAdapterName} votingAdapterName\n * @returns {Promise<AbiItem[]>}\n */\nexport async function getVotingAdapterABI(\n  votingAdapterName: VotingAdapterName\n): Promise<AbiItem[]> {\n  try {\n    switch (votingAdapterName) {\n      // Off-chain optimistic rollup\n      case VotingAdapterName.OffchainVotingContract:\n        const {default: lazyOffchainVotingABI} = await import(\n          '../../../abis/tribute-contracts/OffchainVotingContract.json'\n        );\n\n        return lazyOffchainVotingABI as AbiItem[];\n\n      // On-chain voting\n      case VotingAdapterName.VotingContract:\n        const {default: lazyVotingABI} = await import(\n          '../../../abis/tribute-contracts/VotingContract.json'\n        );\n\n        return lazyVotingABI as AbiItem[];\n\n      default:\n        throw new Error(\n          `No voting adapter name was found for \"${votingAdapterName}\".`\n        );\n    }\n  } catch (error) {\n    throw error;\n  }\n}\n","import {ProposalFlag} from '../types';\n\n/**\n * proposalHasFlag\n *\n * @param flagToCheck\n * @param daoProposalFlag\n * @returns {boolean}\n *\n * @see `ProposalFlag` `DaoRegistry.sol`\n * @see `getFlag` `DaoHelper.sol`\n * @see `setFlag` `DaoHelper.sol`\n */\nexport function proposalHasFlag(\n  flagToCheck: ProposalFlag,\n  daoProposalFlag: number | string\n): boolean {\n  return flagToCheck === Math.log2(Number(daoProposalFlag) + 1) - 1;\n}\n","import {VotingState} from '../voting/types';\n\nexport function proposalHasVotingState(\n  votingStateToCheck: VotingState,\n  votingState: number | string\n): boolean {\n  return VotingState[votingState] === VotingState[votingStateToCheck];\n}\n","import {SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {ToStepNodeResult} from '@openlaw/snapshot-js-erc712/dist/types';\n\ntype SubmitOffchainVotingProofArguments = {\n  /**\n   * DAO Adapter address\n   */\n  actionId: string;\n  /**\n   * Blockchain network ID\n   */\n  chainId: number;\n  /**\n   * Hex string of the Merkle root\n   */\n  merkleRoot: string;\n  /**\n   * An array of Merkle tree steps\n   */\n  steps: ToStepNodeResult[];\n  /**\n   * DAO Registry address\n   */\n  verifyingContract: string;\n};\n\n/**\n * submitOffchainVotingProof\n *\n * Submits a Merkle hex root and its steps to Snapshot Hub\n * for verification and storage (if successful).\n *\n * The API endpoint does not have any return data, only a `201` response.\n *\n * @link https://github.com/openlawteam/snapshot-hub\n */\nexport async function submitOffchainVotingProof(\n  data: SubmitOffchainVotingProofArguments\n): Promise<void> {\n  try {\n    const response = await fetch(\n      `${SNAPSHOT_HUB_API_URL}/api/${SPACE}/offchain_proofs`,\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    if (!response.ok) {\n      throw new Error(\n        'Something went wrong while submitting the off-chain vote proof.'\n      );\n    }\n  } catch (error) {\n    throw error;\n  }\n}\n","import {CoreProposalVoteChoices} from '@openlaw/snapshot-js-erc712';\nimport {VoteChoices} from './types';\n\n/**\n * WEB3 CONFIG for TRIBUTE\n */\n\n// Vote choices should be \"yes\", \"no\" unless Tribute contracts change.\nexport const VOTE_CHOICES: CoreProposalVoteChoices = [\n  VoteChoices.Yes,\n  VoteChoices.No,\n];\n\n// When signing data this is the `primaryType` key's value which is part of the data to sign.\nexport const PRIMARY_TYPE_ERC712 = 'Message';\n\nexport const TX_CYCLE_MESSAGES: string[] = [\n  'Submitting\\u2026',\n  'Working\\u2026',\n  'DAOing\\u2026',\n  'Getting closer\\u2026',\n  'Dreaming of ETH\\u2026',\n];\n","import React, {useState, useEffect} from 'react';\n\nimport {chooseRandom} from '../../util/helpers';\n\ntype CycleMessageProps = {\n  /**\n   * Use the first item as the default.\n   */\n  useFirstItemStart?: boolean;\n  /**\n   * What is the interval of cycling the message?\n   */\n  intervalMs: number;\n  /**\n   * Provide multiple strings to cycle through.\n   */\n  messages: string[];\n  /**\n   * Render a React Element.\n   * activeMessage is passed in.\n   */\n  render: (m: string) => React.ReactElement;\n};\n\nexport default function CycleMessage(props: CycleMessageProps) {\n  const {intervalMs, messages, useFirstItemStart} = props;\n\n  // Default item at start.\n  const INITIAL_ITEM = useFirstItemStart\n    ? messages[0]\n    : chooseRandom<string>(messages);\n\n  const [activeMessage, setActiveMessage] = useState<string>(INITIAL_ITEM);\n\n  useEffect(() => {\n    const intervalId = setInterval(\n      () =>\n        setActiveMessage((prevMessage) =>\n          chooseRandom<string>(messages, prevMessage)\n        ),\n      intervalMs\n    );\n\n    return () => {\n      clearInterval(intervalId);\n    };\n  }, [intervalMs, messages]);\n\n  return props.render(activeMessage);\n}\n","import Web3 from 'web3';\n\nexport const hasValue = (value: string) => (value !== '' ? true : false);\n\nexport const isEmailValid = (email: string) =>\n  /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$/i.test(email);\n\nexport const isEthAddressValid = (ethAddress: string) =>\n  Web3.utils.isAddress(ethAddress);\n","import {useState, useEffect} from 'react';\n\ntype LoaderLargeProps = {\n  // Show waiting effect after some time has elapsed. Prevents the \"sudden\n  // spinner\" UI/UX no-no. Esp. if we could have cached data.\n  showAfterMs?: number;\n};\n\nexport default function LoaderLarge(props: LoaderLargeProps) {\n  const {showAfterMs} = props;\n  const [showLoaderAfterMs, setShowLoaderAfterMs] = useState<boolean>(false);\n\n  useEffect(() => {\n    /* 200ms is approx. the time a user will notice a stalled, blank screen */\n    const timeoutId =\n      showAfterMs && setTimeout(() => setShowLoaderAfterMs(true), showAfterMs);\n\n    return function cleanup() {\n      timeoutId && clearTimeout(timeoutId);\n    };\n  }, [showAfterMs]);\n\n  return !showAfterMs || (showAfterMs && showLoaderAfterMs) ? (\n    <div className=\"loader--large\" aria-label=\"Loading content...\" />\n  ) : null;\n}\n","/**\n * WEB3 TYPES\n */\n\n// ...\n\n/**\n * WEB3 ENUMS\n */\n\n/**\n * Mapping of DaoRegistry member flags. This should match the enum (including\n * order) in the `DaoRegistry`. If it does not match,\n * the results of checking the proposal's state via flag will be wrong.\n *\n * @see `MemberFlag` `DaoRegistry.sol`\n * @see `getFlag` `DaoHelper.sol`\n * @see `setFlag` `DaoHelper.sol`\n */\nexport enum MemberFlag {\n  EXISTS,\n}\n\n/**\n * Should match tribute-contracts constants\n *\n * @todo Add other extensions as needs arise\n */\nexport enum ContractAdapterNames {\n  bank = 'bank',\n  configuration = 'configuration',\n  coupon_onboarding = 'coupon-onboarding',\n  dao_registry = 'daoRegistry',\n  distribute = 'distribute',\n  financing = 'financing',\n  guildkick = 'guildkick',\n  kyc_onboarding = 'kyc-onboarding',\n  managing = 'managing',\n  nft = 'nft',\n  onboarding = 'onboarding',\n  ragequit = 'ragequit',\n  tribute = 'tribute',\n  tribute_nft = 'tribute-nft',\n  voting = 'voting',\n}\n\n/**\n * Should match tribute-contracts constants\n *\n * @todo Add other extensions as needs arise\n */\nexport enum ContractExtensionNames {\n  bank = 'bank',\n  erc20 = 'erc20-ext',\n  nft = 'nft',\n}\n\n/**\n * Should match tribute-contracts constants\n *\n * @todo Add other extensions as needs arise\n */\nexport enum ContractDAOConfigKeys {\n  kycOnboardingChunkSize = 'kyc-onboarding.chunkSize',\n  kycOnboardingFundTargetAddress = 'kyc-onboarding.fundTargetAddress',\n  kycOnboardingMaximumChunks = 'kyc-onboarding.maximumChunks',\n  kycOnboardingMaxMembers = 'kyc-onboarding.maxMembers',\n  kycOnboardingSignerAddress = 'kyc-onboarding.signerAddress',\n  kycOnboardingTargetAddress = 'kyc-onboarding.tokenAddr',\n  kycOnboardingUnitsPerChunk = 'kyc-onboarding.unitsPerChunk',\n  offchainVotingGracePeriod = 'offchainvoting.gracePeriod',\n  offchainVotingStakingAmount = 'offchainvoting.stakingAmount',\n  offchainVotingVotingPeriod = 'offchainvoting.votingPeriod',\n  onboardingChunkSize = 'onboarding.chunkSize',\n  onboardingMaximumChunks = 'onboarding.maximumChunks',\n  onboardingUnitsPerChunk = 'onboarding.unitsPerChunk',\n  onboardingTokenAddr = 'onboarding.tokenAddr',\n  votingGracePeriod = 'voting.gracePeriod',\n  votingStakingAmount = 'voting.stakingAmount',\n  votingVotingPeriod = 'voting.votingPeriod',\n}\n\nexport enum VoteChoices {\n  Yes = 'Yes',\n  No = 'No',\n}\n\nexport enum Web3TxStatus {\n  STANDBY = 'STANDBY',\n  AWAITING_CONFIRM = 'AWAITING_CONFIRM',\n  PENDING = 'PENDING',\n  FULFILLED = 'FULFILLED',\n  REJECTED = 'REJECTED',\n}\n","export enum SubgraphNetworkStatus {\n  OK = 'OK',\n  ERR = 'ERR',\n}\n\nexport type SubgraphNetworkStatusState = {\n  status: SubgraphNetworkStatus;\n};\n"],"sourceRoot":""}